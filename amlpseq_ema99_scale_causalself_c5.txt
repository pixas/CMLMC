2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | distributed init (rank 0): tcp://localhost:15922
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | distributed init (rank 1): tcp://localhost:15922
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | distributed init (rank 2): tcp://localhost:15922
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | distributed init (rank 3): tcp://localhost:15922
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for 4 nodes.
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | initialized host SH-IDC1-10-140-0-245 as rank 0
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for 4 nodes.
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for 4 nodes.
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | initialized host SH-IDC1-10-140-0-245 as rank 2
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | initialized host SH-IDC1-10-140-0-245 as rank 1
2023-02-27 23:40:49 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for 4 nodes.
2023-02-27 23:40:49 | INFO | fairseq.distributed_utils | initialized host SH-IDC1-10-140-0-245 as rank 3
2023-02-27 23:40:54 | INFO | fairseq_cli.train | Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, all_gather_list_size=16384, amlp_activation='softmax', apply_bert_init=True, arch='cmlm_transformer_wmt_en_de', attention_dropout=0.0, best_checkpoint_metric='loss', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_suffix='', clip_norm=0.0, concatPE=True, cpu=False, criterion='nat_loss', cross_self_attention=False, curriculum=0, data='/mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', decoder_attention_heads=8, decoder_cross_attention_type='amlpseq', decoder_embed_dim=512, decoder_embed_path=None, decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=False, decoder_output_dim=512, decoder_self_attention_type='amlpseq', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:15922', distributed_no_spawn=False, distributed_num_procs=4, distributed_port=-1, distributed_rank=0, distributed_world_size=4, distributed_wrapper='DDP', dont_use_layernorm=False, dropout=0.2, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_embed_path=None, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=False, encoder_self_attention_type='mha', eval_bleu=True, eval_bleu_args='{"iter_decode_max_iter": 0, "iter_decode_with_beam": 1}', eval_bleu_detok='space', eval_bleu_detok_args=None, eval_bleu_print_samples=False, eval_bleu_remove_bpe='@@ ', eval_tokenized_bleu=True, fast_stat_sync=False, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, fp16=True, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, insertCausalSelfAttn=True, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=20, label_smoothing=0.1, landmarks=16, left_pad_source='True', left_pad_target='False', length_loss_factor=0.1, load_alignments=False, localsgd_frequency=3, log_format=None, log_interval=100, lr=[0.0005], lr_scheduler='inverse_sqrt', maskdistshiftpower=1.0, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=16384, max_tokens_valid=16384, max_update=300000, maximize_best_checkpoint_metric=False, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=-1, model_parallel_size=1, ngram_predictor=1, no_cross_attention=False, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=True, no_token_positional_embeddings=False, noise='random_mask', nprocs_per_node=4, num_batch_buckets=0, num_workers=1, optimizer='adam', optimizer_overrides='{}', patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=None, pipeline_devices=None, pipeline_model_parallel=False, pred_length_offset=False, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, replacefactor=0.3, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/', save_interval=1, save_interval_updates=0, scoring='bleu', seed=1, selfcorrection=0, sentence_avg=False, sg_length_pred=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, source_lang='de', src_embedding_copy=False, stop_time_hours=0, target_lang='en', task='translation_lev', tensorboard_logdir='', threshold_loss_scale=None, tokenizer=None, tpu=False, train_subset='train', truncate_source=False, update_freq=[1], upsample_primary=1, use_bmuf=False, use_old_adam=False, user_dir=None, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, warmup_init_lr=1e-07, warmup_updates=40000, weight_decay=0.01, zero_sharding='none')
2023-02-27 23:40:55 | INFO | fairseq.tasks.translation | [de] dictionary: 39960 types
2023-02-27 23:40:55 | INFO | fairseq.tasks.translation | [en] dictionary: 39960 types
2023-02-27 23:40:55 | INFO | fairseq.data.data_utils | loaded 3000 examples from: /mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict/valid.de-en.de
2023-02-27 23:40:55 | INFO | fairseq.data.data_utils | loaded 3000 examples from: /mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict/valid.de-en.en
2023-02-27 23:40:55 | INFO | fairseq.tasks.translation | /mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict valid de-en 3000 examples
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:55 | INFO | root | Using efficient attention MultiheadAttention
2023-02-27 23:40:55 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:56 | INFO | root | Using efficient attention FSAMLPSeq
2023-02-27 23:40:56 | INFO | fairseq_cli.train | CMLMNATransformerModel(
  (encoder): FairseqNATEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(39960, 512, padding_idx=1)
    (embed_positions): LearnedPositionalEmbedding(1026, 512, padding_idx=1)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (PEfc): Linear(in_features=1024, out_features=512, bias=True)
  )
  (decoder): NATransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(39960, 512, padding_idx=1)
    (PEfc): Linear(in_features=1024, out_features=512, bias=True)
    (embed_positions): LearnedPositionalEmbedding(1026, 512, padding_idx=1)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn_unmasked): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (self_attn_unmasked_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn_unmasked): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (self_attn_unmasked_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn_unmasked): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (self_attn_unmasked_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn_unmasked): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (self_attn_unmasked_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn_unmasked): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (self_attn_unmasked_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn_unmasked): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (self_attn_unmasked_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): FSCls(
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (k_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (v_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (w_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (approx_out_proj): Linear(in_features=128, out_features=64, bias=True)
          (conv): Conv2d(8, 8, kernel_size=(5, 1), stride=(1, 1), padding=(2, 0), groups=8)
          (drop): Dropout(p=0.0, inplace=False)
          (out_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (output_projection): Linear(in_features=512, out_features=39960, bias=False)
    (embed_length): Embedding(256, 512)
  )
)
2023-02-27 23:40:56 | INFO | fairseq_cli.train | task: translation_lev (TranslationLevenshteinTask)
2023-02-27 23:40:56 | INFO | fairseq_cli.train | model: cmlm_transformer_wmt_en_de (CMLMNATransformerModel)
2023-02-27 23:40:56 | INFO | fairseq_cli.train | criterion: nat_loss (LabelSmoothedDualImitationCriterion)
2023-02-27 23:40:56 | INFO | fairseq_cli.train | num. model params: 73443136 (num. trained: 73443136)
2023-02-27 23:40:56 | INFO | fairseq.trainer | detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2023-02-27 23:40:56 | INFO | fairseq.trainer | detected shared parameter: encoder.embed_tokens.weight <- decoder.output_projection.weight
2023-02-27 23:40:56 | INFO | fairseq.utils | ***********************CUDA enviroments for all 4 workers***********************
2023-02-27 23:40:56 | INFO | fairseq.utils | rank   0: capabilities =  8.0  ; total memory = 79.347 GB ; name = NVIDIA A100-SXM4-80GB                   
2023-02-27 23:40:56 | INFO | fairseq.utils | rank   1: capabilities =  8.0  ; total memory = 79.347 GB ; name = NVIDIA A100-SXM4-80GB                   
2023-02-27 23:40:56 | INFO | fairseq.utils | rank   2: capabilities =  8.0  ; total memory = 79.347 GB ; name = NVIDIA A100-SXM4-80GB                   
2023-02-27 23:40:56 | INFO | fairseq.utils | rank   3: capabilities =  8.0  ; total memory = 79.347 GB ; name = NVIDIA A100-SXM4-80GB                   
2023-02-27 23:40:56 | INFO | fairseq.utils | ***********************CUDA enviroments for all 4 workers***********************
2023-02-27 23:40:56 | INFO | fairseq_cli.train | training on 4 devices (GPUs/TPUs)
2023-02-27 23:40:56 | INFO | fairseq_cli.train | max tokens per GPU = 16384 and max sentences per GPU = None
2023-02-27 23:41:01 | INFO | fairseq.trainer | loaded checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint_last.pt (epoch 56 @ 108775 updates)
2023-02-27 23:41:01 | INFO | fairseq.trainer | loading train data for epoch 56
2023-02-27 23:41:02 | INFO | fairseq.data.data_utils | loaded 3961179 examples from: /mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict/train.de-en.de
2023-02-27 23:41:02 | INFO | fairseq.data.data_utils | loaded 3961179 examples from: /mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict/train.de-en.en
2023-02-27 23:41:02 | INFO | fairseq.tasks.translation | /mnt/petrelfs/jiangshuyang/data-bin/wmt14_deen_distill_jointdict train de-en 3961179 examples
2023-02-27 23:41:05 | INFO | fairseq.trainer | begin training epoch 56
/mnt/petrelfs/jiangshuyang/.local/lib/python3.7/site-packages/torch/nn/parallel/distributed.py:468: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  "The `check_reduction` argument in `DistributedDataParallel` "
/mnt/petrelfs/jiangshuyang/.local/lib/python3.7/site-packages/torch/nn/parallel/distributed.py:468: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  "The `check_reduction` argument in `DistributedDataParallel` "
/mnt/petrelfs/jiangshuyang/.local/lib/python3.7/site-packages/torch/nn/parallel/distributed.py:468: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  "The `check_reduction` argument in `DistributedDataParallel` "
/mnt/petrelfs/jiangshuyang/.local/lib/python3.7/site-packages/torch/nn/parallel/distributed.py:468: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  "The `check_reduction` argument in `DistributedDataParallel` "
2023-02-27 23:41:23 | INFO | root | Reducer buckets have been rebuilt in this iteration.
2023-02-27 23:42:22 | INFO | train_inner | epoch 056:     25 / 1978 loss=3.13, nll_loss=0.972, word_ins=2.794, length=3.366, ppl=8.76, wps=19654.8, ups=0.33, wpb=59098.1, bsz=1905.1, num_updates=108800, lr=0.00030317, gnorm=1.103, loss_scale=8192, train_wall=258, wall=0
2023-02-27 23:46:24 | INFO | train_inner | epoch 056:    125 / 1978 loss=3.106, nll_loss=0.953, word_ins=2.777, length=3.282, ppl=8.61, wps=24551.1, ups=0.41, wpb=59499.9, bsz=1984.2, num_updates=108900, lr=0.00030303, gnorm=1.075, loss_scale=8192, train_wall=242, wall=0
2023-02-27 23:50:28 | INFO | train_inner | epoch 056:    225 / 1978 loss=3.086, nll_loss=0.937, word_ins=2.762, length=3.241, ppl=8.49, wps=24430.1, ups=0.41, wpb=59571.1, bsz=2031.8, num_updates=109000, lr=0.000302891, gnorm=1.075, loss_scale=8192, train_wall=244, wall=0
2023-02-27 23:54:31 | INFO | train_inner | epoch 056:    325 / 1978 loss=3.082, nll_loss=0.931, word_ins=2.756, length=3.259, ppl=8.47, wps=24558.4, ups=0.41, wpb=59656.6, bsz=2044.2, num_updates=109100, lr=0.000302752, gnorm=1.076, loss_scale=8192, train_wall=243, wall=0
2023-02-27 23:58:32 | INFO | train_inner | epoch 056:    425 / 1978 loss=3.096, nll_loss=0.942, word_ins=2.767, length=3.285, ppl=8.55, wps=24356.6, ups=0.41, wpb=58799.5, bsz=2003.5, num_updates=109200, lr=0.000302614, gnorm=1.067, loss_scale=8192, train_wall=241, wall=0
2023-02-28 00:02:35 | INFO | train_inner | epoch 056:    525 / 1978 loss=3.132, nll_loss=0.972, word_ins=2.794, length=3.371, ppl=8.76, wps=24331.4, ups=0.41, wpb=59118.7, bsz=1961.1, num_updates=109300, lr=0.000302475, gnorm=1.105, loss_scale=8192, train_wall=243, wall=0
2023-02-28 00:06:38 | INFO | train_inner | epoch 056:    625 / 1978 loss=3.092, nll_loss=0.943, word_ins=2.767, length=3.25, ppl=8.53, wps=24625.4, ups=0.41, wpb=59761.8, bsz=2057.3, num_updates=109400, lr=0.000302337, gnorm=1.06, loss_scale=8192, train_wall=242, wall=0
2023-02-28 00:10:39 | INFO | train_inner | epoch 056:    725 / 1978 loss=3.116, nll_loss=0.955, word_ins=2.779, length=3.373, ppl=8.67, wps=24309.8, ups=0.41, wpb=58633.3, bsz=1943.7, num_updates=109500, lr=0.000302199, gnorm=1.1, loss_scale=8192, train_wall=241, wall=0
2023-02-28 00:14:37 | INFO | train_inner | epoch 056:    825 / 1978 loss=3.112, nll_loss=0.955, word_ins=2.778, length=3.34, ppl=8.65, wps=24954.1, ups=0.42, wpb=59374, bsz=2047.8, num_updates=109600, lr=0.000302061, gnorm=1.109, loss_scale=8192, train_wall=238, wall=0
2023-02-28 00:18:31 | INFO | train_inner | epoch 056:    925 / 1978 loss=3.096, nll_loss=0.942, word_ins=2.766, length=3.3, ppl=8.55, wps=25529.4, ups=0.43, wpb=59776.2, bsz=2008.3, num_updates=109700, lr=0.000301923, gnorm=1.072, loss_scale=8192, train_wall=234, wall=0
2023-02-28 00:22:26 | INFO | train_inner | epoch 056:   1025 / 1978 loss=3.112, nll_loss=0.962, word_ins=2.785, length=3.271, ppl=8.65, wps=25307.9, ups=0.43, wpb=59424, bsz=1955.9, num_updates=109800, lr=0.000301786, gnorm=1.116, loss_scale=8192, train_wall=235, wall=0
2023-02-28 00:26:23 | INFO | train_inner | epoch 056:   1125 / 1978 loss=3.112, nll_loss=0.958, word_ins=2.781, length=3.309, ppl=8.65, wps=24686.7, ups=0.42, wpb=58633.8, bsz=2100.6, num_updates=109900, lr=0.000301648, gnorm=1.085, loss_scale=8192, train_wall=237, wall=0
2023-02-28 00:30:21 | INFO | train_inner | epoch 056:   1225 / 1978 loss=3.11, nll_loss=0.956, word_ins=2.78, length=3.301, ppl=8.63, wps=24805.7, ups=0.42, wpb=58891.2, bsz=1997.5, num_updates=110000, lr=0.000301511, gnorm=1.076, loss_scale=8192, train_wall=237, wall=0
2023-02-28 00:34:15 | INFO | train_inner | epoch 056:   1325 / 1978 loss=3.104, nll_loss=0.95, word_ins=2.773, length=3.311, ppl=8.6, wps=25537.3, ups=0.43, wpb=59651.6, bsz=1959.9, num_updates=110100, lr=0.000301374, gnorm=1.095, loss_scale=8192, train_wall=233, wall=0
2023-02-28 00:38:08 | INFO | train_inner | epoch 056:   1425 / 1978 loss=3.096, nll_loss=0.944, word_ins=2.768, length=3.282, ppl=8.55, wps=25693.8, ups=0.43, wpb=60022, bsz=2032.2, num_updates=110200, lr=0.000301238, gnorm=1.1, loss_scale=8192, train_wall=233, wall=0
2023-02-28 00:42:02 | INFO | train_inner | epoch 056:   1525 / 1978 loss=3.109, nll_loss=0.955, word_ins=2.778, length=3.315, ppl=8.63, wps=25234.8, ups=0.43, wpb=59090.4, bsz=2022, num_updates=110300, lr=0.000301101, gnorm=1.096, loss_scale=8192, train_wall=234, wall=0
2023-02-28 00:45:55 | INFO | train_inner | epoch 056:   1625 / 1978 loss=3.117, nll_loss=0.961, word_ins=2.784, length=3.326, ppl=8.67, wps=25239.1, ups=0.43, wpb=58846, bsz=1959.6, num_updates=110400, lr=0.000300965, gnorm=1.064, loss_scale=8192, train_wall=233, wall=0
2023-02-28 00:49:50 | INFO | train_inner | epoch 056:   1725 / 1978 loss=3.108, nll_loss=0.954, word_ins=2.777, length=3.31, ppl=8.62, wps=25335.9, ups=0.43, wpb=59318.9, bsz=2006.6, num_updates=110500, lr=0.000300828, gnorm=1.058, loss_scale=8192, train_wall=234, wall=0
2023-02-28 00:53:44 | INFO | train_inner | epoch 056:   1825 / 1978 loss=3.097, nll_loss=0.942, word_ins=2.766, length=3.312, ppl=8.56, wps=25343.7, ups=0.43, wpb=59403.9, bsz=2027.3, num_updates=110600, lr=0.000300692, gnorm=1.049, loss_scale=8192, train_wall=234, wall=0
2023-02-28 00:57:38 | INFO | train_inner | epoch 056:   1925 / 1978 loss=3.133, nll_loss=0.976, word_ins=2.797, length=3.358, ppl=8.77, wps=25264, ups=0.43, wpb=59092.7, bsz=1946.2, num_updates=110700, lr=0.000300557, gnorm=1.111, loss_scale=8192, train_wall=234, wall=0
2023-02-28 00:59:43 | INFO | fairseq_cli.train | begin validation on "valid" subset
/mnt/petrelfs/jiangshuyang/repo/efficient-attention/efficient_attention/amlp.py:321: UserWarning: AMLP does not support causal attention
  warnings.warn("AMLP does not support causal attention")
/mnt/petrelfs/jiangshuyang/repo/efficient-attention/efficient_attention/amlp.py:321: UserWarning: AMLP does not support causal attention
  warnings.warn("AMLP does not support causal attention")
/mnt/petrelfs/jiangshuyang/repo/efficient-attention/efficient_attention/amlp.py:321: UserWarning: AMLP does not support causal attention
  warnings.warn("AMLP does not support causal attention")
/mnt/petrelfs/jiangshuyang/repo/efficient-attention/efficient_attention/amlp.py:321: UserWarning: AMLP does not support causal attention
  warnings.warn("AMLP does not support causal attention")
2023-02-28 01:00:00 | INFO | valid | epoch 056 | valid on 'valid' subset | loss 4.09 | nll_loss 1.944 | word_ins 3.713 | length 3.763 | ppl 17.03 | wps 31237 | wpb 40242.5 | bsz 1500 | num_updates 110753 | best_loss 4.082
2023-02-28 01:00:00 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 01:00:06 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint56.pt (epoch 56 @ 110753 updates, score 4.09) (writing took 5.950517239049077 seconds)
2023-02-28 01:00:06 | INFO | fairseq_cli.train | end of epoch 56 (average epoch stats below)
2023-02-28 01:00:06 | INFO | train | epoch 056 | loss 3.109 | nll_loss 0.954 | word_ins 2.778 | length 3.312 | ppl 8.63 | wps 23168.6 | ups 0.39 | wpb 59284.3 | bsz 2002.6 | num_updates 110753 | lr 0.000300485 | gnorm 1.082 | loss_scale 8192 | train_wall 10031 | wall 0
2023-02-28 01:00:06 | INFO | fairseq.trainer | begin training epoch 57
2023-02-28 01:02:10 | INFO | train_inner | epoch 057:     47 / 1978 loss=3.095, nll_loss=0.942, word_ins=2.766, length=3.292, ppl=8.55, wps=21897.6, ups=0.37, wpb=59492.9, bsz=2002.7, num_updates=110800, lr=0.000300421, gnorm=1.1, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:06:04 | INFO | train_inner | epoch 057:    147 / 1978 loss=3.093, nll_loss=0.937, word_ins=2.762, length=3.313, ppl=8.54, wps=25206.8, ups=0.43, wpb=59021.9, bsz=2015.1, num_updates=110900, lr=0.000300285, gnorm=1.078, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:09:59 | INFO | train_inner | epoch 057:    247 / 1978 loss=3.078, nll_loss=0.929, word_ins=2.755, length=3.231, ppl=8.44, wps=25361.5, ups=0.42, wpb=59752.1, bsz=2104.1, num_updates=111000, lr=0.00030015, gnorm=1.102, loss_scale=8192, train_wall=235, wall=0
2023-02-28 01:13:54 | INFO | train_inner | epoch 057:    347 / 1978 loss=3.074, nll_loss=0.925, word_ins=2.751, length=3.238, ppl=8.42, wps=25325.8, ups=0.43, wpb=59329.7, bsz=2058.4, num_updates=111100, lr=0.000300015, gnorm=1.104, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:17:48 | INFO | train_inner | epoch 057:    447 / 1978 loss=3.118, nll_loss=0.962, word_ins=2.785, length=3.325, ppl=8.68, wps=25086.9, ups=0.43, wpb=58721.9, bsz=1975.2, num_updates=111200, lr=0.00029988, gnorm=1.108, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:21:41 | INFO | train_inner | epoch 057:    547 / 1978 loss=3.103, nll_loss=0.948, word_ins=2.772, length=3.31, ppl=8.59, wps=25342.1, ups=0.43, wpb=59067.3, bsz=1960.5, num_updates=111300, lr=0.000299745, gnorm=1.076, loss_scale=8192, train_wall=233, wall=0
2023-02-28 01:25:35 | INFO | train_inner | epoch 057:    647 / 1978 loss=3.102, nll_loss=0.944, word_ins=2.768, length=3.34, ppl=8.59, wps=25373, ups=0.43, wpb=59515.9, bsz=1958, num_updates=111400, lr=0.000299611, gnorm=1.084, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:29:30 | INFO | train_inner | epoch 057:    747 / 1978 loss=3.068, nll_loss=0.924, word_ins=2.75, length=3.18, ppl=8.39, wps=25442.1, ups=0.43, wpb=59705.4, bsz=2055, num_updates=111500, lr=0.000299476, gnorm=1.044, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:33:25 | INFO | train_inner | epoch 057:    847 / 1978 loss=3.078, nll_loss=0.933, word_ins=2.758, length=3.208, ppl=8.45, wps=25268.3, ups=0.43, wpb=59367.6, bsz=2092.9, num_updates=111600, lr=0.000299342, gnorm=1.06, loss_scale=8192, train_wall=235, wall=0
2023-02-28 01:37:19 | INFO | train_inner | epoch 057:    947 / 1978 loss=3.102, nll_loss=0.95, word_ins=2.773, length=3.288, ppl=8.59, wps=25347.2, ups=0.43, wpb=59407.5, bsz=1993.3, num_updates=111700, lr=0.000299208, gnorm=1.11, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:41:15 | INFO | train_inner | epoch 057:   1047 / 1978 loss=3.088, nll_loss=0.932, word_ins=2.757, length=3.309, ppl=8.5, wps=25304.2, ups=0.42, wpb=59560.7, bsz=2068.1, num_updates=111800, lr=0.000299074, gnorm=1.074, loss_scale=8192, train_wall=235, wall=0
2023-02-28 01:45:10 | INFO | train_inner | epoch 057:   1147 / 1978 loss=3.104, nll_loss=0.951, word_ins=2.775, length=3.296, ppl=8.6, wps=25390.8, ups=0.43, wpb=59721.9, bsz=1989.9, num_updates=111900, lr=0.000298941, gnorm=1.108, loss_scale=8192, train_wall=235, wall=0
2023-02-28 01:49:04 | INFO | train_inner | epoch 057:   1247 / 1978 loss=3.122, nll_loss=0.964, word_ins=2.786, length=3.351, ppl=8.7, wps=25153.8, ups=0.43, wpb=58941, bsz=1966.8, num_updates=112000, lr=0.000298807, gnorm=1.121, loss_scale=8192, train_wall=234, wall=0
2023-02-28 01:52:57 | INFO | train_inner | epoch 057:   1347 / 1978 loss=3.161, nll_loss=0.994, word_ins=2.814, length=3.473, ppl=8.95, wps=25261.4, ups=0.43, wpb=58827, bsz=1883.3, num_updates=112100, lr=0.000298674, gnorm=1.155, loss_scale=8192, train_wall=233, wall=0
2023-02-28 01:56:51 | INFO | train_inner | epoch 057:   1447 / 1978 loss=3.099, nll_loss=0.943, word_ins=2.767, length=3.315, ppl=8.57, wps=25561.7, ups=0.43, wpb=59801.2, bsz=2042.6, num_updates=112200, lr=0.000298541, gnorm=1.103, loss_scale=8192, train_wall=234, wall=0
2023-02-28 02:00:45 | INFO | train_inner | epoch 057:   1547 / 1978 loss=3.113, nll_loss=0.963, word_ins=2.785, length=3.278, ppl=8.65, wps=25153.3, ups=0.43, wpb=58952.6, bsz=2046.3, num_updates=112300, lr=0.000298408, gnorm=1.101, loss_scale=8192, train_wall=234, wall=0
2023-02-28 02:04:38 | INFO | train_inner | epoch 057:   1647 / 1978 loss=3.151, nll_loss=0.982, word_ins=2.803, length=3.475, ppl=8.88, wps=25224.2, ups=0.43, wpb=58745.1, bsz=1860.7, num_updates=112400, lr=0.000298275, gnorm=1.118, loss_scale=8192, train_wall=233, wall=0
2023-02-28 02:08:33 | INFO | train_inner | epoch 057:   1747 / 1978 loss=3.111, nll_loss=0.956, word_ins=2.779, length=3.315, ppl=8.64, wps=25294.7, ups=0.43, wpb=59447.1, bsz=2028.9, num_updates=112500, lr=0.000298142, gnorm=1.082, loss_scale=8192, train_wall=235, wall=0
2023-02-28 02:12:29 | INFO | train_inner | epoch 057:   1847 / 1978 loss=3.093, nll_loss=0.939, word_ins=2.764, length=3.298, ppl=8.54, wps=25092.2, ups=0.42, wpb=59048.2, bsz=2049.2, num_updates=112600, lr=0.00029801, gnorm=1.115, loss_scale=8192, train_wall=235, wall=0
2023-02-28 02:16:22 | INFO | train_inner | epoch 057:   1947 / 1978 loss=3.121, nll_loss=0.964, word_ins=2.786, length=3.346, ppl=8.7, wps=25471.4, ups=0.43, wpb=59476.4, bsz=1917.9, num_updates=112700, lr=0.000297878, gnorm=1.085, loss_scale=8192, train_wall=233, wall=0
2023-02-28 02:17:34 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 02:17:55 | INFO | valid | epoch 057 | valid on 'valid' subset | loss 4.091 | nll_loss 1.953 | word_ins 3.724 | length 3.677 | ppl 17.05 | wps 30357.5 | wpb 40242.5 | bsz 1500 | num_updates 112731 | best_loss 4.082
2023-02-28 02:17:55 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 02:18:02 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint57.pt (epoch 57 @ 112731 updates, score 4.091) (writing took 6.294295102357864 seconds)
2023-02-28 02:18:02 | INFO | fairseq_cli.train | end of epoch 57 (average epoch stats below)
2023-02-28 02:18:02 | INFO | train | epoch 057 | loss 3.104 | nll_loss 0.949 | word_ins 2.773 | length 3.309 | ppl 8.6 | wps 25080.6 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 112731 | lr 0.000297837 | gnorm 1.096 | loss_scale 8192 | train_wall 4629 | wall 0
2023-02-28 02:18:02 | INFO | fairseq.trainer | begin training epoch 58
2023-02-28 02:20:56 | INFO | train_inner | epoch 058:     69 / 1978 loss=3.1, nll_loss=0.948, word_ins=2.772, length=3.274, ppl=8.57, wps=21546.2, ups=0.37, wpb=58961.4, bsz=1958.4, num_updates=112800, lr=0.000297746, gnorm=1.082, loss_scale=8192, train_wall=233, wall=0
2023-02-28 02:24:50 | INFO | train_inner | epoch 058:    169 / 1978 loss=3.1, nll_loss=0.953, word_ins=2.776, length=3.235, ppl=8.57, wps=25444.1, ups=0.43, wpb=59484.7, bsz=1997.3, num_updates=112900, lr=0.000297614, gnorm=1.1, loss_scale=16384, train_wall=234, wall=0
2023-02-28 02:28:45 | INFO | train_inner | epoch 058:    269 / 1978 loss=3.109, nll_loss=0.95, word_ins=2.774, length=3.348, ppl=8.63, wps=25148.5, ups=0.42, wpb=59292.8, bsz=1979.5, num_updates=113000, lr=0.000297482, gnorm=1.119, loss_scale=16384, train_wall=236, wall=0
2023-02-28 02:32:40 | INFO | train_inner | epoch 058:    369 / 1978 loss=3.101, nll_loss=0.945, word_ins=2.77, length=3.309, ppl=8.58, wps=25466.1, ups=0.43, wpb=59764.2, bsz=1982.3, num_updates=113100, lr=0.000297351, gnorm=1.115, loss_scale=16384, train_wall=234, wall=0
2023-02-28 02:36:35 | INFO | train_inner | epoch 058:    469 / 1978 loss=3.079, nll_loss=0.929, word_ins=2.754, length=3.253, ppl=8.45, wps=25353.8, ups=0.43, wpb=59526.6, bsz=2020.1, num_updates=113200, lr=0.000297219, gnorm=1.106, loss_scale=16384, train_wall=235, wall=0
2023-02-28 02:40:30 | INFO | train_inner | epoch 058:    569 / 1978 loss=3.088, nll_loss=0.935, word_ins=2.76, length=3.274, ppl=8.5, wps=25398.3, ups=0.43, wpb=59738.2, bsz=1979.8, num_updates=113300, lr=0.000297088, gnorm=1.094, loss_scale=16384, train_wall=235, wall=0
2023-02-28 02:44:24 | INFO | train_inner | epoch 058:    669 / 1978 loss=3.122, nll_loss=0.97, word_ins=2.792, length=3.3, ppl=8.71, wps=25325.5, ups=0.43, wpb=59241.5, bsz=1976.8, num_updates=113400, lr=0.000296957, gnorm=1.143, loss_scale=16384, train_wall=234, wall=0
2023-02-28 02:48:18 | INFO | train_inner | epoch 058:    769 / 1978 loss=3.115, nll_loss=0.958, word_ins=2.781, length=3.34, ppl=8.66, wps=25290.5, ups=0.43, wpb=59221, bsz=2010.7, num_updates=113500, lr=0.000296826, gnorm=1.126, loss_scale=16384, train_wall=234, wall=0
2023-02-28 02:52:14 | INFO | train_inner | epoch 058:    869 / 1978 loss=3.082, nll_loss=0.933, word_ins=2.758, length=3.243, ppl=8.47, wps=25148.4, ups=0.42, wpb=59361.2, bsz=2064.8, num_updates=113600, lr=0.000296695, gnorm=1.091, loss_scale=16384, train_wall=236, wall=0
2023-02-28 02:56:08 | INFO | train_inner | epoch 058:    969 / 1978 loss=3.079, nll_loss=0.923, word_ins=2.749, length=3.296, ppl=8.45, wps=25353.8, ups=0.43, wpb=59147.4, bsz=2029.8, num_updates=113700, lr=0.000296565, gnorm=1.067, loss_scale=16384, train_wall=233, wall=0
2023-02-28 03:00:02 | INFO | train_inner | epoch 058:   1069 / 1978 loss=3.1, nll_loss=0.946, word_ins=2.77, length=3.299, ppl=8.57, wps=25207, ups=0.43, wpb=59004.9, bsz=1991.4, num_updates=113800, lr=0.000296435, gnorm=1.129, loss_scale=16384, train_wall=234, wall=0
2023-02-28 03:03:56 | INFO | train_inner | epoch 058:   1169 / 1978 loss=3.081, nll_loss=0.928, word_ins=2.753, length=3.272, ppl=8.46, wps=25271.9, ups=0.43, wpb=59168.5, bsz=2056.7, num_updates=113900, lr=0.000296304, gnorm=1.047, loss_scale=16384, train_wall=234, wall=0
2023-02-28 03:05:11 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 03:07:53 | INFO | train_inner | epoch 058:   1270 / 1978 loss=3.076, nll_loss=0.922, word_ins=2.748, length=3.279, ppl=8.43, wps=25039.1, ups=0.42, wpb=59471.1, bsz=2078.6, num_updates=114000, lr=0.000296174, gnorm=1.1, loss_scale=8192, train_wall=237, wall=0
2023-02-28 03:11:48 | INFO | train_inner | epoch 058:   1370 / 1978 loss=3.095, nll_loss=0.937, word_ins=2.761, length=3.339, ppl=8.54, wps=25138, ups=0.43, wpb=59083.9, bsz=2052, num_updates=114100, lr=0.000296045, gnorm=1.095, loss_scale=8192, train_wall=235, wall=0
2023-02-28 03:15:42 | INFO | train_inner | epoch 058:   1470 / 1978 loss=3.118, nll_loss=0.961, word_ins=2.783, length=3.355, ppl=8.68, wps=25396.5, ups=0.43, wpb=59374.7, bsz=1930.4, num_updates=114200, lr=0.000295915, gnorm=1.127, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:19:35 | INFO | train_inner | epoch 058:   1570 / 1978 loss=3.112, nll_loss=0.959, word_ins=2.782, length=3.304, ppl=8.65, wps=25311.1, ups=0.43, wpb=58823.2, bsz=1901.7, num_updates=114300, lr=0.000295786, gnorm=1.116, loss_scale=8192, train_wall=232, wall=0
2023-02-28 03:23:29 | INFO | train_inner | epoch 058:   1670 / 1978 loss=3.098, nll_loss=0.943, word_ins=2.767, length=3.308, ppl=8.56, wps=25184.2, ups=0.43, wpb=59078.7, bsz=2048, num_updates=114400, lr=0.000295656, gnorm=1.079, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:27:23 | INFO | train_inner | epoch 058:   1770 / 1978 loss=3.09, nll_loss=0.935, word_ins=2.759, length=3.306, ppl=8.51, wps=25409.3, ups=0.43, wpb=59513.8, bsz=2030.5, num_updates=114500, lr=0.000295527, gnorm=1.108, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:31:17 | INFO | train_inner | epoch 058:   1870 / 1978 loss=3.116, nll_loss=0.954, word_ins=2.777, length=3.39, ppl=8.67, wps=25379.2, ups=0.43, wpb=59363.9, bsz=1939.5, num_updates=114600, lr=0.000295398, gnorm=1.111, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:35:11 | INFO | train_inner | epoch 058:   1970 / 1978 loss=3.117, nll_loss=0.962, word_ins=2.785, length=3.32, ppl=8.67, wps=25129.3, ups=0.43, wpb=58701.2, bsz=1998.9, num_updates=114700, lr=0.000295269, gnorm=1.087, loss_scale=8192, train_wall=233, wall=0
2023-02-28 03:35:29 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 03:35:50 | INFO | valid | epoch 058 | valid on 'valid' subset | loss 4.122 | nll_loss 1.948 | word_ins 3.716 | length 4.062 | ppl 17.42 | wps 30446.8 | wpb 40242.5 | bsz 1500 | num_updates 114708 | best_loss 4.082
2023-02-28 03:35:50 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 03:35:57 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint58.pt (epoch 58 @ 114708 updates, score 4.122) (writing took 6.502897223457694 seconds)
2023-02-28 03:35:57 | INFO | fairseq_cli.train | end of epoch 58 (average epoch stats below)
2023-02-28 03:35:57 | INFO | train | epoch 058 | loss 3.098 | nll_loss 0.944 | word_ins 2.768 | length 3.299 | ppl 8.56 | wps 25069.9 | ups 0.42 | wpb 59283 | bsz 2003 | num_updates 114708 | lr 0.000295259 | gnorm 1.103 | loss_scale 8192 | train_wall 4630 | wall 0
2023-02-28 03:35:57 | INFO | fairseq.trainer | begin training epoch 59
2023-02-28 03:39:43 | INFO | train_inner | epoch 059:     92 / 1978 loss=3.095, nll_loss=0.942, word_ins=2.767, length=3.284, ppl=8.55, wps=21948.5, ups=0.37, wpb=59726, bsz=1894.1, num_updates=114800, lr=0.000295141, gnorm=1.137, loss_scale=8192, train_wall=232, wall=0
2023-02-28 03:43:37 | INFO | train_inner | epoch 059:    192 / 1978 loss=3.093, nll_loss=0.944, word_ins=2.768, length=3.249, ppl=8.53, wps=25440.6, ups=0.43, wpb=59476.2, bsz=1997.4, num_updates=114900, lr=0.000295012, gnorm=1.096, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:47:32 | INFO | train_inner | epoch 059:    292 / 1978 loss=3.088, nll_loss=0.94, word_ins=2.765, length=3.232, ppl=8.5, wps=25224.7, ups=0.43, wpb=59344.3, bsz=2034.2, num_updates=115000, lr=0.000294884, gnorm=1.099, loss_scale=8192, train_wall=235, wall=0
2023-02-28 03:51:27 | INFO | train_inner | epoch 059:    392 / 1978 loss=3.082, nll_loss=0.929, word_ins=2.754, length=3.277, ppl=8.47, wps=25365.7, ups=0.43, wpb=59491.9, bsz=1986.1, num_updates=115100, lr=0.000294756, gnorm=1.075, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:55:21 | INFO | train_inner | epoch 059:    492 / 1978 loss=3.106, nll_loss=0.944, word_ins=2.769, length=3.377, ppl=8.61, wps=25236.5, ups=0.43, wpb=59136, bsz=1979.8, num_updates=115200, lr=0.000294628, gnorm=1.087, loss_scale=8192, train_wall=234, wall=0
2023-02-28 03:59:17 | INFO | train_inner | epoch 059:    592 / 1978 loss=3.08, nll_loss=0.926, word_ins=2.752, length=3.275, ppl=8.45, wps=25197.9, ups=0.42, wpb=59353.3, bsz=2048.8, num_updates=115300, lr=0.0002945, gnorm=1.087, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:03:12 | INFO | train_inner | epoch 059:    692 / 1978 loss=3.079, nll_loss=0.927, word_ins=2.752, length=3.267, ppl=8.45, wps=25210.1, ups=0.43, wpb=59291.3, bsz=2014.6, num_updates=115400, lr=0.000294372, gnorm=1.117, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:07:07 | INFO | train_inner | epoch 059:    792 / 1978 loss=3.107, nll_loss=0.949, word_ins=2.773, length=3.338, ppl=8.61, wps=25166.3, ups=0.43, wpb=59128.6, bsz=2000.7, num_updates=115500, lr=0.000294245, gnorm=1.148, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:11:02 | INFO | train_inner | epoch 059:    892 / 1978 loss=3.091, nll_loss=0.942, word_ins=2.767, length=3.25, ppl=8.52, wps=25071.8, ups=0.43, wpb=58961.1, bsz=2043.2, num_updates=115600, lr=0.000294118, gnorm=1.105, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:14:56 | INFO | train_inner | epoch 059:    992 / 1978 loss=3.101, nll_loss=0.942, word_ins=2.766, length=3.35, ppl=8.58, wps=25144.5, ups=0.43, wpb=58920.3, bsz=1969.4, num_updates=115700, lr=0.000293991, gnorm=1.112, loss_scale=8192, train_wall=234, wall=0
2023-02-28 04:18:51 | INFO | train_inner | epoch 059:   1092 / 1978 loss=3.087, nll_loss=0.935, word_ins=2.759, length=3.284, ppl=8.5, wps=25378.1, ups=0.43, wpb=59553.8, bsz=2015.3, num_updates=115800, lr=0.000293864, gnorm=1.105, loss_scale=8192, train_wall=234, wall=0
2023-02-28 04:22:44 | INFO | train_inner | epoch 059:   1192 / 1978 loss=3.127, nll_loss=0.968, word_ins=2.791, length=3.361, ppl=8.73, wps=25280.9, ups=0.43, wpb=58957.2, bsz=1951.4, num_updates=115900, lr=0.000293737, gnorm=1.15, loss_scale=8192, train_wall=233, wall=0
2023-02-28 04:26:39 | INFO | train_inner | epoch 059:   1292 / 1978 loss=3.103, nll_loss=0.947, word_ins=2.771, length=3.318, ppl=8.59, wps=25109.8, ups=0.43, wpb=58968.9, bsz=2012.8, num_updates=116000, lr=0.00029361, gnorm=1.127, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:30:34 | INFO | train_inner | epoch 059:   1392 / 1978 loss=3.092, nll_loss=0.938, word_ins=2.763, length=3.296, ppl=8.53, wps=25111.8, ups=0.43, wpb=58955.6, bsz=2021.8, num_updates=116100, lr=0.000293484, gnorm=1.114, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:34:28 | INFO | train_inner | epoch 059:   1492 / 1978 loss=3.092, nll_loss=0.94, word_ins=2.763, length=3.289, ppl=8.53, wps=25385, ups=0.43, wpb=59596.8, bsz=2040.3, num_updates=116200, lr=0.000293357, gnorm=1.074, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:38:23 | INFO | train_inner | epoch 059:   1592 / 1978 loss=3.1, nll_loss=0.948, word_ins=2.772, length=3.287, ppl=8.58, wps=25177.8, ups=0.43, wpb=59130.4, bsz=1997.5, num_updates=116300, lr=0.000293231, gnorm=1.111, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:42:18 | INFO | train_inner | epoch 059:   1692 / 1978 loss=3.093, nll_loss=0.938, word_ins=2.762, length=3.312, ppl=8.53, wps=25387.1, ups=0.43, wpb=59551.3, bsz=2057.4, num_updates=116400, lr=0.000293105, gnorm=1.119, loss_scale=8192, train_wall=234, wall=0
2023-02-28 04:46:12 | INFO | train_inner | epoch 059:   1792 / 1978 loss=3.113, nll_loss=0.956, word_ins=2.779, length=3.348, ppl=8.65, wps=25335.5, ups=0.43, wpb=59244.3, bsz=1966.6, num_updates=116500, lr=0.000292979, gnorm=1.141, loss_scale=8192, train_wall=234, wall=0
2023-02-28 04:50:07 | INFO | train_inner | epoch 059:   1892 / 1978 loss=3.075, nll_loss=0.925, word_ins=2.75, length=3.25, ppl=8.43, wps=25460.6, ups=0.43, wpb=59804.1, bsz=2020, num_updates=116600, lr=0.000292854, gnorm=1.116, loss_scale=8192, train_wall=235, wall=0
2023-02-28 04:53:28 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 04:53:48 | INFO | valid | epoch 059 | valid on 'valid' subset | loss 4.09 | nll_loss 1.943 | word_ins 3.711 | length 3.791 | ppl 17.03 | wps 30226.1 | wpb 40242.5 | bsz 1500 | num_updates 116686 | best_loss 4.082
2023-02-28 04:53:48 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 04:53:54 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint59.pt (epoch 59 @ 116686 updates, score 4.09) (writing took 6.032399702817202 seconds)
2023-02-28 04:53:54 | INFO | fairseq_cli.train | end of epoch 59 (average epoch stats below)
2023-02-28 04:53:54 | INFO | train | epoch 059 | loss 3.095 | nll_loss 0.94 | word_ins 2.765 | length 3.3 | ppl 8.54 | wps 25071.9 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 116686 | lr 0.000292746 | gnorm 1.11 | loss_scale 8192 | train_wall 4634 | wall 0
2023-02-28 04:53:54 | INFO | fairseq.trainer | begin training epoch 60
2023-02-28 04:54:37 | INFO | train_inner | epoch 060:     14 / 1978 loss=3.084, nll_loss=0.927, word_ins=2.752, length=3.318, ppl=8.48, wps=21779.2, ups=0.37, wpb=58987, bsz=2015.3, num_updates=116700, lr=0.000292728, gnorm=1.09, loss_scale=8192, train_wall=233, wall=0
2023-02-28 04:58:32 | INFO | train_inner | epoch 060:    114 / 1978 loss=3.057, nll_loss=0.912, word_ins=2.738, length=3.184, ppl=8.32, wps=25409.5, ups=0.43, wpb=59665.9, bsz=2113.8, num_updates=116800, lr=0.000292603, gnorm=1.079, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:02:27 | INFO | train_inner | epoch 060:    214 / 1978 loss=3.089, nll_loss=0.94, word_ins=2.764, length=3.249, ppl=8.51, wps=25191.4, ups=0.43, wpb=59015.7, bsz=1986.8, num_updates=116900, lr=0.000292478, gnorm=1.071, loss_scale=8192, train_wall=234, wall=0
2023-02-28 05:06:21 | INFO | train_inner | epoch 060:    314 / 1978 loss=3.095, nll_loss=0.941, word_ins=2.766, length=3.292, ppl=8.54, wps=25403, ups=0.43, wpb=59449.2, bsz=1975, num_updates=117000, lr=0.000292353, gnorm=1.111, loss_scale=8192, train_wall=234, wall=0
2023-02-28 05:10:15 | INFO | train_inner | epoch 060:    414 / 1978 loss=3.098, nll_loss=0.942, word_ins=2.766, length=3.323, ppl=8.56, wps=25215.7, ups=0.43, wpb=59128.8, bsz=1959.4, num_updates=117100, lr=0.000292228, gnorm=1.103, loss_scale=8192, train_wall=234, wall=0
2023-02-28 05:14:10 | INFO | train_inner | epoch 060:    514 / 1978 loss=3.085, nll_loss=0.93, word_ins=2.755, length=3.301, ppl=8.49, wps=25232.8, ups=0.43, wpb=59303.1, bsz=2045.7, num_updates=117200, lr=0.000292103, gnorm=1.113, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:18:03 | INFO | train_inner | epoch 060:    614 / 1978 loss=3.111, nll_loss=0.954, word_ins=2.777, length=3.334, ppl=8.64, wps=25212.2, ups=0.43, wpb=58756.3, bsz=1860.8, num_updates=117300, lr=0.000291979, gnorm=1.144, loss_scale=8192, train_wall=233, wall=0
2023-02-28 05:21:58 | INFO | train_inner | epoch 060:    714 / 1978 loss=3.102, nll_loss=0.946, word_ins=2.769, length=3.329, ppl=8.59, wps=25200, ups=0.43, wpb=59247.1, bsz=2051.4, num_updates=117400, lr=0.000291854, gnorm=1.13, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:25:52 | INFO | train_inner | epoch 060:    814 / 1978 loss=3.112, nll_loss=0.954, word_ins=2.777, length=3.351, ppl=8.64, wps=25390.6, ups=0.43, wpb=59373.7, bsz=1932.5, num_updates=117500, lr=0.00029173, gnorm=1.109, loss_scale=8192, train_wall=234, wall=0
2023-02-28 05:29:47 | INFO | train_inner | epoch 060:    914 / 1978 loss=3.081, nll_loss=0.931, word_ins=2.756, length=3.253, ppl=8.46, wps=25197.5, ups=0.43, wpb=59168.1, bsz=2042.3, num_updates=117600, lr=0.000291606, gnorm=1.108, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:33:41 | INFO | train_inner | epoch 060:   1014 / 1978 loss=3.085, nll_loss=0.931, word_ins=2.756, length=3.295, ppl=8.49, wps=25213.1, ups=0.43, wpb=59100.3, bsz=2033.5, num_updates=117700, lr=0.000291482, gnorm=1.118, loss_scale=8192, train_wall=234, wall=0
2023-02-28 05:37:36 | INFO | train_inner | epoch 060:   1114 / 1978 loss=3.107, nll_loss=0.953, word_ins=2.776, length=3.311, ppl=8.62, wps=25203.1, ups=0.43, wpb=59220.5, bsz=2039.8, num_updates=117800, lr=0.000291358, gnorm=1.155, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:41:32 | INFO | train_inner | epoch 060:   1214 / 1978 loss=3.089, nll_loss=0.933, word_ins=2.757, length=3.314, ppl=8.51, wps=25293.6, ups=0.42, wpb=59585.5, bsz=2080.2, num_updates=117900, lr=0.000291235, gnorm=1.096, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:45:26 | INFO | train_inner | epoch 060:   1314 / 1978 loss=3.095, nll_loss=0.936, word_ins=2.761, length=3.346, ppl=8.55, wps=25296.5, ups=0.43, wpb=59179.7, bsz=1962.9, num_updates=118000, lr=0.000291111, gnorm=1.075, loss_scale=8192, train_wall=234, wall=0
2023-02-28 05:46:55 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 05:49:24 | INFO | train_inner | epoch 060:   1415 / 1978 loss=3.089, nll_loss=0.936, word_ins=2.761, length=3.281, ppl=8.51, wps=24879.9, ups=0.42, wpb=59287.9, bsz=2075.1, num_updates=118100, lr=0.000290988, gnorm=1.113, loss_scale=8192, train_wall=238, wall=0
2023-02-28 05:53:19 | INFO | train_inner | epoch 060:   1515 / 1978 loss=3.09, nll_loss=0.938, word_ins=2.762, length=3.278, ppl=8.51, wps=25327.6, ups=0.43, wpb=59524.8, bsz=1987.2, num_updates=118200, lr=0.000290865, gnorm=1.115, loss_scale=8192, train_wall=235, wall=0
2023-02-28 05:57:14 | INFO | train_inner | epoch 060:   1615 / 1978 loss=3.092, nll_loss=0.937, word_ins=2.761, length=3.317, ppl=8.53, wps=25352.7, ups=0.43, wpb=59531.2, bsz=1986.1, num_updates=118300, lr=0.000290742, gnorm=1.095, loss_scale=8192, train_wall=235, wall=0
2023-02-28 06:01:07 | INFO | train_inner | epoch 060:   1715 / 1978 loss=3.104, nll_loss=0.953, word_ins=2.776, length=3.28, ppl=8.6, wps=25296.8, ups=0.43, wpb=58980.2, bsz=1951.4, num_updates=118400, lr=0.000290619, gnorm=1.133, loss_scale=8192, train_wall=233, wall=0
2023-02-28 06:05:02 | INFO | train_inner | epoch 060:   1815 / 1978 loss=3.084, nll_loss=0.933, word_ins=2.758, length=3.261, ppl=8.48, wps=25331.4, ups=0.43, wpb=59466.9, bsz=1987.6, num_updates=118500, lr=0.000290496, gnorm=1.134, loss_scale=8192, train_wall=235, wall=0
2023-02-28 06:08:56 | INFO | train_inner | epoch 060:   1915 / 1978 loss=3.086, nll_loss=0.932, word_ins=2.757, length=3.296, ppl=8.49, wps=25355.3, ups=0.43, wpb=59350.9, bsz=1984.1, num_updates=118600, lr=0.000290374, gnorm=1.125, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:11:24 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 06:11:43 | INFO | valid | epoch 060 | valid on 'valid' subset | loss 4.098 | nll_loss 1.981 | word_ins 3.74 | length 3.571 | ppl 17.12 | wps 30782.6 | wpb 40242.5 | bsz 1500 | num_updates 118663 | best_loss 4.082
2023-02-28 06:11:43 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 06:11:48 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint60.pt (epoch 60 @ 118663 updates, score 4.098) (writing took 5.800054714083672 seconds)
2023-02-28 06:11:49 | INFO | fairseq_cli.train | end of epoch 60 (average epoch stats below)
2023-02-28 06:11:49 | INFO | train | epoch 060 | loss 3.092 | nll_loss 0.938 | word_ins 2.762 | length 3.293 | ppl 8.52 | wps 25074.1 | ups 0.42 | wpb 59287.6 | bsz 2002.9 | num_updates 118663 | lr 0.000290297 | gnorm 1.113 | loss_scale 8192 | train_wall 4634 | wall 0
2023-02-28 06:11:49 | INFO | fairseq.trainer | begin training epoch 61
2023-02-28 06:13:25 | INFO | train_inner | epoch 061:     37 / 1978 loss=3.078, nll_loss=0.927, word_ins=2.752, length=3.263, ppl=8.45, wps=22178.9, ups=0.37, wpb=59708.7, bsz=1960.4, num_updates=118700, lr=0.000290252, gnorm=1.145, loss_scale=8192, train_wall=233, wall=0
2023-02-28 06:17:20 | INFO | train_inner | epoch 061:    137 / 1978 loss=3.052, nll_loss=0.901, word_ins=2.729, length=3.231, ppl=8.29, wps=25370.8, ups=0.43, wpb=59454.2, bsz=2104, num_updates=118800, lr=0.000290129, gnorm=1.125, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:21:14 | INFO | train_inner | epoch 061:    237 / 1978 loss=3.084, nll_loss=0.933, word_ins=2.758, length=3.263, ppl=8.48, wps=25075.8, ups=0.43, wpb=58716.5, bsz=1938.6, num_updates=118900, lr=0.000290007, gnorm=1.119, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:25:09 | INFO | train_inner | epoch 061:    337 / 1978 loss=3.086, nll_loss=0.932, word_ins=2.757, length=3.292, ppl=8.49, wps=25177.6, ups=0.42, wpb=59297.1, bsz=1951.7, num_updates=119000, lr=0.000289886, gnorm=1.103, loss_scale=8192, train_wall=235, wall=0
2023-02-28 06:29:04 | INFO | train_inner | epoch 061:    437 / 1978 loss=3.083, nll_loss=0.927, word_ins=2.752, length=3.309, ppl=8.48, wps=25291.4, ups=0.43, wpb=59294.7, bsz=2007.5, num_updates=119100, lr=0.000289764, gnorm=1.151, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:32:56 | INFO | train_inner | epoch 061:    537 / 1978 loss=3.08, nll_loss=0.927, word_ins=2.752, length=3.281, ppl=8.46, wps=25659.3, ups=0.43, wpb=59650.3, bsz=1932.1, num_updates=119200, lr=0.000289642, gnorm=1.095, loss_scale=8192, train_wall=232, wall=0
2023-02-28 06:36:50 | INFO | train_inner | epoch 061:    637 / 1978 loss=3.09, nll_loss=0.933, word_ins=2.758, length=3.327, ppl=8.52, wps=25440.2, ups=0.43, wpb=59581.9, bsz=1949.8, num_updates=119300, lr=0.000289521, gnorm=1.106, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:40:47 | INFO | train_inner | epoch 061:    737 / 1978 loss=3.065, nll_loss=0.919, word_ins=2.744, length=3.211, ppl=8.37, wps=25070.9, ups=0.42, wpb=59217.7, bsz=2094.6, num_updates=119400, lr=0.0002894, gnorm=1.078, loss_scale=8192, train_wall=236, wall=0
2023-02-28 06:44:41 | INFO | train_inner | epoch 061:    837 / 1978 loss=3.097, nll_loss=0.942, word_ins=2.766, length=3.308, ppl=8.56, wps=25176.6, ups=0.43, wpb=59030.9, bsz=2020.1, num_updates=119500, lr=0.000289278, gnorm=1.102, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:48:35 | INFO | train_inner | epoch 061:    937 / 1978 loss=3.108, nll_loss=0.948, word_ins=2.771, length=3.368, ppl=8.62, wps=25242.1, ups=0.43, wpb=59165.5, bsz=2018, num_updates=119600, lr=0.000289157, gnorm=1.138, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:52:30 | INFO | train_inner | epoch 061:   1037 / 1978 loss=3.078, nll_loss=0.926, word_ins=2.752, length=3.261, ppl=8.44, wps=25215.8, ups=0.43, wpb=59085.4, bsz=1985.4, num_updates=119700, lr=0.000289037, gnorm=1.102, loss_scale=8192, train_wall=234, wall=0
2023-02-28 06:56:24 | INFO | train_inner | epoch 061:   1137 / 1978 loss=3.097, nll_loss=0.938, word_ins=2.763, length=3.347, ppl=8.56, wps=25111.9, ups=0.43, wpb=58710.4, bsz=1955.4, num_updates=119800, lr=0.000288916, gnorm=1.111, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:00:18 | INFO | train_inner | epoch 061:   1237 / 1978 loss=3.075, nll_loss=0.921, word_ins=2.746, length=3.289, ppl=8.43, wps=25210.6, ups=0.43, wpb=59198, bsz=2029.4, num_updates=119900, lr=0.000288795, gnorm=1.1, loss_scale=8192, train_wall=235, wall=0
2023-02-28 07:04:12 | INFO | train_inner | epoch 061:   1337 / 1978 loss=3.092, nll_loss=0.936, word_ins=2.76, length=3.325, ppl=8.53, wps=25350.1, ups=0.43, wpb=59307.2, bsz=1917.3, num_updates=120000, lr=0.000288675, gnorm=1.143, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:08:07 | INFO | train_inner | epoch 061:   1437 / 1978 loss=3.09, nll_loss=0.937, word_ins=2.761, length=3.283, ppl=8.51, wps=25146.9, ups=0.43, wpb=59039.2, bsz=2025, num_updates=120100, lr=0.000288555, gnorm=1.104, loss_scale=8192, train_wall=235, wall=0
2023-02-28 07:12:02 | INFO | train_inner | epoch 061:   1537 / 1978 loss=3.069, nll_loss=0.92, word_ins=2.745, length=3.241, ppl=8.39, wps=25229.1, ups=0.43, wpb=59341.7, bsz=2128.9, num_updates=120200, lr=0.000288435, gnorm=1.122, loss_scale=8192, train_wall=235, wall=0
2023-02-28 07:15:57 | INFO | train_inner | epoch 061:   1637 / 1978 loss=3.098, nll_loss=0.946, word_ins=2.77, length=3.283, ppl=8.56, wps=25206.7, ups=0.43, wpb=59240.4, bsz=2031.4, num_updates=120300, lr=0.000288315, gnorm=1.134, loss_scale=8192, train_wall=235, wall=0
2023-02-28 07:19:52 | INFO | train_inner | epoch 061:   1737 / 1978 loss=3.077, nll_loss=0.93, word_ins=2.755, length=3.228, ppl=8.44, wps=25466.3, ups=0.43, wpb=59656.5, bsz=2025.5, num_updates=120400, lr=0.000288195, gnorm=1.156, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:23:47 | INFO | train_inner | epoch 061:   1837 / 1978 loss=3.094, nll_loss=0.938, word_ins=2.762, length=3.318, ppl=8.54, wps=25411.4, ups=0.42, wpb=59868.9, bsz=2023.4, num_updates=120500, lr=0.000288076, gnorm=1.143, loss_scale=8192, train_wall=235, wall=0
2023-02-28 07:27:39 | INFO | train_inner | epoch 061:   1937 / 1978 loss=3.107, nll_loss=0.948, word_ins=2.771, length=3.355, ppl=8.62, wps=25437.2, ups=0.43, wpb=58994.4, bsz=1919.8, num_updates=120600, lr=0.000287956, gnorm=1.146, loss_scale=8192, train_wall=232, wall=0
2023-02-28 07:29:16 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 07:29:34 | INFO | valid | epoch 061 | valid on 'valid' subset | loss 4.071 | nll_loss 1.935 | word_ins 3.706 | length 3.653 | ppl 16.81 | wps 29799.2 | wpb 40242.5 | bsz 1500 | num_updates 120641 | best_loss 4.071
2023-02-28 07:29:34 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 07:29:43 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint61.pt (epoch 61 @ 120641 updates, score 4.071) (writing took 8.845558762550354 seconds)
2023-02-28 07:29:43 | INFO | fairseq_cli.train | end of epoch 61 (average epoch stats below)
2023-02-28 07:29:43 | INFO | train | epoch 061 | loss 3.085 | nll_loss 0.932 | word_ins 2.757 | length 3.289 | ppl 8.49 | wps 25087.3 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 120641 | lr 0.000287907 | gnorm 1.121 | loss_scale 8192 | train_wall 4631 | wall 0
2023-02-28 07:29:43 | INFO | fairseq.trainer | begin training epoch 62
2023-02-28 07:32:12 | INFO | train_inner | epoch 062:     59 / 1978 loss=3.077, nll_loss=0.928, word_ins=2.753, length=3.249, ppl=8.44, wps=21888.2, ups=0.37, wpb=59742.7, bsz=2008.6, num_updates=120700, lr=0.000287837, gnorm=1.167, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:36:07 | INFO | train_inner | epoch 062:    159 / 1978 loss=3.078, nll_loss=0.925, word_ins=2.75, length=3.272, ppl=8.44, wps=25277.1, ups=0.43, wpb=59274.4, bsz=2023.8, num_updates=120800, lr=0.000287718, gnorm=1.162, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:40:03 | INFO | train_inner | epoch 062:    259 / 1978 loss=3.066, nll_loss=0.912, word_ins=2.738, length=3.277, ppl=8.38, wps=25164.9, ups=0.42, wpb=59490.3, bsz=2044.2, num_updates=120900, lr=0.000287599, gnorm=1.136, loss_scale=8192, train_wall=236, wall=0
2023-02-28 07:43:58 | INFO | train_inner | epoch 062:    359 / 1978 loss=3.078, nll_loss=0.927, word_ins=2.752, length=3.258, ppl=8.44, wps=25239, ups=0.43, wpb=59202.9, bsz=1979.5, num_updates=121000, lr=0.00028748, gnorm=1.111, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:47:53 | INFO | train_inner | epoch 062:    459 / 1978 loss=3.081, nll_loss=0.926, word_ins=2.752, length=3.291, ppl=8.46, wps=25209.1, ups=0.43, wpb=59213.9, bsz=1993.8, num_updates=121100, lr=0.000287361, gnorm=1.141, loss_scale=8192, train_wall=235, wall=0
2023-02-28 07:51:47 | INFO | train_inner | epoch 062:    559 / 1978 loss=3.075, nll_loss=0.92, word_ins=2.746, length=3.295, ppl=8.43, wps=25255, ups=0.43, wpb=59192.6, bsz=2038.1, num_updates=121200, lr=0.000287242, gnorm=1.092, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:55:41 | INFO | train_inner | epoch 062:    659 / 1978 loss=3.081, nll_loss=0.924, word_ins=2.75, length=3.307, ppl=8.46, wps=25308.3, ups=0.43, wpb=59184.7, bsz=1973.9, num_updates=121300, lr=0.000287124, gnorm=1.106, loss_scale=8192, train_wall=234, wall=0
2023-02-28 07:59:34 | INFO | train_inner | epoch 062:    759 / 1978 loss=3.111, nll_loss=0.955, word_ins=2.777, length=3.333, ppl=8.64, wps=25156.3, ups=0.43, wpb=58660.9, bsz=1876.6, num_updates=121400, lr=0.000287006, gnorm=1.135, loss_scale=8192, train_wall=233, wall=0
2023-02-28 08:03:30 | INFO | train_inner | epoch 062:    859 / 1978 loss=3.064, nll_loss=0.91, word_ins=2.736, length=3.272, ppl=8.36, wps=25374, ups=0.42, wpb=59893, bsz=2093.8, num_updates=121500, lr=0.000286888, gnorm=1.115, loss_scale=8192, train_wall=236, wall=0
2023-02-28 08:07:25 | INFO | train_inner | epoch 062:    959 / 1978 loss=3.064, nll_loss=0.914, word_ins=2.74, length=3.237, ppl=8.36, wps=25242.6, ups=0.43, wpb=59320.7, bsz=2038.5, num_updates=121600, lr=0.00028677, gnorm=1.088, loss_scale=8192, train_wall=235, wall=0
2023-02-28 08:11:19 | INFO | train_inner | epoch 062:   1059 / 1978 loss=3.076, nll_loss=0.925, word_ins=2.751, length=3.257, ppl=8.44, wps=25152.6, ups=0.43, wpb=58803.8, bsz=2034.5, num_updates=121700, lr=0.000286652, gnorm=1.134, loss_scale=8192, train_wall=234, wall=0
2023-02-28 08:15:14 | INFO | train_inner | epoch 062:   1159 / 1978 loss=3.069, nll_loss=0.922, word_ins=2.747, length=3.221, ppl=8.39, wps=25487.1, ups=0.43, wpb=59942, bsz=2050.6, num_updates=121800, lr=0.000286534, gnorm=1.105, loss_scale=8192, train_wall=235, wall=0
2023-02-28 08:19:09 | INFO | train_inner | epoch 062:   1259 / 1978 loss=3.089, nll_loss=0.93, word_ins=2.755, length=3.336, ppl=8.51, wps=25110, ups=0.43, wpb=58924.8, bsz=2030.2, num_updates=121900, lr=0.000286417, gnorm=1.134, loss_scale=8192, train_wall=234, wall=0
2023-02-28 08:23:03 | INFO | train_inner | epoch 062:   1359 / 1978 loss=3.082, nll_loss=0.931, word_ins=2.755, length=3.267, ppl=8.47, wps=25459.7, ups=0.43, wpb=59636.9, bsz=2003.2, num_updates=122000, lr=0.000286299, gnorm=1.158, loss_scale=8192, train_wall=234, wall=0
2023-02-28 08:26:56 | INFO | train_inner | epoch 062:   1459 / 1978 loss=3.119, nll_loss=0.966, word_ins=2.787, length=3.324, ppl=8.69, wps=25271.9, ups=0.43, wpb=58963.8, bsz=1937.6, num_updates=122100, lr=0.000286182, gnorm=1.143, loss_scale=8192, train_wall=233, wall=0
2023-02-28 08:30:25 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 08:30:54 | INFO | train_inner | epoch 062:   1560 / 1978 loss=3.061, nll_loss=0.913, word_ins=2.739, length=3.223, ppl=8.35, wps=25054.7, ups=0.42, wpb=59485.6, bsz=2080.2, num_updates=122200, lr=0.000286065, gnorm=1.104, loss_scale=8192, train_wall=237, wall=0
2023-02-28 08:34:48 | INFO | train_inner | epoch 062:   1660 / 1978 loss=3.095, nll_loss=0.938, word_ins=2.761, length=3.336, ppl=8.54, wps=25477.4, ups=0.43, wpb=59734.4, bsz=1917.3, num_updates=122300, lr=0.000285948, gnorm=1.152, loss_scale=8192, train_wall=234, wall=0
2023-02-28 08:38:42 | INFO | train_inner | epoch 062:   1760 / 1978 loss=3.099, nll_loss=0.942, word_ins=2.766, length=3.331, ppl=8.57, wps=25126.6, ups=0.43, wpb=58678.9, bsz=1965.7, num_updates=122400, lr=0.000285831, gnorm=1.143, loss_scale=8192, train_wall=233, wall=0
2023-02-28 08:42:36 | INFO | train_inner | epoch 062:   1860 / 1978 loss=3.104, nll_loss=0.952, word_ins=2.775, length=3.297, ppl=8.6, wps=25319, ups=0.43, wpb=59299.7, bsz=1969, num_updates=122500, lr=0.000285714, gnorm=1.194, loss_scale=8192, train_wall=234, wall=0
2023-02-28 08:46:30 | INFO | train_inner | epoch 062:   1960 / 1978 loss=3.088, nll_loss=0.934, word_ins=2.758, length=3.305, ppl=8.5, wps=25327.3, ups=0.43, wpb=59347.2, bsz=1999.8, num_updates=122600, lr=0.000285598, gnorm=1.107, loss_scale=8192, train_wall=234, wall=0
2023-02-28 08:47:12 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 08:47:32 | INFO | valid | epoch 062 | valid on 'valid' subset | loss 4.08 | nll_loss 1.949 | word_ins 3.715 | length 3.65 | ppl 16.91 | wps 24066.2 | wpb 40242.5 | bsz 1500 | num_updates 122618 | best_loss 4.071
2023-02-28 08:47:32 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 08:47:38 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint62.pt (epoch 62 @ 122618 updates, score 4.08) (writing took 5.72252937965095 seconds)
2023-02-28 08:47:38 | INFO | fairseq_cli.train | end of epoch 62 (average epoch stats below)
2023-02-28 08:47:38 | INFO | train | epoch 062 | loss 3.082 | nll_loss 0.929 | word_ins 2.754 | length 3.284 | ppl 8.47 | wps 25071.1 | ups 0.42 | wpb 59283.5 | bsz 2002.7 | num_updates 122618 | lr 0.000285577 | gnorm 1.131 | loss_scale 8192 | train_wall 4633 | wall 0
2023-02-28 08:47:38 | INFO | fairseq.trainer | begin training epoch 63
2023-02-28 08:51:01 | INFO | train_inner | epoch 063:     82 / 1978 loss=3.057, nll_loss=0.909, word_ins=2.736, length=3.216, ppl=8.32, wps=21891.4, ups=0.37, wpb=59280.2, bsz=2014.8, num_updates=122700, lr=0.000285481, gnorm=1.14, loss_scale=8192, train_wall=233, wall=0
2023-02-28 08:54:56 | INFO | train_inner | epoch 063:    182 / 1978 loss=3.053, nll_loss=0.905, word_ins=2.732, length=3.21, ppl=8.3, wps=25257.6, ups=0.42, wpb=59440.4, bsz=2092.2, num_updates=122800, lr=0.000285365, gnorm=1.113, loss_scale=8192, train_wall=235, wall=0
2023-02-28 08:58:51 | INFO | train_inner | epoch 063:    282 / 1978 loss=3.068, nll_loss=0.92, word_ins=2.746, length=3.224, ppl=8.39, wps=25191.2, ups=0.43, wpb=59155.5, bsz=2057.4, num_updates=122900, lr=0.000285249, gnorm=1.167, loss_scale=8192, train_wall=235, wall=0
2023-02-28 09:02:45 | INFO | train_inner | epoch 063:    382 / 1978 loss=3.067, nll_loss=0.913, word_ins=2.739, length=3.28, ppl=8.38, wps=25272, ups=0.43, wpb=59166.7, bsz=2033.8, num_updates=123000, lr=0.000285133, gnorm=1.146, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:06:40 | INFO | train_inner | epoch 063:    482 / 1978 loss=3.046, nll_loss=0.898, word_ins=2.726, length=3.197, ppl=8.26, wps=25387.4, ups=0.43, wpb=59574, bsz=2133.8, num_updates=123100, lr=0.000285017, gnorm=1.144, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:10:34 | INFO | train_inner | epoch 063:    582 / 1978 loss=3.069, nll_loss=0.915, word_ins=2.741, length=3.283, ppl=8.39, wps=25346.8, ups=0.43, wpb=59398.5, bsz=2082.2, num_updates=123200, lr=0.000284901, gnorm=1.101, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:14:28 | INFO | train_inner | epoch 063:    682 / 1978 loss=3.092, nll_loss=0.938, word_ins=2.762, length=3.3, ppl=8.52, wps=25333.3, ups=0.43, wpb=59304.4, bsz=1951.7, num_updates=123300, lr=0.000284786, gnorm=1.115, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:18:21 | INFO | train_inner | epoch 063:    782 / 1978 loss=3.077, nll_loss=0.923, word_ins=2.748, length=3.295, ppl=8.44, wps=25742.1, ups=0.43, wpb=59987.6, bsz=1901.4, num_updates=123400, lr=0.00028467, gnorm=1.156, loss_scale=8192, train_wall=233, wall=0
2023-02-28 09:22:15 | INFO | train_inner | epoch 063:    882 / 1978 loss=3.088, nll_loss=0.934, word_ins=2.759, length=3.29, ppl=8.5, wps=25101.2, ups=0.43, wpb=58695.6, bsz=2002.1, num_updates=123500, lr=0.000284555, gnorm=1.135, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:26:09 | INFO | train_inner | epoch 063:    982 / 1978 loss=3.083, nll_loss=0.927, word_ins=2.752, length=3.303, ppl=8.47, wps=25161.4, ups=0.43, wpb=58835, bsz=1963, num_updates=123600, lr=0.00028444, gnorm=1.1, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:30:03 | INFO | train_inner | epoch 063:   1082 / 1978 loss=3.059, nll_loss=0.908, word_ins=2.734, length=3.244, ppl=8.33, wps=25279.4, ups=0.43, wpb=59224.9, bsz=2059.9, num_updates=123700, lr=0.000284325, gnorm=1.117, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:33:58 | INFO | train_inner | epoch 063:   1182 / 1978 loss=3.085, nll_loss=0.932, word_ins=2.756, length=3.292, ppl=8.49, wps=25274.8, ups=0.43, wpb=59346.9, bsz=2037.9, num_updates=123800, lr=0.00028421, gnorm=1.141, loss_scale=8192, train_wall=235, wall=0
2023-02-28 09:37:52 | INFO | train_inner | epoch 063:   1282 / 1978 loss=3.104, nll_loss=0.949, word_ins=2.772, length=3.314, ppl=8.6, wps=25273.2, ups=0.43, wpb=58973.6, bsz=1938.6, num_updates=123900, lr=0.000284095, gnorm=1.141, loss_scale=8192, train_wall=233, wall=0
2023-02-28 09:41:45 | INFO | train_inner | epoch 063:   1382 / 1978 loss=3.104, nll_loss=0.95, word_ins=2.773, length=3.31, ppl=8.6, wps=25328.4, ups=0.43, wpb=59181.5, bsz=1895.4, num_updates=124000, lr=0.000283981, gnorm=1.178, loss_scale=8192, train_wall=233, wall=0
2023-02-28 09:45:39 | INFO | train_inner | epoch 063:   1482 / 1978 loss=3.069, nll_loss=0.916, word_ins=2.742, length=3.274, ppl=8.39, wps=25441.2, ups=0.43, wpb=59536.9, bsz=2028.2, num_updates=124100, lr=0.000283866, gnorm=1.156, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:49:32 | INFO | train_inner | epoch 063:   1582 / 1978 loss=3.077, nll_loss=0.924, word_ins=2.75, length=3.273, ppl=8.44, wps=25261.5, ups=0.43, wpb=58843.4, bsz=1969, num_updates=124200, lr=0.000283752, gnorm=1.132, loss_scale=8192, train_wall=233, wall=0
2023-02-28 09:53:26 | INFO | train_inner | epoch 063:   1682 / 1978 loss=3.091, nll_loss=0.935, word_ins=2.759, length=3.327, ppl=8.52, wps=25420.4, ups=0.43, wpb=59502.9, bsz=1929.8, num_updates=124300, lr=0.000283638, gnorm=1.111, loss_scale=8192, train_wall=234, wall=0
2023-02-28 09:57:21 | INFO | train_inner | epoch 063:   1782 / 1978 loss=3.08, nll_loss=0.93, word_ins=2.754, length=3.263, ppl=8.46, wps=25530.7, ups=0.43, wpb=59846.7, bsz=2001.2, num_updates=124400, lr=0.000283524, gnorm=1.136, loss_scale=8192, train_wall=234, wall=0
2023-02-28 10:01:15 | INFO | train_inner | epoch 063:   1882 / 1978 loss=3.083, nll_loss=0.931, word_ins=2.756, length=3.272, ppl=8.47, wps=25361.2, ups=0.43, wpb=59379, bsz=1964.5, num_updates=124500, lr=0.00028341, gnorm=1.163, loss_scale=8192, train_wall=234, wall=0
2023-02-28 10:05:01 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 10:05:20 | INFO | valid | epoch 063 | valid on 'valid' subset | loss 4.086 | nll_loss 1.947 | word_ins 3.713 | length 3.731 | ppl 16.99 | wps 30114.2 | wpb 40242.5 | bsz 1500 | num_updates 124596 | best_loss 4.071
2023-02-28 10:05:20 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 10:05:25 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint63.pt (epoch 63 @ 124596 updates, score 4.086) (writing took 5.718894694000483 seconds)
2023-02-28 10:05:25 | INFO | fairseq_cli.train | end of epoch 63 (average epoch stats below)
2023-02-28 10:05:25 | INFO | train | epoch 063 | loss 3.077 | nll_loss 0.924 | word_ins 2.75 | length 3.277 | ppl 8.44 | wps 25121.7 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 124596 | lr 0.000283301 | gnorm 1.136 | loss_scale 8192 | train_wall 4626 | wall 0
2023-02-28 10:05:25 | INFO | fairseq.trainer | begin training epoch 64
2023-02-28 10:05:44 | INFO | train_inner | epoch 064:      4 / 1978 loss=3.095, nll_loss=0.934, word_ins=2.758, length=3.372, ppl=8.55, wps=21791, ups=0.37, wpb=58751.1, bsz=1982.5, num_updates=124600, lr=0.000283296, gnorm=1.143, loss_scale=8192, train_wall=234, wall=0
2023-02-28 10:09:39 | INFO | train_inner | epoch 064:    104 / 1978 loss=3.064, nll_loss=0.914, word_ins=2.741, length=3.237, ppl=8.36, wps=25389.7, ups=0.43, wpb=59668.9, bsz=1999.8, num_updates=124700, lr=0.000283183, gnorm=1.119, loss_scale=8192, train_wall=235, wall=0
2023-02-28 10:13:34 | INFO | train_inner | epoch 064:    204 / 1978 loss=3.051, nll_loss=0.9, word_ins=2.727, length=3.241, ppl=8.29, wps=25312.3, ups=0.43, wpb=59316.1, bsz=1997.4, num_updates=124800, lr=0.000283069, gnorm=1.103, loss_scale=8192, train_wall=234, wall=0
2023-02-28 10:17:38 | INFO | train_inner | epoch 064:    304 / 1978 loss=3.061, nll_loss=0.909, word_ins=2.735, length=3.255, ppl=8.35, wps=24288.1, ups=0.41, wpb=59392.1, bsz=2025.7, num_updates=124900, lr=0.000282956, gnorm=1.185, loss_scale=8192, train_wall=244, wall=0
2023-02-28 10:21:34 | INFO | train_inner | epoch 064:    404 / 1978 loss=3.072, nll_loss=0.922, word_ins=2.747, length=3.25, ppl=8.41, wps=25238.5, ups=0.42, wpb=59403.5, bsz=2050.5, num_updates=125000, lr=0.000282843, gnorm=1.17, loss_scale=8192, train_wall=235, wall=0
2023-02-28 10:25:27 | INFO | train_inner | epoch 064:    504 / 1978 loss=3.065, nll_loss=0.914, word_ins=2.741, length=3.238, ppl=8.37, wps=25547.3, ups=0.43, wpb=59594.8, bsz=1983.3, num_updates=125100, lr=0.00028273, gnorm=1.167, loss_scale=8192, train_wall=233, wall=0
2023-02-28 10:29:22 | INFO | train_inner | epoch 064:    604 / 1978 loss=3.058, nll_loss=0.911, word_ins=2.737, length=3.213, ppl=8.33, wps=25329.9, ups=0.43, wpb=59468.9, bsz=2066.6, num_updates=125200, lr=0.000282617, gnorm=1.127, loss_scale=8192, train_wall=235, wall=0
2023-02-28 10:33:17 | INFO | train_inner | epoch 064:    704 / 1978 loss=3.049, nll_loss=0.9, word_ins=2.727, length=3.215, ppl=8.28, wps=25424.7, ups=0.43, wpb=59776, bsz=2101.4, num_updates=125300, lr=0.000282504, gnorm=1.157, loss_scale=8192, train_wall=235, wall=0
2023-02-28 10:37:11 | INFO | train_inner | epoch 064:    804 / 1978 loss=3.063, nll_loss=0.916, word_ins=2.742, length=3.214, ppl=8.36, wps=25396.5, ups=0.43, wpb=59438.3, bsz=2047.4, num_updates=125400, lr=0.000282391, gnorm=1.114, loss_scale=8192, train_wall=234, wall=0
2023-02-28 10:41:46 | INFO | train_inner | epoch 064:    904 / 1978 loss=3.063, nll_loss=0.909, word_ins=2.735, length=3.272, ppl=8.35, wps=21699.9, ups=0.36, wpb=59676, bsz=2030.4, num_updates=125500, lr=0.000282279, gnorm=1.134, loss_scale=8192, train_wall=275, wall=0
2023-02-28 10:46:01 | INFO | train_inner | epoch 064:   1004 / 1978 loss=3.087, nll_loss=0.927, word_ins=2.752, length=3.349, ppl=8.5, wps=23030.1, ups=0.39, wpb=58695, bsz=1961.5, num_updates=125600, lr=0.000282166, gnorm=1.108, loss_scale=8192, train_wall=255, wall=0
2023-02-28 10:49:54 | INFO | train_inner | epoch 064:   1104 / 1978 loss=3.09, nll_loss=0.931, word_ins=2.756, length=3.339, ppl=8.51, wps=25448.7, ups=0.43, wpb=59298.2, bsz=1981.3, num_updates=125700, lr=0.000282054, gnorm=1.129, loss_scale=8192, train_wall=233, wall=0
2023-02-28 10:53:46 | INFO | train_inner | epoch 064:   1204 / 1978 loss=3.108, nll_loss=0.956, word_ins=2.779, length=3.295, ppl=8.62, wps=25478.6, ups=0.43, wpb=59224.3, bsz=1898.2, num_updates=125800, lr=0.000281942, gnorm=1.193, loss_scale=8192, train_wall=232, wall=0
2023-02-28 10:57:41 | INFO | train_inner | epoch 064:   1304 / 1978 loss=3.066, nll_loss=0.912, word_ins=2.738, length=3.272, ppl=8.37, wps=25441.3, ups=0.43, wpb=59568.7, bsz=1971.4, num_updates=125900, lr=0.00028183, gnorm=1.127, loss_scale=8192, train_wall=234, wall=0
2023-02-28 11:01:34 | INFO | train_inner | epoch 064:   1404 / 1978 loss=3.083, nll_loss=0.928, word_ins=2.753, length=3.298, ppl=8.47, wps=25242.6, ups=0.43, wpb=58972.5, bsz=1993, num_updates=126000, lr=0.000281718, gnorm=1.14, loss_scale=8192, train_wall=233, wall=0
2023-02-28 11:05:28 | INFO | train_inner | epoch 064:   1504 / 1978 loss=3.064, nll_loss=0.914, word_ins=2.74, length=3.235, ppl=8.36, wps=25319.2, ups=0.43, wpb=59287.6, bsz=2049.2, num_updates=126100, lr=0.000281606, gnorm=1.173, loss_scale=8192, train_wall=234, wall=0
2023-02-28 11:09:23 | INFO | train_inner | epoch 064:   1604 / 1978 loss=3.096, nll_loss=0.941, word_ins=2.765, length=3.314, ppl=8.55, wps=25117.9, ups=0.43, wpb=58901.4, bsz=1986.6, num_updates=126200, lr=0.000281495, gnorm=1.172, loss_scale=8192, train_wall=234, wall=0
2023-02-28 11:13:58 | INFO | train_inner | epoch 064:   1704 / 1978 loss=3.08, nll_loss=0.928, word_ins=2.752, length=3.279, ppl=8.46, wps=21375.8, ups=0.36, wpb=58768, bsz=1973.4, num_updates=126300, lr=0.000281383, gnorm=1.145, loss_scale=16384, train_wall=275, wall=0
2023-02-28 11:15:43 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 11:17:58 | INFO | train_inner | epoch 064:   1805 / 1978 loss=3.076, nll_loss=0.924, word_ins=2.749, length=3.271, ppl=8.43, wps=24840.2, ups=0.42, wpb=59557, bsz=1978.8, num_updates=126400, lr=0.000281272, gnorm=1.18, loss_scale=8192, train_wall=240, wall=0
2023-02-28 11:22:02 | INFO | train_inner | epoch 064:   1905 / 1978 loss=3.076, nll_loss=0.928, word_ins=2.753, length=3.233, ppl=8.43, wps=24156.4, ups=0.41, wpb=59122.4, bsz=2033.8, num_updates=126500, lr=0.000281161, gnorm=1.153, loss_scale=8192, train_wall=244, wall=0
2023-02-28 11:25:05 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 11:25:25 | INFO | valid | epoch 064 | valid on 'valid' subset | loss 4.091 | nll_loss 1.934 | word_ins 3.7 | length 3.91 | ppl 17.04 | wps 30752 | wpb 40242.5 | bsz 1500 | num_updates 126573 | best_loss 4.071
2023-02-28 11:25:25 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 11:25:31 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint64.pt (epoch 64 @ 126573 updates, score 4.091) (writing took 5.767922505736351 seconds)
2023-02-28 11:25:31 | INFO | fairseq_cli.train | end of epoch 64 (average epoch stats below)
2023-02-28 11:25:31 | INFO | train | epoch 064 | loss 3.074 | nll_loss 0.922 | word_ins 2.747 | length 3.27 | ppl 8.42 | wps 24390.5 | ups 0.41 | wpb 59281.7 | bsz 2002.4 | num_updates 126573 | lr 0.00028108 | gnorm 1.149 | loss_scale 8192 | train_wall 4764 | wall 0
2023-02-28 11:25:31 | INFO | fairseq.trainer | begin training epoch 65
2023-02-28 11:26:47 | INFO | train_inner | epoch 065:     27 / 1978 loss=3.107, nll_loss=0.948, word_ins=2.771, length=3.364, ppl=8.62, wps=20768.3, ups=0.35, wpb=59046.3, bsz=1920, num_updates=126600, lr=0.00028105, gnorm=1.196, loss_scale=8192, train_wall=247, wall=0
2023-02-28 11:30:40 | INFO | train_inner | epoch 065:    127 / 1978 loss=3.061, nll_loss=0.911, word_ins=2.738, length=3.232, ppl=8.35, wps=25390.8, ups=0.43, wpb=59351.2, bsz=1979.3, num_updates=126700, lr=0.000280939, gnorm=1.132, loss_scale=8192, train_wall=234, wall=0
2023-02-28 11:34:35 | INFO | train_inner | epoch 065:    227 / 1978 loss=3.077, nll_loss=0.926, word_ins=2.752, length=3.256, ppl=8.44, wps=25399.3, ups=0.43, wpb=59479.6, bsz=1973.6, num_updates=126800, lr=0.000280828, gnorm=1.159, loss_scale=8192, train_wall=234, wall=0
2023-02-28 11:38:33 | INFO | train_inner | epoch 065:    327 / 1978 loss=3.032, nll_loss=0.887, word_ins=2.715, length=3.169, ppl=8.18, wps=25085.1, ups=0.42, wpb=59905.8, bsz=2099.5, num_updates=126900, lr=0.000280717, gnorm=1.097, loss_scale=8192, train_wall=239, wall=0
2023-02-28 11:42:26 | INFO | train_inner | epoch 065:    427 / 1978 loss=3.086, nll_loss=0.932, word_ins=2.757, length=3.292, ppl=8.49, wps=25266.5, ups=0.43, wpb=58848.6, bsz=1947.4, num_updates=127000, lr=0.000280607, gnorm=1.167, loss_scale=8192, train_wall=233, wall=0
2023-02-28 11:46:41 | INFO | train_inner | epoch 065:    527 / 1978 loss=3.053, nll_loss=0.907, word_ins=2.734, length=3.195, ppl=8.3, wps=23179.1, ups=0.39, wpb=59015.7, bsz=2092.6, num_updates=127100, lr=0.000280496, gnorm=1.136, loss_scale=8192, train_wall=254, wall=0
2023-02-28 11:51:01 | INFO | train_inner | epoch 065:    627 / 1978 loss=3.074, nll_loss=0.922, word_ins=2.747, length=3.267, ppl=8.42, wps=22968, ups=0.38, wpb=59848.4, bsz=1940.6, num_updates=127200, lr=0.000280386, gnorm=1.19, loss_scale=8192, train_wall=258, wall=0
2023-02-28 11:54:59 | INFO | train_inner | epoch 065:    727 / 1978 loss=3.089, nll_loss=0.929, word_ins=2.754, length=3.352, ppl=8.51, wps=24755.6, ups=0.42, wpb=58898.9, bsz=1981.7, num_updates=127300, lr=0.000280276, gnorm=1.173, loss_scale=8192, train_wall=238, wall=0
2023-02-28 11:58:53 | INFO | train_inner | epoch 065:    827 / 1978 loss=3.091, nll_loss=0.936, word_ins=2.76, length=3.305, ppl=8.52, wps=25371, ups=0.43, wpb=59368.5, bsz=1964.4, num_updates=127400, lr=0.000280166, gnorm=1.158, loss_scale=8192, train_wall=234, wall=0
2023-02-28 12:02:46 | INFO | train_inner | epoch 065:    927 / 1978 loss=3.075, nll_loss=0.92, word_ins=2.745, length=3.296, ppl=8.43, wps=25602.6, ups=0.43, wpb=59544.8, bsz=1883.5, num_updates=127500, lr=0.000280056, gnorm=1.197, loss_scale=8192, train_wall=232, wall=0
2023-02-28 12:06:41 | INFO | train_inner | epoch 065:   1027 / 1978 loss=3.059, nll_loss=0.913, word_ins=2.739, length=3.191, ppl=8.33, wps=25149.3, ups=0.43, wpb=59069.7, bsz=2063.4, num_updates=127600, lr=0.000279946, gnorm=1.143, loss_scale=8192, train_wall=235, wall=0
2023-02-28 12:10:33 | INFO | train_inner | epoch 065:   1127 / 1978 loss=3.085, nll_loss=0.931, word_ins=2.755, length=3.296, ppl=8.49, wps=25532.1, ups=0.43, wpb=59367.9, bsz=1918, num_updates=127700, lr=0.000279837, gnorm=1.195, loss_scale=8192, train_wall=232, wall=0
2023-02-28 12:14:27 | INFO | train_inner | epoch 065:   1227 / 1978 loss=3.066, nll_loss=0.912, word_ins=2.738, length=3.274, ppl=8.37, wps=25642.4, ups=0.43, wpb=59800.9, bsz=1960.8, num_updates=127800, lr=0.000279727, gnorm=1.168, loss_scale=8192, train_wall=233, wall=0
2023-02-28 12:18:22 | INFO | train_inner | epoch 065:   1327 / 1978 loss=3.073, nll_loss=0.924, word_ins=2.748, length=3.247, ppl=8.42, wps=25250.2, ups=0.43, wpb=59322.4, bsz=2096.8, num_updates=127900, lr=0.000279618, gnorm=1.189, loss_scale=8192, train_wall=235, wall=0
2023-02-28 12:22:15 | INFO | train_inner | epoch 065:   1427 / 1978 loss=3.076, nll_loss=0.923, word_ins=2.749, length=3.271, ppl=8.43, wps=25064, ups=0.43, wpb=58569.4, bsz=1945.9, num_updates=128000, lr=0.000279508, gnorm=1.142, loss_scale=8192, train_wall=233, wall=0
2023-02-28 12:26:08 | INFO | train_inner | epoch 065:   1527 / 1978 loss=3.081, nll_loss=0.927, word_ins=2.752, length=3.293, ppl=8.46, wps=25527.4, ups=0.43, wpb=59327.3, bsz=1971.7, num_updates=128100, lr=0.000279399, gnorm=1.135, loss_scale=8192, train_wall=232, wall=0
2023-02-28 12:30:01 | INFO | train_inner | epoch 065:   1627 / 1978 loss=3.065, nll_loss=0.914, word_ins=2.74, length=3.255, ppl=8.37, wps=25319, ups=0.43, wpb=59089, bsz=2095, num_updates=128200, lr=0.00027929, gnorm=1.133, loss_scale=8192, train_wall=233, wall=0
2023-02-28 12:33:53 | INFO | train_inner | epoch 065:   1727 / 1978 loss=3.076, nll_loss=0.921, word_ins=2.747, length=3.295, ppl=8.43, wps=25389.4, ups=0.43, wpb=58970.7, bsz=2038.9, num_updates=128300, lr=0.000279182, gnorm=1.148, loss_scale=8192, train_wall=232, wall=0
2023-02-28 12:37:47 | INFO | train_inner | epoch 065:   1827 / 1978 loss=3.063, nll_loss=0.912, word_ins=2.737, length=3.261, ppl=8.36, wps=25346.4, ups=0.43, wpb=59136.6, bsz=2046.4, num_updates=128400, lr=0.000279073, gnorm=1.143, loss_scale=8192, train_wall=233, wall=0
2023-02-28 12:41:39 | INFO | train_inner | epoch 065:   1927 / 1978 loss=3.059, nll_loss=0.911, word_ins=2.737, length=3.218, ppl=8.33, wps=25501.4, ups=0.43, wpb=59389.4, bsz=2079.1, num_updates=128500, lr=0.000278964, gnorm=1.178, loss_scale=8192, train_wall=233, wall=0
2023-02-28 12:43:37 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 12:43:54 | INFO | valid | epoch 065 | valid on 'valid' subset | loss 4.101 | nll_loss 1.948 | word_ins 3.716 | length 3.847 | ppl 17.15 | wps 31606.4 | wpb 40242.5 | bsz 1500 | num_updates 128551 | best_loss 4.071
2023-02-28 12:43:54 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 12:44:00 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint65.pt (epoch 65 @ 128551 updates, score 4.101) (writing took 5.763178184628487 seconds)
2023-02-28 12:44:00 | INFO | fairseq_cli.train | end of epoch 65 (average epoch stats below)
2023-02-28 12:44:00 | INFO | train | epoch 065 | loss 3.071 | nll_loss 0.919 | word_ins 2.744 | length 3.264 | ppl 8.4 | wps 24898.8 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 128551 | lr 0.000278909 | gnorm 1.158 | loss_scale 8192 | train_wall 4667 | wall 0
2023-02-28 12:44:00 | INFO | fairseq.trainer | begin training epoch 66
2023-02-28 12:46:04 | INFO | train_inner | epoch 066:     49 / 1978 loss=3.066, nll_loss=0.913, word_ins=2.739, length=3.275, ppl=8.38, wps=22328.7, ups=0.38, wpb=58982.7, bsz=1996.2, num_updates=128600, lr=0.000278856, gnorm=1.17, loss_scale=8192, train_wall=230, wall=0
2023-02-28 12:49:56 | INFO | train_inner | epoch 066:    149 / 1978 loss=3.053, nll_loss=0.905, word_ins=2.732, length=3.212, ppl=8.3, wps=25292.4, ups=0.43, wpb=58875.9, bsz=2042.6, num_updates=128700, lr=0.000278747, gnorm=1.124, loss_scale=8192, train_wall=233, wall=0
2023-02-28 12:53:49 | INFO | train_inner | epoch 066:    249 / 1978 loss=3.067, nll_loss=0.908, word_ins=2.735, length=3.322, ppl=8.38, wps=25268.7, ups=0.43, wpb=58800.5, bsz=2020, num_updates=128800, lr=0.000278639, gnorm=1.168, loss_scale=8192, train_wall=232, wall=0
2023-02-28 12:57:41 | INFO | train_inner | epoch 066:    349 / 1978 loss=3.078, nll_loss=0.924, word_ins=2.75, length=3.287, ppl=8.45, wps=25688.9, ups=0.43, wpb=59518.6, bsz=1940, num_updates=128900, lr=0.000278531, gnorm=1.171, loss_scale=8192, train_wall=231, wall=0
2023-02-28 13:01:33 | INFO | train_inner | epoch 066:    449 / 1978 loss=3.052, nll_loss=0.904, word_ins=2.73, length=3.214, ppl=8.29, wps=25640.4, ups=0.43, wpb=59551.5, bsz=2029.8, num_updates=129000, lr=0.000278423, gnorm=1.115, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:05:25 | INFO | train_inner | epoch 066:    549 / 1978 loss=3.033, nll_loss=0.886, word_ins=2.715, length=3.178, ppl=8.18, wps=25620.3, ups=0.43, wpb=59416.2, bsz=2091.7, num_updates=129100, lr=0.000278315, gnorm=1.147, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:09:16 | INFO | train_inner | epoch 066:    649 / 1978 loss=3.074, nll_loss=0.923, word_ins=2.748, length=3.256, ppl=8.42, wps=25535.1, ups=0.43, wpb=59000.1, bsz=1985.8, num_updates=129200, lr=0.000278207, gnorm=1.164, loss_scale=8192, train_wall=231, wall=0
2023-02-28 13:13:08 | INFO | train_inner | epoch 066:    749 / 1978 loss=3.069, nll_loss=0.919, word_ins=2.744, length=3.25, ppl=8.39, wps=25507.6, ups=0.43, wpb=59118.7, bsz=1961.3, num_updates=129300, lr=0.0002781, gnorm=1.149, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:16:59 | INFO | train_inner | epoch 066:    849 / 1978 loss=3.087, nll_loss=0.933, word_ins=2.758, length=3.298, ppl=8.5, wps=25730.8, ups=0.43, wpb=59422.5, bsz=1930.8, num_updates=129400, lr=0.000277992, gnorm=1.203, loss_scale=8192, train_wall=231, wall=0
2023-02-28 13:20:52 | INFO | train_inner | epoch 066:    949 / 1978 loss=3.044, nll_loss=0.896, word_ins=2.723, length=3.211, ppl=8.25, wps=25671.8, ups=0.43, wpb=59856.9, bsz=2116.6, num_updates=129500, lr=0.000277885, gnorm=1.147, loss_scale=8192, train_wall=233, wall=0
2023-02-28 13:24:43 | INFO | train_inner | epoch 066:   1049 / 1978 loss=3.07, nll_loss=0.915, word_ins=2.74, length=3.301, ppl=8.4, wps=25508.2, ups=0.43, wpb=59052.6, bsz=1975.1, num_updates=129600, lr=0.000277778, gnorm=1.148, loss_scale=8192, train_wall=231, wall=0
2023-02-28 13:28:37 | INFO | train_inner | epoch 066:   1149 / 1978 loss=3.04, nll_loss=0.896, word_ins=2.723, length=3.167, ppl=8.23, wps=25530.7, ups=0.43, wpb=59535, bsz=2082.6, num_updates=129700, lr=0.000277671, gnorm=1.135, loss_scale=8192, train_wall=233, wall=0
2023-02-28 13:32:29 | INFO | train_inner | epoch 066:   1249 / 1978 loss=3.061, nll_loss=0.912, word_ins=2.738, length=3.229, ppl=8.34, wps=25638.4, ups=0.43, wpb=59660.4, bsz=1998.1, num_updates=129800, lr=0.000277564, gnorm=1.158, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:36:22 | INFO | train_inner | epoch 066:   1349 / 1978 loss=3.089, nll_loss=0.937, word_ins=2.761, length=3.284, ppl=8.51, wps=25341.4, ups=0.43, wpb=58925.2, bsz=1940.3, num_updates=129900, lr=0.000277457, gnorm=1.182, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:40:13 | INFO | train_inner | epoch 066:   1449 / 1978 loss=3.085, nll_loss=0.929, word_ins=2.753, length=3.318, ppl=8.48, wps=25643.3, ups=0.43, wpb=59308, bsz=1890.1, num_updates=130000, lr=0.00027735, gnorm=1.156, loss_scale=8192, train_wall=231, wall=0
2023-02-28 13:44:05 | INFO | train_inner | epoch 066:   1549 / 1978 loss=3.057, nll_loss=0.91, word_ins=2.736, length=3.216, ppl=8.32, wps=25665.2, ups=0.43, wpb=59532.8, bsz=2038.9, num_updates=130100, lr=0.000277243, gnorm=1.141, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:47:57 | INFO | train_inner | epoch 066:   1649 / 1978 loss=3.075, nll_loss=0.924, word_ins=2.749, length=3.258, ppl=8.43, wps=25475.6, ups=0.43, wpb=59048.7, bsz=2058.3, num_updates=130200, lr=0.000277137, gnorm=1.164, loss_scale=8192, train_wall=232, wall=0
2023-02-28 13:51:48 | INFO | train_inner | epoch 066:   1749 / 1978 loss=3.083, nll_loss=0.934, word_ins=2.758, length=3.248, ppl=8.48, wps=25683.8, ups=0.43, wpb=59238, bsz=1951.3, num_updates=130300, lr=0.000277031, gnorm=1.211, loss_scale=8192, train_wall=230, wall=0
2023-02-28 13:55:38 | INFO | train_inner | epoch 066:   1849 / 1978 loss=3.089, nll_loss=0.931, word_ins=2.755, length=3.339, ppl=8.51, wps=25759.6, ups=0.43, wpb=59334.1, bsz=1925.9, num_updates=130400, lr=0.000276924, gnorm=1.195, loss_scale=8192, train_wall=230, wall=0
2023-02-28 13:57:33 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 13:59:31 | INFO | train_inner | epoch 066:   1950 / 1978 loss=3.063, nll_loss=0.904, word_ins=2.73, length=3.334, ppl=8.36, wps=25465.6, ups=0.43, wpb=59371.3, bsz=2023.7, num_updates=130500, lr=0.000276818, gnorm=1.198, loss_scale=8192, train_wall=233, wall=0
2023-02-28 14:00:36 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 14:00:58 | INFO | valid | epoch 066 | valid on 'valid' subset | loss 4.141 | nll_loss 1.941 | word_ins 3.707 | length 4.336 | ppl 17.64 | wps 31204.3 | wpb 40242.5 | bsz 1500 | num_updates 130528 | best_loss 4.071
2023-02-28 14:00:58 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 14:01:04 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint66.pt (epoch 66 @ 130528 updates, score 4.141) (writing took 5.973967105150223 seconds)
2023-02-28 14:01:04 | INFO | fairseq_cli.train | end of epoch 66 (average epoch stats below)
2023-02-28 14:01:04 | INFO | train | epoch 066 | loss 3.066 | nll_loss 0.915 | word_ins 2.741 | length 3.256 | ppl 8.38 | wps 25347.8 | ups 0.43 | wpb 59282.2 | bsz 2002.9 | num_updates 130528 | lr 0.000276789 | gnorm 1.163 | loss_scale 8192 | train_wall 4580 | wall 0
2023-02-28 14:01:04 | INFO | fairseq.trainer | begin training epoch 67
2023-02-28 14:04:04 | INFO | train_inner | epoch 067:     72 / 1978 loss=3.048, nll_loss=0.899, word_ins=2.726, length=3.226, ppl=8.27, wps=21773.8, ups=0.37, wpb=59436.8, bsz=2010.8, num_updates=130600, lr=0.000276712, gnorm=1.166, loss_scale=8192, train_wall=230, wall=0
2023-02-28 14:07:55 | INFO | train_inner | epoch 067:    172 / 1978 loss=3.06, nll_loss=0.906, word_ins=2.733, length=3.272, ppl=8.34, wps=25759.2, ups=0.43, wpb=59370.7, bsz=2003.5, num_updates=130700, lr=0.000276606, gnorm=1.152, loss_scale=8192, train_wall=230, wall=0
2023-02-28 14:11:46 | INFO | train_inner | epoch 067:    272 / 1978 loss=3.052, nll_loss=0.897, word_ins=2.724, length=3.275, ppl=8.29, wps=25791.6, ups=0.43, wpb=59605.9, bsz=2004.2, num_updates=130800, lr=0.000276501, gnorm=1.132, loss_scale=8192, train_wall=231, wall=0
2023-02-28 14:15:37 | INFO | train_inner | epoch 067:    372 / 1978 loss=3.08, nll_loss=0.929, word_ins=2.754, length=3.264, ppl=8.46, wps=25319.2, ups=0.43, wpb=58545.8, bsz=1954.4, num_updates=130900, lr=0.000276395, gnorm=1.159, loss_scale=8192, train_wall=231, wall=0
2023-02-28 14:19:28 | INFO | train_inner | epoch 067:    472 / 1978 loss=3.039, nll_loss=0.892, word_ins=2.72, length=3.192, ppl=8.22, wps=25836.9, ups=0.43, wpb=59784.5, bsz=2053.4, num_updates=131000, lr=0.000276289, gnorm=1.2, loss_scale=8192, train_wall=231, wall=0
2023-02-28 14:23:20 | INFO | train_inner | epoch 067:    572 / 1978 loss=3.06, nll_loss=0.912, word_ins=2.738, length=3.219, ppl=8.34, wps=25592.5, ups=0.43, wpb=59195.7, bsz=1990.4, num_updates=131100, lr=0.000276184, gnorm=1.178, loss_scale=8192, train_wall=231, wall=0
2023-02-28 14:27:12 | INFO | train_inner | epoch 067:    672 / 1978 loss=3.083, nll_loss=0.926, word_ins=2.751, length=3.316, ppl=8.47, wps=25400.4, ups=0.43, wpb=58979.9, bsz=1920.9, num_updates=131200, lr=0.000276079, gnorm=1.183, loss_scale=8192, train_wall=232, wall=0
2023-02-28 14:31:03 | INFO | train_inner | epoch 067:    772 / 1978 loss=3.07, nll_loss=0.911, word_ins=2.737, length=3.329, ppl=8.4, wps=25726.8, ups=0.43, wpb=59562.4, bsz=1991.9, num_updates=131300, lr=0.000275974, gnorm=1.203, loss_scale=8192, train_wall=231, wall=0
2023-02-28 14:35:00 | INFO | train_inner | epoch 067:    872 / 1978 loss=3.053, nll_loss=0.898, word_ins=2.725, length=3.287, ppl=8.3, wps=24965.8, ups=0.42, wpb=59095.5, bsz=2023.4, num_updates=131400, lr=0.000275869, gnorm=1.145, loss_scale=8192, train_wall=236, wall=0
2023-02-28 14:38:51 | INFO | train_inner | epoch 067:    972 / 1978 loss=3.042, nll_loss=0.894, word_ins=2.721, length=3.206, ppl=8.24, wps=25663.6, ups=0.43, wpb=59362, bsz=2058.4, num_updates=131500, lr=0.000275764, gnorm=1.181, loss_scale=8192, train_wall=231, wall=0
2023-02-28 14:42:44 | INFO | train_inner | epoch 067:   1072 / 1978 loss=3.087, nll_loss=0.937, word_ins=2.761, length=3.263, ppl=8.5, wps=25504.7, ups=0.43, wpb=59269.7, bsz=1999.8, num_updates=131600, lr=0.000275659, gnorm=1.151, loss_scale=8192, train_wall=232, wall=0
2023-02-28 14:46:36 | INFO | train_inner | epoch 067:   1172 / 1978 loss=3.036, nll_loss=0.893, word_ins=2.72, length=3.153, ppl=8.2, wps=25551, ups=0.43, wpb=59468.1, bsz=2113.9, num_updates=131700, lr=0.000275554, gnorm=1.168, loss_scale=8192, train_wall=233, wall=0
2023-02-28 14:50:36 | INFO | train_inner | epoch 067:   1272 / 1978 loss=3.053, nll_loss=0.903, word_ins=2.729, length=3.249, ppl=8.3, wps=24950.2, ups=0.42, wpb=59819.8, bsz=2029.6, num_updates=131800, lr=0.00027545, gnorm=1.139, loss_scale=8192, train_wall=239, wall=0
2023-02-28 14:54:31 | INFO | train_inner | epoch 067:   1372 / 1978 loss=3.052, nll_loss=0.901, word_ins=2.727, length=3.252, ppl=8.3, wps=25384.5, ups=0.43, wpb=59572.1, bsz=2022.2, num_updates=131900, lr=0.000275345, gnorm=1.16, loss_scale=8192, train_wall=234, wall=0
2023-02-28 14:58:28 | INFO | train_inner | epoch 067:   1472 / 1978 loss=3.07, nll_loss=0.913, word_ins=2.739, length=3.305, ppl=8.39, wps=24989.3, ups=0.42, wpb=59141.9, bsz=2009, num_updates=132000, lr=0.000275241, gnorm=1.169, loss_scale=8192, train_wall=236, wall=0
2023-02-28 15:02:26 | INFO | train_inner | epoch 067:   1572 / 1978 loss=3.056, nll_loss=0.905, word_ins=2.731, length=3.251, ppl=8.32, wps=24865.7, ups=0.42, wpb=59346.3, bsz=2006.8, num_updates=132100, lr=0.000275137, gnorm=1.194, loss_scale=8192, train_wall=238, wall=0
2023-02-28 15:06:31 | INFO | train_inner | epoch 067:   1672 / 1978 loss=3.06, nll_loss=0.91, word_ins=2.736, length=3.241, ppl=8.34, wps=24066.4, ups=0.41, wpb=58889.7, bsz=1936.4, num_updates=132200, lr=0.000275033, gnorm=1.147, loss_scale=8192, train_wall=238, wall=0
2023-02-28 15:10:30 | INFO | train_inner | epoch 067:   1772 / 1978 loss=3.097, nll_loss=0.939, word_ins=2.762, length=3.349, ppl=8.55, wps=24491.5, ups=0.42, wpb=58626.8, bsz=1970.7, num_updates=132300, lr=0.000274929, gnorm=1.194, loss_scale=8192, train_wall=239, wall=0
2023-02-28 15:14:30 | INFO | train_inner | epoch 067:   1872 / 1978 loss=3.082, nll_loss=0.93, word_ins=2.754, length=3.278, ppl=8.47, wps=24499.6, ups=0.42, wpb=58823.8, bsz=1969.1, num_updates=132400, lr=0.000274825, gnorm=1.166, loss_scale=8192, train_wall=240, wall=0
2023-02-28 15:18:28 | INFO | train_inner | epoch 067:   1972 / 1978 loss=3.062, nll_loss=0.911, word_ins=2.736, length=3.251, ppl=8.35, wps=25166.6, ups=0.42, wpb=59667.5, bsz=2021.2, num_updates=132500, lr=0.000274721, gnorm=1.185, loss_scale=8192, train_wall=237, wall=0
2023-02-28 15:18:42 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 15:19:02 | INFO | valid | epoch 067 | valid on 'valid' subset | loss 4.063 | nll_loss 1.931 | word_ins 3.698 | length 3.648 | ppl 16.72 | wps 30287 | wpb 40242.5 | bsz 1500 | num_updates 132506 | best_loss 4.063
2023-02-28 15:19:02 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 15:19:11 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint67.pt (epoch 67 @ 132506 updates, score 4.063) (writing took 8.883233474567533 seconds)
2023-02-28 15:19:11 | INFO | fairseq_cli.train | end of epoch 67 (average epoch stats below)
2023-02-28 15:19:11 | INFO | train | epoch 067 | loss 3.062 | nll_loss 0.91 | word_ins 2.736 | length 3.26 | ppl 8.35 | wps 25020.9 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 132506 | lr 0.000274715 | gnorm 1.169 | loss_scale 8192 | train_wall 4632 | wall 0
2023-02-28 15:19:11 | INFO | fairseq.trainer | begin training epoch 68
2023-02-28 15:23:02 | INFO | train_inner | epoch 068:     94 / 1978 loss=3.035, nll_loss=0.884, word_ins=2.713, length=3.22, ppl=8.2, wps=21687.2, ups=0.36, wpb=59598.2, bsz=1987.2, num_updates=132600, lr=0.000274618, gnorm=1.201, loss_scale=8192, train_wall=234, wall=0
2023-02-28 15:26:58 | INFO | train_inner | epoch 068:    194 / 1978 loss=3.048, nll_loss=0.896, word_ins=2.723, length=3.246, ppl=8.27, wps=25090.2, ups=0.42, wpb=59080.2, bsz=2005.4, num_updates=132700, lr=0.000274514, gnorm=1.126, loss_scale=8192, train_wall=235, wall=0
2023-02-28 15:30:52 | INFO | train_inner | epoch 068:    294 / 1978 loss=3.059, nll_loss=0.913, word_ins=2.739, length=3.199, ppl=8.33, wps=25041.4, ups=0.43, wpb=58573.4, bsz=2020.7, num_updates=132800, lr=0.000274411, gnorm=1.134, loss_scale=8192, train_wall=234, wall=0
2023-02-28 15:34:48 | INFO | train_inner | epoch 068:    394 / 1978 loss=3.086, nll_loss=0.933, word_ins=2.758, length=3.287, ppl=8.49, wps=24876.5, ups=0.42, wpb=58807.7, bsz=1964.6, num_updates=132900, lr=0.000274307, gnorm=1.185, loss_scale=8192, train_wall=236, wall=0
2023-02-28 15:38:45 | INFO | train_inner | epoch 068:    494 / 1978 loss=3.041, nll_loss=0.892, word_ins=2.72, length=3.212, ppl=8.23, wps=25056.1, ups=0.42, wpb=59258.7, bsz=2085.4, num_updates=133000, lr=0.000274204, gnorm=1.143, loss_scale=8192, train_wall=236, wall=0
2023-02-28 15:42:39 | INFO | train_inner | epoch 068:    594 / 1978 loss=3.076, nll_loss=0.92, word_ins=2.746, length=3.3, ppl=8.43, wps=25141.4, ups=0.43, wpb=59039.1, bsz=1902.3, num_updates=133100, lr=0.000274101, gnorm=1.144, loss_scale=8192, train_wall=235, wall=0
2023-02-28 15:46:35 | INFO | train_inner | epoch 068:    694 / 1978 loss=3.062, nll_loss=0.913, word_ins=2.739, length=3.23, ppl=8.35, wps=25004.2, ups=0.42, wpb=58949.1, bsz=2020.7, num_updates=133200, lr=0.000273998, gnorm=1.18, loss_scale=8192, train_wall=235, wall=0
2023-02-28 15:50:31 | INFO | train_inner | epoch 068:    794 / 1978 loss=3.065, nll_loss=0.91, word_ins=2.736, length=3.287, ppl=8.37, wps=25084, ups=0.42, wpb=59214.1, bsz=1996.9, num_updates=133300, lr=0.000273896, gnorm=1.158, loss_scale=8192, train_wall=236, wall=0
2023-02-28 15:54:28 | INFO | train_inner | epoch 068:    894 / 1978 loss=3.05, nll_loss=0.903, word_ins=2.729, length=3.209, ppl=8.28, wps=25047.2, ups=0.42, wpb=59334.6, bsz=2164.6, num_updates=133400, lr=0.000273793, gnorm=1.174, loss_scale=8192, train_wall=237, wall=0
2023-02-28 15:58:25 | INFO | train_inner | epoch 068:    994 / 1978 loss=3.042, nll_loss=0.894, word_ins=2.721, length=3.21, ppl=8.24, wps=25038.3, ups=0.42, wpb=59227.8, bsz=2070.1, num_updates=133500, lr=0.00027369, gnorm=1.184, loss_scale=8192, train_wall=236, wall=0
2023-02-28 16:02:21 | INFO | train_inner | epoch 068:   1094 / 1978 loss=3.07, nll_loss=0.919, word_ins=2.744, length=3.254, ppl=8.4, wps=25023.9, ups=0.42, wpb=59224, bsz=1972.2, num_updates=133600, lr=0.000273588, gnorm=1.194, loss_scale=8192, train_wall=236, wall=0
2023-02-28 16:06:17 | INFO | train_inner | epoch 068:   1194 / 1978 loss=3.064, nll_loss=0.912, word_ins=2.738, length=3.264, ppl=8.36, wps=25245.5, ups=0.42, wpb=59543.8, bsz=1980, num_updates=133700, lr=0.000273485, gnorm=1.19, loss_scale=8192, train_wall=236, wall=0
2023-02-28 16:10:13 | INFO | train_inner | epoch 068:   1294 / 1978 loss=3.066, nll_loss=0.915, word_ins=2.74, length=3.26, ppl=8.38, wps=25249.6, ups=0.42, wpb=59524.6, bsz=1995.7, num_updates=133800, lr=0.000273383, gnorm=1.179, loss_scale=8192, train_wall=236, wall=0
2023-02-28 16:14:09 | INFO | train_inner | epoch 068:   1394 / 1978 loss=3.055, nll_loss=0.905, word_ins=2.731, length=3.24, ppl=8.31, wps=25251.2, ups=0.42, wpb=59510.2, bsz=1962.9, num_updates=133900, lr=0.000273281, gnorm=1.147, loss_scale=8192, train_wall=235, wall=0
2023-02-28 16:18:04 | INFO | train_inner | epoch 068:   1494 / 1978 loss=3.051, nll_loss=0.898, word_ins=2.725, length=3.258, ppl=8.29, wps=25158.9, ups=0.43, wpb=59157.4, bsz=1990.6, num_updates=134000, lr=0.000273179, gnorm=1.138, loss_scale=8192, train_wall=235, wall=0
2023-02-28 16:23:29 | INFO | train_inner | epoch 068:   1594 / 1978 loss=3.058, nll_loss=0.902, word_ins=2.728, length=3.302, ppl=8.33, wps=18400.8, ups=0.31, wpb=59834.3, bsz=2002.9, num_updates=134100, lr=0.000273077, gnorm=1.238, loss_scale=8192, train_wall=325, wall=0
2023-02-28 16:27:25 | INFO | train_inner | epoch 068:   1694 / 1978 loss=3.049, nll_loss=0.903, word_ins=2.729, length=3.204, ppl=8.28, wps=25325.3, ups=0.42, wpb=59844.1, bsz=2024, num_updates=134200, lr=0.000272976, gnorm=1.148, loss_scale=8192, train_wall=236, wall=0
2023-02-28 16:31:20 | INFO | train_inner | epoch 068:   1794 / 1978 loss=3.057, nll_loss=0.91, word_ins=2.736, length=3.211, ppl=8.32, wps=25277.2, ups=0.43, wpb=59294.4, bsz=2024.6, num_updates=134300, lr=0.000272874, gnorm=1.143, loss_scale=8192, train_wall=234, wall=0
2023-02-28 16:35:15 | INFO | train_inner | epoch 068:   1894 / 1978 loss=3.058, nll_loss=0.904, word_ins=2.73, length=3.281, ppl=8.33, wps=25227.4, ups=0.42, wpb=59381.3, bsz=2004.8, num_updates=134400, lr=0.000272772, gnorm=1.186, loss_scale=8192, train_wall=235, wall=0
2023-02-28 16:38:31 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 16:38:54 | INFO | valid | epoch 068 | valid on 'valid' subset | loss 4.075 | nll_loss 1.936 | word_ins 3.704 | length 3.704 | ppl 16.85 | wps 30593.3 | wpb 40242.5 | bsz 1500 | num_updates 134484 | best_loss 4.063
2023-02-28 16:38:54 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 16:39:01 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint68.pt (epoch 68 @ 134484 updates, score 4.075) (writing took 7.368879512883723 seconds)
2023-02-28 16:39:01 | INFO | fairseq_cli.train | end of epoch 68 (average epoch stats below)
2023-02-28 16:39:01 | INFO | train | epoch 068 | loss 3.059 | nll_loss 0.908 | word_ins 2.734 | length 3.251 | ppl 8.34 | wps 24477.3 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 134484 | lr 0.000272687 | gnorm 1.171 | loss_scale 8192 | train_wall 4744 | wall 0
2023-02-28 16:39:01 | INFO | fairseq.trainer | begin training epoch 69
2023-02-28 16:39:54 | INFO | train_inner | epoch 069:     16 / 1978 loss=3.086, nll_loss=0.93, word_ins=2.754, length=3.32, ppl=8.49, wps=21344.1, ups=0.36, wpb=59425.1, bsz=1880.1, num_updates=134500, lr=0.000272671, gnorm=1.243, loss_scale=8192, train_wall=233, wall=0
2023-02-28 16:41:52 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 16:43:52 | INFO | train_inner | epoch 069:    117 / 1978 loss=3.059, nll_loss=0.91, word_ins=2.737, length=3.22, ppl=8.33, wps=24800.3, ups=0.42, wpb=59166.3, bsz=1983.3, num_updates=134600, lr=0.00027257, gnorm=1.192, loss_scale=8192, train_wall=238, wall=0
2023-02-28 16:47:48 | INFO | train_inner | epoch 069:    217 / 1978 loss=3.056, nll_loss=0.904, word_ins=2.731, length=3.248, ppl=8.31, wps=25179.5, ups=0.42, wpb=59311, bsz=1954.6, num_updates=134700, lr=0.000272468, gnorm=1.164, loss_scale=8192, train_wall=235, wall=0
2023-02-28 16:51:44 | INFO | train_inner | epoch 069:    317 / 1978 loss=3.035, nll_loss=0.887, word_ins=2.715, length=3.202, ppl=8.2, wps=25330, ups=0.42, wpb=59818.2, bsz=2031.3, num_updates=134800, lr=0.000272367, gnorm=1.179, loss_scale=8192, train_wall=236, wall=0
2023-02-28 16:57:18 | INFO | train_inner | epoch 069:    417 / 1978 loss=3.045, nll_loss=0.893, word_ins=2.721, length=3.238, ppl=8.25, wps=17698.9, ups=0.3, wpb=59063.3, bsz=2012.6, num_updates=134900, lr=0.000272266, gnorm=1.187, loss_scale=8192, train_wall=333, wall=0
2023-02-28 17:01:13 | INFO | train_inner | epoch 069:    517 / 1978 loss=3.061, nll_loss=0.908, word_ins=2.734, length=3.27, ppl=8.34, wps=25065.2, ups=0.43, wpb=58952.9, bsz=1959.4, num_updates=135000, lr=0.000272166, gnorm=1.16, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:05:08 | INFO | train_inner | epoch 069:    617 / 1978 loss=3.061, nll_loss=0.912, word_ins=2.738, length=3.232, ppl=8.34, wps=25190, ups=0.42, wpb=59286.8, bsz=1956.8, num_updates=135100, lr=0.000272065, gnorm=1.173, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:09:05 | INFO | train_inner | epoch 069:    717 / 1978 loss=3.058, nll_loss=0.907, word_ins=2.734, length=3.241, ppl=8.33, wps=24909.9, ups=0.42, wpb=59025.5, bsz=2023, num_updates=135200, lr=0.000271964, gnorm=1.153, loss_scale=8192, train_wall=237, wall=0
2023-02-28 17:13:01 | INFO | train_inner | epoch 069:    817 / 1978 loss=3.047, nll_loss=0.895, word_ins=2.723, length=3.243, ppl=8.27, wps=25110, ups=0.42, wpb=59227.2, bsz=2037.8, num_updates=135300, lr=0.000271864, gnorm=1.189, loss_scale=8192, train_wall=236, wall=0
2023-02-28 17:16:56 | INFO | train_inner | epoch 069:    917 / 1978 loss=3.07, nll_loss=0.913, word_ins=2.739, length=3.31, ppl=8.4, wps=25220.3, ups=0.43, wpb=59116.5, bsz=1921, num_updates=135400, lr=0.000271763, gnorm=1.186, loss_scale=8192, train_wall=234, wall=0
2023-02-28 17:20:50 | INFO | train_inner | epoch 069:   1017 / 1978 loss=3.064, nll_loss=0.916, word_ins=2.741, length=3.227, ppl=8.36, wps=25385.1, ups=0.43, wpb=59619.8, bsz=1996.8, num_updates=135500, lr=0.000271663, gnorm=1.214, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:24:48 | INFO | train_inner | epoch 069:   1117 / 1978 loss=3.043, nll_loss=0.898, word_ins=2.724, length=3.184, ppl=8.24, wps=24961, ups=0.42, wpb=59187, bsz=2134.2, num_updates=135600, lr=0.000271563, gnorm=1.175, loss_scale=8192, train_wall=237, wall=0
2023-02-28 17:28:43 | INFO | train_inner | epoch 069:   1217 / 1978 loss=3.053, nll_loss=0.9, word_ins=2.727, length=3.262, ppl=8.3, wps=25128.1, ups=0.42, wpb=59170.3, bsz=2066.6, num_updates=135700, lr=0.000271463, gnorm=1.189, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:32:39 | INFO | train_inner | epoch 069:   1317 / 1978 loss=3.068, nll_loss=0.916, word_ins=2.741, length=3.267, ppl=8.38, wps=25183.1, ups=0.42, wpb=59325.2, bsz=2020.3, num_updates=135800, lr=0.000271363, gnorm=1.189, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:36:34 | INFO | train_inner | epoch 069:   1417 / 1978 loss=3.044, nll_loss=0.895, word_ins=2.723, length=3.213, ppl=8.25, wps=25056.4, ups=0.42, wpb=59030.8, bsz=2059.1, num_updates=135900, lr=0.000271263, gnorm=1.157, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:40:29 | INFO | train_inner | epoch 069:   1517 / 1978 loss=3.088, nll_loss=0.93, word_ins=2.754, length=3.34, ppl=8.5, wps=25432.3, ups=0.43, wpb=59747.9, bsz=1907.8, num_updates=136000, lr=0.000271163, gnorm=1.227, loss_scale=8192, train_wall=235, wall=0
2023-02-28 17:44:26 | INFO | train_inner | epoch 069:   1617 / 1978 loss=3.029, nll_loss=0.885, word_ins=2.712, length=3.171, ppl=8.16, wps=25178.3, ups=0.42, wpb=59562.2, bsz=2130.6, num_updates=136100, lr=0.000271063, gnorm=1.155, loss_scale=8192, train_wall=236, wall=0
2023-02-28 17:50:52 | INFO | train_inner | epoch 069:   1717 / 1978 loss=3.067, nll_loss=0.914, word_ins=2.739, length=3.28, ppl=8.38, wps=15335.1, ups=0.26, wpb=59207.1, bsz=1957.9, num_updates=136200, lr=0.000270964, gnorm=1.197, loss_scale=8192, train_wall=386, wall=0
2023-02-28 17:54:56 | INFO | train_inner | epoch 069:   1817 / 1978 loss=3.05, nll_loss=0.902, word_ins=2.729, length=3.219, ppl=8.28, wps=24168.1, ups=0.41, wpb=59066.8, bsz=2014.2, num_updates=136300, lr=0.000270864, gnorm=1.197, loss_scale=8192, train_wall=244, wall=0
2023-02-28 17:59:12 | INFO | train_inner | epoch 069:   1917 / 1978 loss=3.068, nll_loss=0.916, word_ins=2.741, length=3.271, ppl=8.38, wps=23201, ups=0.39, wpb=59322, bsz=1961.2, num_updates=136400, lr=0.000270765, gnorm=1.203, loss_scale=8192, train_wall=255, wall=0
2023-02-28 18:01:47 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 18:02:10 | INFO | valid | epoch 069 | valid on 'valid' subset | loss 4.12 | nll_loss 1.949 | word_ins 3.714 | length 4.061 | ppl 17.39 | wps 27556.7 | wpb 40242.5 | bsz 1500 | num_updates 136461 | best_loss 4.063
2023-02-28 18:02:10 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 18:02:20 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint69.pt (epoch 69 @ 136461 updates, score 4.12) (writing took 10.194708357565105 seconds)
2023-02-28 18:02:20 | INFO | fairseq_cli.train | end of epoch 69 (average epoch stats below)
2023-02-28 18:02:20 | INFO | train | epoch 069 | loss 3.057 | nll_loss 0.906 | word_ins 2.732 | length 3.245 | ppl 8.32 | wps 23446 | ups 0.4 | wpb 59283.4 | bsz 2002.8 | num_updates 136461 | lr 0.000270705 | gnorm 1.185 | loss_scale 8192 | train_wall 4945 | wall 0
2023-02-28 18:02:20 | INFO | fairseq.trainer | begin training epoch 70
2023-02-28 18:04:16 | INFO | train_inner | epoch 070:     39 / 1978 loss=3.074, nll_loss=0.922, word_ins=2.746, length=3.272, ppl=8.42, wps=19590.9, ups=0.33, wpb=59491, bsz=1884.7, num_updates=136500, lr=0.000270666, gnorm=1.208, loss_scale=8192, train_wall=254, wall=0
2023-02-28 18:08:34 | INFO | train_inner | epoch 070:    139 / 1978 loss=3.043, nll_loss=0.891, word_ins=2.718, length=3.243, ppl=8.24, wps=22948, ups=0.39, wpb=59255.5, bsz=1986.2, num_updates=136600, lr=0.000270567, gnorm=1.15, loss_scale=8192, train_wall=258, wall=0
2023-02-28 18:12:50 | INFO | train_inner | epoch 070:    239 / 1978 loss=3.072, nll_loss=0.915, word_ins=2.74, length=3.316, ppl=8.41, wps=23140.6, ups=0.39, wpb=59377.2, bsz=1922.7, num_updates=136700, lr=0.000270468, gnorm=1.196, loss_scale=8192, train_wall=256, wall=0
2023-02-28 18:17:08 | INFO | train_inner | epoch 070:    339 / 1978 loss=3.037, nll_loss=0.894, word_ins=2.721, length=3.16, ppl=8.21, wps=23173.4, ups=0.39, wpb=59756, bsz=2037.2, num_updates=136800, lr=0.000270369, gnorm=1.183, loss_scale=8192, train_wall=258, wall=0
2023-02-28 18:21:25 | INFO | train_inner | epoch 070:    439 / 1978 loss=3.067, nll_loss=0.912, word_ins=2.737, length=3.301, ppl=8.38, wps=23118.3, ups=0.39, wpb=59368.1, bsz=1972.3, num_updates=136900, lr=0.00027027, gnorm=1.208, loss_scale=8192, train_wall=256, wall=0
2023-02-28 18:25:40 | INFO | train_inner | epoch 070:    539 / 1978 loss=3.054, nll_loss=0.9, word_ins=2.727, length=3.272, ppl=8.31, wps=23294.6, ups=0.39, wpb=59347.8, bsz=2003, num_updates=137000, lr=0.000270172, gnorm=1.193, loss_scale=8192, train_wall=254, wall=0
2023-02-28 18:29:57 | INFO | train_inner | epoch 070:    639 / 1978 loss=3.046, nll_loss=0.896, word_ins=2.723, length=3.226, ppl=8.26, wps=22939.1, ups=0.39, wpb=58898.2, bsz=1977.7, num_updates=137100, lr=0.000270073, gnorm=1.186, loss_scale=8192, train_wall=256, wall=0
2023-02-28 18:34:14 | INFO | train_inner | epoch 070:    739 / 1978 loss=3.053, nll_loss=0.905, word_ins=2.731, length=3.221, ppl=8.3, wps=23003.3, ups=0.39, wpb=59190.9, bsz=1991.8, num_updates=137200, lr=0.000269975, gnorm=1.18, loss_scale=8192, train_wall=257, wall=0
2023-02-28 18:38:31 | INFO | train_inner | epoch 070:    839 / 1978 loss=3.049, nll_loss=0.904, word_ins=2.731, length=3.184, ppl=8.28, wps=22978.4, ups=0.39, wpb=59092.3, bsz=1976.4, num_updates=137300, lr=0.000269876, gnorm=1.172, loss_scale=8192, train_wall=257, wall=0
2023-02-28 18:42:48 | INFO | train_inner | epoch 070:    939 / 1978 loss=3.064, nll_loss=0.91, word_ins=2.735, length=3.286, ppl=8.36, wps=23099.5, ups=0.39, wpb=59448.1, bsz=1995.8, num_updates=137400, lr=0.000269778, gnorm=1.204, loss_scale=8192, train_wall=257, wall=0
2023-02-28 18:47:05 | INFO | train_inner | epoch 070:   1039 / 1978 loss=3.067, nll_loss=0.913, word_ins=2.738, length=3.293, ppl=8.38, wps=23092.1, ups=0.39, wpb=59145.2, bsz=1993.8, num_updates=137500, lr=0.00026968, gnorm=1.203, loss_scale=8192, train_wall=256, wall=0
2023-02-28 18:51:14 | INFO | train_inner | epoch 070:   1139 / 1978 loss=3.042, nll_loss=0.892, word_ins=2.719, length=3.233, ppl=8.24, wps=23847.5, ups=0.4, wpb=59545.5, bsz=2009.5, num_updates=137600, lr=0.000269582, gnorm=1.158, loss_scale=8192, train_wall=249, wall=0
2023-02-28 18:55:09 | INFO | train_inner | epoch 070:   1239 / 1978 loss=3.039, nll_loss=0.894, word_ins=2.721, length=3.178, ppl=8.22, wps=25107.1, ups=0.43, wpb=58989.5, bsz=2119.1, num_updates=137700, lr=0.000269484, gnorm=1.162, loss_scale=8192, train_wall=235, wall=0
2023-02-28 18:59:02 | INFO | train_inner | epoch 070:   1339 / 1978 loss=3.074, nll_loss=0.922, word_ins=2.747, length=3.278, ppl=8.42, wps=25361.7, ups=0.43, wpb=59133.5, bsz=1981.9, num_updates=137800, lr=0.000269386, gnorm=1.21, loss_scale=8192, train_wall=233, wall=0
2023-02-28 19:02:57 | INFO | train_inner | epoch 070:   1439 / 1978 loss=3.03, nll_loss=0.883, word_ins=2.711, length=3.193, ppl=8.17, wps=25209.8, ups=0.43, wpb=59176.6, bsz=2076.2, num_updates=137900, lr=0.000269289, gnorm=1.181, loss_scale=8192, train_wall=235, wall=0
2023-02-28 19:06:52 | INFO | train_inner | epoch 070:   1539 / 1978 loss=3.045, nll_loss=0.897, word_ins=2.724, length=3.215, ppl=8.25, wps=25370.7, ups=0.43, wpb=59637.5, bsz=2081.5, num_updates=138000, lr=0.000269191, gnorm=1.192, loss_scale=8192, train_wall=235, wall=0
2023-02-28 19:11:28 | INFO | train_inner | epoch 070:   1639 / 1978 loss=3.063, nll_loss=0.906, word_ins=2.732, length=3.313, ppl=8.36, wps=21400.9, ups=0.36, wpb=58971.6, bsz=2001.8, num_updates=138100, lr=0.000269093, gnorm=1.193, loss_scale=8192, train_wall=275, wall=0
2023-02-28 19:15:25 | INFO | train_inner | epoch 070:   1739 / 1978 loss=3.082, nll_loss=0.925, word_ins=2.749, length=3.326, ppl=8.47, wps=24891.9, ups=0.42, wpb=59018.5, bsz=1992.8, num_updates=138200, lr=0.000268996, gnorm=1.246, loss_scale=8192, train_wall=237, wall=0
2023-02-28 19:19:19 | INFO | train_inner | epoch 070:   1839 / 1978 loss=3.051, nll_loss=0.897, word_ins=2.724, length=3.277, ppl=8.29, wps=25413.4, ups=0.43, wpb=59427.8, bsz=1965.8, num_updates=138300, lr=0.000268899, gnorm=1.242, loss_scale=8192, train_wall=234, wall=0
2023-02-28 19:23:12 | INFO | train_inner | epoch 070:   1939 / 1978 loss=3.041, nll_loss=0.898, word_ins=2.725, length=3.166, ppl=8.23, wps=25444.8, ups=0.43, wpb=59442.8, bsz=2003.1, num_updates=138400, lr=0.000268802, gnorm=1.226, loss_scale=8192, train_wall=233, wall=0
2023-02-28 19:24:43 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 19:25:04 | INFO | valid | epoch 070 | valid on 'valid' subset | loss 4.109 | nll_loss 1.948 | word_ins 3.712 | length 3.968 | ppl 17.26 | wps 30640.2 | wpb 40242.5 | bsz 1500 | num_updates 138439 | best_loss 4.063
2023-02-28 19:25:04 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 19:25:10 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint70.pt (epoch 70 @ 138439 updates, score 4.109) (writing took 5.861168653704226 seconds)
2023-02-28 19:25:10 | INFO | fairseq_cli.train | end of epoch 70 (average epoch stats below)
2023-02-28 19:25:10 | INFO | train | epoch 070 | loss 3.053 | nll_loss 0.903 | word_ins 2.729 | length 3.246 | ppl 8.3 | wps 23593.9 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 138439 | lr 0.000268764 | gnorm 1.194 | loss_scale 8192 | train_wall 4921 | wall 0
2023-02-28 19:25:10 | INFO | fairseq.trainer | begin training epoch 71
2023-02-28 19:27:45 | INFO | train_inner | epoch 071:     61 / 1978 loss=3.03, nll_loss=0.883, word_ins=2.711, length=3.188, ppl=8.17, wps=21833.9, ups=0.37, wpb=59468.5, bsz=2052.6, num_updates=138500, lr=0.000268705, gnorm=1.172, loss_scale=8192, train_wall=233, wall=0
2023-02-28 19:31:37 | INFO | train_inner | epoch 071:    161 / 1978 loss=3.048, nll_loss=0.897, word_ins=2.724, length=3.239, ppl=8.27, wps=25528.3, ups=0.43, wpb=59282.8, bsz=1945.8, num_updates=138600, lr=0.000268608, gnorm=1.155, loss_scale=8192, train_wall=232, wall=0
2023-02-28 19:34:18 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 19:35:32 | INFO | train_inner | epoch 071:    262 / 1978 loss=3.017, nll_loss=0.87, word_ins=2.699, length=3.174, ppl=8.09, wps=25281.3, ups=0.42, wpb=59537.9, bsz=2063.8, num_updates=138700, lr=0.000268511, gnorm=1.166, loss_scale=8192, train_wall=235, wall=0
2023-02-28 19:39:24 | INFO | train_inner | epoch 071:    362 / 1978 loss=3.051, nll_loss=0.902, word_ins=2.729, length=3.216, ppl=8.29, wps=25581.9, ups=0.43, wpb=59320.5, bsz=1988.6, num_updates=138800, lr=0.000268414, gnorm=1.239, loss_scale=8192, train_wall=232, wall=0
2023-02-28 19:43:17 | INFO | train_inner | epoch 071:    462 / 1978 loss=3.064, nll_loss=0.91, word_ins=2.736, length=3.278, ppl=8.36, wps=25488.7, ups=0.43, wpb=59364.5, bsz=1936.6, num_updates=138900, lr=0.000268317, gnorm=1.216, loss_scale=8192, train_wall=233, wall=0
2023-02-28 19:47:11 | INFO | train_inner | epoch 071:    562 / 1978 loss=3.034, nll_loss=0.884, word_ins=2.712, length=3.217, ppl=8.19, wps=25490.8, ups=0.43, wpb=59629.1, bsz=2030.4, num_updates=139000, lr=0.000268221, gnorm=1.197, loss_scale=8192, train_wall=234, wall=0
2023-02-28 19:51:06 | INFO | train_inner | epoch 071:    662 / 1978 loss=3.026, nll_loss=0.88, word_ins=2.708, length=3.183, ppl=8.15, wps=25365.6, ups=0.43, wpb=59499.4, bsz=2067.2, num_updates=139100, lr=0.000268124, gnorm=1.176, loss_scale=8192, train_wall=234, wall=0
2023-02-28 19:55:00 | INFO | train_inner | epoch 071:    762 / 1978 loss=3.04, nll_loss=0.888, word_ins=2.715, length=3.251, ppl=8.23, wps=25532.1, ups=0.43, wpb=59808, bsz=2059.4, num_updates=139200, lr=0.000268028, gnorm=1.207, loss_scale=8192, train_wall=234, wall=0
2023-02-28 19:59:13 | INFO | train_inner | epoch 071:    862 / 1978 loss=3.054, nll_loss=0.907, word_ins=2.733, length=3.215, ppl=8.31, wps=23282.4, ups=0.4, wpb=58916.5, bsz=2067.9, num_updates=139300, lr=0.000267932, gnorm=1.216, loss_scale=8192, train_wall=253, wall=0
2023-02-28 20:03:31 | INFO | train_inner | epoch 071:    962 / 1978 loss=3.041, nll_loss=0.897, word_ins=2.723, length=3.18, ppl=8.23, wps=22936.5, ups=0.39, wpb=59132.6, bsz=2047.8, num_updates=139400, lr=0.000267836, gnorm=1.173, loss_scale=8192, train_wall=258, wall=0
2023-02-28 20:07:28 | INFO | train_inner | epoch 071:   1062 / 1978 loss=3.059, nll_loss=0.904, word_ins=2.73, length=3.292, ppl=8.34, wps=24724.8, ups=0.42, wpb=58669.5, bsz=2017.6, num_updates=139500, lr=0.00026774, gnorm=1.153, loss_scale=8192, train_wall=237, wall=0
2023-02-28 20:11:24 | INFO | train_inner | epoch 071:   1162 / 1978 loss=3.062, nll_loss=0.909, word_ins=2.735, length=3.267, ppl=8.35, wps=24913.1, ups=0.42, wpb=58759.4, bsz=1990.5, num_updates=139600, lr=0.000267644, gnorm=1.222, loss_scale=8192, train_wall=236, wall=0
2023-02-28 20:15:16 | INFO | train_inner | epoch 071:   1262 / 1978 loss=3.08, nll_loss=0.922, word_ins=2.747, length=3.335, ppl=8.46, wps=25357, ups=0.43, wpb=58731.6, bsz=1895.4, num_updates=139700, lr=0.000267548, gnorm=1.193, loss_scale=8192, train_wall=231, wall=0
2023-02-28 20:19:09 | INFO | train_inner | epoch 071:   1362 / 1978 loss=3.053, nll_loss=0.902, word_ins=2.728, length=3.246, ppl=8.3, wps=25493.3, ups=0.43, wpb=59397.7, bsz=1991.8, num_updates=139800, lr=0.000267452, gnorm=1.232, loss_scale=8192, train_wall=233, wall=0
2023-02-28 20:23:03 | INFO | train_inner | epoch 071:   1462 / 1978 loss=3.024, nll_loss=0.876, word_ins=2.704, length=3.203, ppl=8.14, wps=25376, ups=0.43, wpb=59503.6, bsz=2092.5, num_updates=139900, lr=0.000267357, gnorm=1.137, loss_scale=8192, train_wall=234, wall=0
2023-02-28 20:26:59 | INFO | train_inner | epoch 071:   1562 / 1978 loss=3.039, nll_loss=0.891, word_ins=2.718, length=3.209, ppl=8.22, wps=25351.3, ups=0.42, wpb=59681.5, bsz=2025.5, num_updates=140000, lr=0.000267261, gnorm=1.208, loss_scale=8192, train_wall=235, wall=0
2023-02-28 20:31:29 | INFO | train_inner | epoch 071:   1662 / 1978 loss=3.055, nll_loss=0.901, word_ins=2.727, length=3.285, ppl=8.31, wps=21973.7, ups=0.37, wpb=59324.4, bsz=1984.5, num_updates=140100, lr=0.000267166, gnorm=1.18, loss_scale=8192, train_wall=270, wall=0
2023-02-28 20:35:25 | INFO | train_inner | epoch 071:   1762 / 1978 loss=3.075, nll_loss=0.922, word_ins=2.746, length=3.283, ppl=8.43, wps=25014.5, ups=0.42, wpb=59047.8, bsz=1906.1, num_updates=140200, lr=0.000267071, gnorm=1.188, loss_scale=8192, train_wall=236, wall=0
2023-02-28 20:39:21 | INFO | train_inner | epoch 071:   1862 / 1978 loss=3.078, nll_loss=0.923, word_ins=2.747, length=3.31, ppl=8.45, wps=24878, ups=0.42, wpb=58839.9, bsz=1957.4, num_updates=140300, lr=0.000266975, gnorm=1.191, loss_scale=8192, train_wall=236, wall=0
2023-02-28 20:43:23 | INFO | train_inner | epoch 071:   1962 / 1978 loss=3.074, nll_loss=0.922, word_ins=2.746, length=3.273, ppl=8.42, wps=24783.2, ups=0.41, wpb=59980.5, bsz=1979.3, num_updates=140400, lr=0.00026688, gnorm=1.251, loss_scale=8192, train_wall=242, wall=0
2023-02-28 20:44:03 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 20:44:23 | INFO | valid | epoch 071 | valid on 'valid' subset | loss 4.107 | nll_loss 1.95 | word_ins 3.719 | length 3.876 | ppl 17.23 | wps 29251.4 | wpb 40242.5 | bsz 1500 | num_updates 140416 | best_loss 4.063
2023-02-28 20:44:23 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 20:44:29 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint71.pt (epoch 71 @ 140416 updates, score 4.107) (writing took 5.618821288459003 seconds)
2023-02-28 20:44:29 | INFO | fairseq_cli.train | end of epoch 71 (average epoch stats below)
2023-02-28 20:44:29 | INFO | train | epoch 071 | loss 3.051 | nll_loss 0.9 | word_ins 2.727 | length 3.245 | ppl 8.29 | wps 24631.6 | ups 0.42 | wpb 59283.4 | bsz 2002.7 | num_updates 140416 | lr 0.000266865 | gnorm 1.195 | loss_scale 8192 | train_wall 4715 | wall 0
2023-02-28 20:44:29 | INFO | fairseq.trainer | begin training epoch 72
2023-02-28 20:47:55 | INFO | train_inner | epoch 072:     84 / 1978 loss=3.065, nll_loss=0.911, word_ins=2.737, length=3.273, ppl=8.37, wps=21907.2, ups=0.37, wpb=59504.7, bsz=1945.7, num_updates=140500, lr=0.000266785, gnorm=1.211, loss_scale=8192, train_wall=236, wall=0
2023-02-28 20:51:47 | INFO | train_inner | epoch 072:    184 / 1978 loss=3.061, nll_loss=0.912, word_ins=2.737, length=3.234, ppl=8.34, wps=25252.7, ups=0.43, wpb=58573.6, bsz=1917.8, num_updates=140600, lr=0.00026669, gnorm=1.189, loss_scale=8192, train_wall=232, wall=0
2023-02-28 20:55:42 | INFO | train_inner | epoch 072:    284 / 1978 loss=3.016, nll_loss=0.868, word_ins=2.698, length=3.186, ppl=8.09, wps=25267.4, ups=0.43, wpb=59347.6, bsz=2100.4, num_updates=140700, lr=0.000266596, gnorm=1.203, loss_scale=8192, train_wall=235, wall=0
2023-02-28 20:59:35 | INFO | train_inner | epoch 072:    384 / 1978 loss=3.042, nll_loss=0.893, word_ins=2.72, length=3.228, ppl=8.24, wps=25349.8, ups=0.43, wpb=59281.6, bsz=2016.3, num_updates=140800, lr=0.000266501, gnorm=1.187, loss_scale=8192, train_wall=234, wall=0
2023-02-28 21:03:51 | INFO | train_inner | epoch 072:    484 / 1978 loss=3.057, nll_loss=0.902, word_ins=2.728, length=3.288, ppl=8.32, wps=23223.2, ups=0.39, wpb=59415.3, bsz=1897.9, num_updates=140900, lr=0.000266406, gnorm=1.208, loss_scale=8192, train_wall=256, wall=0
2023-02-28 21:07:54 | INFO | train_inner | epoch 072:    584 / 1978 loss=3.035, nll_loss=0.888, word_ins=2.715, length=3.201, ppl=8.2, wps=24563.5, ups=0.41, wpb=59738.8, bsz=1994.2, num_updates=141000, lr=0.000266312, gnorm=1.21, loss_scale=8192, train_wall=243, wall=0
2023-02-28 21:11:50 | INFO | train_inner | epoch 072:    684 / 1978 loss=3.052, nll_loss=0.903, word_ins=2.729, length=3.226, ppl=8.29, wps=25249, ups=0.42, wpb=59510, bsz=1989.8, num_updates=141100, lr=0.000266217, gnorm=1.23, loss_scale=8192, train_wall=235, wall=0
2023-02-28 21:15:44 | INFO | train_inner | epoch 072:    784 / 1978 loss=3.065, nll_loss=0.916, word_ins=2.74, length=3.242, ppl=8.37, wps=25234.3, ups=0.43, wpb=59109.4, bsz=1983.3, num_updates=141200, lr=0.000266123, gnorm=1.202, loss_scale=8192, train_wall=234, wall=0
2023-02-28 21:19:40 | INFO | train_inner | epoch 072:    884 / 1978 loss=3.038, nll_loss=0.887, word_ins=2.714, length=3.239, ppl=8.21, wps=25127.7, ups=0.42, wpb=59215.5, bsz=2035.9, num_updates=141300, lr=0.000266029, gnorm=1.186, loss_scale=8192, train_wall=235, wall=0
2023-02-28 21:23:34 | INFO | train_inner | epoch 072:    984 / 1978 loss=3.044, nll_loss=0.892, word_ins=2.719, length=3.256, ppl=8.25, wps=25258.1, ups=0.43, wpb=59088, bsz=2065.8, num_updates=141400, lr=0.000265935, gnorm=1.157, loss_scale=8192, train_wall=234, wall=0
2023-02-28 21:27:26 | INFO | train_inner | epoch 072:   1084 / 1978 loss=3.06, nll_loss=0.909, word_ins=2.735, length=3.242, ppl=8.34, wps=25490.2, ups=0.43, wpb=59217.8, bsz=1944.2, num_updates=141500, lr=0.000265841, gnorm=1.238, loss_scale=8192, train_wall=232, wall=0
2023-02-28 21:31:20 | INFO | train_inner | epoch 072:   1184 / 1978 loss=3.068, nll_loss=0.913, word_ins=2.738, length=3.3, ppl=8.39, wps=25209, ups=0.43, wpb=58786.2, bsz=1978.2, num_updates=141600, lr=0.000265747, gnorm=1.218, loss_scale=8192, train_wall=233, wall=0
2023-02-28 21:35:14 | INFO | train_inner | epoch 072:   1284 / 1978 loss=3.041, nll_loss=0.893, word_ins=2.72, length=3.209, ppl=8.23, wps=25316.2, ups=0.43, wpb=59399.3, bsz=2083.9, num_updates=141700, lr=0.000265653, gnorm=1.191, loss_scale=8192, train_wall=234, wall=0
2023-02-28 21:39:10 | INFO | train_inner | epoch 072:   1384 / 1978 loss=3.03, nll_loss=0.879, word_ins=2.706, length=3.239, ppl=8.17, wps=25213.5, ups=0.42, wpb=59516.5, bsz=2073.3, num_updates=141800, lr=0.00026556, gnorm=1.2, loss_scale=8192, train_wall=236, wall=0
2023-02-28 21:43:11 | INFO | train_inner | epoch 072:   1484 / 1978 loss=3.077, nll_loss=0.926, word_ins=2.75, length=3.269, ppl=8.44, wps=24574.7, ups=0.42, wpb=59153.2, bsz=1948.4, num_updates=141900, lr=0.000265466, gnorm=1.227, loss_scale=8192, train_wall=240, wall=0
2023-02-28 21:47:19 | INFO | train_inner | epoch 072:   1584 / 1978 loss=3.053, nll_loss=0.898, word_ins=2.724, length=3.291, ppl=8.3, wps=23836.8, ups=0.4, wpb=59035.5, bsz=1993.1, num_updates=142000, lr=0.000265372, gnorm=1.175, loss_scale=8192, train_wall=247, wall=0
2023-02-28 21:51:26 | INFO | train_inner | epoch 072:   1684 / 1978 loss=3.05, nll_loss=0.904, word_ins=2.73, length=3.201, ppl=8.28, wps=24142.7, ups=0.4, wpb=59673.6, bsz=1977.2, num_updates=142100, lr=0.000265279, gnorm=1.231, loss_scale=8192, train_wall=247, wall=0
2023-02-28 21:55:28 | INFO | train_inner | epoch 072:   1784 / 1978 loss=3.043, nll_loss=0.891, word_ins=2.718, length=3.247, ppl=8.24, wps=24560.1, ups=0.41, wpb=59377.2, bsz=2039, num_updates=142200, lr=0.000265186, gnorm=1.194, loss_scale=8192, train_wall=242, wall=0
2023-02-28 21:59:36 | INFO | train_inner | epoch 072:   1884 / 1978 loss=3.054, nll_loss=0.902, word_ins=2.728, length=3.256, ppl=8.3, wps=23824.3, ups=0.4, wpb=59170.4, bsz=1994.2, num_updates=142300, lr=0.000265093, gnorm=1.193, loss_scale=8192, train_wall=248, wall=0
2023-02-28 22:03:34 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 22:03:55 | INFO | valid | epoch 072 | valid on 'valid' subset | loss 4.083 | nll_loss 1.934 | word_ins 3.7 | length 3.826 | ppl 16.94 | wps 17924.5 | wpb 40242.5 | bsz 1500 | num_updates 142394 | best_loss 4.063
2023-02-28 22:03:55 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 22:04:02 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint72.pt (epoch 72 @ 142394 updates, score 4.083) (writing took 7.205809484235942 seconds)
2023-02-28 22:04:02 | INFO | fairseq_cli.train | end of epoch 72 (average epoch stats below)
2023-02-28 22:04:02 | INFO | train | epoch 072 | loss 3.048 | nll_loss 0.898 | word_ins 2.724 | length 3.239 | ppl 8.27 | wps 24566.9 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 142394 | lr 0.000265005 | gnorm 1.203 | loss_scale 8192 | train_wall 4730 | wall 0
2023-02-28 22:04:02 | INFO | fairseq.trainer | begin training epoch 73
2023-02-28 22:04:27 | INFO | train_inner | epoch 073:      6 / 1978 loss=3.029, nll_loss=0.883, word_ins=2.71, length=3.185, ppl=8.16, wps=20428.6, ups=0.34, wpb=59448.8, bsz=2045.3, num_updates=142400, lr=0.000264999, gnorm=1.24, loss_scale=8192, train_wall=252, wall=0
2023-02-28 22:08:39 | INFO | train_inner | epoch 073:    106 / 1978 loss=3.035, nll_loss=0.883, word_ins=2.712, length=3.234, ppl=8.2, wps=23587.3, ups=0.4, wpb=59410.5, bsz=2011.7, num_updates=142500, lr=0.000264906, gnorm=1.211, loss_scale=8192, train_wall=252, wall=0
2023-02-28 22:12:46 | INFO | train_inner | epoch 073:    206 / 1978 loss=3.027, nll_loss=0.881, word_ins=2.709, length=3.178, ppl=8.15, wps=23895.3, ups=0.4, wpb=59018.5, bsz=2073.3, num_updates=142600, lr=0.000264814, gnorm=1.153, loss_scale=8192, train_wall=247, wall=0
2023-02-28 22:16:59 | INFO | train_inner | epoch 073:    306 / 1978 loss=3.065, nll_loss=0.912, word_ins=2.737, length=3.275, ppl=8.37, wps=23355.1, ups=0.39, wpb=59222.5, bsz=1924.5, num_updates=142700, lr=0.000264721, gnorm=1.199, loss_scale=8192, train_wall=253, wall=0
2023-02-28 22:19:53 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-02-28 22:21:17 | INFO | train_inner | epoch 073:    407 / 1978 loss=3.065, nll_loss=0.913, word_ins=2.738, length=3.265, ppl=8.37, wps=22895.2, ups=0.39, wpb=58868, bsz=1915.2, num_updates=142800, lr=0.000264628, gnorm=1.211, loss_scale=8192, train_wall=257, wall=0
2023-02-28 22:25:30 | INFO | train_inner | epoch 073:    507 / 1978 loss=3.04, nll_loss=0.891, word_ins=2.718, length=3.215, ppl=8.22, wps=23283.4, ups=0.4, wpb=58895.1, bsz=1974.9, num_updates=142900, lr=0.000264535, gnorm=1.196, loss_scale=8192, train_wall=253, wall=0
2023-02-28 22:29:33 | INFO | train_inner | epoch 073:    607 / 1978 loss=3.055, nll_loss=0.905, word_ins=2.731, length=3.242, ppl=8.31, wps=24429.2, ups=0.41, wpb=59431.2, bsz=1982.7, num_updates=143000, lr=0.000264443, gnorm=1.187, loss_scale=8192, train_wall=243, wall=0
2023-02-28 22:33:41 | INFO | train_inner | epoch 073:    707 / 1978 loss=3.017, nll_loss=0.872, word_ins=2.7, length=3.163, ppl=8.09, wps=24253.6, ups=0.4, wpb=60073.5, bsz=2026.1, num_updates=143100, lr=0.000264351, gnorm=1.174, loss_scale=8192, train_wall=247, wall=0
2023-02-28 22:37:41 | INFO | train_inner | epoch 073:    807 / 1978 loss=3.043, nll_loss=0.892, word_ins=2.72, length=3.231, ppl=8.24, wps=24887.5, ups=0.42, wpb=59935.3, bsz=1991.5, num_updates=143200, lr=0.000264258, gnorm=1.247, loss_scale=8192, train_wall=241, wall=0
2023-02-28 22:41:48 | INFO | train_inner | epoch 073:    907 / 1978 loss=3.047, nll_loss=0.895, word_ins=2.722, length=3.243, ppl=8.26, wps=24142.1, ups=0.41, wpb=59451.1, bsz=2012.8, num_updates=143300, lr=0.000264166, gnorm=1.223, loss_scale=8192, train_wall=246, wall=0
2023-02-28 22:45:54 | INFO | train_inner | epoch 073:   1007 / 1978 loss=3.014, nll_loss=0.868, word_ins=2.697, length=3.168, ppl=8.08, wps=24146.6, ups=0.41, wpb=59499.1, bsz=2120.5, num_updates=143400, lr=0.000264074, gnorm=1.202, loss_scale=8192, train_wall=246, wall=0
2023-02-28 22:49:48 | INFO | train_inner | epoch 073:   1107 / 1978 loss=3.036, nll_loss=0.893, word_ins=2.72, length=3.156, ppl=8.2, wps=25285.9, ups=0.43, wpb=59182, bsz=2102.6, num_updates=143500, lr=0.000263982, gnorm=1.228, loss_scale=8192, train_wall=234, wall=0
2023-02-28 22:53:40 | INFO | train_inner | epoch 073:   1207 / 1978 loss=3.094, nll_loss=0.935, word_ins=2.759, length=3.355, ppl=8.54, wps=25113.9, ups=0.43, wpb=58161.7, bsz=1849.1, num_updates=143600, lr=0.00026389, gnorm=1.203, loss_scale=8192, train_wall=231, wall=0
2023-02-28 22:57:31 | INFO | train_inner | epoch 073:   1307 / 1978 loss=3.068, nll_loss=0.909, word_ins=2.734, length=3.338, ppl=8.39, wps=25666.4, ups=0.43, wpb=59372.3, bsz=1873, num_updates=143700, lr=0.000263798, gnorm=1.266, loss_scale=8192, train_wall=231, wall=0
2023-02-28 23:01:24 | INFO | train_inner | epoch 073:   1407 / 1978 loss=3.044, nll_loss=0.892, word_ins=2.719, length=3.249, ppl=8.25, wps=25338.4, ups=0.43, wpb=58972.4, bsz=2026.8, num_updates=143800, lr=0.000263706, gnorm=1.201, loss_scale=8192, train_wall=233, wall=0
2023-02-28 23:05:17 | INFO | train_inner | epoch 073:   1507 / 1978 loss=3.054, nll_loss=0.904, word_ins=2.729, length=3.242, ppl=8.3, wps=25356.6, ups=0.43, wpb=59088.1, bsz=1951, num_updates=143900, lr=0.000263615, gnorm=1.214, loss_scale=8192, train_wall=233, wall=0
2023-02-28 23:09:10 | INFO | train_inner | epoch 073:   1607 / 1978 loss=3.028, nll_loss=0.878, word_ins=2.706, length=3.221, ppl=8.16, wps=25589.4, ups=0.43, wpb=59674, bsz=2023.6, num_updates=144000, lr=0.000263523, gnorm=1.213, loss_scale=8192, train_wall=233, wall=0
2023-02-28 23:13:05 | INFO | train_inner | epoch 073:   1707 / 1978 loss=3.047, nll_loss=0.892, word_ins=2.719, length=3.279, ppl=8.26, wps=25126.4, ups=0.43, wpb=59075.2, bsz=2094.4, num_updates=144100, lr=0.000263432, gnorm=1.213, loss_scale=8192, train_wall=235, wall=0
2023-02-28 23:17:01 | INFO | train_inner | epoch 073:   1807 / 1978 loss=3.024, nll_loss=0.878, word_ins=2.705, length=3.186, ppl=8.13, wps=25374.7, ups=0.42, wpb=59755.7, bsz=2117, num_updates=144200, lr=0.00026334, gnorm=1.21, loss_scale=8192, train_wall=235, wall=0
2023-02-28 23:20:52 | INFO | train_inner | epoch 073:   1907 / 1978 loss=3.052, nll_loss=0.901, word_ins=2.727, length=3.257, ppl=8.3, wps=25548.6, ups=0.43, wpb=59221.1, bsz=1962, num_updates=144300, lr=0.000263249, gnorm=1.227, loss_scale=8192, train_wall=232, wall=0
2023-02-28 23:23:38 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-02-28 23:23:56 | INFO | valid | epoch 073 | valid on 'valid' subset | loss 4.09 | nll_loss 1.939 | word_ins 3.7 | length 3.897 | ppl 17.03 | wps 30737.1 | wpb 40242.5 | bsz 1500 | num_updates 144371 | best_loss 4.063
2023-02-28 23:23:56 | INFO | fairseq_cli.train | begin save checkpoint
2023-02-28 23:24:02 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint73.pt (epoch 73 @ 144371 updates, score 4.09) (writing took 5.882883718237281 seconds)
2023-02-28 23:24:02 | INFO | fairseq_cli.train | end of epoch 73 (average epoch stats below)
2023-02-28 23:24:02 | INFO | train | epoch 073 | loss 3.045 | nll_loss 0.895 | word_ins 2.721 | length 3.237 | ppl 8.25 | wps 24415 | ups 0.41 | wpb 59283.9 | bsz 2002.5 | num_updates 144371 | lr 0.000263184 | gnorm 1.209 | loss_scale 8192 | train_wall 4760 | wall 0
2023-02-28 23:24:02 | INFO | fairseq.trainer | begin training epoch 74
2023-02-28 23:25:18 | INFO | train_inner | epoch 074:     29 / 1978 loss=3.047, nll_loss=0.897, word_ins=2.724, length=3.237, ppl=8.27, wps=22224.5, ups=0.38, wpb=59104, bsz=1997, num_updates=144400, lr=0.000263158, gnorm=1.188, loss_scale=8192, train_wall=231, wall=0
2023-02-28 23:29:11 | INFO | train_inner | epoch 074:    129 / 1978 loss=3.061, nll_loss=0.906, word_ins=2.732, length=3.292, ppl=8.34, wps=25430.1, ups=0.43, wpb=59106.5, bsz=1980.6, num_updates=144500, lr=0.000263067, gnorm=1.263, loss_scale=8192, train_wall=232, wall=0
2023-02-28 23:33:03 | INFO | train_inner | epoch 074:    229 / 1978 loss=3.057, nll_loss=0.904, word_ins=2.731, length=3.265, ppl=8.32, wps=25411.7, ups=0.43, wpb=58890.2, bsz=1956.2, num_updates=144600, lr=0.000262976, gnorm=1.203, loss_scale=8192, train_wall=232, wall=0
2023-02-28 23:36:55 | INFO | train_inner | epoch 074:    329 / 1978 loss=3.01, nll_loss=0.864, word_ins=2.693, length=3.172, ppl=8.06, wps=25647.5, ups=0.43, wpb=59723.3, bsz=2052.9, num_updates=144700, lr=0.000262885, gnorm=1.167, loss_scale=8192, train_wall=233, wall=0
2023-02-28 23:40:50 | INFO | train_inner | epoch 074:    429 / 1978 loss=3.042, nll_loss=0.889, word_ins=2.716, length=3.259, ppl=8.24, wps=25333.8, ups=0.43, wpb=59455, bsz=1977.1, num_updates=144800, lr=0.000262794, gnorm=1.221, loss_scale=8192, train_wall=234, wall=0
2023-02-28 23:44:47 | INFO | train_inner | epoch 074:    529 / 1978 loss=3.038, nll_loss=0.885, word_ins=2.712, length=3.261, ppl=8.21, wps=25381.1, ups=0.42, wpb=60032.6, bsz=1933.5, num_updates=144900, lr=0.000262703, gnorm=1.208, loss_scale=8192, train_wall=236, wall=0
2023-02-28 23:49:11 | INFO | train_inner | epoch 074:    629 / 1978 loss=3.045, nll_loss=0.896, word_ins=2.723, length=3.221, ppl=8.25, wps=22313.6, ups=0.38, wpb=58980, bsz=2047.1, num_updates=145000, lr=0.000262613, gnorm=1.228, loss_scale=8192, train_wall=264, wall=0
2023-02-28 23:53:04 | INFO | train_inner | epoch 074:    729 / 1978 loss=3.049, nll_loss=0.899, word_ins=2.725, length=3.244, ppl=8.28, wps=25592.5, ups=0.43, wpb=59560.4, bsz=1987.5, num_updates=145100, lr=0.000262522, gnorm=1.249, loss_scale=8192, train_wall=232, wall=0
2023-02-28 23:56:56 | INFO | train_inner | epoch 074:    829 / 1978 loss=3.037, nll_loss=0.888, word_ins=2.715, length=3.224, ppl=8.21, wps=25678.8, ups=0.43, wpb=59529.2, bsz=1982.1, num_updates=145200, lr=0.000262432, gnorm=1.26, loss_scale=8192, train_wall=232, wall=0
2023-03-01 00:00:50 | INFO | train_inner | epoch 074:    929 / 1978 loss=3.029, nll_loss=0.882, word_ins=2.71, length=3.197, ppl=8.16, wps=25412.1, ups=0.43, wpb=59455.8, bsz=2039.8, num_updates=145300, lr=0.000262342, gnorm=1.191, loss_scale=8192, train_wall=234, wall=0
2023-03-01 00:04:42 | INFO | train_inner | epoch 074:   1029 / 1978 loss=3.04, nll_loss=0.888, word_ins=2.715, length=3.25, ppl=8.23, wps=25581, ups=0.43, wpb=59404.5, bsz=1999.4, num_updates=145400, lr=0.000262251, gnorm=1.25, loss_scale=8192, train_wall=232, wall=0
2023-03-01 00:08:59 | INFO | train_inner | epoch 074:   1129 / 1978 loss=3.054, nll_loss=0.902, word_ins=2.728, length=3.255, ppl=8.3, wps=23032.3, ups=0.39, wpb=59361.5, bsz=1919.2, num_updates=145500, lr=0.000262161, gnorm=1.211, loss_scale=8192, train_wall=257, wall=0
2023-03-01 00:12:54 | INFO | train_inner | epoch 074:   1229 / 1978 loss=3.026, nll_loss=0.879, word_ins=2.707, length=3.188, ppl=8.14, wps=25205, ups=0.43, wpb=59136.6, bsz=2057.4, num_updates=145600, lr=0.000262071, gnorm=1.212, loss_scale=8192, train_wall=234, wall=0
2023-03-01 00:16:51 | INFO | train_inner | epoch 074:   1329 / 1978 loss=3.043, nll_loss=0.897, word_ins=2.723, length=3.199, ppl=8.24, wps=25109, ups=0.42, wpb=59579.4, bsz=2022.4, num_updates=145700, lr=0.000261981, gnorm=1.206, loss_scale=8192, train_wall=237, wall=0
2023-03-01 00:20:52 | INFO | train_inner | epoch 074:   1429 / 1978 loss=3.061, nll_loss=0.915, word_ins=2.74, length=3.207, ppl=8.34, wps=24561.3, ups=0.42, wpb=59023.6, bsz=2031.5, num_updates=145800, lr=0.000261891, gnorm=1.212, loss_scale=8192, train_wall=240, wall=0
2023-03-01 00:24:53 | INFO | train_inner | epoch 074:   1529 / 1978 loss=3.038, nll_loss=0.886, word_ins=2.714, length=3.242, ppl=8.21, wps=24285.7, ups=0.41, wpb=58689.6, bsz=2022.3, num_updates=145900, lr=0.000261802, gnorm=1.215, loss_scale=8192, train_wall=241, wall=0
2023-03-01 00:28:57 | INFO | train_inner | epoch 074:   1629 / 1978 loss=3.015, nll_loss=0.87, word_ins=2.698, length=3.167, ppl=8.08, wps=24613.3, ups=0.41, wpb=59867.6, bsz=2086.9, num_updates=146000, lr=0.000261712, gnorm=1.159, loss_scale=8192, train_wall=243, wall=0
2023-03-01 00:32:58 | INFO | train_inner | epoch 074:   1729 / 1978 loss=3.055, nll_loss=0.9, word_ins=2.726, length=3.29, ppl=8.31, wps=24303.7, ups=0.41, wpb=58734.6, bsz=1979, num_updates=146100, lr=0.000261622, gnorm=1.194, loss_scale=8192, train_wall=241, wall=0
2023-03-01 00:37:00 | INFO | train_inner | epoch 074:   1829 / 1978 loss=3.029, nll_loss=0.884, word_ins=2.711, length=3.178, ppl=8.16, wps=24604, ups=0.41, wpb=59416.7, bsz=2073.4, num_updates=146200, lr=0.000261533, gnorm=1.2, loss_scale=8192, train_wall=241, wall=0
2023-03-01 00:41:00 | INFO | train_inner | epoch 074:   1929 / 1978 loss=3.067, nll_loss=0.906, word_ins=2.732, length=3.344, ppl=8.38, wps=24507.9, ups=0.42, wpb=58761.1, bsz=1924.9, num_updates=146300, lr=0.000261443, gnorm=1.223, loss_scale=8192, train_wall=239, wall=0
2023-03-01 00:42:59 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 00:43:19 | INFO | valid | epoch 074 | valid on 'valid' subset | loss 4.111 | nll_loss 1.924 | word_ins 3.694 | length 4.18 | ppl 17.29 | wps 30168.3 | wpb 40242.5 | bsz 1500 | num_updates 146349 | best_loss 4.063
2023-03-01 00:43:19 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 00:43:25 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint74.pt (epoch 74 @ 146349 updates, score 4.111) (writing took 5.735516019165516 seconds)
2023-03-01 00:43:25 | INFO | fairseq_cli.train | end of epoch 74 (average epoch stats below)
2023-03-01 00:43:25 | INFO | train | epoch 074 | loss 3.042 | nll_loss 0.892 | word_ins 2.718 | length 3.234 | ppl 8.24 | wps 24623.5 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 146349 | lr 0.0002614 | gnorm 1.211 | loss_scale 8192 | train_wall 4722 | wall 0
2023-03-01 00:43:25 | INFO | fairseq.trainer | begin training epoch 75
2023-03-01 00:45:38 | INFO | train_inner | epoch 075:     51 / 1978 loss=3.034, nll_loss=0.884, word_ins=2.712, length=3.217, ppl=8.19, wps=21203.8, ups=0.36, wpb=58934.5, bsz=1970.3, num_updates=146400, lr=0.000261354, gnorm=1.158, loss_scale=8192, train_wall=240, wall=0
2023-03-01 00:49:30 | INFO | train_inner | epoch 075:    151 / 1978 loss=3.008, nll_loss=0.863, word_ins=2.692, length=3.158, ppl=8.05, wps=25665.2, ups=0.43, wpb=59702.4, bsz=2097.9, num_updates=146500, lr=0.000261265, gnorm=1.167, loss_scale=8192, train_wall=232, wall=0
2023-03-01 00:53:22 | INFO | train_inner | epoch 075:    251 / 1978 loss=3.036, nll_loss=0.885, word_ins=2.713, length=3.231, ppl=8.2, wps=25460.6, ups=0.43, wpb=59013.2, bsz=2011.9, num_updates=146600, lr=0.000261176, gnorm=1.272, loss_scale=8192, train_wall=232, wall=0
2023-03-01 00:57:13 | INFO | train_inner | epoch 075:    351 / 1978 loss=3.02, nll_loss=0.874, word_ins=2.702, length=3.181, ppl=8.11, wps=25793.1, ups=0.43, wpb=59500.6, bsz=2026.4, num_updates=146700, lr=0.000261087, gnorm=1.198, loss_scale=8192, train_wall=230, wall=0
2023-03-01 01:01:04 | INFO | train_inner | epoch 075:    451 / 1978 loss=3.034, nll_loss=0.888, word_ins=2.716, length=3.182, ppl=8.19, wps=25603.3, ups=0.43, wpb=59250.1, bsz=2073.1, num_updates=146800, lr=0.000260998, gnorm=1.217, loss_scale=8192, train_wall=231, wall=0
2023-03-01 01:05:02 | INFO | train_inner | epoch 075:    551 / 1978 loss=3.048, nll_loss=0.898, word_ins=2.724, length=3.23, ppl=8.27, wps=24706.9, ups=0.42, wpb=58906.7, bsz=1968.8, num_updates=146900, lr=0.000260909, gnorm=1.18, loss_scale=16384, train_wall=238, wall=0
2023-03-01 01:06:14 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-01 01:09:05 | INFO | train_inner | epoch 075:    652 / 1978 loss=3.049, nll_loss=0.896, word_ins=2.722, length=3.271, ppl=8.28, wps=24650.1, ups=0.41, wpb=59746, bsz=1955.5, num_updates=147000, lr=0.00026082, gnorm=1.24, loss_scale=8192, train_wall=242, wall=0
2023-03-01 01:13:05 | INFO | train_inner | epoch 075:    752 / 1978 loss=3.041, nll_loss=0.887, word_ins=2.715, length=3.266, ppl=8.23, wps=24672.4, ups=0.42, wpb=59277.1, bsz=1961.4, num_updates=147100, lr=0.000260732, gnorm=1.197, loss_scale=8192, train_wall=240, wall=0
2023-03-01 01:17:03 | INFO | train_inner | epoch 075:    852 / 1978 loss=3.023, nll_loss=0.876, word_ins=2.704, length=3.191, ppl=8.13, wps=24724.9, ups=0.42, wpb=58857.3, bsz=2056.1, num_updates=147200, lr=0.000260643, gnorm=1.195, loss_scale=8192, train_wall=238, wall=0
2023-03-01 01:21:04 | INFO | train_inner | epoch 075:    952 / 1978 loss=3.049, nll_loss=0.902, word_ins=2.728, length=3.213, ppl=8.28, wps=24530.8, ups=0.42, wpb=59040.3, bsz=2067.8, num_updates=147300, lr=0.000260555, gnorm=1.281, loss_scale=8192, train_wall=240, wall=0
2023-03-01 01:25:06 | INFO | train_inner | epoch 075:   1052 / 1978 loss=3.01, nll_loss=0.863, word_ins=2.692, length=3.182, ppl=8.06, wps=24580.6, ups=0.41, wpb=59478.5, bsz=2091.3, num_updates=147400, lr=0.000260466, gnorm=1.17, loss_scale=8192, train_wall=242, wall=0
2023-03-01 01:29:05 | INFO | train_inner | epoch 075:   1152 / 1978 loss=3.053, nll_loss=0.904, word_ins=2.73, length=3.23, ppl=8.3, wps=24554.9, ups=0.42, wpb=58716.1, bsz=1935.7, num_updates=147500, lr=0.000260378, gnorm=1.212, loss_scale=8192, train_wall=239, wall=0
2023-03-01 01:33:06 | INFO | train_inner | epoch 075:   1252 / 1978 loss=3.049, nll_loss=0.9, word_ins=2.726, length=3.23, ppl=8.28, wps=24476.8, ups=0.41, wpb=59062.2, bsz=1958, num_updates=147600, lr=0.00026029, gnorm=1.195, loss_scale=8192, train_wall=241, wall=0
2023-03-01 01:37:08 | INFO | train_inner | epoch 075:   1352 / 1978 loss=3.058, nll_loss=0.903, word_ins=2.728, length=3.299, ppl=8.33, wps=24352, ups=0.41, wpb=58749.2, bsz=1922, num_updates=147700, lr=0.000260201, gnorm=1.179, loss_scale=8192, train_wall=241, wall=0
2023-03-01 01:41:08 | INFO | train_inner | epoch 075:   1452 / 1978 loss=3.036, nll_loss=0.886, word_ins=2.713, length=3.235, ppl=8.2, wps=24940.8, ups=0.42, wpb=59948, bsz=2009.8, num_updates=147800, lr=0.000260113, gnorm=1.235, loss_scale=8192, train_wall=240, wall=0
2023-03-01 01:45:09 | INFO | train_inner | epoch 075:   1552 / 1978 loss=3.045, nll_loss=0.892, word_ins=2.719, length=3.26, ppl=8.25, wps=24591.7, ups=0.42, wpb=59191.9, bsz=1963.9, num_updates=147900, lr=0.000260025, gnorm=1.241, loss_scale=8192, train_wall=240, wall=0
2023-03-01 01:49:10 | INFO | train_inner | epoch 075:   1652 / 1978 loss=3.046, nll_loss=0.901, word_ins=2.727, length=3.196, ppl=8.26, wps=24760.4, ups=0.41, wpb=59760.3, bsz=1949.2, num_updates=148000, lr=0.000259938, gnorm=1.21, loss_scale=8192, train_wall=241, wall=0
2023-03-01 01:53:11 | INFO | train_inner | epoch 075:   1752 / 1978 loss=3.032, nll_loss=0.883, word_ins=2.711, length=3.216, ppl=8.18, wps=24554.4, ups=0.42, wpb=59072, bsz=2012, num_updates=148100, lr=0.00025985, gnorm=1.202, loss_scale=8192, train_wall=240, wall=0
2023-03-01 01:57:12 | INFO | train_inner | epoch 075:   1852 / 1978 loss=3.036, nll_loss=0.884, word_ins=2.711, length=3.25, ppl=8.2, wps=24802.6, ups=0.41, wpb=59920.7, bsz=2004.6, num_updates=148200, lr=0.000259762, gnorm=1.202, loss_scale=8192, train_wall=241, wall=0
2023-03-01 02:01:13 | INFO | train_inner | epoch 075:   1952 / 1978 loss=3.039, nll_loss=0.889, word_ins=2.716, length=3.23, ppl=8.22, wps=24709.9, ups=0.42, wpb=59529.2, bsz=2029.8, num_updates=148300, lr=0.000259675, gnorm=1.217, loss_scale=8192, train_wall=241, wall=0
2023-03-01 02:02:14 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 02:02:41 | INFO | valid | epoch 075 | valid on 'valid' subset | loss 4.082 | nll_loss 1.922 | word_ins 3.685 | length 3.972 | ppl 16.93 | wps 30371.3 | wpb 40242.5 | bsz 1500 | num_updates 148326 | best_loss 4.063
2023-03-01 02:02:41 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 02:02:47 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint75.pt (epoch 75 @ 148326 updates, score 4.082) (writing took 6.085102379322052 seconds)
2023-03-01 02:02:47 | INFO | fairseq_cli.train | end of epoch 75 (average epoch stats below)
2023-03-01 02:02:47 | INFO | train | epoch 075 | loss 3.038 | nll_loss 0.888 | word_ins 2.715 | length 3.224 | ppl 8.21 | wps 24609.3 | ups 0.42 | wpb 59282.3 | bsz 2002.6 | num_updates 148326 | lr 0.000259652 | gnorm 1.21 | loss_scale 8192 | train_wall 4712 | wall 0
2023-03-01 02:02:47 | INFO | fairseq.trainer | begin training epoch 76
2023-03-01 02:05:56 | INFO | train_inner | epoch 076:     74 / 1978 loss=3.056, nll_loss=0.904, word_ins=2.73, length=3.258, ppl=8.31, wps=20862.3, ups=0.35, wpb=59126.6, bsz=1900.2, num_updates=148400, lr=0.000259587, gnorm=1.219, loss_scale=8192, train_wall=237, wall=0
2023-03-01 02:09:58 | INFO | train_inner | epoch 076:    174 / 1978 loss=3.034, nll_loss=0.882, word_ins=2.71, length=3.235, ppl=8.19, wps=24543.1, ups=0.41, wpb=59313.5, bsz=2000.2, num_updates=148500, lr=0.0002595, gnorm=1.211, loss_scale=8192, train_wall=241, wall=0
2023-03-01 02:13:59 | INFO | train_inner | epoch 076:    274 / 1978 loss=3.021, nll_loss=0.874, word_ins=2.703, length=3.188, ppl=8.12, wps=24610.9, ups=0.41, wpb=59365.2, bsz=2037.3, num_updates=148600, lr=0.000259412, gnorm=1.176, loss_scale=8192, train_wall=241, wall=0
2023-03-01 02:18:00 | INFO | train_inner | epoch 076:    374 / 1978 loss=3.025, nll_loss=0.876, word_ins=2.705, length=3.2, ppl=8.14, wps=24551.4, ups=0.41, wpb=59161.6, bsz=1941.2, num_updates=148700, lr=0.000259325, gnorm=1.194, loss_scale=8192, train_wall=241, wall=0
2023-03-01 02:22:04 | INFO | train_inner | epoch 076:    474 / 1978 loss=3.031, nll_loss=0.883, word_ins=2.711, length=3.201, ppl=8.17, wps=24328.3, ups=0.41, wpb=59220.7, bsz=2023.8, num_updates=148800, lr=0.000259238, gnorm=1.178, loss_scale=8192, train_wall=243, wall=0
2023-03-01 02:26:03 | INFO | train_inner | epoch 076:    574 / 1978 loss=3.017, nll_loss=0.874, word_ins=2.702, length=3.143, ppl=8.09, wps=24706, ups=0.42, wpb=59224.8, bsz=2074.8, num_updates=148900, lr=0.000259151, gnorm=1.192, loss_scale=8192, train_wall=239, wall=0
2023-03-01 02:30:04 | INFO | train_inner | epoch 076:    674 / 1978 loss=3.041, nll_loss=0.889, word_ins=2.715, length=3.257, ppl=8.23, wps=24719.7, ups=0.41, wpb=59577.2, bsz=1916.5, num_updates=149000, lr=0.000259064, gnorm=1.23, loss_scale=8192, train_wall=241, wall=0
2023-03-01 02:34:12 | INFO | train_inner | epoch 076:    774 / 1978 loss=3.035, nll_loss=0.885, word_ins=2.713, length=3.217, ppl=8.19, wps=23914.9, ups=0.4, wpb=59111.7, bsz=2046.3, num_updates=149100, lr=0.000258977, gnorm=1.184, loss_scale=8192, train_wall=247, wall=0
2023-03-01 02:38:28 | INFO | train_inner | epoch 076:    874 / 1978 loss=3.027, nll_loss=0.876, word_ins=2.704, length=3.231, ppl=8.15, wps=23108.1, ups=0.39, wpb=59115.8, bsz=2051.6, num_updates=149200, lr=0.00025889, gnorm=1.21, loss_scale=8192, train_wall=256, wall=0
2023-03-01 02:42:27 | INFO | train_inner | epoch 076:    974 / 1978 loss=3.034, nll_loss=0.89, word_ins=2.717, length=3.176, ppl=8.19, wps=24789.3, ups=0.42, wpb=59368.4, bsz=2043.4, num_updates=149300, lr=0.000258803, gnorm=1.262, loss_scale=8192, train_wall=239, wall=0
2023-03-01 02:46:25 | INFO | train_inner | epoch 076:   1074 / 1978 loss=3.058, nll_loss=0.905, word_ins=2.73, length=3.28, ppl=8.33, wps=24763.7, ups=0.42, wpb=58935.5, bsz=1914.6, num_updates=149400, lr=0.000258717, gnorm=1.275, loss_scale=8192, train_wall=238, wall=0
2023-03-01 02:50:22 | INFO | train_inner | epoch 076:   1174 / 1978 loss=3.032, nll_loss=0.883, word_ins=2.71, length=3.223, ppl=8.18, wps=24939.8, ups=0.42, wpb=59190.7, bsz=2064.4, num_updates=149500, lr=0.00025863, gnorm=1.199, loss_scale=8192, train_wall=237, wall=0
2023-03-01 02:54:22 | INFO | train_inner | epoch 076:   1274 / 1978 loss=3.043, nll_loss=0.89, word_ins=2.717, length=3.258, ppl=8.24, wps=24820.5, ups=0.42, wpb=59380.1, bsz=1990, num_updates=149600, lr=0.000258544, gnorm=1.216, loss_scale=8192, train_wall=239, wall=0
2023-03-01 02:58:22 | INFO | train_inner | epoch 076:   1374 / 1978 loss=3.033, nll_loss=0.882, word_ins=2.709, length=3.239, ppl=8.19, wps=24635.5, ups=0.42, wpb=59214.1, bsz=2037.4, num_updates=149700, lr=0.000258457, gnorm=1.215, loss_scale=8192, train_wall=240, wall=0
2023-03-01 03:02:32 | INFO | train_inner | epoch 076:   1474 / 1978 loss=3.043, nll_loss=0.887, word_ins=2.714, length=3.292, ppl=8.24, wps=23698.1, ups=0.4, wpb=59218.3, bsz=1968.5, num_updates=149800, lr=0.000258371, gnorm=1.247, loss_scale=8192, train_wall=250, wall=0
2023-03-01 03:06:46 | INFO | train_inner | epoch 076:   1574 / 1978 loss=3.046, nll_loss=0.892, word_ins=2.718, length=3.279, ppl=8.26, wps=23242.8, ups=0.39, wpb=59025.7, bsz=1981, num_updates=149900, lr=0.000258285, gnorm=1.217, loss_scale=8192, train_wall=254, wall=0
2023-03-01 03:11:00 | INFO | train_inner | epoch 076:   1674 / 1978 loss=3.033, nll_loss=0.885, word_ins=2.712, length=3.212, ppl=8.19, wps=23527.3, ups=0.39, wpb=59863.9, bsz=1983, num_updates=150000, lr=0.000258199, gnorm=1.21, loss_scale=8192, train_wall=254, wall=0
2023-03-01 03:15:14 | INFO | train_inner | epoch 076:   1774 / 1978 loss=3.041, nll_loss=0.895, word_ins=2.721, length=3.195, ppl=8.23, wps=23352.7, ups=0.39, wpb=59170.1, bsz=2045.1, num_updates=150100, lr=0.000258113, gnorm=1.259, loss_scale=8192, train_wall=253, wall=0
2023-03-01 03:19:27 | INFO | train_inner | epoch 076:   1874 / 1978 loss=3.016, nll_loss=0.873, word_ins=2.701, length=3.143, ppl=8.09, wps=23587.2, ups=0.39, wpb=59826.7, bsz=2038, num_updates=150200, lr=0.000258027, gnorm=1.244, loss_scale=8192, train_wall=253, wall=0
2023-03-01 03:23:41 | INFO | train_inner | epoch 076:   1974 / 1978 loss=3.045, nll_loss=0.894, word_ins=2.72, length=3.249, ppl=8.25, wps=23348, ups=0.39, wpb=59243.6, bsz=1949.8, num_updates=150300, lr=0.000257941, gnorm=1.206, loss_scale=8192, train_wall=253, wall=0
2023-03-01 03:23:51 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 03:24:14 | INFO | valid | epoch 076 | valid on 'valid' subset | loss 4.081 | nll_loss 1.912 | word_ins 3.68 | length 4.012 | ppl 16.93 | wps 26957.4 | wpb 40242.5 | bsz 1500 | num_updates 150304 | best_loss 4.063
2023-03-01 03:24:14 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 03:24:20 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint76.pt (epoch 76 @ 150304 updates, score 4.081) (writing took 5.980239562690258 seconds)
2023-03-01 03:24:20 | INFO | fairseq_cli.train | end of epoch 76 (average epoch stats below)
2023-03-01 03:24:20 | INFO | train | epoch 076 | loss 3.035 | nll_loss 0.886 | word_ins 2.713 | length 3.222 | ppl 8.2 | wps 23966.9 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 150304 | lr 0.000257938 | gnorm 1.218 | loss_scale 8192 | train_wall 4845 | wall 0
2023-03-01 03:24:20 | INFO | fairseq.trainer | begin training epoch 77
2023-03-01 03:28:35 | INFO | train_inner | epoch 077:     96 / 1978 loss=3.024, nll_loss=0.879, word_ins=2.707, length=3.164, ppl=8.13, wps=20157.2, ups=0.34, wpb=59162.6, bsz=2069, num_updates=150400, lr=0.000257855, gnorm=1.225, loss_scale=8192, train_wall=251, wall=0
2023-03-01 03:32:48 | INFO | train_inner | epoch 077:    196 / 1978 loss=3.012, nll_loss=0.866, word_ins=2.695, length=3.165, ppl=8.07, wps=23280.1, ups=0.39, wpb=58981, bsz=2028.9, num_updates=150500, lr=0.00025777, gnorm=1.162, loss_scale=8192, train_wall=253, wall=0
2023-03-01 03:37:00 | INFO | train_inner | epoch 077:    296 / 1978 loss=3.034, nll_loss=0.886, word_ins=2.714, length=3.201, ppl=8.19, wps=23647, ups=0.4, wpb=59709.9, bsz=1963.8, num_updates=150600, lr=0.000257684, gnorm=1.235, loss_scale=8192, train_wall=252, wall=0
2023-03-01 03:41:11 | INFO | train_inner | epoch 077:    396 / 1978 loss=3.036, nll_loss=0.888, word_ins=2.715, length=3.214, ppl=8.2, wps=23595.6, ups=0.4, wpb=59240.2, bsz=1961.7, num_updates=150700, lr=0.000257599, gnorm=1.205, loss_scale=8192, train_wall=251, wall=0
2023-03-01 03:45:26 | INFO | train_inner | epoch 077:    496 / 1978 loss=3.027, nll_loss=0.882, word_ins=2.71, length=3.172, ppl=8.15, wps=23453.9, ups=0.39, wpb=59620.1, bsz=2045.1, num_updates=150800, lr=0.000257513, gnorm=1.219, loss_scale=8192, train_wall=254, wall=0
2023-03-01 03:49:38 | INFO | train_inner | epoch 077:    596 / 1978 loss=3.05, nll_loss=0.899, word_ins=2.726, length=3.241, ppl=8.28, wps=23179.2, ups=0.4, wpb=58602, bsz=2029.9, num_updates=150900, lr=0.000257428, gnorm=1.269, loss_scale=8192, train_wall=253, wall=0
2023-03-01 03:53:53 | INFO | train_inner | epoch 077:    696 / 1978 loss=3.026, nll_loss=0.877, word_ins=2.705, length=3.211, ppl=8.14, wps=23321.3, ups=0.39, wpb=59450.9, bsz=2083.5, num_updates=151000, lr=0.000257343, gnorm=1.207, loss_scale=8192, train_wall=255, wall=0
2023-03-01 03:55:00 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-01 03:58:11 | INFO | train_inner | epoch 077:    797 / 1978 loss=3.022, nll_loss=0.876, word_ins=2.703, length=3.185, ppl=8.12, wps=23076.3, ups=0.39, wpb=59507.5, bsz=2050.1, num_updates=151100, lr=0.000257257, gnorm=1.201, loss_scale=8192, train_wall=258, wall=0
2023-03-01 04:02:24 | INFO | train_inner | epoch 077:    897 / 1978 loss=3.046, nll_loss=0.897, word_ins=2.723, length=3.234, ppl=8.26, wps=23517.1, ups=0.4, wpb=59463.9, bsz=1951.9, num_updates=151200, lr=0.000257172, gnorm=1.251, loss_scale=8192, train_wall=253, wall=0
2023-03-01 04:06:40 | INFO | train_inner | epoch 077:    997 / 1978 loss=3.019, nll_loss=0.873, word_ins=2.701, length=3.177, ppl=8.11, wps=23213, ups=0.39, wpb=59423.4, bsz=2095.7, num_updates=151300, lr=0.000257087, gnorm=1.211, loss_scale=8192, train_wall=256, wall=0
2023-03-01 04:10:53 | INFO | train_inner | epoch 077:   1097 / 1978 loss=3.029, nll_loss=0.885, word_ins=2.712, length=3.168, ppl=8.16, wps=23495.5, ups=0.4, wpb=59447.6, bsz=2019.5, num_updates=151400, lr=0.000257002, gnorm=1.196, loss_scale=8192, train_wall=253, wall=0
2023-03-01 04:15:06 | INFO | train_inner | epoch 077:   1197 / 1978 loss=3.047, nll_loss=0.893, word_ins=2.72, length=3.266, ppl=8.26, wps=23362.6, ups=0.4, wpb=58958.1, bsz=1954.4, num_updates=151500, lr=0.000256917, gnorm=1.216, loss_scale=8192, train_wall=252, wall=0
2023-03-01 04:19:20 | INFO | train_inner | epoch 077:   1297 / 1978 loss=3.041, nll_loss=0.89, word_ins=2.717, length=3.233, ppl=8.23, wps=23408.6, ups=0.39, wpb=59587, bsz=1996.9, num_updates=151600, lr=0.000256833, gnorm=1.183, loss_scale=8192, train_wall=254, wall=0
2023-03-01 04:23:33 | INFO | train_inner | epoch 077:   1397 / 1978 loss=3.05, nll_loss=0.896, word_ins=2.722, length=3.275, ppl=8.28, wps=23394.8, ups=0.39, wpb=59267.3, bsz=1914, num_updates=151700, lr=0.000256748, gnorm=1.255, loss_scale=8192, train_wall=253, wall=0
2023-03-01 04:27:45 | INFO | train_inner | epoch 077:   1497 / 1978 loss=3.059, nll_loss=0.902, word_ins=2.728, length=3.308, ppl=8.33, wps=23559.8, ups=0.4, wpb=59193.2, bsz=1875.4, num_updates=151800, lr=0.000256664, gnorm=1.29, loss_scale=8192, train_wall=251, wall=0
2023-03-01 04:31:58 | INFO | train_inner | epoch 077:   1597 / 1978 loss=3.039, nll_loss=0.886, word_ins=2.713, length=3.264, ppl=8.22, wps=23488.8, ups=0.4, wpb=59454.7, bsz=1956.4, num_updates=151900, lr=0.000256579, gnorm=1.165, loss_scale=8192, train_wall=253, wall=0
2023-03-01 04:36:12 | INFO | train_inner | epoch 077:   1697 / 1978 loss=3.017, nll_loss=0.866, word_ins=2.695, length=3.221, ppl=8.1, wps=23130.7, ups=0.39, wpb=58888.8, bsz=2039.5, num_updates=152000, lr=0.000256495, gnorm=1.182, loss_scale=8192, train_wall=254, wall=0
2023-03-01 04:40:25 | INFO | train_inner | epoch 077:   1797 / 1978 loss=3.03, nll_loss=0.88, word_ins=2.708, length=3.223, ppl=8.17, wps=23345.4, ups=0.4, wpb=59064.1, bsz=2002.6, num_updates=152100, lr=0.00025641, gnorm=1.239, loss_scale=8192, train_wall=253, wall=0
2023-03-01 04:44:40 | INFO | train_inner | epoch 077:   1897 / 1978 loss=3.028, nll_loss=0.876, word_ins=2.704, length=3.237, ppl=8.16, wps=23271.7, ups=0.39, wpb=59186.8, bsz=2047.1, num_updates=152200, lr=0.000256326, gnorm=1.21, loss_scale=8192, train_wall=254, wall=0
2023-03-01 04:48:05 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 04:48:25 | INFO | valid | epoch 077 | valid on 'valid' subset | loss 4.107 | nll_loss 1.917 | word_ins 3.687 | length 4.206 | ppl 17.23 | wps 25765.3 | wpb 40242.5 | bsz 1500 | num_updates 152281 | best_loss 4.063
2023-03-01 04:48:25 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 04:48:32 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint77.pt (epoch 77 @ 152281 updates, score 4.107) (writing took 6.466412976384163 seconds)
2023-03-01 04:48:32 | INFO | fairseq_cli.train | end of epoch 77 (average epoch stats below)
2023-03-01 04:48:32 | INFO | train | epoch 077 | loss 3.034 | nll_loss 0.884 | word_ins 2.712 | length 3.22 | ppl 8.19 | wps 23199.3 | ups 0.39 | wpb 59282.7 | bsz 2002.4 | num_updates 152281 | lr 0.000256258 | gnorm 1.218 | loss_scale 8192 | train_wall 5005 | wall 0
2023-03-01 04:48:32 | INFO | fairseq.trainer | begin training epoch 78
2023-03-01 04:49:31 | INFO | train_inner | epoch 078:     19 / 1978 loss=3.04, nll_loss=0.887, word_ins=2.714, length=3.259, ppl=8.22, wps=20283.7, ups=0.34, wpb=59168.3, bsz=1956.6, num_updates=152300, lr=0.000256242, gnorm=1.239, loss_scale=8192, train_wall=251, wall=0
2023-03-01 04:53:43 | INFO | train_inner | epoch 078:    119 / 1978 loss=3.002, nll_loss=0.857, word_ins=2.686, length=3.155, ppl=8.01, wps=23793.1, ups=0.4, wpb=59760.6, bsz=1993.7, num_updates=152400, lr=0.000256158, gnorm=1.229, loss_scale=8192, train_wall=251, wall=0
2023-03-01 04:57:57 | INFO | train_inner | epoch 078:    219 / 1978 loss=3.021, nll_loss=0.868, word_ins=2.697, length=3.242, ppl=8.12, wps=23379.8, ups=0.39, wpb=59565.8, bsz=2001.4, num_updates=152500, lr=0.000256074, gnorm=1.231, loss_scale=8192, train_wall=254, wall=0
2023-03-01 05:02:12 | INFO | train_inner | epoch 078:    319 / 1978 loss=3.033, nll_loss=0.887, word_ins=2.715, length=3.179, ppl=8.18, wps=23395.1, ups=0.39, wpb=59499.2, bsz=2021, num_updates=152600, lr=0.00025599, gnorm=1.231, loss_scale=8192, train_wall=254, wall=0
2023-03-01 05:06:22 | INFO | train_inner | epoch 078:    419 / 1978 loss=3.043, nll_loss=0.892, word_ins=2.718, length=3.252, ppl=8.24, wps=23694.3, ups=0.4, wpb=59412.7, bsz=1915.6, num_updates=152700, lr=0.000255906, gnorm=1.243, loss_scale=8192, train_wall=250, wall=0
2023-03-01 05:10:34 | INFO | train_inner | epoch 078:    519 / 1978 loss=3.026, nll_loss=0.878, word_ins=2.705, length=3.206, ppl=8.15, wps=23622.1, ups=0.4, wpb=59310.2, bsz=2020.4, num_updates=152800, lr=0.000255822, gnorm=1.182, loss_scale=8192, train_wall=251, wall=0
2023-03-01 05:14:47 | INFO | train_inner | epoch 078:    619 / 1978 loss=3.038, nll_loss=0.888, word_ins=2.715, length=3.236, ppl=8.22, wps=23216.1, ups=0.39, wpb=58881.1, bsz=2024.6, num_updates=152900, lr=0.000255739, gnorm=1.21, loss_scale=8192, train_wall=253, wall=0
2023-03-01 05:18:59 | INFO | train_inner | epoch 078:    719 / 1978 loss=3.034, nll_loss=0.885, word_ins=2.712, length=3.222, ppl=8.19, wps=23520.5, ups=0.4, wpb=59210.6, bsz=1918.4, num_updates=153000, lr=0.000255655, gnorm=1.213, loss_scale=8192, train_wall=251, wall=0
2023-03-01 05:23:14 | INFO | train_inner | epoch 078:    819 / 1978 loss=3.015, nll_loss=0.87, word_ins=2.698, length=3.172, ppl=8.09, wps=23352.5, ups=0.39, wpb=59456.7, bsz=2061.3, num_updates=153100, lr=0.000255571, gnorm=1.21, loss_scale=8192, train_wall=254, wall=0
2023-03-01 05:27:27 | INFO | train_inner | epoch 078:    919 / 1978 loss=3.036, nll_loss=0.885, word_ins=2.712, length=3.234, ppl=8.2, wps=23444.8, ups=0.39, wpb=59537.3, bsz=1961.3, num_updates=153200, lr=0.000255488, gnorm=1.219, loss_scale=8192, train_wall=254, wall=0
2023-03-01 05:31:41 | INFO | train_inner | epoch 078:   1019 / 1978 loss=3.004, nll_loss=0.86, word_ins=2.69, length=3.141, ppl=8.02, wps=23380.6, ups=0.39, wpb=59343.9, bsz=2082.9, num_updates=153300, lr=0.000255405, gnorm=1.17, loss_scale=8192, train_wall=254, wall=0
2023-03-01 05:35:55 | INFO | train_inner | epoch 078:   1119 / 1978 loss=3.018, nll_loss=0.87, word_ins=2.699, length=3.189, ppl=8.1, wps=23282.2, ups=0.39, wpb=58978.4, bsz=2035.6, num_updates=153400, lr=0.000255321, gnorm=1.192, loss_scale=8192, train_wall=253, wall=0
2023-03-01 05:40:05 | INFO | train_inner | epoch 078:   1219 / 1978 loss=3.065, nll_loss=0.91, word_ins=2.735, length=3.306, ppl=8.37, wps=23444.8, ups=0.4, wpb=58772, bsz=1849, num_updates=153500, lr=0.000255238, gnorm=1.235, loss_scale=8192, train_wall=250, wall=0
2023-03-01 05:43:52 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 4096.0
2023-03-01 05:44:23 | INFO | train_inner | epoch 078:   1320 / 1978 loss=3.017, nll_loss=0.87, word_ins=2.698, length=3.187, ppl=8.09, wps=23240.9, ups=0.39, wpb=59857.3, bsz=2103, num_updates=153600, lr=0.000255155, gnorm=1.214, loss_scale=4096, train_wall=257, wall=0
2023-03-01 05:48:36 | INFO | train_inner | epoch 078:   1420 / 1978 loss=3.031, nll_loss=0.881, word_ins=2.708, length=3.235, ppl=8.17, wps=23450.9, ups=0.4, wpb=59317.3, bsz=2001, num_updates=153700, lr=0.000255072, gnorm=1.226, loss_scale=4096, train_wall=253, wall=0
2023-03-01 05:52:48 | INFO | train_inner | epoch 078:   1520 / 1978 loss=3.031, nll_loss=0.881, word_ins=2.708, length=3.225, ppl=8.17, wps=23659.2, ups=0.4, wpb=59719.3, bsz=1959, num_updates=153800, lr=0.000254989, gnorm=1.248, loss_scale=4096, train_wall=252, wall=0
2023-03-01 05:57:02 | INFO | train_inner | epoch 078:   1620 / 1978 loss=3.04, nll_loss=0.89, word_ins=2.716, length=3.241, ppl=8.23, wps=23254.7, ups=0.39, wpb=59039, bsz=2021.7, num_updates=153900, lr=0.000254906, gnorm=1.236, loss_scale=4096, train_wall=254, wall=0
2023-03-01 06:01:16 | INFO | train_inner | epoch 078:   1720 / 1978 loss=3.062, nll_loss=0.909, word_ins=2.734, length=3.277, ppl=8.35, wps=23120.3, ups=0.39, wpb=58665.2, bsz=2011, num_updates=154000, lr=0.000254824, gnorm=1.233, loss_scale=4096, train_wall=253, wall=0
2023-03-01 06:05:29 | INFO | train_inner | epoch 078:   1820 / 1978 loss=3.033, nll_loss=0.885, word_ins=2.712, length=3.215, ppl=8.19, wps=23254, ups=0.4, wpb=58817.9, bsz=2031.4, num_updates=154100, lr=0.000254741, gnorm=1.182, loss_scale=4096, train_wall=253, wall=0
2023-03-01 06:09:44 | INFO | train_inner | epoch 078:   1920 / 1978 loss=3.032, nll_loss=0.884, word_ins=2.711, length=3.205, ppl=8.18, wps=23254.8, ups=0.39, wpb=59228.3, bsz=2023, num_updates=154200, lr=0.000254658, gnorm=1.208, loss_scale=4096, train_wall=254, wall=0
2023-03-01 06:12:11 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 06:12:29 | INFO | valid | epoch 078 | valid on 'valid' subset | loss 4.063 | nll_loss 1.935 | word_ins 3.701 | length 3.622 | ppl 16.71 | wps 26574.9 | wpb 40242.5 | bsz 1500 | num_updates 154258 | best_loss 4.063
2023-03-01 06:12:29 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 06:12:39 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint78.pt (epoch 78 @ 154258 updates, score 4.063) (writing took 9.520083663985133 seconds)
2023-03-01 06:12:39 | INFO | fairseq_cli.train | end of epoch 78 (average epoch stats below)
2023-03-01 06:12:39 | INFO | train | epoch 078 | loss 3.031 | nll_loss 0.882 | word_ins 2.709 | length 3.218 | ppl 8.17 | wps 23221.9 | ups 0.39 | wpb 59283.7 | bsz 2002.8 | num_updates 154258 | lr 0.00025461 | gnorm 1.217 | loss_scale 4096 | train_wall 5000 | wall 0
2023-03-01 06:12:39 | INFO | fairseq.trainer | begin training epoch 79
2023-03-01 06:14:39 | INFO | train_inner | epoch 079:     42 / 1978 loss=3.054, nll_loss=0.9, word_ins=2.726, length=3.287, ppl=8.31, wps=20008.3, ups=0.34, wpb=59117, bsz=1947.8, num_updates=154300, lr=0.000254576, gnorm=1.237, loss_scale=4096, train_wall=251, wall=0
2023-03-01 06:18:51 | INFO | train_inner | epoch 079:    142 / 1978 loss=3.025, nll_loss=0.879, word_ins=2.707, length=3.18, ppl=8.14, wps=23464.3, ups=0.4, wpb=59111.3, bsz=2029.5, num_updates=154400, lr=0.000254493, gnorm=1.197, loss_scale=4096, train_wall=252, wall=0
2023-03-01 06:23:05 | INFO | train_inner | epoch 079:    242 / 1978 loss=3.015, nll_loss=0.872, word_ins=2.7, length=3.152, ppl=8.09, wps=23601.1, ups=0.39, wpb=59973.1, bsz=2025.9, num_updates=154500, lr=0.000254411, gnorm=1.225, loss_scale=4096, train_wall=254, wall=0
2023-03-01 06:27:20 | INFO | train_inner | epoch 079:    342 / 1978 loss=3.02, nll_loss=0.875, word_ins=2.704, length=3.16, ppl=8.11, wps=23091.3, ups=0.39, wpb=58780.5, bsz=2079.3, num_updates=154600, lr=0.000254329, gnorm=1.175, loss_scale=4096, train_wall=254, wall=0
2023-03-01 06:31:32 | INFO | train_inner | epoch 079:    442 / 1978 loss=3.023, nll_loss=0.873, word_ins=2.702, length=3.208, ppl=8.13, wps=23417.9, ups=0.4, wpb=59167.5, bsz=2016.8, num_updates=154700, lr=0.000254246, gnorm=1.245, loss_scale=4096, train_wall=252, wall=0
2023-03-01 06:35:45 | INFO | train_inner | epoch 079:    542 / 1978 loss=3.04, nll_loss=0.893, word_ins=2.719, length=3.214, ppl=8.23, wps=23354.3, ups=0.4, wpb=59037, bsz=1924.1, num_updates=154800, lr=0.000254164, gnorm=1.203, loss_scale=4096, train_wall=253, wall=0
2023-03-01 06:40:00 | INFO | train_inner | epoch 079:    642 / 1978 loss=3.014, nll_loss=0.868, word_ins=2.696, length=3.178, ppl=8.08, wps=23308.6, ups=0.39, wpb=59379, bsz=2039.5, num_updates=154900, lr=0.000254082, gnorm=1.233, loss_scale=4096, train_wall=254, wall=0
2023-03-01 06:44:14 | INFO | train_inner | epoch 079:    742 / 1978 loss=3.025, nll_loss=0.876, word_ins=2.704, length=3.207, ppl=8.14, wps=23305.2, ups=0.39, wpb=59197, bsz=2047.1, num_updates=155000, lr=0.000254, gnorm=1.241, loss_scale=4096, train_wall=254, wall=0
2023-03-01 06:48:27 | INFO | train_inner | epoch 079:    842 / 1978 loss=3.035, nll_loss=0.88, word_ins=2.707, length=3.277, ppl=8.2, wps=23458.5, ups=0.39, wpb=59396.9, bsz=2015.1, num_updates=155100, lr=0.000253918, gnorm=1.235, loss_scale=4096, train_wall=253, wall=0
2023-03-01 06:52:40 | INFO | train_inner | epoch 079:    942 / 1978 loss=3.033, nll_loss=0.884, word_ins=2.711, length=3.218, ppl=8.18, wps=23389.9, ups=0.4, wpb=59183.5, bsz=1958.2, num_updates=155200, lr=0.000253837, gnorm=1.22, loss_scale=4096, train_wall=253, wall=0
2023-03-01 06:56:54 | INFO | train_inner | epoch 079:   1042 / 1978 loss=3.017, nll_loss=0.868, word_ins=2.697, length=3.203, ppl=8.1, wps=23402.2, ups=0.39, wpb=59446, bsz=2004.9, num_updates=155300, lr=0.000253755, gnorm=1.188, loss_scale=4096, train_wall=254, wall=0
2023-03-01 07:01:09 | INFO | train_inner | epoch 079:   1142 / 1978 loss=3.021, nll_loss=0.875, word_ins=2.703, length=3.182, ppl=8.12, wps=23579, ups=0.39, wpb=60060, bsz=2045.4, num_updates=155400, lr=0.000253673, gnorm=1.23, loss_scale=4096, train_wall=254, wall=0
2023-03-01 07:05:22 | INFO | train_inner | epoch 079:   1242 / 1978 loss=3.025, nll_loss=0.876, word_ins=2.704, length=3.214, ppl=8.14, wps=23379.5, ups=0.39, wpb=59244.3, bsz=2012.9, num_updates=155500, lr=0.000253592, gnorm=1.232, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:09:36 | INFO | train_inner | epoch 079:   1342 / 1978 loss=3.036, nll_loss=0.883, word_ins=2.71, length=3.253, ppl=8.2, wps=23343.5, ups=0.39, wpb=59222.1, bsz=1952.2, num_updates=155600, lr=0.00025351, gnorm=1.203, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:13:49 | INFO | train_inner | epoch 079:   1442 / 1978 loss=3.019, nll_loss=0.872, word_ins=2.7, length=3.187, ppl=8.1, wps=23514.4, ups=0.4, wpb=59509.5, bsz=2035, num_updates=155700, lr=0.000253429, gnorm=1.244, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:18:01 | INFO | train_inner | epoch 079:   1542 / 1978 loss=3.024, nll_loss=0.873, word_ins=2.701, length=3.226, ppl=8.13, wps=23599.9, ups=0.4, wpb=59583.7, bsz=1984.3, num_updates=155800, lr=0.000253347, gnorm=1.197, loss_scale=4096, train_wall=252, wall=0
2023-03-01 07:22:14 | INFO | train_inner | epoch 079:   1642 / 1978 loss=3.023, nll_loss=0.875, word_ins=2.703, length=3.199, ppl=8.13, wps=23416.5, ups=0.4, wpb=59223.4, bsz=2035.7, num_updates=155900, lr=0.000253266, gnorm=1.214, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:26:26 | INFO | train_inner | epoch 079:   1742 / 1978 loss=3.031, nll_loss=0.882, word_ins=2.709, length=3.221, ppl=8.17, wps=23443.9, ups=0.4, wpb=58962, bsz=1982.2, num_updates=156000, lr=0.000253185, gnorm=1.203, loss_scale=4096, train_wall=251, wall=0
2023-03-01 07:30:38 | INFO | train_inner | epoch 079:   1842 / 1978 loss=3.051, nll_loss=0.9, word_ins=2.725, length=3.26, ppl=8.29, wps=23457.7, ups=0.4, wpb=59128.9, bsz=1921.4, num_updates=156100, lr=0.000253104, gnorm=1.193, loss_scale=4096, train_wall=252, wall=0
2023-03-01 07:34:51 | INFO | train_inner | epoch 079:   1942 / 1978 loss=3.028, nll_loss=0.878, word_ins=2.706, length=3.219, ppl=8.16, wps=23440.2, ups=0.39, wpb=59354.5, bsz=2005.4, num_updates=156200, lr=0.000253023, gnorm=1.246, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:36:24 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 07:36:41 | INFO | valid | epoch 079 | valid on 'valid' subset | loss 4.064 | nll_loss 1.923 | word_ins 3.693 | length 3.706 | ppl 16.72 | wps 26434.2 | wpb 40242.5 | bsz 1500 | num_updates 156236 | best_loss 4.063
2023-03-01 07:36:41 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 07:36:47 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint79.pt (epoch 79 @ 156236 updates, score 4.064) (writing took 6.069425983354449 seconds)
2023-03-01 07:36:47 | INFO | fairseq_cli.train | end of epoch 79 (average epoch stats below)
2023-03-01 07:36:47 | INFO | train | epoch 079 | loss 3.027 | nll_loss 0.879 | word_ins 2.706 | length 3.211 | ppl 8.15 | wps 23230.8 | ups 0.39 | wpb 59284.3 | bsz 2002.6 | num_updates 156236 | lr 0.000252994 | gnorm 1.217 | loss_scale 4096 | train_wall 5003 | wall 0
2023-03-01 07:36:47 | INFO | fairseq.trainer | begin training epoch 80
2023-03-01 07:39:40 | INFO | train_inner | epoch 080:     64 / 1978 loss=3.026, nll_loss=0.879, word_ins=2.707, length=3.197, ppl=8.15, wps=20351.1, ups=0.35, wpb=58700.7, bsz=2028.6, num_updates=156300, lr=0.000252942, gnorm=1.232, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:43:53 | INFO | train_inner | epoch 080:    164 / 1978 loss=3.004, nll_loss=0.86, word_ins=2.689, length=3.153, ppl=8.02, wps=23490.1, ups=0.39, wpb=59576.7, bsz=2005.5, num_updates=156400, lr=0.000252861, gnorm=1.172, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:48:07 | INFO | train_inner | epoch 080:    264 / 1978 loss=3.02, nll_loss=0.871, word_ins=2.699, length=3.203, ppl=8.11, wps=23426.4, ups=0.39, wpb=59369.1, bsz=1951.3, num_updates=156500, lr=0.00025278, gnorm=1.247, loss_scale=4096, train_wall=253, wall=0
2023-03-01 07:52:21 | INFO | train_inner | epoch 080:    364 / 1978 loss=3.024, nll_loss=0.876, word_ins=2.704, length=3.197, ppl=8.13, wps=23435.1, ups=0.39, wpb=59667.6, bsz=1991.8, num_updates=156600, lr=0.000252699, gnorm=1.253, loss_scale=4096, train_wall=254, wall=0
2023-03-01 07:56:33 | INFO | train_inner | epoch 080:    464 / 1978 loss=3.036, nll_loss=0.883, word_ins=2.711, length=3.246, ppl=8.2, wps=23442, ups=0.4, wpb=59030, bsz=1921.8, num_updates=156700, lr=0.000252619, gnorm=1.244, loss_scale=4096, train_wall=252, wall=0
2023-03-01 08:00:47 | INFO | train_inner | epoch 080:    564 / 1978 loss=3.012, nll_loss=0.861, word_ins=2.69, length=3.221, ppl=8.07, wps=23472.2, ups=0.39, wpb=59603.4, bsz=2048.2, num_updates=156800, lr=0.000252538, gnorm=1.245, loss_scale=4096, train_wall=254, wall=0
2023-03-01 08:05:00 | INFO | train_inner | epoch 080:    664 / 1978 loss=3.016, nll_loss=0.867, word_ins=2.695, length=3.21, ppl=8.09, wps=23566.4, ups=0.4, wpb=59620.2, bsz=1980.9, num_updates=156900, lr=0.000252458, gnorm=1.204, loss_scale=4096, train_wall=253, wall=0
2023-03-01 08:09:12 | INFO | train_inner | epoch 080:    764 / 1978 loss=3.042, nll_loss=0.889, word_ins=2.716, length=3.26, ppl=8.23, wps=23114.8, ups=0.4, wpb=58319.6, bsz=1972.4, num_updates=157000, lr=0.000252377, gnorm=1.207, loss_scale=4096, train_wall=252, wall=0
2023-03-01 08:13:26 | INFO | train_inner | epoch 080:    864 / 1978 loss=3.032, nll_loss=0.883, word_ins=2.71, length=3.217, ppl=8.18, wps=23371.6, ups=0.39, wpb=59334.3, bsz=1958.8, num_updates=157100, lr=0.000252297, gnorm=1.245, loss_scale=4096, train_wall=254, wall=0
2023-03-01 08:17:40 | INFO | train_inner | epoch 080:    964 / 1978 loss=3.021, nll_loss=0.867, word_ins=2.696, length=3.249, ppl=8.12, wps=23345.8, ups=0.39, wpb=59166.3, bsz=2032.8, num_updates=157200, lr=0.000252217, gnorm=1.212, loss_scale=4096, train_wall=253, wall=0
2023-03-01 08:21:54 | INFO | train_inner | epoch 080:   1064 / 1978 loss=3.011, nll_loss=0.869, word_ins=2.697, length=3.136, ppl=8.06, wps=23449.4, ups=0.39, wpb=59532.9, bsz=2062, num_updates=157300, lr=0.000252136, gnorm=1.211, loss_scale=4096, train_wall=254, wall=0
2023-03-01 08:26:08 | INFO | train_inner | epoch 080:   1164 / 1978 loss=3.015, nll_loss=0.875, word_ins=2.702, length=3.126, ppl=8.08, wps=23287.4, ups=0.39, wpb=59198.5, bsz=2023.3, num_updates=157400, lr=0.000252056, gnorm=1.211, loss_scale=4096, train_wall=254, wall=0
2023-03-01 08:30:21 | INFO | train_inner | epoch 080:   1264 / 1978 loss=3.048, nll_loss=0.899, word_ins=2.724, length=3.237, ppl=8.27, wps=23313.2, ups=0.39, wpb=59041.3, bsz=2003.9, num_updates=157500, lr=0.000251976, gnorm=1.258, loss_scale=4096, train_wall=253, wall=0
2023-03-01 08:34:33 | INFO | train_inner | epoch 080:   1364 / 1978 loss=3.054, nll_loss=0.901, word_ins=2.727, length=3.273, ppl=8.3, wps=23365.5, ups=0.4, wpb=58970.7, bsz=1931, num_updates=157600, lr=0.000251896, gnorm=1.215, loss_scale=4096, train_wall=252, wall=0
2023-03-01 08:38:47 | INFO | train_inner | epoch 080:   1464 / 1978 loss=3.027, nll_loss=0.879, word_ins=2.707, length=3.207, ppl=8.15, wps=23406.3, ups=0.4, wpb=59238.8, bsz=2003.8, num_updates=157700, lr=0.000251816, gnorm=1.137, loss_scale=8192, train_wall=253, wall=0
2023-03-01 08:43:01 | INFO | train_inner | epoch 080:   1564 / 1978 loss=3.004, nll_loss=0.858, word_ins=2.686, length=3.17, ppl=8.02, wps=23329.1, ups=0.39, wpb=59296.9, bsz=2021.4, num_updates=157800, lr=0.000251737, gnorm=1.188, loss_scale=8192, train_wall=254, wall=0
2023-03-01 08:47:14 | INFO | train_inner | epoch 080:   1664 / 1978 loss=3.017, nll_loss=0.87, word_ins=2.698, length=3.197, ppl=8.1, wps=23422.5, ups=0.39, wpb=59412.4, bsz=2060.6, num_updates=157900, lr=0.000251657, gnorm=1.246, loss_scale=8192, train_wall=253, wall=0
2023-03-01 08:51:28 | INFO | train_inner | epoch 080:   1764 / 1978 loss=3.017, nll_loss=0.87, word_ins=2.698, length=3.186, ppl=8.09, wps=23394.6, ups=0.39, wpb=59321.9, bsz=2048.6, num_updates=158000, lr=0.000251577, gnorm=1.193, loss_scale=8192, train_wall=253, wall=0
2023-03-01 08:55:40 | INFO | train_inner | epoch 080:   1864 / 1978 loss=3.031, nll_loss=0.878, word_ins=2.706, length=3.25, ppl=8.17, wps=23505.2, ups=0.4, wpb=59259.6, bsz=1987, num_updates=158100, lr=0.000251498, gnorm=1.268, loss_scale=8192, train_wall=252, wall=0
2023-03-01 08:59:53 | INFO | train_inner | epoch 080:   1964 / 1978 loss=3.014, nll_loss=0.867, word_ins=2.695, length=3.195, ppl=8.08, wps=23673.7, ups=0.39, wpb=59952.2, bsz=2040.4, num_updates=158200, lr=0.000251418, gnorm=1.201, loss_scale=8192, train_wall=253, wall=0
2023-03-01 09:00:29 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 09:00:46 | INFO | valid | epoch 080 | valid on 'valid' subset | loss 4.1 | nll_loss 1.93 | word_ins 3.697 | length 4.033 | ppl 17.15 | wps 13749.4 | wpb 40242.5 | bsz 1500 | num_updates 158214 | best_loss 4.063
2023-03-01 09:00:46 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 09:00:55 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint80.pt (epoch 80 @ 158214 updates, score 4.1) (writing took 8.925402242690325 seconds)
2023-03-01 09:00:55 | INFO | fairseq_cli.train | end of epoch 80 (average epoch stats below)
2023-03-01 09:00:55 | INFO | train | epoch 080 | loss 3.024 | nll_loss 0.875 | word_ins 2.703 | length 3.207 | ppl 8.13 | wps 23229 | ups 0.39 | wpb 59284.3 | bsz 2002.6 | num_updates 158214 | lr 0.000251407 | gnorm 1.22 | loss_scale 8192 | train_wall 5004 | wall 0
2023-03-01 09:00:55 | INFO | fairseq.trainer | begin training epoch 81
2023-03-01 09:04:52 | INFO | train_inner | epoch 081:     86 / 1978 loss=3.015, nll_loss=0.865, word_ins=2.694, length=3.209, ppl=8.08, wps=19781.4, ups=0.34, wpb=59033.7, bsz=1994.5, num_updates=158300, lr=0.000251339, gnorm=1.194, loss_scale=8192, train_wall=252, wall=0
2023-03-01 09:09:04 | INFO | train_inner | epoch 081:    186 / 1978 loss=3.017, nll_loss=0.869, word_ins=2.697, length=3.202, ppl=8.1, wps=23323.8, ups=0.4, wpb=58860.2, bsz=2021, num_updates=158400, lr=0.000251259, gnorm=1.229, loss_scale=8192, train_wall=252, wall=0
2023-03-01 09:13:18 | INFO | train_inner | epoch 081:    286 / 1978 loss=3.005, nll_loss=0.862, word_ins=2.691, length=3.139, ppl=8.03, wps=23489.5, ups=0.39, wpb=59736.5, bsz=2045.4, num_updates=158500, lr=0.00025118, gnorm=1.249, loss_scale=8192, train_wall=254, wall=0
2023-03-01 09:17:32 | INFO | train_inner | epoch 081:    386 / 1978 loss=3.005, nll_loss=0.861, word_ins=2.69, length=3.151, ppl=8.03, wps=23467.5, ups=0.39, wpb=59498.2, bsz=2034.2, num_updates=158600, lr=0.000251101, gnorm=1.198, loss_scale=8192, train_wall=253, wall=0
2023-03-01 09:21:44 | INFO | train_inner | epoch 081:    486 / 1978 loss=3.009, nll_loss=0.868, word_ins=2.697, length=3.119, ppl=8.05, wps=23397.7, ups=0.4, wpb=58905.1, bsz=2081.4, num_updates=158700, lr=0.000251022, gnorm=1.242, loss_scale=8192, train_wall=252, wall=0
2023-03-01 09:25:50 | INFO | train_inner | epoch 081:    586 / 1978 loss=3.05, nll_loss=0.896, word_ins=2.723, length=3.271, ppl=8.28, wps=24064.3, ups=0.41, wpb=59277, bsz=1888.3, num_updates=158800, lr=0.000250943, gnorm=1.234, loss_scale=8192, train_wall=246, wall=0
2023-03-01 09:29:57 | INFO | train_inner | epoch 081:    686 / 1978 loss=3.03, nll_loss=0.876, word_ins=2.704, length=3.26, ppl=8.17, wps=23892.3, ups=0.4, wpb=59040.8, bsz=1988.6, num_updates=158900, lr=0.000250864, gnorm=1.276, loss_scale=8192, train_wall=247, wall=0
2023-03-01 09:34:03 | INFO | train_inner | epoch 081:    786 / 1978 loss=3.003, nll_loss=0.857, word_ins=2.686, length=3.166, ppl=8.02, wps=24190.8, ups=0.41, wpb=59569.1, bsz=2016.5, num_updates=159000, lr=0.000250785, gnorm=1.247, loss_scale=8192, train_wall=246, wall=0
2023-03-01 09:37:58 | INFO | train_inner | epoch 081:    886 / 1978 loss=3.033, nll_loss=0.88, word_ins=2.707, length=3.255, ppl=8.18, wps=25328.3, ups=0.43, wpb=59410.3, bsz=1963, num_updates=159100, lr=0.000250706, gnorm=1.251, loss_scale=8192, train_wall=234, wall=0
2023-03-01 09:42:21 | INFO | train_inner | epoch 081:    986 / 1978 loss=3.027, nll_loss=0.881, word_ins=2.708, length=3.19, ppl=8.15, wps=22390.6, ups=0.38, wpb=58911.1, bsz=1993.6, num_updates=159200, lr=0.000250627, gnorm=1.209, loss_scale=8192, train_wall=263, wall=0
2023-03-01 09:46:19 | INFO | train_inner | epoch 081:   1086 / 1978 loss=3.038, nll_loss=0.89, word_ins=2.716, length=3.215, ppl=8.21, wps=24906, ups=0.42, wpb=59281.8, bsz=2007.8, num_updates=159300, lr=0.000250549, gnorm=1.224, loss_scale=8192, train_wall=238, wall=0
2023-03-01 09:50:18 | INFO | train_inner | epoch 081:   1186 / 1978 loss=3.021, nll_loss=0.87, word_ins=2.698, length=3.23, ppl=8.12, wps=24789.6, ups=0.42, wpb=59200.8, bsz=2046.1, num_updates=159400, lr=0.00025047, gnorm=1.182, loss_scale=8192, train_wall=239, wall=0
2023-03-01 09:54:14 | INFO | train_inner | epoch 081:   1286 / 1978 loss=3.014, nll_loss=0.867, word_ins=2.695, length=3.182, ppl=8.08, wps=25120.8, ups=0.42, wpb=59351.7, bsz=1974.5, num_updates=159500, lr=0.000250392, gnorm=1.201, loss_scale=8192, train_wall=236, wall=0
2023-03-01 09:58:06 | INFO | train_inner | epoch 081:   1386 / 1978 loss=3.014, nll_loss=0.867, word_ins=2.695, length=3.189, ppl=8.08, wps=25633.2, ups=0.43, wpb=59407, bsz=1989.2, num_updates=159600, lr=0.000250313, gnorm=1.238, loss_scale=8192, train_wall=232, wall=0
2023-03-01 10:01:58 | INFO | train_inner | epoch 081:   1486 / 1978 loss=3.03, nll_loss=0.88, word_ins=2.707, length=3.228, ppl=8.17, wps=25513, ups=0.43, wpb=59262.1, bsz=1988.6, num_updates=159700, lr=0.000250235, gnorm=1.242, loss_scale=8192, train_wall=232, wall=0
2023-03-01 10:05:52 | INFO | train_inner | epoch 081:   1586 / 1978 loss=3.043, nll_loss=0.895, word_ins=2.721, length=3.222, ppl=8.24, wps=25293.5, ups=0.43, wpb=59116.7, bsz=1941.7, num_updates=159800, lr=0.000250156, gnorm=1.245, loss_scale=8192, train_wall=234, wall=0
2023-03-01 10:09:56 | INFO | train_inner | epoch 081:   1686 / 1978 loss=3.035, nll_loss=0.886, word_ins=2.713, length=3.224, ppl=8.2, wps=24241.7, ups=0.41, wpb=59126.1, bsz=1965, num_updates=159900, lr=0.000250078, gnorm=1.223, loss_scale=8192, train_wall=244, wall=0
2023-03-01 10:14:18 | INFO | train_inner | epoch 081:   1786 / 1978 loss=3.007, nll_loss=0.867, word_ins=2.695, length=3.123, ppl=8.04, wps=22785.6, ups=0.38, wpb=59734.9, bsz=2037.1, num_updates=160000, lr=0.00025, gnorm=1.187, loss_scale=8192, train_wall=262, wall=0
2023-03-01 10:18:52 | INFO | train_inner | epoch 081:   1886 / 1978 loss=3.007, nll_loss=0.862, word_ins=2.691, length=3.166, ppl=8.04, wps=21799.6, ups=0.37, wpb=59643.9, bsz=2061.8, num_updates=160100, lr=0.000249922, gnorm=1.189, loss_scale=8192, train_wall=273, wall=0
2023-03-01 10:22:41 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 10:23:08 | INFO | valid | epoch 081 | valid on 'valid' subset | loss 4.073 | nll_loss 1.916 | word_ins 3.683 | length 3.903 | ppl 16.83 | wps 31602.3 | wpb 40242.5 | bsz 1500 | num_updates 160192 | best_loss 4.063
2023-03-01 10:23:08 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 10:23:26 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint81.pt (epoch 81 @ 160192 updates, score 4.073) (writing took 17.944599232636392 seconds)
2023-03-01 10:23:26 | INFO | fairseq_cli.train | end of epoch 81 (average epoch stats below)
2023-03-01 10:23:26 | INFO | train | epoch 081 | loss 3.021 | nll_loss 0.873 | word_ins 2.701 | length 3.199 | ppl 8.12 | wps 23683.9 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 160192 | lr 0.00024985 | gnorm 1.222 | loss_scale 8192 | train_wall 4882 | wall 0
2023-03-01 10:23:26 | INFO | fairseq.trainer | begin training epoch 82
2023-03-01 10:24:06 | INFO | train_inner | epoch 082:      8 / 1978 loss=3.012, nll_loss=0.864, word_ins=2.692, length=3.2, ppl=8.07, wps=18851.9, ups=0.32, wpb=59295.8, bsz=2033.6, num_updates=160200, lr=0.000249844, gnorm=1.154, loss_scale=8192, train_wall=248, wall=0
2023-03-01 10:28:30 | INFO | train_inner | epoch 082:    108 / 1978 loss=3.014, nll_loss=0.863, word_ins=2.692, length=3.211, ppl=8.08, wps=22437.6, ups=0.38, wpb=59094.2, bsz=1957.3, num_updates=160300, lr=0.000249766, gnorm=1.25, loss_scale=8192, train_wall=263, wall=0
2023-03-01 10:32:46 | INFO | train_inner | epoch 082:    208 / 1978 loss=3.015, nll_loss=0.872, word_ins=2.701, length=3.143, ppl=8.09, wps=23025.8, ups=0.39, wpb=58974.8, bsz=2000.9, num_updates=160400, lr=0.000249688, gnorm=1.152, loss_scale=8192, train_wall=256, wall=0
2023-03-01 10:37:08 | INFO | train_inner | epoch 082:    308 / 1978 loss=3.003, nll_loss=0.859, word_ins=2.688, length=3.148, ppl=8.02, wps=22840.2, ups=0.38, wpb=59818.7, bsz=2008.8, num_updates=160500, lr=0.00024961, gnorm=1.226, loss_scale=8192, train_wall=262, wall=0
2023-03-01 10:41:34 | INFO | train_inner | epoch 082:    408 / 1978 loss=3.02, nll_loss=0.869, word_ins=2.697, length=3.226, ppl=8.11, wps=22137.5, ups=0.38, wpb=58998.4, bsz=2037.7, num_updates=160600, lr=0.000249533, gnorm=1.224, loss_scale=8192, train_wall=266, wall=0
2023-03-01 10:45:38 | INFO | train_inner | epoch 082:    508 / 1978 loss=3.02, nll_loss=0.869, word_ins=2.697, length=3.225, ppl=8.11, wps=24405.7, ups=0.41, wpb=59528.5, bsz=1934.7, num_updates=160700, lr=0.000249455, gnorm=1.223, loss_scale=8192, train_wall=244, wall=0
2023-03-01 10:49:47 | INFO | train_inner | epoch 082:    608 / 1978 loss=3.016, nll_loss=0.87, word_ins=2.698, length=3.183, ppl=8.09, wps=23857.5, ups=0.4, wpb=59377.7, bsz=2040.4, num_updates=160800, lr=0.000249377, gnorm=1.176, loss_scale=8192, train_wall=249, wall=0
2023-03-01 10:53:52 | INFO | train_inner | epoch 082:    708 / 1978 loss=3.015, nll_loss=0.869, word_ins=2.698, length=3.173, ppl=8.08, wps=24117.6, ups=0.41, wpb=59033.7, bsz=2065, num_updates=160900, lr=0.0002493, gnorm=1.204, loss_scale=8192, train_wall=245, wall=0
2023-03-01 10:58:21 | INFO | train_inner | epoch 082:    808 / 1978 loss=3.005, nll_loss=0.859, word_ins=2.688, length=3.178, ppl=8.03, wps=22143.6, ups=0.37, wpb=59542.1, bsz=2028.9, num_updates=161000, lr=0.000249222, gnorm=1.202, loss_scale=8192, train_wall=269, wall=0
2023-03-01 11:02:22 | INFO | train_inner | epoch 082:    908 / 1978 loss=3.023, nll_loss=0.874, word_ins=2.703, length=3.2, ppl=8.13, wps=24438.3, ups=0.41, wpb=59067.1, bsz=2000.3, num_updates=161100, lr=0.000249145, gnorm=1.23, loss_scale=8192, train_wall=241, wall=0
2023-03-01 11:06:24 | INFO | train_inner | epoch 082:   1008 / 1978 loss=3.023, nll_loss=0.876, word_ins=2.703, length=3.192, ppl=8.13, wps=24588.6, ups=0.41, wpb=59435.9, bsz=1936.6, num_updates=161200, lr=0.000249068, gnorm=1.211, loss_scale=8192, train_wall=241, wall=0
2023-03-01 11:10:38 | INFO | train_inner | epoch 082:   1108 / 1978 loss=3.013, nll_loss=0.865, word_ins=2.693, length=3.196, ppl=8.07, wps=23328.3, ups=0.39, wpb=59183.4, bsz=1996.9, num_updates=161300, lr=0.000248991, gnorm=1.202, loss_scale=8192, train_wall=253, wall=0
2023-03-01 11:14:54 | INFO | train_inner | epoch 082:   1208 / 1978 loss=3.025, nll_loss=0.877, word_ins=2.704, length=3.214, ppl=8.14, wps=23046, ups=0.39, wpb=58962.6, bsz=2043.8, num_updates=161400, lr=0.000248913, gnorm=1.201, loss_scale=8192, train_wall=256, wall=0
2023-03-01 11:20:47 | INFO | train_inner | epoch 082:   1308 / 1978 loss=3.008, nll_loss=0.861, word_ins=2.69, length=3.177, ppl=8.04, wps=16807.8, ups=0.28, wpb=59364.2, bsz=1991.1, num_updates=161500, lr=0.000248836, gnorm=1.207, loss_scale=8192, train_wall=353, wall=0
2023-03-01 11:26:42 | INFO | train_inner | epoch 082:   1408 / 1978 loss=3.024, nll_loss=0.875, word_ins=2.702, length=3.222, ppl=8.13, wps=16804.7, ups=0.28, wpb=59688.7, bsz=1965.8, num_updates=161600, lr=0.000248759, gnorm=1.222, loss_scale=8192, train_wall=355, wall=0
2023-03-01 11:32:37 | INFO | train_inner | epoch 082:   1508 / 1978 loss=3.016, nll_loss=0.87, word_ins=2.698, length=3.181, ppl=8.09, wps=16662.7, ups=0.28, wpb=59187.2, bsz=2031.3, num_updates=161700, lr=0.000248682, gnorm=1.2, loss_scale=8192, train_wall=355, wall=0
2023-03-01 11:37:32 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-01 11:38:35 | INFO | train_inner | epoch 082:   1609 / 1978 loss=3.036, nll_loss=0.885, word_ins=2.712, length=3.246, ppl=8.2, wps=16562.7, ups=0.28, wpb=59290.3, bsz=1943.3, num_updates=161800, lr=0.000248606, gnorm=1.224, loss_scale=8192, train_wall=357, wall=0
2023-03-01 11:44:26 | INFO | train_inner | epoch 082:   1709 / 1978 loss=3.081, nll_loss=0.927, word_ins=2.75, length=3.319, ppl=8.46, wps=16812.5, ups=0.29, wpb=58941.5, bsz=1856.8, num_updates=161900, lr=0.000248529, gnorm=1.304, loss_scale=8192, train_wall=350, wall=0
2023-03-01 11:50:21 | INFO | train_inner | epoch 082:   1809 / 1978 loss=3.032, nll_loss=0.879, word_ins=2.707, length=3.252, ppl=8.18, wps=16668.1, ups=0.28, wpb=59261.9, bsz=2038.7, num_updates=162000, lr=0.000248452, gnorm=1.255, loss_scale=8192, train_wall=355, wall=0
2023-03-01 11:56:19 | INFO | train_inner | epoch 082:   1909 / 1978 loss=3.01, nll_loss=0.862, word_ins=2.69, length=3.202, ppl=8.06, wps=16577, ups=0.28, wpb=59195, bsz=2117.9, num_updates=162100, lr=0.000248375, gnorm=1.23, loss_scale=8192, train_wall=357, wall=0
2023-03-01 12:00:24 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 12:00:42 | INFO | valid | epoch 082 | valid on 'valid' subset | loss 4.058 | nll_loss 1.905 | word_ins 3.674 | length 3.836 | ppl 16.65 | wps 28581.1 | wpb 40242.5 | bsz 1500 | num_updates 162169 | best_loss 4.058
2023-03-01 12:00:42 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 12:00:56 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint82.pt (epoch 82 @ 162169 updates, score 4.058) (writing took 14.498423370532691 seconds)
2023-03-01 12:00:56 | INFO | fairseq_cli.train | end of epoch 82 (average epoch stats below)
2023-03-01 12:00:56 | INFO | train | epoch 082 | loss 3.02 | nll_loss 0.872 | word_ins 2.7 | length 3.202 | ppl 8.11 | wps 20035.7 | ups 0.34 | wpb 59284.7 | bsz 2002.7 | num_updates 162169 | lr 0.000248323 | gnorm 1.215 | loss_scale 8192 | train_wall 5788 | wall 0
2023-03-01 12:00:56 | INFO | fairseq.trainer | begin training epoch 83
2023-03-01 12:03:01 | INFO | train_inner | epoch 083:     31 / 1978 loss=3.001, nll_loss=0.854, word_ins=2.683, length=3.176, ppl=8, wps=14762.1, ups=0.25, wpb=59396.8, bsz=2039.8, num_updates=162200, lr=0.000248299, gnorm=1.186, loss_scale=8192, train_wall=355, wall=0
2023-03-01 12:08:57 | INFO | train_inner | epoch 083:    131 / 1978 loss=3.004, nll_loss=0.859, word_ins=2.688, length=3.161, ppl=8.02, wps=16673.8, ups=0.28, wpb=59432, bsz=2023.4, num_updates=162300, lr=0.000248222, gnorm=1.222, loss_scale=8192, train_wall=356, wall=0
2023-03-01 12:14:51 | INFO | train_inner | epoch 083:    231 / 1978 loss=3.011, nll_loss=0.865, word_ins=2.694, length=3.173, ppl=8.06, wps=16806.1, ups=0.28, wpb=59433.3, bsz=2002.5, num_updates=162400, lr=0.000248146, gnorm=1.206, loss_scale=8192, train_wall=353, wall=0
2023-03-01 12:20:44 | INFO | train_inner | epoch 083:    331 / 1978 loss=3.01, nll_loss=0.864, word_ins=2.692, length=3.171, ppl=8.05, wps=16844.5, ups=0.28, wpb=59514.6, bsz=2018.3, num_updates=162500, lr=0.000248069, gnorm=1.174, loss_scale=8192, train_wall=353, wall=0
2023-03-01 12:26:38 | INFO | train_inner | epoch 083:    431 / 1978 loss=3.035, nll_loss=0.884, word_ins=2.711, length=3.241, ppl=8.2, wps=16744.4, ups=0.28, wpb=59195.6, bsz=1939.2, num_updates=162600, lr=0.000247993, gnorm=1.205, loss_scale=8192, train_wall=353, wall=0
2023-03-01 12:32:36 | INFO | train_inner | epoch 083:    531 / 1978 loss=3.018, nll_loss=0.868, word_ins=2.696, length=3.221, ppl=8.1, wps=16666.6, ups=0.28, wpb=59582.6, bsz=1995, num_updates=162700, lr=0.000247917, gnorm=1.293, loss_scale=8192, train_wall=357, wall=0
2023-03-01 12:38:32 | INFO | train_inner | epoch 083:    631 / 1978 loss=3, nll_loss=0.854, word_ins=2.684, length=3.167, ppl=8, wps=16614.2, ups=0.28, wpb=59179.6, bsz=2077.4, num_updates=162800, lr=0.000247841, gnorm=1.194, loss_scale=8192, train_wall=356, wall=0
2023-03-01 12:44:27 | INFO | train_inner | epoch 083:    731 / 1978 loss=3.02, nll_loss=0.87, word_ins=2.698, length=3.218, ppl=8.11, wps=16737.1, ups=0.28, wpb=59425, bsz=1919.6, num_updates=162900, lr=0.000247765, gnorm=1.2, loss_scale=8192, train_wall=354, wall=0
2023-03-01 12:50:21 | INFO | train_inner | epoch 083:    831 / 1978 loss=3.026, nll_loss=0.876, word_ins=2.704, length=3.215, ppl=8.14, wps=16649.6, ups=0.28, wpb=59012, bsz=1967.6, num_updates=163000, lr=0.000247689, gnorm=1.233, loss_scale=8192, train_wall=354, wall=0
2023-03-01 12:56:17 | INFO | train_inner | epoch 083:    931 / 1978 loss=2.997, nll_loss=0.853, word_ins=2.683, length=3.142, ppl=7.98, wps=16731.9, ups=0.28, wpb=59434.4, bsz=2034.3, num_updates=163100, lr=0.000247613, gnorm=1.211, loss_scale=8192, train_wall=355, wall=0
2023-03-01 13:02:13 | INFO | train_inner | epoch 083:   1031 / 1978 loss=3.024, nll_loss=0.88, word_ins=2.707, length=3.173, ppl=8.14, wps=16624, ups=0.28, wpb=59318.6, bsz=2025.8, num_updates=163200, lr=0.000247537, gnorm=1.245, loss_scale=8192, train_wall=356, wall=0
2023-03-01 13:08:07 | INFO | train_inner | epoch 083:   1131 / 1978 loss=3.03, nll_loss=0.879, word_ins=2.706, length=3.234, ppl=8.17, wps=16750.4, ups=0.28, wpb=59258.3, bsz=1974, num_updates=163300, lr=0.000247461, gnorm=1.266, loss_scale=8192, train_wall=353, wall=0
2023-03-01 13:14:03 | INFO | train_inner | epoch 083:   1231 / 1978 loss=3.011, nll_loss=0.866, word_ins=2.694, length=3.166, ppl=8.06, wps=16782.4, ups=0.28, wpb=59733.2, bsz=2001, num_updates=163400, lr=0.000247385, gnorm=1.227, loss_scale=8192, train_wall=355, wall=0
2023-03-01 13:19:56 | INFO | train_inner | epoch 083:   1331 / 1978 loss=3.03, nll_loss=0.88, word_ins=2.708, length=3.222, ppl=8.17, wps=16685.3, ups=0.28, wpb=58919, bsz=1960.2, num_updates=163500, lr=0.00024731, gnorm=1.194, loss_scale=8192, train_wall=353, wall=0
2023-03-01 13:25:52 | INFO | train_inner | epoch 083:   1431 / 1978 loss=3.019, nll_loss=0.871, word_ins=2.699, length=3.2, ppl=8.11, wps=16529.8, ups=0.28, wpb=58725.2, bsz=2087.7, num_updates=163600, lr=0.000247234, gnorm=1.216, loss_scale=8192, train_wall=355, wall=0
2023-03-01 13:31:47 | INFO | train_inner | epoch 083:   1531 / 1978 loss=3.004, nll_loss=0.859, word_ins=2.688, length=3.167, ppl=8.02, wps=16697.5, ups=0.28, wpb=59340, bsz=2041.9, num_updates=163700, lr=0.000247159, gnorm=1.162, loss_scale=8192, train_wall=355, wall=0
2023-03-01 13:37:45 | INFO | train_inner | epoch 083:   1631 / 1978 loss=2.992, nll_loss=0.847, word_ins=2.677, length=3.157, ppl=7.96, wps=16637.7, ups=0.28, wpb=59619, bsz=2154.3, num_updates=163800, lr=0.000247083, gnorm=1.221, loss_scale=8192, train_wall=358, wall=0
2023-03-01 13:43:44 | INFO | train_inner | epoch 083:   1731 / 1978 loss=3.026, nll_loss=0.881, word_ins=2.708, length=3.186, ppl=8.15, wps=16585.5, ups=0.28, wpb=59524.4, bsz=1925, num_updates=163900, lr=0.000247008, gnorm=1.232, loss_scale=8192, train_wall=358, wall=0
2023-03-01 13:49:39 | INFO | train_inner | epoch 083:   1831 / 1978 loss=3.032, nll_loss=0.881, word_ins=2.707, length=3.243, ppl=8.18, wps=16599.3, ups=0.28, wpb=58864.9, bsz=1965.1, num_updates=164000, lr=0.000246932, gnorm=1.229, loss_scale=8192, train_wall=354, wall=0
2023-03-01 13:55:34 | INFO | train_inner | epoch 083:   1931 / 1978 loss=3.008, nll_loss=0.861, word_ins=2.689, length=3.189, ppl=8.04, wps=16658, ups=0.28, wpb=59202.7, bsz=1997.3, num_updates=164100, lr=0.000246857, gnorm=1.19, loss_scale=8192, train_wall=355, wall=0
2023-03-01 13:58:19 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 13:58:35 | INFO | valid | epoch 083 | valid on 'valid' subset | loss 4.08 | nll_loss 1.918 | word_ins 3.687 | length 3.939 | ppl 16.92 | wps 27376.2 | wpb 40242.5 | bsz 1500 | num_updates 164147 | best_loss 4.058
2023-03-01 13:58:35 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 13:58:45 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint83.pt (epoch 83 @ 164147 updates, score 4.08) (writing took 10.07329572737217 seconds)
2023-03-01 13:58:45 | INFO | fairseq_cli.train | end of epoch 83 (average epoch stats below)
2023-03-01 13:58:45 | INFO | train | epoch 083 | loss 3.017 | nll_loss 0.869 | word_ins 2.697 | length 3.194 | ppl 8.09 | wps 16587.6 | ups 0.28 | wpb 59284.3 | bsz 2002.6 | num_updates 164147 | lr 0.000246822 | gnorm 1.219 | loss_scale 8192 | train_wall 7018 | wall 0
2023-03-01 13:58:45 | INFO | fairseq.trainer | begin training epoch 84
2023-03-01 14:02:02 | INFO | train_inner | epoch 084:     53 / 1978 loss=3.067, nll_loss=0.913, word_ins=2.738, length=3.289, ppl=8.38, wps=15183.9, ups=0.26, wpb=58904.4, bsz=1876.2, num_updates=164200, lr=0.000246782, gnorm=1.262, loss_scale=8192, train_wall=351, wall=0
2023-03-01 14:07:58 | INFO | train_inner | epoch 084:    153 / 1978 loss=3.015, nll_loss=0.869, word_ins=2.698, length=3.17, ppl=8.08, wps=16587.5, ups=0.28, wpb=58931.1, bsz=2016.1, num_updates=164300, lr=0.000246707, gnorm=1.189, loss_scale=8192, train_wall=355, wall=0
2023-03-01 14:13:53 | INFO | train_inner | epoch 084:    253 / 1978 loss=2.993, nll_loss=0.847, word_ins=2.677, length=3.159, ppl=7.96, wps=16636, ups=0.28, wpb=59108.1, bsz=2117.4, num_updates=164400, lr=0.000246632, gnorm=1.183, loss_scale=8192, train_wall=355, wall=0
2023-03-01 14:19:50 | INFO | train_inner | epoch 084:    353 / 1978 loss=2.992, nll_loss=0.848, word_ins=2.678, length=3.143, ppl=7.96, wps=16699.2, ups=0.28, wpb=59655.2, bsz=2041.7, num_updates=164500, lr=0.000246557, gnorm=1.233, loss_scale=8192, train_wall=357, wall=0
2023-03-01 14:25:41 | INFO | train_inner | epoch 084:    453 / 1978 loss=3.017, nll_loss=0.867, word_ins=2.695, length=3.217, ppl=8.09, wps=16782.8, ups=0.28, wpb=58928.8, bsz=1953, num_updates=164600, lr=0.000246482, gnorm=1.17, loss_scale=8192, train_wall=351, wall=0
2023-03-01 14:31:35 | INFO | train_inner | epoch 084:    553 / 1978 loss=3.048, nll_loss=0.899, word_ins=2.724, length=3.234, ppl=8.27, wps=16773, ups=0.28, wpb=59295.8, bsz=1905, num_updates=164700, lr=0.000246407, gnorm=1.247, loss_scale=8192, train_wall=353, wall=0
2023-03-01 14:37:30 | INFO | train_inner | epoch 084:    653 / 1978 loss=3.001, nll_loss=0.861, word_ins=2.689, length=3.121, ppl=8.01, wps=16802.6, ups=0.28, wpb=59590.1, bsz=2072.5, num_updates=164800, lr=0.000246332, gnorm=1.216, loss_scale=8192, train_wall=354, wall=0
2023-03-01 14:43:24 | INFO | train_inner | epoch 084:    753 / 1978 loss=3.003, nll_loss=0.853, word_ins=2.682, length=3.204, ppl=8.01, wps=16726.2, ups=0.28, wpb=59332.1, bsz=2022.6, num_updates=164900, lr=0.000246258, gnorm=1.255, loss_scale=8192, train_wall=354, wall=0
2023-03-01 14:49:21 | INFO | train_inner | epoch 084:    853 / 1978 loss=3.008, nll_loss=0.86, word_ins=2.69, length=3.184, ppl=8.04, wps=16608.7, ups=0.28, wpb=59166.2, bsz=2024.9, num_updates=165000, lr=0.000246183, gnorm=1.226, loss_scale=8192, train_wall=356, wall=0
2023-03-01 14:55:13 | INFO | train_inner | epoch 084:    953 / 1978 loss=3.014, nll_loss=0.867, word_ins=2.695, length=3.185, ppl=8.08, wps=16945.2, ups=0.28, wpb=59681.6, bsz=1951.4, num_updates=165100, lr=0.000246108, gnorm=1.21, loss_scale=8192, train_wall=352, wall=0
2023-03-01 15:01:05 | INFO | train_inner | epoch 084:   1053 / 1978 loss=3.03, nll_loss=0.886, word_ins=2.712, length=3.172, ppl=8.17, wps=16793.4, ups=0.28, wpb=59128.8, bsz=1949.8, num_updates=165200, lr=0.000246034, gnorm=1.23, loss_scale=8192, train_wall=352, wall=0
2023-03-01 15:07:01 | INFO | train_inner | epoch 084:   1153 / 1978 loss=3.003, nll_loss=0.854, word_ins=2.684, length=3.196, ppl=8.02, wps=16734.1, ups=0.28, wpb=59512.5, bsz=1993.2, num_updates=165300, lr=0.000245959, gnorm=1.172, loss_scale=8192, train_wall=355, wall=0
2023-03-01 15:12:56 | INFO | train_inner | epoch 084:   1253 / 1978 loss=3.016, nll_loss=0.868, word_ins=2.697, length=3.196, ppl=8.09, wps=16585.1, ups=0.28, wpb=58912.6, bsz=1992.1, num_updates=165400, lr=0.000245885, gnorm=1.182, loss_scale=8192, train_wall=355, wall=0
2023-03-01 15:18:50 | INFO | train_inner | epoch 084:   1353 / 1978 loss=3.012, nll_loss=0.864, word_ins=2.693, length=3.191, ppl=8.07, wps=16775, ups=0.28, wpb=59415, bsz=2046.3, num_updates=165500, lr=0.000245811, gnorm=1.193, loss_scale=8192, train_wall=354, wall=0
2023-03-01 15:24:45 | INFO | train_inner | epoch 084:   1453 / 1978 loss=3.001, nll_loss=0.856, word_ins=2.685, length=3.165, ppl=8.01, wps=16751.7, ups=0.28, wpb=59447, bsz=2021.4, num_updates=165600, lr=0.000245737, gnorm=1.165, loss_scale=8192, train_wall=354, wall=0
2023-03-01 15:29:00 | INFO | train_inner | epoch 084:   1553 / 1978 loss=3.006, nll_loss=0.861, word_ins=2.69, length=3.158, ppl=8.03, wps=23354.1, ups=0.39, wpb=59506.6, bsz=2021.7, num_updates=165700, lr=0.000245662, gnorm=1.197, loss_scale=8192, train_wall=255, wall=0
2023-03-01 15:32:51 | INFO | train_inner | epoch 084:   1653 / 1978 loss=3.012, nll_loss=0.867, word_ins=2.695, length=3.17, ppl=8.06, wps=25807.3, ups=0.43, wpb=59693.4, bsz=1963.5, num_updates=165800, lr=0.000245588, gnorm=1.196, loss_scale=8192, train_wall=231, wall=0
2023-03-01 15:36:43 | INFO | train_inner | epoch 084:   1753 / 1978 loss=3.042, nll_loss=0.887, word_ins=2.713, length=3.29, ppl=8.24, wps=25316.9, ups=0.43, wpb=58697.1, bsz=2033.7, num_updates=165900, lr=0.000245514, gnorm=1.216, loss_scale=16384, train_wall=232, wall=0
2023-03-01 15:38:24 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-01 15:40:39 | INFO | train_inner | epoch 084:   1854 / 1978 loss=3.003, nll_loss=0.861, word_ins=2.689, length=3.137, ppl=8.02, wps=25166.5, ups=0.42, wpb=59325.2, bsz=2011.3, num_updates=166000, lr=0.00024544, gnorm=1.171, loss_scale=8192, train_wall=236, wall=0
2023-03-01 15:44:33 | INFO | train_inner | epoch 084:   1954 / 1978 loss=3.029, nll_loss=0.874, word_ins=2.702, length=3.273, ppl=8.16, wps=25294.6, ups=0.43, wpb=59260.1, bsz=1960.2, num_updates=166100, lr=0.000245366, gnorm=1.236, loss_scale=8192, train_wall=234, wall=0
2023-03-01 15:45:30 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 15:45:49 | INFO | valid | epoch 084 | valid on 'valid' subset | loss 4.043 | nll_loss 1.932 | word_ins 3.697 | length 3.459 | ppl 16.48 | wps 31356.7 | wpb 40242.5 | bsz 1500 | num_updates 166124 | best_loss 4.043
2023-03-01 15:45:49 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 15:46:00 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint84.pt (epoch 84 @ 166124 updates, score 4.043) (writing took 11.224079558625817 seconds)
2023-03-01 15:46:00 | INFO | fairseq_cli.train | end of epoch 84 (average epoch stats below)
2023-03-01 15:46:00 | INFO | train | epoch 084 | loss 3.014 | nll_loss 0.867 | word_ins 2.695 | length 3.189 | ppl 8.08 | wps 18214.4 | ups 0.31 | wpb 59283.3 | bsz 2002.9 | num_updates 166124 | lr 0.000245349 | gnorm 1.206 | loss_scale 8192 | train_wall 6385 | wall 0
2023-03-01 15:46:00 | INFO | fairseq.trainer | begin training epoch 85
2023-03-01 15:49:11 | INFO | train_inner | epoch 085:     76 / 1978 loss=3.011, nll_loss=0.859, word_ins=2.688, length=3.231, ppl=8.06, wps=21161, ups=0.36, wpb=58854.3, bsz=1950.6, num_updates=166200, lr=0.000245293, gnorm=1.226, loss_scale=8192, train_wall=237, wall=0
2023-03-01 15:53:05 | INFO | train_inner | epoch 085:    176 / 1978 loss=3, nll_loss=0.858, word_ins=2.687, length=3.13, ppl=8, wps=25282.6, ups=0.43, wpb=59087.4, bsz=2038.2, num_updates=166300, lr=0.000245219, gnorm=1.208, loss_scale=8192, train_wall=233, wall=0
2023-03-01 15:57:03 | INFO | train_inner | epoch 085:    276 / 1978 loss=2.97, nll_loss=0.828, word_ins=2.659, length=3.113, ppl=7.84, wps=25092.6, ups=0.42, wpb=59719.4, bsz=2094.3, num_updates=166400, lr=0.000245145, gnorm=1.17, loss_scale=8192, train_wall=238, wall=0
2023-03-01 16:00:59 | INFO | train_inner | epoch 085:    376 / 1978 loss=3.005, nll_loss=0.857, word_ins=2.687, length=3.177, ppl=8.03, wps=24920.9, ups=0.42, wpb=58884.3, bsz=2030.2, num_updates=166500, lr=0.000245072, gnorm=1.216, loss_scale=8192, train_wall=236, wall=0
2023-03-01 16:04:56 | INFO | train_inner | epoch 085:    476 / 1978 loss=3.022, nll_loss=0.875, word_ins=2.703, length=3.185, ppl=8.12, wps=24805.2, ups=0.42, wpb=58805.8, bsz=1988.1, num_updates=166600, lr=0.000244998, gnorm=1.196, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:08:54 | INFO | train_inner | epoch 085:    576 / 1978 loss=3.006, nll_loss=0.862, word_ins=2.69, length=3.164, ppl=8.04, wps=24915.7, ups=0.42, wpb=59258.4, bsz=2031.4, num_updates=166700, lr=0.000244924, gnorm=1.187, loss_scale=8192, train_wall=238, wall=0
2023-03-01 16:12:50 | INFO | train_inner | epoch 085:    676 / 1978 loss=3.026, nll_loss=0.877, word_ins=2.704, length=3.223, ppl=8.14, wps=25247.9, ups=0.42, wpb=59701, bsz=1966.5, num_updates=166800, lr=0.000244851, gnorm=1.208, loss_scale=8192, train_wall=236, wall=0
2023-03-01 16:16:46 | INFO | train_inner | epoch 085:    776 / 1978 loss=3.035, nll_loss=0.891, word_ins=2.717, length=3.176, ppl=8.19, wps=25173.6, ups=0.42, wpb=59377, bsz=1946.2, num_updates=166900, lr=0.000244778, gnorm=1.282, loss_scale=8192, train_wall=236, wall=0
2023-03-01 16:20:44 | INFO | train_inner | epoch 085:    876 / 1978 loss=3.018, nll_loss=0.868, word_ins=2.696, length=3.218, ppl=8.1, wps=24843.7, ups=0.42, wpb=58972.8, bsz=2013, num_updates=167000, lr=0.000244704, gnorm=1.248, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:24:42 | INFO | train_inner | epoch 085:    976 / 1978 loss=3.035, nll_loss=0.889, word_ins=2.715, length=3.206, ppl=8.2, wps=25007.7, ups=0.42, wpb=59658.9, bsz=1933, num_updates=167100, lr=0.000244631, gnorm=1.284, loss_scale=8192, train_wall=238, wall=0
2023-03-01 16:28:40 | INFO | train_inner | epoch 085:   1076 / 1978 loss=3.004, nll_loss=0.857, word_ins=2.686, length=3.185, ppl=8.02, wps=24915.5, ups=0.42, wpb=59233.5, bsz=2012.6, num_updates=167200, lr=0.000244558, gnorm=1.191, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:32:37 | INFO | train_inner | epoch 085:   1176 / 1978 loss=3.017, nll_loss=0.868, word_ins=2.696, length=3.21, ppl=8.1, wps=25003.8, ups=0.42, wpb=59233.5, bsz=1981, num_updates=167300, lr=0.000244485, gnorm=1.243, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:36:35 | INFO | train_inner | epoch 085:   1276 / 1978 loss=3.006, nll_loss=0.86, word_ins=2.689, length=3.178, ppl=8.04, wps=24853, ups=0.42, wpb=59153.7, bsz=2079.7, num_updates=167400, lr=0.000244412, gnorm=1.178, loss_scale=8192, train_wall=238, wall=0
2023-03-01 16:40:32 | INFO | train_inner | epoch 085:   1376 / 1978 loss=3.022, nll_loss=0.87, word_ins=2.699, length=3.234, ppl=8.12, wps=24788.9, ups=0.42, wpb=58856.8, bsz=2051.2, num_updates=167500, lr=0.000244339, gnorm=1.249, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:44:30 | INFO | train_inner | epoch 085:   1476 / 1978 loss=2.996, nll_loss=0.852, word_ins=2.681, length=3.146, ppl=7.98, wps=25171.6, ups=0.42, wpb=59720.3, bsz=2013.4, num_updates=167600, lr=0.000244266, gnorm=1.183, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:48:28 | INFO | train_inner | epoch 085:   1576 / 1978 loss=2.994, nll_loss=0.85, word_ins=2.68, length=3.147, ppl=7.97, wps=25082.4, ups=0.42, wpb=59703, bsz=2031.2, num_updates=167700, lr=0.000244193, gnorm=1.169, loss_scale=8192, train_wall=238, wall=0
2023-03-01 16:52:25 | INFO | train_inner | epoch 085:   1676 / 1978 loss=2.993, nll_loss=0.849, word_ins=2.678, length=3.148, ppl=7.96, wps=25260.6, ups=0.42, wpb=59841.1, bsz=2049, num_updates=167800, lr=0.00024412, gnorm=1.231, loss_scale=8192, train_wall=237, wall=0
2023-03-01 16:56:25 | INFO | train_inner | epoch 085:   1776 / 1978 loss=3.037, nll_loss=0.887, word_ins=2.713, length=3.241, ppl=8.21, wps=24649.2, ups=0.42, wpb=59203.7, bsz=1929, num_updates=167900, lr=0.000244048, gnorm=1.218, loss_scale=8192, train_wall=240, wall=0
2023-03-01 17:00:23 | INFO | train_inner | epoch 085:   1876 / 1978 loss=3.026, nll_loss=0.874, word_ins=2.701, length=3.248, ppl=8.14, wps=24893.9, ups=0.42, wpb=59382.8, bsz=1915.7, num_updates=168000, lr=0.000243975, gnorm=1.231, loss_scale=8192, train_wall=238, wall=0
2023-03-01 17:04:18 | INFO | train_inner | epoch 085:   1976 / 1978 loss=3.006, nll_loss=0.858, word_ins=2.687, length=3.196, ppl=8.03, wps=25248.2, ups=0.43, wpb=59318.7, bsz=2036.4, num_updates=168100, lr=0.000243902, gnorm=1.199, loss_scale=8192, train_wall=235, wall=0
2023-03-01 17:04:23 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 17:04:44 | INFO | valid | epoch 085 | valid on 'valid' subset | loss 4.082 | nll_loss 1.908 | word_ins 3.68 | length 4.016 | ppl 16.93 | wps 31440.2 | wpb 40242.5 | bsz 1500 | num_updates 168102 | best_loss 4.043
2023-03-01 17:04:44 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 17:04:52 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint85.pt (epoch 85 @ 168102 updates, score 4.082) (writing took 8.040073312819004 seconds)
2023-03-01 17:04:53 | INFO | fairseq_cli.train | end of epoch 85 (average epoch stats below)
2023-03-01 17:04:53 | INFO | train | epoch 085 | loss 3.012 | nll_loss 0.865 | word_ins 2.693 | length 3.19 | ppl 8.07 | wps 24779.2 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 168102 | lr 0.000243901 | gnorm 1.216 | loss_scale 8192 | train_wall 4687 | wall 0
2023-03-01 17:04:53 | INFO | fairseq.trainer | begin training epoch 86
2023-03-01 17:08:51 | INFO | train_inner | epoch 086:     98 / 1978 loss=3.005, nll_loss=0.858, word_ins=2.688, length=3.173, ppl=8.03, wps=21622.1, ups=0.37, wpb=59018.7, bsz=1953, num_updates=168200, lr=0.00024383, gnorm=1.204, loss_scale=8192, train_wall=233, wall=0
2023-03-01 17:12:51 | INFO | train_inner | epoch 086:    198 / 1978 loss=2.985, nll_loss=0.841, word_ins=2.672, length=3.134, ppl=7.92, wps=24863.6, ups=0.42, wpb=59630.7, bsz=2080.1, num_updates=168300, lr=0.000243757, gnorm=1.161, loss_scale=8192, train_wall=240, wall=0
2023-03-01 17:16:51 | INFO | train_inner | epoch 086:    298 / 1978 loss=3.013, nll_loss=0.868, word_ins=2.696, length=3.168, ppl=8.07, wps=24534.8, ups=0.42, wpb=58963.2, bsz=1996.8, num_updates=168400, lr=0.000243685, gnorm=1.214, loss_scale=8192, train_wall=240, wall=0
2023-03-01 17:21:01 | INFO | train_inner | epoch 086:    398 / 1978 loss=2.995, nll_loss=0.852, word_ins=2.681, length=3.135, ppl=7.97, wps=23629.7, ups=0.4, wpb=59066, bsz=2019.6, num_updates=168500, lr=0.000243613, gnorm=1.194, loss_scale=8192, train_wall=250, wall=0
2023-03-01 17:25:10 | INFO | train_inner | epoch 086:    498 / 1978 loss=2.997, nll_loss=0.854, word_ins=2.683, length=3.141, ppl=7.99, wps=23954.9, ups=0.4, wpb=59636.2, bsz=1970.3, num_updates=168600, lr=0.000243541, gnorm=1.225, loss_scale=8192, train_wall=249, wall=0
2023-03-01 17:29:20 | INFO | train_inner | epoch 086:    598 / 1978 loss=3.015, nll_loss=0.868, word_ins=2.696, length=3.188, ppl=8.08, wps=23874.3, ups=0.4, wpb=59514.1, bsz=2072.2, num_updates=168700, lr=0.000243468, gnorm=1.203, loss_scale=8192, train_wall=249, wall=0
2023-03-01 17:33:32 | INFO | train_inner | epoch 086:    698 / 1978 loss=3.005, nll_loss=0.856, word_ins=2.685, length=3.194, ppl=8.03, wps=23537.8, ups=0.4, wpb=59394.8, bsz=2020.3, num_updates=168800, lr=0.000243396, gnorm=1.216, loss_scale=8192, train_wall=252, wall=0
2023-03-01 17:37:44 | INFO | train_inner | epoch 086:    798 / 1978 loss=3.011, nll_loss=0.862, word_ins=2.69, length=3.205, ppl=8.06, wps=23485, ups=0.4, wpb=59155.7, bsz=1958.6, num_updates=168900, lr=0.000243324, gnorm=1.185, loss_scale=8192, train_wall=252, wall=0
2023-03-01 17:41:56 | INFO | train_inner | epoch 086:    898 / 1978 loss=3.003, nll_loss=0.855, word_ins=2.685, length=3.188, ppl=8.02, wps=23523, ups=0.4, wpb=59213.3, bsz=1993.9, num_updates=169000, lr=0.000243252, gnorm=1.229, loss_scale=8192, train_wall=251, wall=0
2023-03-01 17:46:07 | INFO | train_inner | epoch 086:    998 / 1978 loss=3.007, nll_loss=0.864, word_ins=2.693, length=3.145, ppl=8.04, wps=23445.7, ups=0.4, wpb=59049.7, bsz=2021.8, num_updates=169100, lr=0.00024318, gnorm=1.225, loss_scale=8192, train_wall=252, wall=0
2023-03-01 17:50:22 | INFO | train_inner | epoch 086:   1098 / 1978 loss=3.02, nll_loss=0.87, word_ins=2.697, length=3.224, ppl=8.11, wps=23594.6, ups=0.4, wpb=59289.9, bsz=1956.2, num_updates=169200, lr=0.000243108, gnorm=1.25, loss_scale=8192, train_wall=251, wall=0
2023-03-01 17:54:34 | INFO | train_inner | epoch 086:   1198 / 1978 loss=3, nll_loss=0.856, word_ins=2.685, length=3.155, ppl=8, wps=23626.7, ups=0.4, wpb=59411.8, bsz=2061.6, num_updates=169300, lr=0.000243037, gnorm=1.196, loss_scale=8192, train_wall=251, wall=0
2023-03-01 17:58:46 | INFO | train_inner | epoch 086:   1298 / 1978 loss=3.013, nll_loss=0.867, word_ins=2.695, length=3.176, ppl=8.07, wps=23549.9, ups=0.4, wpb=59343.4, bsz=2023.6, num_updates=169400, lr=0.000242965, gnorm=1.196, loss_scale=8192, train_wall=252, wall=0
2023-03-01 18:02:57 | INFO | train_inner | epoch 086:   1398 / 1978 loss=3.044, nll_loss=0.89, word_ins=2.716, length=3.281, ppl=8.25, wps=23491.4, ups=0.4, wpb=59055.3, bsz=1877.6, num_updates=169500, lr=0.000242893, gnorm=1.234, loss_scale=8192, train_wall=251, wall=0
2023-03-01 18:07:11 | INFO | train_inner | epoch 086:   1498 / 1978 loss=3.018, nll_loss=0.871, word_ins=2.699, length=3.193, ppl=8.1, wps=23147.8, ups=0.39, wpb=58735.7, bsz=2016.8, num_updates=169600, lr=0.000242821, gnorm=1.155, loss_scale=8192, train_wall=253, wall=0
2023-03-01 18:11:23 | INFO | train_inner | epoch 086:   1598 / 1978 loss=3.019, nll_loss=0.87, word_ins=2.699, length=3.205, ppl=8.11, wps=23412.8, ups=0.4, wpb=59075.9, bsz=1963, num_updates=169700, lr=0.00024275, gnorm=1.186, loss_scale=8192, train_wall=252, wall=0
2023-03-01 18:15:35 | INFO | train_inner | epoch 086:   1698 / 1978 loss=3.006, nll_loss=0.86, word_ins=2.688, length=3.176, ppl=8.03, wps=23621.8, ups=0.4, wpb=59521.1, bsz=2032.2, num_updates=169800, lr=0.000242678, gnorm=1.19, loss_scale=8192, train_wall=252, wall=0
2023-03-01 18:19:39 | INFO | train_inner | epoch 086:   1798 / 1978 loss=3.011, nll_loss=0.864, word_ins=2.692, length=3.194, ppl=8.06, wps=24322.6, ups=0.41, wpb=59403.1, bsz=1959.6, num_updates=169900, lr=0.000242607, gnorm=1.223, loss_scale=8192, train_wall=244, wall=0
2023-03-01 18:23:55 | INFO | train_inner | epoch 086:   1898 / 1978 loss=2.994, nll_loss=0.851, word_ins=2.68, length=3.138, ppl=7.97, wps=23359.5, ups=0.39, wpb=59667, bsz=2045.9, num_updates=170000, lr=0.000242536, gnorm=1.205, loss_scale=8192, train_wall=255, wall=0
2023-03-01 18:26:54 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-01 18:27:15 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 18:27:33 | INFO | valid | epoch 086 | valid on 'valid' subset | loss 4.072 | nll_loss 1.911 | word_ins 3.678 | length 3.946 | ppl 16.82 | wps 25082.4 | wpb 40242.5 | bsz 1500 | num_updates 170079 | best_loss 4.043
2023-03-01 18:27:33 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 18:27:40 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint86.pt (epoch 86 @ 170079 updates, score 4.072) (writing took 6.9267854588106275 seconds)
2023-03-01 18:27:40 | INFO | fairseq_cli.train | end of epoch 86 (average epoch stats below)
2023-03-01 18:27:40 | INFO | train | epoch 086 | loss 3.008 | nll_loss 0.862 | word_ins 2.69 | length 3.179 | ppl 8.04 | wps 23595.3 | ups 0.4 | wpb 59284.4 | bsz 2002.6 | num_updates 170079 | lr 0.000242479 | gnorm 1.204 | loss_scale 8192 | train_wall 4923 | wall 0
2023-03-01 18:27:40 | INFO | fairseq.trainer | begin training epoch 87
2023-03-01 18:28:43 | INFO | train_inner | epoch 087:     21 / 1978 loss=3.002, nll_loss=0.854, word_ins=2.683, length=3.194, ppl=8.01, wps=20519.9, ups=0.35, wpb=59112.9, bsz=2008.6, num_updates=170100, lr=0.000242464, gnorm=1.172, loss_scale=8192, train_wall=250, wall=0
2023-03-01 18:32:43 | INFO | train_inner | epoch 087:    121 / 1978 loss=3.011, nll_loss=0.861, word_ins=2.69, length=3.214, ppl=8.06, wps=24670.5, ups=0.42, wpb=59211.8, bsz=1971, num_updates=170200, lr=0.000242393, gnorm=1.245, loss_scale=8192, train_wall=240, wall=0
2023-03-01 18:36:38 | INFO | train_inner | epoch 087:    221 / 1978 loss=2.998, nll_loss=0.852, word_ins=2.682, length=3.165, ppl=7.99, wps=25410.7, ups=0.43, wpb=59712.6, bsz=1974.2, num_updates=170300, lr=0.000242322, gnorm=1.214, loss_scale=8192, train_wall=235, wall=0
2023-03-01 18:40:31 | INFO | train_inner | epoch 087:    321 / 1978 loss=2.99, nll_loss=0.845, word_ins=2.675, length=3.15, ppl=7.94, wps=25598.7, ups=0.43, wpb=59749.8, bsz=1977.5, num_updates=170400, lr=0.000242251, gnorm=1.212, loss_scale=8192, train_wall=233, wall=0
2023-03-01 18:44:32 | INFO | train_inner | epoch 087:    421 / 1978 loss=3.015, nll_loss=0.868, word_ins=2.696, length=3.194, ppl=8.08, wps=24647.7, ups=0.42, wpb=59299.9, bsz=1942.7, num_updates=170500, lr=0.00024218, gnorm=1.221, loss_scale=8192, train_wall=240, wall=0
2023-03-01 18:48:36 | INFO | train_inner | epoch 087:    521 / 1978 loss=3.037, nll_loss=0.892, word_ins=2.718, length=3.19, ppl=8.21, wps=24287.5, ups=0.41, wpb=59245.3, bsz=1876.9, num_updates=170600, lr=0.000242109, gnorm=1.252, loss_scale=8192, train_wall=244, wall=0
2023-03-01 18:52:44 | INFO | train_inner | epoch 087:    621 / 1978 loss=2.993, nll_loss=0.847, word_ins=2.676, length=3.167, ppl=7.96, wps=24011.8, ups=0.4, wpb=59593.9, bsz=2068.7, num_updates=170700, lr=0.000242038, gnorm=1.188, loss_scale=8192, train_wall=248, wall=0
2023-03-01 18:56:56 | INFO | train_inner | epoch 087:    721 / 1978 loss=3.008, nll_loss=0.862, word_ins=2.691, length=3.17, ppl=8.04, wps=23519.3, ups=0.4, wpb=59133, bsz=2033, num_updates=170800, lr=0.000241967, gnorm=1.217, loss_scale=8192, train_wall=251, wall=0
2023-03-01 19:01:13 | INFO | train_inner | epoch 087:    821 / 1978 loss=3.005, nll_loss=0.859, word_ins=2.688, length=3.165, ppl=8.03, wps=23031, ups=0.39, wpb=59352.5, bsz=2015.7, num_updates=170900, lr=0.000241896, gnorm=1.275, loss_scale=8192, train_wall=257, wall=0
2023-03-01 19:05:32 | INFO | train_inner | epoch 087:    921 / 1978 loss=3.005, nll_loss=0.858, word_ins=2.687, length=3.177, ppl=8.03, wps=22964.5, ups=0.39, wpb=59324.5, bsz=1971.8, num_updates=171000, lr=0.000241825, gnorm=1.219, loss_scale=8192, train_wall=258, wall=0
2023-03-01 19:09:50 | INFO | train_inner | epoch 087:   1021 / 1978 loss=2.998, nll_loss=0.852, word_ins=2.681, length=3.173, ppl=7.99, wps=22982.5, ups=0.39, wpb=59297.4, bsz=2011.4, num_updates=171100, lr=0.000241755, gnorm=1.206, loss_scale=8192, train_wall=258, wall=0
2023-03-01 19:14:08 | INFO | train_inner | epoch 087:   1121 / 1978 loss=3.018, nll_loss=0.87, word_ins=2.698, length=3.2, ppl=8.1, wps=22988.8, ups=0.39, wpb=59334.4, bsz=1980.6, num_updates=171200, lr=0.000241684, gnorm=1.18, loss_scale=8192, train_wall=258, wall=0
2023-03-01 19:18:29 | INFO | train_inner | epoch 087:   1221 / 1978 loss=2.998, nll_loss=0.857, word_ins=2.685, length=3.121, ppl=7.99, wps=22670.7, ups=0.38, wpb=59307.5, bsz=2055, num_updates=171300, lr=0.000241614, gnorm=1.219, loss_scale=8192, train_wall=261, wall=0
2023-03-01 19:22:50 | INFO | train_inner | epoch 087:   1321 / 1978 loss=3.012, nll_loss=0.862, word_ins=2.691, length=3.211, ppl=8.07, wps=22709.3, ups=0.38, wpb=59167.5, bsz=2048.4, num_updates=171400, lr=0.000241543, gnorm=1.203, loss_scale=8192, train_wall=260, wall=0
2023-03-01 19:27:11 | INFO | train_inner | epoch 087:   1421 / 1978 loss=2.994, nll_loss=0.851, word_ins=2.68, length=3.138, ppl=7.97, wps=22552.7, ups=0.38, wpb=58848.2, bsz=2070.3, num_updates=171500, lr=0.000241473, gnorm=1.164, loss_scale=8192, train_wall=261, wall=0
2023-03-01 19:31:31 | INFO | train_inner | epoch 087:   1521 / 1978 loss=3.005, nll_loss=0.859, word_ins=2.688, length=3.176, ppl=8.03, wps=22985.7, ups=0.38, wpb=59846.5, bsz=2069, num_updates=171600, lr=0.000241402, gnorm=1.216, loss_scale=8192, train_wall=260, wall=0
2023-03-01 19:35:37 | INFO | train_inner | epoch 087:   1621 / 1978 loss=3.015, nll_loss=0.863, word_ins=2.691, length=3.243, ppl=8.08, wps=23976.4, ups=0.41, wpb=58875.5, bsz=2010.2, num_updates=171700, lr=0.000241332, gnorm=1.172, loss_scale=8192, train_wall=245, wall=0
2023-03-01 19:39:29 | INFO | train_inner | epoch 087:   1721 / 1978 loss=3, nll_loss=0.855, word_ins=2.684, length=3.155, ppl=8, wps=25361.8, ups=0.43, wpb=59025.1, bsz=2058.4, num_updates=171800, lr=0.000241262, gnorm=1.178, loss_scale=8192, train_wall=233, wall=0
2023-03-01 19:43:20 | INFO | train_inner | epoch 087:   1821 / 1978 loss=3.023, nll_loss=0.875, word_ins=2.702, length=3.205, ppl=8.13, wps=25685, ups=0.43, wpb=59323.6, bsz=1977.8, num_updates=171900, lr=0.000241192, gnorm=1.265, loss_scale=8192, train_wall=231, wall=0
2023-03-01 19:47:11 | INFO | train_inner | epoch 087:   1921 / 1978 loss=3.024, nll_loss=0.876, word_ins=2.703, length=3.214, ppl=8.14, wps=25600.7, ups=0.43, wpb=59121.6, bsz=1974.5, num_updates=172000, lr=0.000241121, gnorm=1.185, loss_scale=8192, train_wall=231, wall=0
2023-03-01 19:49:23 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 19:49:41 | INFO | valid | epoch 087 | valid on 'valid' subset | loss 4.073 | nll_loss 1.929 | word_ins 3.693 | length 3.799 | ppl 16.84 | wps 31332.1 | wpb 40242.5 | bsz 1500 | num_updates 172057 | best_loss 4.043
2023-03-01 19:49:41 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 19:49:48 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint87.pt (epoch 87 @ 172057 updates, score 4.073) (writing took 6.698602880351245 seconds)
2023-03-01 19:49:48 | INFO | fairseq_cli.train | end of epoch 87 (average epoch stats below)
2023-03-01 19:49:48 | INFO | train | epoch 087 | loss 3.008 | nll_loss 0.861 | word_ins 2.69 | length 3.183 | ppl 8.04 | wps 23795 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 172057 | lr 0.000241081 | gnorm 1.212 | loss_scale 8192 | train_wall 4886 | wall 0
2023-03-01 19:49:48 | INFO | fairseq.trainer | begin training epoch 88
2023-03-01 19:51:36 | INFO | train_inner | epoch 088:     43 / 1978 loss=3.022, nll_loss=0.871, word_ins=2.698, length=3.236, ppl=8.12, wps=22248.2, ups=0.38, wpb=58862.1, bsz=1922.8, num_updates=172100, lr=0.000241051, gnorm=1.208, loss_scale=8192, train_wall=229, wall=0
2023-03-01 19:55:27 | INFO | train_inner | epoch 088:    143 / 1978 loss=2.97, nll_loss=0.83, word_ins=2.662, length=3.079, ppl=7.84, wps=25591.3, ups=0.43, wpb=59158.2, bsz=2092.6, num_updates=172200, lr=0.000240981, gnorm=1.167, loss_scale=8192, train_wall=231, wall=0
2023-03-01 19:59:18 | INFO | train_inner | epoch 088:    243 / 1978 loss=2.995, nll_loss=0.849, word_ins=2.679, length=3.165, ppl=7.97, wps=25588.8, ups=0.43, wpb=59160.9, bsz=2055.8, num_updates=172300, lr=0.000240911, gnorm=1.177, loss_scale=8192, train_wall=231, wall=0
2023-03-01 20:03:13 | INFO | train_inner | epoch 088:    343 / 1978 loss=2.984, nll_loss=0.847, word_ins=2.677, length=3.065, ppl=7.91, wps=25505.3, ups=0.43, wpb=59741.7, bsz=2025.1, num_updates=172400, lr=0.000240842, gnorm=1.247, loss_scale=8192, train_wall=234, wall=0
2023-03-01 20:07:05 | INFO | train_inner | epoch 088:    443 / 1978 loss=3.019, nll_loss=0.87, word_ins=2.698, length=3.216, ppl=8.11, wps=25525.9, ups=0.43, wpb=59251, bsz=1966.6, num_updates=172500, lr=0.000240772, gnorm=1.173, loss_scale=8192, train_wall=232, wall=0
2023-03-01 20:11:01 | INFO | train_inner | epoch 088:    543 / 1978 loss=3.004, nll_loss=0.856, word_ins=2.685, length=3.193, ppl=8.02, wps=25122.1, ups=0.42, wpb=59371.9, bsz=2005.2, num_updates=172600, lr=0.000240702, gnorm=1.224, loss_scale=8192, train_wall=236, wall=0
2023-03-01 20:14:52 | INFO | train_inner | epoch 088:    643 / 1978 loss=3.009, nll_loss=0.863, word_ins=2.691, length=3.177, ppl=8.05, wps=25691.3, ups=0.43, wpb=59245, bsz=1951.5, num_updates=172700, lr=0.000240632, gnorm=1.179, loss_scale=8192, train_wall=230, wall=0
2023-03-01 20:18:44 | INFO | train_inner | epoch 088:    743 / 1978 loss=2.991, nll_loss=0.848, word_ins=2.678, length=3.137, ppl=7.95, wps=25499, ups=0.43, wpb=59135.1, bsz=2083.8, num_updates=172800, lr=0.000240563, gnorm=1.179, loss_scale=8192, train_wall=232, wall=0
2023-03-01 20:22:35 | INFO | train_inner | epoch 088:    843 / 1978 loss=2.967, nll_loss=0.829, word_ins=2.66, length=3.07, ppl=7.82, wps=25670.2, ups=0.43, wpb=59460.7, bsz=2118.2, num_updates=172900, lr=0.000240493, gnorm=1.196, loss_scale=8192, train_wall=231, wall=0
2023-03-01 20:26:26 | INFO | train_inner | epoch 088:    943 / 1978 loss=3.031, nll_loss=0.883, word_ins=2.71, length=3.212, ppl=8.18, wps=25693.2, ups=0.43, wpb=59253.4, bsz=1907.7, num_updates=173000, lr=0.000240424, gnorm=1.248, loss_scale=8192, train_wall=230, wall=0
2023-03-01 20:30:16 | INFO | train_inner | epoch 088:   1043 / 1978 loss=3.013, nll_loss=0.869, word_ins=2.697, length=3.161, ppl=8.07, wps=25800.9, ups=0.43, wpb=59336.1, bsz=1936.6, num_updates=173100, lr=0.000240354, gnorm=1.223, loss_scale=8192, train_wall=230, wall=0
2023-03-01 20:34:07 | INFO | train_inner | epoch 088:   1143 / 1978 loss=3.026, nll_loss=0.872, word_ins=2.699, length=3.265, ppl=8.14, wps=25762.5, ups=0.43, wpb=59639.2, bsz=1989.4, num_updates=173200, lr=0.000240285, gnorm=1.246, loss_scale=8192, train_wall=231, wall=0
2023-03-01 20:38:02 | INFO | train_inner | epoch 088:   1243 / 1978 loss=3.006, nll_loss=0.858, word_ins=2.686, length=3.203, ppl=8.04, wps=24993, ups=0.43, wpb=58743.5, bsz=2018, num_updates=173300, lr=0.000240215, gnorm=1.144, loss_scale=8192, train_wall=235, wall=0
2023-03-01 20:41:58 | INFO | train_inner | epoch 088:   1343 / 1978 loss=2.999, nll_loss=0.848, word_ins=2.677, length=3.213, ppl=7.99, wps=25351.3, ups=0.42, wpb=59794.8, bsz=1969.4, num_updates=173400, lr=0.000240146, gnorm=1.225, loss_scale=8192, train_wall=236, wall=0
2023-03-01 20:46:01 | INFO | train_inner | epoch 088:   1443 / 1978 loss=2.998, nll_loss=0.853, word_ins=2.682, length=3.163, ppl=7.99, wps=24368.5, ups=0.41, wpb=59049.3, bsz=2042.2, num_updates=173500, lr=0.000240077, gnorm=1.188, loss_scale=8192, train_wall=242, wall=0
2023-03-01 20:50:07 | INFO | train_inner | epoch 088:   1543 / 1978 loss=3.029, nll_loss=0.876, word_ins=2.704, length=3.255, ppl=8.16, wps=23976, ups=0.41, wpb=58967.7, bsz=1894.4, num_updates=173600, lr=0.000240008, gnorm=1.276, loss_scale=8192, train_wall=246, wall=0
2023-03-01 20:54:13 | INFO | train_inner | epoch 088:   1643 / 1978 loss=2.972, nll_loss=0.833, word_ins=2.663, length=3.09, ppl=7.85, wps=24206.6, ups=0.41, wpb=59599.3, bsz=2090.1, num_updates=173700, lr=0.000239939, gnorm=1.156, loss_scale=8192, train_wall=246, wall=0
2023-03-01 20:58:17 | INFO | train_inner | epoch 088:   1743 / 1978 loss=2.995, nll_loss=0.851, word_ins=2.68, length=3.153, ppl=7.97, wps=24458.8, ups=0.41, wpb=59817.7, bsz=2037.3, num_updates=173800, lr=0.00023987, gnorm=1.212, loss_scale=8192, train_wall=244, wall=0
2023-03-01 21:02:13 | INFO | train_inner | epoch 088:   1843 / 1978 loss=3.031, nll_loss=0.884, word_ins=2.711, length=3.2, ppl=8.17, wps=25219.5, ups=0.42, wpb=59341.8, bsz=1894.2, num_updates=173900, lr=0.000239801, gnorm=1.22, loss_scale=8192, train_wall=235, wall=0
2023-03-01 21:06:08 | INFO | train_inner | epoch 088:   1943 / 1978 loss=3.024, nll_loss=0.877, word_ins=2.704, length=3.202, ppl=8.14, wps=25072.6, ups=0.43, wpb=58939.2, bsz=1931.4, num_updates=174000, lr=0.000239732, gnorm=1.258, loss_scale=8192, train_wall=235, wall=0
2023-03-01 21:07:31 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 21:07:48 | INFO | valid | epoch 088 | valid on 'valid' subset | loss 4.075 | nll_loss 1.914 | word_ins 3.68 | length 3.954 | ppl 16.86 | wps 30496 | wpb 40242.5 | bsz 1500 | num_updates 174035 | best_loss 4.043
2023-03-01 21:07:48 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 21:07:58 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint88.pt (epoch 88 @ 174035 updates, score 4.075) (writing took 9.392636980861425 seconds)
2023-03-01 21:07:58 | INFO | fairseq_cli.train | end of epoch 88 (average epoch stats below)
2023-03-01 21:07:58 | INFO | train | epoch 088 | loss 3.003 | nll_loss 0.858 | word_ins 2.686 | length 3.17 | ppl 8.02 | wps 25004.8 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 174035 | lr 0.000239708 | gnorm 1.209 | loss_scale 8192 | train_wall 4648 | wall 0
2023-03-01 21:07:58 | INFO | fairseq.trainer | begin training epoch 89
2023-03-01 21:10:42 | INFO | train_inner | epoch 089:     65 / 1978 loss=2.982, nll_loss=0.838, word_ins=2.668, length=3.132, ppl=7.9, wps=21414.6, ups=0.36, wpb=58848.5, bsz=2060.9, num_updates=174100, lr=0.000239663, gnorm=1.224, loss_scale=8192, train_wall=237, wall=0
2023-03-01 21:14:39 | INFO | train_inner | epoch 089:    165 / 1978 loss=3.018, nll_loss=0.871, word_ins=2.699, length=3.192, ppl=8.1, wps=25174.4, ups=0.42, wpb=59506, bsz=1911.7, num_updates=174200, lr=0.000239594, gnorm=1.222, loss_scale=16384, train_wall=236, wall=0
2023-03-01 21:17:37 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-01 21:18:48 | INFO | train_inner | epoch 089:    266 / 1978 loss=2.982, nll_loss=0.839, word_ins=2.67, length=3.125, ppl=7.9, wps=23692.9, ups=0.4, wpb=59116.2, bsz=2042.3, num_updates=174300, lr=0.000239525, gnorm=1.13, loss_scale=8192, train_wall=249, wall=0
2023-03-01 21:22:56 | INFO | train_inner | epoch 089:    366 / 1978 loss=3.001, nll_loss=0.857, word_ins=2.686, length=3.147, ppl=8, wps=23913.6, ups=0.4, wpb=59167.3, bsz=1987.7, num_updates=174400, lr=0.000239457, gnorm=1.264, loss_scale=8192, train_wall=247, wall=0
2023-03-01 21:27:02 | INFO | train_inner | epoch 089:    466 / 1978 loss=3.008, nll_loss=0.863, word_ins=2.691, length=3.168, ppl=8.04, wps=24226.3, ups=0.41, wpb=59599.2, bsz=1988.5, num_updates=174500, lr=0.000239388, gnorm=1.286, loss_scale=8192, train_wall=246, wall=0
2023-03-01 21:30:58 | INFO | train_inner | epoch 089:    566 / 1978 loss=3.012, nll_loss=0.863, word_ins=2.692, length=3.203, ppl=8.07, wps=24890.6, ups=0.42, wpb=58879.6, bsz=1942.4, num_updates=174600, lr=0.000239319, gnorm=1.237, loss_scale=8192, train_wall=236, wall=0
2023-03-01 21:34:56 | INFO | train_inner | epoch 089:    666 / 1978 loss=2.993, nll_loss=0.847, word_ins=2.677, length=3.163, ppl=7.96, wps=25043.2, ups=0.42, wpb=59383.8, bsz=2028.2, num_updates=174700, lr=0.000239251, gnorm=1.201, loss_scale=8192, train_wall=237, wall=0
2023-03-01 21:38:52 | INFO | train_inner | epoch 089:    766 / 1978 loss=2.991, nll_loss=0.849, word_ins=2.678, length=3.131, ppl=7.95, wps=25317.9, ups=0.42, wpb=59769.6, bsz=2038.5, num_updates=174800, lr=0.000239182, gnorm=1.197, loss_scale=8192, train_wall=236, wall=0
2023-03-01 21:42:48 | INFO | train_inner | epoch 089:    866 / 1978 loss=2.983, nll_loss=0.845, word_ins=2.674, length=3.09, ppl=7.91, wps=25208.6, ups=0.42, wpb=59493.1, bsz=2082.4, num_updates=174900, lr=0.000239114, gnorm=1.193, loss_scale=8192, train_wall=236, wall=0
2023-03-01 21:46:43 | INFO | train_inner | epoch 089:    966 / 1978 loss=2.991, nll_loss=0.845, word_ins=2.675, length=3.163, ppl=7.95, wps=25001.3, ups=0.42, wpb=58897.2, bsz=2040.5, num_updates=175000, lr=0.000239046, gnorm=1.211, loss_scale=8192, train_wall=235, wall=0
2023-03-01 21:50:41 | INFO | train_inner | epoch 089:   1066 / 1978 loss=2.987, nll_loss=0.844, word_ins=2.673, length=3.142, ppl=7.93, wps=25139.8, ups=0.42, wpb=59766, bsz=2129.4, num_updates=175100, lr=0.000238977, gnorm=1.179, loss_scale=8192, train_wall=237, wall=0
2023-03-01 21:54:37 | INFO | train_inner | epoch 089:   1166 / 1978 loss=2.996, nll_loss=0.854, word_ins=2.683, length=3.134, ppl=7.98, wps=25117, ups=0.42, wpb=59301.9, bsz=2061.4, num_updates=175200, lr=0.000238909, gnorm=1.217, loss_scale=8192, train_wall=236, wall=0
2023-03-01 21:58:32 | INFO | train_inner | epoch 089:   1266 / 1978 loss=3.032, nll_loss=0.877, word_ins=2.704, length=3.282, ppl=8.18, wps=24890.7, ups=0.43, wpb=58411.1, bsz=1910.4, num_updates=175300, lr=0.000238841, gnorm=1.211, loss_scale=8192, train_wall=234, wall=0
2023-03-01 22:02:26 | INFO | train_inner | epoch 089:   1366 / 1978 loss=2.999, nll_loss=0.853, word_ins=2.682, length=3.17, ppl=8, wps=25367.3, ups=0.43, wpb=59533.7, bsz=1968.7, num_updates=175400, lr=0.000238773, gnorm=1.191, loss_scale=8192, train_wall=234, wall=0
2023-03-01 22:06:21 | INFO | train_inner | epoch 089:   1466 / 1978 loss=2.994, nll_loss=0.847, word_ins=2.676, length=3.181, ppl=7.97, wps=25461.3, ups=0.43, wpb=59806, bsz=2031, num_updates=175500, lr=0.000238705, gnorm=1.199, loss_scale=8192, train_wall=235, wall=0
2023-03-01 22:10:12 | INFO | train_inner | epoch 089:   1566 / 1978 loss=3.024, nll_loss=0.877, word_ins=2.704, length=3.208, ppl=8.14, wps=25594.9, ups=0.43, wpb=59131.3, bsz=1947.3, num_updates=175600, lr=0.000238637, gnorm=1.207, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:14:03 | INFO | train_inner | epoch 089:   1666 / 1978 loss=3.002, nll_loss=0.857, word_ins=2.686, length=3.159, ppl=8.01, wps=25785.6, ups=0.43, wpb=59505.3, bsz=1990.6, num_updates=175700, lr=0.000238569, gnorm=1.224, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:17:54 | INFO | train_inner | epoch 089:   1766 / 1978 loss=3.011, nll_loss=0.861, word_ins=2.689, length=3.22, ppl=8.06, wps=25833.7, ups=0.43, wpb=59579.5, bsz=1956.2, num_updates=175800, lr=0.000238501, gnorm=1.22, loss_scale=8192, train_wall=230, wall=0
2023-03-01 22:21:45 | INFO | train_inner | epoch 089:   1866 / 1978 loss=3.008, nll_loss=0.861, word_ins=2.689, length=3.193, ppl=8.05, wps=25591.5, ups=0.43, wpb=59219, bsz=2045.8, num_updates=175900, lr=0.000238433, gnorm=1.211, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:25:36 | INFO | train_inner | epoch 089:   1966 / 1978 loss=3.008, nll_loss=0.86, word_ins=2.688, length=3.202, ppl=8.05, wps=25453.5, ups=0.43, wpb=58674.1, bsz=1978.3, num_updates=176000, lr=0.000238366, gnorm=1.195, loss_scale=8192, train_wall=230, wall=0
2023-03-01 22:26:04 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 22:26:24 | INFO | valid | epoch 089 | valid on 'valid' subset | loss 4.105 | nll_loss 1.916 | word_ins 3.681 | length 4.242 | ppl 17.21 | wps 31136.4 | wpb 40242.5 | bsz 1500 | num_updates 176012 | best_loss 4.043
2023-03-01 22:26:24 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 22:26:29 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint89.pt (epoch 89 @ 176012 updates, score 4.105) (writing took 5.709097446873784 seconds)
2023-03-01 22:26:29 | INFO | fairseq_cli.train | end of epoch 89 (average epoch stats below)
2023-03-01 22:26:29 | INFO | train | epoch 089 | loss 3.002 | nll_loss 0.856 | word_ins 2.685 | length 3.172 | ppl 8.01 | wps 24874.9 | ups 0.42 | wpb 59284.6 | bsz 2002.8 | num_updates 176012 | lr 0.000238358 | gnorm 1.21 | loss_scale 8192 | train_wall 4669 | wall 0
2023-03-01 22:26:29 | INFO | fairseq.trainer | begin training epoch 90
2023-03-01 22:30:03 | INFO | train_inner | epoch 090:     88 / 1978 loss=3.005, nll_loss=0.855, word_ins=2.685, length=3.206, ppl=8.03, wps=22128, ups=0.37, wpb=59049.7, bsz=1985.7, num_updates=176100, lr=0.000238298, gnorm=1.203, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:33:54 | INFO | train_inner | epoch 090:    188 / 1978 loss=2.965, nll_loss=0.828, word_ins=2.66, length=3.058, ppl=7.81, wps=25660.1, ups=0.43, wpb=59415.3, bsz=2136.1, num_updates=176200, lr=0.00023823, gnorm=1.214, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:37:46 | INFO | train_inner | epoch 090:    288 / 1978 loss=2.985, nll_loss=0.843, word_ins=2.673, length=3.118, ppl=7.92, wps=25514, ups=0.43, wpb=59211, bsz=2081.4, num_updates=176300, lr=0.000238163, gnorm=1.228, loss_scale=8192, train_wall=232, wall=0
2023-03-01 22:41:38 | INFO | train_inner | epoch 090:    388 / 1978 loss=2.985, nll_loss=0.843, word_ins=2.673, length=3.118, ppl=7.92, wps=25784, ups=0.43, wpb=59701.9, bsz=2043.8, num_updates=176400, lr=0.000238095, gnorm=1.209, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:45:28 | INFO | train_inner | epoch 090:    488 / 1978 loss=3.015, nll_loss=0.866, word_ins=2.695, length=3.198, ppl=8.08, wps=25623.8, ups=0.43, wpb=58996, bsz=1949.8, num_updates=176500, lr=0.000238028, gnorm=1.212, loss_scale=8192, train_wall=230, wall=0
2023-03-01 22:49:20 | INFO | train_inner | epoch 090:    588 / 1978 loss=2.985, nll_loss=0.837, word_ins=2.667, length=3.174, ppl=7.92, wps=25742.8, ups=0.43, wpb=59622, bsz=2022.4, num_updates=176600, lr=0.00023796, gnorm=1.24, loss_scale=8192, train_wall=231, wall=0
2023-03-01 22:53:12 | INFO | train_inner | epoch 090:    688 / 1978 loss=2.997, nll_loss=0.85, word_ins=2.679, length=3.178, ppl=7.98, wps=25582.9, ups=0.43, wpb=59436.9, bsz=2031.6, num_updates=176700, lr=0.000237893, gnorm=1.222, loss_scale=8192, train_wall=232, wall=0
2023-03-01 22:57:04 | INFO | train_inner | epoch 090:    788 / 1978 loss=2.986, nll_loss=0.841, word_ins=2.671, length=3.152, ppl=7.92, wps=25401.7, ups=0.43, wpb=59016.1, bsz=2049.8, num_updates=176800, lr=0.000237826, gnorm=1.193, loss_scale=8192, train_wall=232, wall=0
2023-03-01 23:00:55 | INFO | train_inner | epoch 090:    888 / 1978 loss=3.021, nll_loss=0.873, word_ins=2.7, length=3.201, ppl=8.12, wps=25696.7, ups=0.43, wpb=59202.9, bsz=1951.3, num_updates=176900, lr=0.000237759, gnorm=1.23, loss_scale=8192, train_wall=230, wall=0
2023-03-01 23:04:47 | INFO | train_inner | epoch 090:    988 / 1978 loss=3.006, nll_loss=0.86, word_ins=2.689, length=3.176, ppl=8.04, wps=25462.2, ups=0.43, wpb=59062.2, bsz=2005.9, num_updates=177000, lr=0.000237691, gnorm=1.229, loss_scale=8192, train_wall=232, wall=0
2023-03-01 23:08:37 | INFO | train_inner | epoch 090:   1088 / 1978 loss=3.008, nll_loss=0.86, word_ins=2.689, length=3.191, ppl=8.04, wps=25767.1, ups=0.43, wpb=59331.2, bsz=1913.8, num_updates=177100, lr=0.000237624, gnorm=1.239, loss_scale=8192, train_wall=230, wall=0
2023-03-01 23:12:27 | INFO | train_inner | epoch 090:   1188 / 1978 loss=3.008, nll_loss=0.857, word_ins=2.686, length=3.225, ppl=8.04, wps=25723.1, ups=0.43, wpb=59198.2, bsz=1927, num_updates=177200, lr=0.000237557, gnorm=1.239, loss_scale=8192, train_wall=230, wall=0
2023-03-01 23:16:17 | INFO | train_inner | epoch 090:   1288 / 1978 loss=3.025, nll_loss=0.878, word_ins=2.705, length=3.192, ppl=8.14, wps=25503.7, ups=0.43, wpb=58776.5, bsz=1939.9, num_updates=177300, lr=0.00023749, gnorm=1.216, loss_scale=8192, train_wall=230, wall=0
2023-03-01 23:20:08 | INFO | train_inner | epoch 090:   1388 / 1978 loss=3.008, nll_loss=0.862, word_ins=2.69, length=3.183, ppl=8.05, wps=25639.9, ups=0.43, wpb=59215.2, bsz=1944.6, num_updates=177400, lr=0.000237423, gnorm=1.232, loss_scale=8192, train_wall=231, wall=0
2023-03-01 23:23:59 | INFO | train_inner | epoch 090:   1488 / 1978 loss=3.014, nll_loss=0.864, word_ins=2.692, length=3.213, ppl=8.08, wps=25612.9, ups=0.43, wpb=59065.8, bsz=1986.2, num_updates=177500, lr=0.000237356, gnorm=1.238, loss_scale=8192, train_wall=230, wall=0
2023-03-01 23:27:53 | INFO | train_inner | epoch 090:   1588 / 1978 loss=2.994, nll_loss=0.847, word_ins=2.677, length=3.179, ppl=7.97, wps=25394, ups=0.43, wpb=59371.5, bsz=2043.6, num_updates=177600, lr=0.000237289, gnorm=1.205, loss_scale=8192, train_wall=234, wall=0
2023-03-01 23:31:48 | INFO | train_inner | epoch 090:   1688 / 1978 loss=3.009, nll_loss=0.859, word_ins=2.687, length=3.221, ppl=8.05, wps=25048.3, ups=0.43, wpb=58891.4, bsz=1955.6, num_updates=177700, lr=0.000237223, gnorm=1.2, loss_scale=8192, train_wall=235, wall=0
2023-03-01 23:35:45 | INFO | train_inner | epoch 090:   1788 / 1978 loss=2.999, nll_loss=0.856, word_ins=2.685, length=3.14, ppl=7.99, wps=25150.4, ups=0.42, wpb=59739.3, bsz=1961, num_updates=177800, lr=0.000237156, gnorm=1.237, loss_scale=8192, train_wall=237, wall=0
2023-03-01 23:39:44 | INFO | train_inner | epoch 090:   1888 / 1978 loss=2.993, nll_loss=0.848, word_ins=2.677, length=3.159, ppl=7.96, wps=25059.8, ups=0.42, wpb=59882, bsz=2031.6, num_updates=177900, lr=0.000237089, gnorm=1.184, loss_scale=8192, train_wall=239, wall=0
2023-03-01 23:43:21 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-01 23:43:39 | INFO | valid | epoch 090 | valid on 'valid' subset | loss 4.096 | nll_loss 1.933 | word_ins 3.699 | length 3.965 | ppl 17.1 | wps 29294.4 | wpb 40242.5 | bsz 1500 | num_updates 177990 | best_loss 4.043
2023-03-01 23:43:39 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-01 23:43:46 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint90.pt (epoch 90 @ 177990 updates, score 4.096) (writing took 6.881739535368979 seconds)
2023-03-01 23:43:46 | INFO | fairseq_cli.train | end of epoch 90 (average epoch stats below)
2023-03-01 23:43:46 | INFO | train | epoch 090 | loss 3 | nll_loss 0.854 | word_ins 2.683 | length 3.171 | ppl 8 | wps 25290.6 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 177990 | lr 0.000237029 | gnorm 1.219 | loss_scale 8192 | train_wall 4596 | wall 0
2023-03-01 23:43:46 | INFO | fairseq.trainer | begin training epoch 91
2023-03-01 23:44:20 | INFO | train_inner | epoch 091:     10 / 1978 loss=2.987, nll_loss=0.843, word_ins=2.672, length=3.143, ppl=7.93, wps=21538.4, ups=0.36, wpb=59311.3, bsz=2100.1, num_updates=178000, lr=0.000237023, gnorm=1.197, loss_scale=8192, train_wall=239, wall=0
2023-03-01 23:48:19 | INFO | train_inner | epoch 091:    110 / 1978 loss=3.002, nll_loss=0.853, word_ins=2.682, length=3.199, ppl=8.01, wps=24768.8, ups=0.42, wpb=59179.2, bsz=1935.4, num_updates=178100, lr=0.000236956, gnorm=1.23, loss_scale=8192, train_wall=239, wall=0
2023-03-01 23:52:12 | INFO | train_inner | epoch 091:    210 / 1978 loss=2.995, nll_loss=0.848, word_ins=2.677, length=3.172, ppl=7.97, wps=25415.8, ups=0.43, wpb=59305.2, bsz=1950.4, num_updates=178200, lr=0.00023689, gnorm=1.22, loss_scale=8192, train_wall=233, wall=0
2023-03-01 23:56:06 | INFO | train_inner | epoch 091:    310 / 1978 loss=2.996, nll_loss=0.849, word_ins=2.679, length=3.169, ppl=7.98, wps=25193.3, ups=0.43, wpb=59056.4, bsz=2019, num_updates=178300, lr=0.000236823, gnorm=1.188, loss_scale=8192, train_wall=234, wall=0
2023-03-02 00:00:00 | INFO | train_inner | epoch 091:    410 / 1978 loss=2.987, nll_loss=0.846, word_ins=2.675, length=3.113, ppl=7.93, wps=25477.3, ups=0.43, wpb=59363, bsz=2050.6, num_updates=178400, lr=0.000236757, gnorm=1.258, loss_scale=16384, train_wall=233, wall=0
2023-03-02 00:00:42 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 00:03:54 | INFO | train_inner | epoch 091:    511 / 1978 loss=2.985, nll_loss=0.844, word_ins=2.674, length=3.108, ppl=7.92, wps=25298.7, ups=0.43, wpb=59354.5, bsz=1994.3, num_updates=178500, lr=0.000236691, gnorm=1.182, loss_scale=8192, train_wall=234, wall=0
2023-03-02 00:07:48 | INFO | train_inner | epoch 091:    611 / 1978 loss=3.009, nll_loss=0.86, word_ins=2.688, length=3.203, ppl=8.05, wps=25249.7, ups=0.43, wpb=59018, bsz=1986.1, num_updates=178600, lr=0.000236624, gnorm=1.239, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:11:41 | INFO | train_inner | epoch 091:    711 / 1978 loss=2.983, nll_loss=0.84, word_ins=2.671, length=3.123, ppl=7.91, wps=25439.2, ups=0.43, wpb=59313.7, bsz=2006.2, num_updates=178700, lr=0.000236558, gnorm=1.182, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:15:35 | INFO | train_inner | epoch 091:    811 / 1978 loss=2.993, nll_loss=0.847, word_ins=2.677, length=3.16, ppl=7.96, wps=25314, ups=0.43, wpb=59129.9, bsz=2065.8, num_updates=178800, lr=0.000236492, gnorm=1.172, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:19:28 | INFO | train_inner | epoch 091:    911 / 1978 loss=2.995, nll_loss=0.846, word_ins=2.675, length=3.194, ppl=7.97, wps=25512.6, ups=0.43, wpb=59516.5, bsz=1977.8, num_updates=178900, lr=0.000236426, gnorm=1.242, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:23:19 | INFO | train_inner | epoch 091:   1011 / 1978 loss=3.023, nll_loss=0.872, word_ins=2.699, length=3.236, ppl=8.13, wps=25673.3, ups=0.43, wpb=59395.1, bsz=1900.9, num_updates=179000, lr=0.00023636, gnorm=1.262, loss_scale=8192, train_wall=231, wall=0
2023-03-02 00:27:12 | INFO | train_inner | epoch 091:   1111 / 1978 loss=2.996, nll_loss=0.853, word_ins=2.681, length=3.153, ppl=7.98, wps=25638.4, ups=0.43, wpb=59740.2, bsz=1987, num_updates=179100, lr=0.000236294, gnorm=1.261, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:31:06 | INFO | train_inner | epoch 091:   1211 / 1978 loss=2.999, nll_loss=0.851, word_ins=2.68, length=3.187, ppl=7.99, wps=25211.1, ups=0.43, wpb=58934.1, bsz=1987.1, num_updates=179200, lr=0.000236228, gnorm=1.206, loss_scale=8192, train_wall=234, wall=0
2023-03-02 00:34:59 | INFO | train_inner | epoch 091:   1311 / 1978 loss=3.008, nll_loss=0.859, word_ins=2.687, length=3.209, ppl=8.04, wps=25271.4, ups=0.43, wpb=58959, bsz=2023, num_updates=179300, lr=0.000236162, gnorm=1.19, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:38:54 | INFO | train_inner | epoch 091:   1411 / 1978 loss=2.989, nll_loss=0.846, word_ins=2.676, length=3.133, ppl=7.94, wps=25414.4, ups=0.43, wpb=59534.9, bsz=2083.4, num_updates=179400, lr=0.000236096, gnorm=1.22, loss_scale=8192, train_wall=234, wall=0
2023-03-02 00:42:46 | INFO | train_inner | epoch 091:   1511 / 1978 loss=3.02, nll_loss=0.87, word_ins=2.698, length=3.225, ppl=8.11, wps=25301.4, ups=0.43, wpb=58849.8, bsz=1955, num_updates=179500, lr=0.00023603, gnorm=1.252, loss_scale=8192, train_wall=232, wall=0
2023-03-02 00:46:39 | INFO | train_inner | epoch 091:   1611 / 1978 loss=3.01, nll_loss=0.865, word_ins=2.693, length=3.173, ppl=8.06, wps=25572.5, ups=0.43, wpb=59629.3, bsz=1948.8, num_updates=179600, lr=0.000235965, gnorm=1.242, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:50:33 | INFO | train_inner | epoch 091:   1711 / 1978 loss=2.974, nll_loss=0.834, word_ins=2.664, length=3.098, ppl=7.86, wps=25638.1, ups=0.43, wpb=59832.6, bsz=2103.3, num_updates=179700, lr=0.000235899, gnorm=1.246, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:54:26 | INFO | train_inner | epoch 091:   1811 / 1978 loss=3.005, nll_loss=0.86, word_ins=2.688, length=3.17, ppl=8.03, wps=25175.8, ups=0.43, wpb=58838.7, bsz=2016.4, num_updates=179800, lr=0.000235833, gnorm=1.215, loss_scale=8192, train_wall=233, wall=0
2023-03-02 00:58:19 | INFO | train_inner | epoch 091:   1911 / 1978 loss=3.019, nll_loss=0.868, word_ins=2.695, length=3.237, ppl=8.1, wps=25444.7, ups=0.43, wpb=59267.6, bsz=2025.6, num_updates=179900, lr=0.000235768, gnorm=1.229, loss_scale=8192, train_wall=233, wall=0
2023-03-02 01:00:56 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 01:01:13 | INFO | valid | epoch 091 | valid on 'valid' subset | loss 4.071 | nll_loss 1.908 | word_ins 3.672 | length 3.986 | ppl 16.8 | wps 15996.5 | wpb 40242.5 | bsz 1500 | num_updates 179967 | best_loss 4.043
2023-03-02 01:01:13 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 01:01:20 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint91.pt (epoch 91 @ 179967 updates, score 4.071) (writing took 7.462394206784666 seconds)
2023-03-02 01:01:20 | INFO | fairseq_cli.train | end of epoch 91 (average epoch stats below)
2023-03-02 01:01:20 | INFO | train | epoch 091 | loss 2.998 | nll_loss 0.853 | word_ins 2.681 | length 3.17 | ppl 7.99 | wps 25183.5 | ups 0.42 | wpb 59286.1 | bsz 2003 | num_updates 179967 | lr 0.000235724 | gnorm 1.221 | loss_scale 8192 | train_wall 4614 | wall 0
2023-03-02 01:01:20 | INFO | fairseq.trainer | begin training epoch 92
2023-03-02 01:02:48 | INFO | train_inner | epoch 092:     33 / 1978 loss=2.983, nll_loss=0.839, word_ins=2.669, length=3.149, ppl=7.91, wps=22156.4, ups=0.37, wpb=59435.6, bsz=2039.8, num_updates=180000, lr=0.000235702, gnorm=1.17, loss_scale=8192, train_wall=232, wall=0
2023-03-02 01:06:40 | INFO | train_inner | epoch 092:    133 / 1978 loss=2.984, nll_loss=0.839, word_ins=2.67, length=3.137, ppl=7.91, wps=25564.1, ups=0.43, wpb=59499.2, bsz=1985.6, num_updates=180100, lr=0.000235637, gnorm=1.245, loss_scale=8192, train_wall=233, wall=0
2023-03-02 01:10:36 | INFO | train_inner | epoch 092:    233 / 1978 loss=3.002, nll_loss=0.857, word_ins=2.685, length=3.169, ppl=8.01, wps=25134.8, ups=0.42, wpb=59208.6, bsz=1927.4, num_updates=180200, lr=0.000235571, gnorm=1.22, loss_scale=8192, train_wall=235, wall=0
2023-03-02 01:14:30 | INFO | train_inner | epoch 092:    333 / 1978 loss=2.983, nll_loss=0.839, word_ins=2.669, length=3.142, ppl=7.91, wps=25385.5, ups=0.43, wpb=59486.4, bsz=2067.1, num_updates=180300, lr=0.000235506, gnorm=1.151, loss_scale=8192, train_wall=234, wall=0
2023-03-02 01:18:24 | INFO | train_inner | epoch 092:    433 / 1978 loss=2.984, nll_loss=0.837, word_ins=2.667, length=3.165, ppl=7.91, wps=25270.3, ups=0.43, wpb=59174.7, bsz=1977.1, num_updates=180400, lr=0.000235441, gnorm=1.214, loss_scale=8192, train_wall=234, wall=0
2023-03-02 01:22:21 | INFO | train_inner | epoch 092:    533 / 1978 loss=2.981, nll_loss=0.836, word_ins=2.666, length=3.147, ppl=7.89, wps=25181.4, ups=0.42, wpb=59470.1, bsz=2037.2, num_updates=180500, lr=0.000235376, gnorm=1.234, loss_scale=8192, train_wall=236, wall=0
2023-03-02 01:26:15 | INFO | train_inner | epoch 092:    633 / 1978 loss=3.016, nll_loss=0.863, word_ins=2.692, length=3.242, ppl=8.09, wps=25091.2, ups=0.43, wpb=58737.8, bsz=1990.2, num_updates=180600, lr=0.00023531, gnorm=1.194, loss_scale=8192, train_wall=234, wall=0
2023-03-02 01:30:12 | INFO | train_inner | epoch 092:    733 / 1978 loss=2.979, nll_loss=0.839, word_ins=2.669, length=3.1, ppl=7.88, wps=25131.5, ups=0.42, wpb=59547.6, bsz=2069.9, num_updates=180700, lr=0.000235245, gnorm=1.235, loss_scale=8192, train_wall=237, wall=0
2023-03-02 01:34:05 | INFO | train_inner | epoch 092:    833 / 1978 loss=2.992, nll_loss=0.843, word_ins=2.672, length=3.198, ppl=7.96, wps=25499.9, ups=0.43, wpb=59371.6, bsz=2013.7, num_updates=180800, lr=0.00023518, gnorm=1.203, loss_scale=8192, train_wall=233, wall=0
2023-03-02 01:37:57 | INFO | train_inner | epoch 092:    933 / 1978 loss=2.989, nll_loss=0.845, word_ins=2.675, length=3.14, ppl=7.94, wps=25381.6, ups=0.43, wpb=58977, bsz=2002.6, num_updates=180900, lr=0.000235115, gnorm=1.207, loss_scale=8192, train_wall=232, wall=0
2023-03-02 01:41:50 | INFO | train_inner | epoch 092:   1033 / 1978 loss=2.98, nll_loss=0.837, word_ins=2.667, length=3.126, ppl=7.89, wps=25485.2, ups=0.43, wpb=59374.7, bsz=2041, num_updates=181000, lr=0.00023505, gnorm=1.207, loss_scale=8192, train_wall=233, wall=0
2023-03-02 01:45:44 | INFO | train_inner | epoch 092:   1133 / 1978 loss=2.986, nll_loss=0.844, word_ins=2.673, length=3.125, ppl=7.92, wps=25437.6, ups=0.43, wpb=59463.9, bsz=2097.2, num_updates=181100, lr=0.000234985, gnorm=1.196, loss_scale=8192, train_wall=234, wall=0
2023-03-02 01:49:40 | INFO | train_inner | epoch 092:   1233 / 1978 loss=2.992, nll_loss=0.845, word_ins=2.675, length=3.17, ppl=7.95, wps=25189, ups=0.42, wpb=59548.2, bsz=2083.4, num_updates=181200, lr=0.00023492, gnorm=1.197, loss_scale=8192, train_wall=236, wall=0
2023-03-02 01:53:33 | INFO | train_inner | epoch 092:   1333 / 1978 loss=3.026, nll_loss=0.878, word_ins=2.705, length=3.207, ppl=8.14, wps=25515.1, ups=0.43, wpb=59454.1, bsz=1928.1, num_updates=181300, lr=0.000234856, gnorm=1.301, loss_scale=8192, train_wall=233, wall=0
2023-03-02 01:57:26 | INFO | train_inner | epoch 092:   1433 / 1978 loss=3.014, nll_loss=0.865, word_ins=2.693, length=3.211, ppl=8.08, wps=25394.2, ups=0.43, wpb=59126.1, bsz=1963.8, num_updates=181400, lr=0.000234791, gnorm=1.253, loss_scale=8192, train_wall=233, wall=0
2023-03-02 02:01:20 | INFO | train_inner | epoch 092:   1533 / 1978 loss=2.992, nll_loss=0.847, word_ins=2.676, length=3.159, ppl=7.95, wps=25330.1, ups=0.43, wpb=59406.1, bsz=2028.7, num_updates=181500, lr=0.000234726, gnorm=1.191, loss_scale=8192, train_wall=234, wall=0
2023-03-02 02:05:16 | INFO | train_inner | epoch 092:   1633 / 1978 loss=2.99, nll_loss=0.846, word_ins=2.675, length=3.155, ppl=7.95, wps=25218.5, ups=0.42, wpb=59512.2, bsz=1973.4, num_updates=181600, lr=0.000234662, gnorm=1.259, loss_scale=8192, train_wall=236, wall=0
2023-03-02 02:09:10 | INFO | train_inner | epoch 092:   1733 / 1978 loss=3.018, nll_loss=0.869, word_ins=2.697, length=3.212, ppl=8.1, wps=25302.1, ups=0.43, wpb=58991.3, bsz=1930.2, num_updates=181700, lr=0.000234597, gnorm=1.245, loss_scale=8192, train_wall=233, wall=0
2023-03-02 02:13:04 | INFO | train_inner | epoch 092:   1833 / 1978 loss=3.016, nll_loss=0.865, word_ins=2.693, length=3.222, ppl=8.09, wps=25086, ups=0.43, wpb=58733.2, bsz=1997.6, num_updates=181800, lr=0.000234533, gnorm=1.215, loss_scale=8192, train_wall=234, wall=0
2023-03-02 02:17:02 | INFO | train_inner | epoch 092:   1933 / 1978 loss=3, nll_loss=0.855, word_ins=2.683, length=3.164, ppl=8, wps=24811.1, ups=0.42, wpb=59233.1, bsz=1976.2, num_updates=181900, lr=0.000234468, gnorm=1.225, loss_scale=8192, train_wall=239, wall=0
2023-03-02 02:18:48 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 02:19:07 | INFO | valid | epoch 092 | valid on 'valid' subset | loss 4.11 | nll_loss 1.929 | word_ins 3.697 | length 4.129 | ppl 17.26 | wps 31095.4 | wpb 40242.5 | bsz 1500 | num_updates 181945 | best_loss 4.043
2023-03-02 02:19:07 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 02:19:16 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint92.pt (epoch 92 @ 181945 updates, score 4.11) (writing took 9.001479930244386 seconds)
2023-03-02 02:19:16 | INFO | fairseq_cli.train | end of epoch 92 (average epoch stats below)
2023-03-02 02:19:16 | INFO | train | epoch 092 | loss 2.996 | nll_loss 0.85 | word_ins 2.68 | length 3.168 | ppl 7.98 | wps 25080.9 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 181945 | lr 0.000234439 | gnorm 1.22 | loss_scale 8192 | train_wall 4632 | wall 0
2023-03-02 02:19:16 | INFO | fairseq.trainer | begin training epoch 93
2023-03-02 02:21:35 | INFO | train_inner | epoch 093:     55 / 1978 loss=3.002, nll_loss=0.86, word_ins=2.688, length=3.141, ppl=8.01, wps=21771, ups=0.37, wpb=59277, bsz=1988.8, num_updates=182000, lr=0.000234404, gnorm=1.214, loss_scale=8192, train_wall=232, wall=0
2023-03-02 02:25:28 | INFO | train_inner | epoch 093:    155 / 1978 loss=2.988, nll_loss=0.843, word_ins=2.673, length=3.153, ppl=7.93, wps=25430.4, ups=0.43, wpb=59257.9, bsz=2009.6, num_updates=182100, lr=0.000234339, gnorm=1.174, loss_scale=8192, train_wall=233, wall=0
2023-03-02 02:29:21 | INFO | train_inner | epoch 093:    255 / 1978 loss=2.999, nll_loss=0.852, word_ins=2.681, length=3.178, ppl=7.99, wps=25364.6, ups=0.43, wpb=59151.7, bsz=1958.7, num_updates=182200, lr=0.000234275, gnorm=1.233, loss_scale=8192, train_wall=233, wall=0
2023-03-02 02:33:14 | INFO | train_inner | epoch 093:    355 / 1978 loss=2.984, nll_loss=0.843, word_ins=2.673, length=3.115, ppl=7.91, wps=25463, ups=0.43, wpb=59293.4, bsz=1982.6, num_updates=182300, lr=0.000234211, gnorm=1.263, loss_scale=8192, train_wall=233, wall=0
2023-03-02 02:37:09 | INFO | train_inner | epoch 093:    455 / 1978 loss=2.989, nll_loss=0.843, word_ins=2.673, length=3.154, ppl=7.94, wps=25033.3, ups=0.43, wpb=58832.1, bsz=1971.8, num_updates=182400, lr=0.000234146, gnorm=1.2, loss_scale=8192, train_wall=235, wall=0
2023-03-02 02:41:02 | INFO | train_inner | epoch 093:    555 / 1978 loss=2.994, nll_loss=0.848, word_ins=2.677, length=3.166, ppl=7.97, wps=25266.5, ups=0.43, wpb=58945.9, bsz=2047.8, num_updates=182500, lr=0.000234082, gnorm=1.24, loss_scale=8192, train_wall=233, wall=0
2023-03-02 02:43:43 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 02:44:57 | INFO | train_inner | epoch 093:    656 / 1978 loss=2.978, nll_loss=0.838, word_ins=2.669, length=3.097, ppl=7.88, wps=25550, ups=0.43, wpb=59868, bsz=2038.4, num_updates=182600, lr=0.000234018, gnorm=1.231, loss_scale=8192, train_wall=234, wall=0
2023-03-02 02:48:48 | INFO | train_inner | epoch 093:    756 / 1978 loss=2.975, nll_loss=0.834, word_ins=2.665, length=3.102, ppl=7.86, wps=25622.7, ups=0.43, wpb=59203.9, bsz=2028.1, num_updates=182700, lr=0.000233954, gnorm=1.259, loss_scale=8192, train_wall=231, wall=0
2023-03-02 02:52:39 | INFO | train_inner | epoch 093:    856 / 1978 loss=2.992, nll_loss=0.846, word_ins=2.676, length=3.167, ppl=7.96, wps=25673.1, ups=0.43, wpb=59353.3, bsz=1996.5, num_updates=182800, lr=0.00023389, gnorm=1.231, loss_scale=8192, train_wall=231, wall=0
2023-03-02 02:56:33 | INFO | train_inner | epoch 093:    956 / 1978 loss=2.998, nll_loss=0.855, word_ins=2.684, length=3.147, ppl=7.99, wps=25504.7, ups=0.43, wpb=59618.6, bsz=1994.1, num_updates=182900, lr=0.000233826, gnorm=1.221, loss_scale=8192, train_wall=234, wall=0
2023-03-02 03:00:27 | INFO | train_inner | epoch 093:   1056 / 1978 loss=2.99, nll_loss=0.85, word_ins=2.679, length=3.113, ppl=7.95, wps=25158.6, ups=0.43, wpb=59064.7, bsz=2046.8, num_updates=183000, lr=0.000233762, gnorm=1.212, loss_scale=8192, train_wall=235, wall=0
2023-03-02 03:04:23 | INFO | train_inner | epoch 093:   1156 / 1978 loss=3.005, nll_loss=0.859, word_ins=2.687, length=3.182, ppl=8.03, wps=25162.9, ups=0.42, wpb=59216.5, bsz=2007.2, num_updates=183100, lr=0.000233698, gnorm=1.238, loss_scale=8192, train_wall=235, wall=0
2023-03-02 03:08:18 | INFO | train_inner | epoch 093:   1256 / 1978 loss=2.995, nll_loss=0.854, word_ins=2.683, length=3.12, ppl=7.97, wps=25273.1, ups=0.43, wpb=59350.7, bsz=2044.3, num_updates=183200, lr=0.000233635, gnorm=1.232, loss_scale=8192, train_wall=235, wall=0
2023-03-02 03:12:13 | INFO | train_inner | epoch 093:   1356 / 1978 loss=2.972, nll_loss=0.83, word_ins=2.66, length=3.118, ppl=7.85, wps=25443.3, ups=0.43, wpb=59853.7, bsz=2081.6, num_updates=183300, lr=0.000233571, gnorm=1.206, loss_scale=8192, train_wall=235, wall=0
2023-03-02 03:16:05 | INFO | train_inner | epoch 093:   1456 / 1978 loss=2.991, nll_loss=0.846, word_ins=2.675, length=3.161, ppl=7.95, wps=25408, ups=0.43, wpb=59006.1, bsz=2050.6, num_updates=183400, lr=0.000233507, gnorm=1.18, loss_scale=8192, train_wall=232, wall=0
2023-03-02 03:20:10 | INFO | train_inner | epoch 093:   1556 / 1978 loss=2.998, nll_loss=0.851, word_ins=2.68, length=3.184, ppl=7.99, wps=24134.2, ups=0.41, wpb=59233.3, bsz=1958.8, num_updates=183500, lr=0.000233444, gnorm=1.232, loss_scale=8192, train_wall=245, wall=0
2023-03-02 03:24:20 | INFO | train_inner | epoch 093:   1656 / 1978 loss=3.008, nll_loss=0.861, word_ins=2.689, length=3.194, ppl=8.04, wps=23820.7, ups=0.4, wpb=59342.5, bsz=2001.6, num_updates=183600, lr=0.00023338, gnorm=1.234, loss_scale=8192, train_wall=249, wall=0
2023-03-02 03:28:29 | INFO | train_inner | epoch 093:   1756 / 1978 loss=3.027, nll_loss=0.871, word_ins=2.698, length=3.287, ppl=8.15, wps=23654.8, ups=0.4, wpb=58946.5, bsz=1856.8, num_updates=183700, lr=0.000233316, gnorm=1.253, loss_scale=8192, train_wall=249, wall=0
2023-03-02 03:32:40 | INFO | train_inner | epoch 093:   1856 / 1978 loss=2.999, nll_loss=0.852, word_ins=2.68, length=3.192, ppl=8, wps=23782.2, ups=0.4, wpb=59714.1, bsz=2033.8, num_updates=183800, lr=0.000233253, gnorm=1.207, loss_scale=8192, train_wall=251, wall=0
2023-03-02 03:36:51 | INFO | train_inner | epoch 093:   1956 / 1978 loss=3.015, nll_loss=0.862, word_ins=2.69, length=3.246, ppl=8.08, wps=23660.1, ups=0.4, wpb=59330.1, bsz=1943.7, num_updates=183900, lr=0.00023319, gnorm=1.203, loss_scale=8192, train_wall=251, wall=0
2023-03-02 03:37:45 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 03:38:01 | INFO | valid | epoch 093 | valid on 'valid' subset | loss 4.089 | nll_loss 1.908 | word_ins 3.676 | length 4.127 | ppl 17.02 | wps 26832.3 | wpb 40242.5 | bsz 1500 | num_updates 183922 | best_loss 4.043
2023-03-02 03:38:01 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 03:38:07 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint93.pt (epoch 93 @ 183922 updates, score 4.089) (writing took 5.94700625911355 seconds)
2023-03-02 03:38:07 | INFO | fairseq_cli.train | end of epoch 93 (average epoch stats below)
2023-03-02 03:38:07 | INFO | train | epoch 093 | loss 2.994 | nll_loss 0.849 | word_ins 2.678 | length 3.162 | ppl 7.97 | wps 24772.9 | ups 0.42 | wpb 59284 | bsz 2002.8 | num_updates 183922 | lr 0.000233176 | gnorm 1.224 | loss_scale 8192 | train_wall 4693 | wall 0
2023-03-02 03:38:07 | INFO | fairseq.trainer | begin training epoch 94
2023-03-02 03:41:29 | INFO | train_inner | epoch 094:     78 / 1978 loss=2.987, nll_loss=0.844, word_ins=2.674, length=3.137, ppl=7.93, wps=21347.8, ups=0.36, wpb=59474, bsz=1996.2, num_updates=184000, lr=0.000233126, gnorm=1.256, loss_scale=8192, train_wall=247, wall=0
2023-03-02 03:45:35 | INFO | train_inner | epoch 094:    178 / 1978 loss=2.995, nll_loss=0.848, word_ins=2.678, length=3.175, ppl=7.97, wps=24129.8, ups=0.41, wpb=59196.7, bsz=2018.3, num_updates=184100, lr=0.000233063, gnorm=1.253, loss_scale=8192, train_wall=245, wall=0
2023-03-02 03:49:40 | INFO | train_inner | epoch 094:    278 / 1978 loss=2.97, nll_loss=0.832, word_ins=2.663, length=3.068, ppl=7.83, wps=24253.6, ups=0.41, wpb=59444.4, bsz=2045.6, num_updates=184200, lr=0.000233, gnorm=1.214, loss_scale=8192, train_wall=245, wall=0
2023-03-02 03:53:44 | INFO | train_inner | epoch 094:    378 / 1978 loss=2.983, nll_loss=0.841, word_ins=2.671, length=3.115, ppl=7.91, wps=24318.9, ups=0.41, wpb=59515.7, bsz=2026.7, num_updates=184300, lr=0.000232936, gnorm=1.23, loss_scale=8192, train_wall=244, wall=0
2023-03-02 03:57:50 | INFO | train_inner | epoch 094:    478 / 1978 loss=2.973, nll_loss=0.836, word_ins=2.666, length=3.069, ppl=7.85, wps=24291.8, ups=0.41, wpb=59706.7, bsz=2068.6, num_updates=184400, lr=0.000232873, gnorm=1.254, loss_scale=8192, train_wall=246, wall=0
2023-03-02 04:01:55 | INFO | train_inner | epoch 094:    578 / 1978 loss=3.04, nll_loss=0.883, word_ins=2.71, length=3.301, ppl=8.22, wps=24238.9, ups=0.41, wpb=59265.2, bsz=1887, num_updates=184500, lr=0.00023281, gnorm=1.33, loss_scale=8192, train_wall=244, wall=0
2023-03-02 04:06:01 | INFO | train_inner | epoch 094:    678 / 1978 loss=2.975, nll_loss=0.833, word_ins=2.664, length=3.108, ppl=7.86, wps=24112.2, ups=0.41, wpb=59416.2, bsz=2066.5, num_updates=184600, lr=0.000232747, gnorm=1.201, loss_scale=8192, train_wall=246, wall=0
2023-03-02 04:10:05 | INFO | train_inner | epoch 094:    778 / 1978 loss=3.012, nll_loss=0.865, word_ins=2.693, length=3.184, ppl=8.07, wps=24247.9, ups=0.41, wpb=59171, bsz=1898.6, num_updates=184700, lr=0.000232684, gnorm=1.223, loss_scale=8192, train_wall=244, wall=0
2023-03-02 04:14:10 | INFO | train_inner | epoch 094:    878 / 1978 loss=2.999, nll_loss=0.854, word_ins=2.682, length=3.176, ppl=8, wps=24280.4, ups=0.41, wpb=59530.3, bsz=1956.7, num_updates=184800, lr=0.000232621, gnorm=1.241, loss_scale=8192, train_wall=245, wall=0
2023-03-02 04:18:16 | INFO | train_inner | epoch 094:    978 / 1978 loss=2.975, nll_loss=0.829, word_ins=2.659, length=3.154, ppl=7.86, wps=24465, ups=0.41, wpb=60000.5, bsz=2011.8, num_updates=184900, lr=0.000232558, gnorm=1.211, loss_scale=8192, train_wall=245, wall=0
2023-03-02 04:22:10 | INFO | train_inner | epoch 094:   1078 / 1978 loss=3.006, nll_loss=0.855, word_ins=2.684, length=3.216, ppl=8.03, wps=25072.1, ups=0.43, wpb=58861.6, bsz=1950.4, num_updates=185000, lr=0.000232495, gnorm=1.225, loss_scale=8192, train_wall=235, wall=0
2023-03-02 04:26:05 | INFO | train_inner | epoch 094:   1178 / 1978 loss=3.015, nll_loss=0.862, word_ins=2.69, length=3.248, ppl=8.08, wps=25228.5, ups=0.43, wpb=59252.6, bsz=1939.5, num_updates=185100, lr=0.000232432, gnorm=1.259, loss_scale=8192, train_wall=235, wall=0
2023-03-02 04:30:12 | INFO | train_inner | epoch 094:   1278 / 1978 loss=2.995, nll_loss=0.846, word_ins=2.675, length=3.195, ppl=7.97, wps=24077.4, ups=0.41, wpb=59405.3, bsz=1945, num_updates=185200, lr=0.00023237, gnorm=1.266, loss_scale=8192, train_wall=246, wall=0
2023-03-02 04:34:20 | INFO | train_inner | epoch 094:   1378 / 1978 loss=2.967, nll_loss=0.828, word_ins=2.659, length=3.086, ppl=7.82, wps=24182.9, ups=0.4, wpb=59968.5, bsz=2102.2, num_updates=185300, lr=0.000232307, gnorm=1.236, loss_scale=8192, train_wall=248, wall=0
2023-03-02 04:38:28 | INFO | train_inner | epoch 094:   1478 / 1978 loss=2.991, nll_loss=0.844, word_ins=2.673, length=3.172, ppl=7.95, wps=23726.7, ups=0.4, wpb=58929.4, bsz=2057.8, num_updates=185400, lr=0.000232244, gnorm=1.25, loss_scale=8192, train_wall=248, wall=0
2023-03-02 04:42:35 | INFO | train_inner | epoch 094:   1578 / 1978 loss=2.997, nll_loss=0.854, word_ins=2.683, length=3.146, ppl=7.98, wps=23800.7, ups=0.4, wpb=58768.1, bsz=2014, num_updates=185500, lr=0.000232182, gnorm=1.22, loss_scale=8192, train_wall=247, wall=0
2023-03-02 04:46:42 | INFO | train_inner | epoch 094:   1678 / 1978 loss=2.968, nll_loss=0.828, word_ins=2.658, length=3.101, ppl=7.83, wps=24123.2, ups=0.41, wpb=59468.6, bsz=2001.8, num_updates=185600, lr=0.000232119, gnorm=1.226, loss_scale=8192, train_wall=246, wall=0
2023-03-02 04:50:48 | INFO | train_inner | epoch 094:   1778 / 1978 loss=3.014, nll_loss=0.865, word_ins=2.693, length=3.217, ppl=8.08, wps=23729.7, ups=0.41, wpb=58390, bsz=1983.9, num_updates=185700, lr=0.000232057, gnorm=1.189, loss_scale=8192, train_wall=246, wall=0
2023-03-02 04:54:56 | INFO | train_inner | epoch 094:   1878 / 1978 loss=2.993, nll_loss=0.846, word_ins=2.675, length=3.181, ppl=7.96, wps=23768.9, ups=0.4, wpb=58906.4, bsz=2067.6, num_updates=185800, lr=0.000231994, gnorm=1.193, loss_scale=8192, train_wall=248, wall=0
2023-03-02 04:59:04 | INFO | train_inner | epoch 094:   1978 / 1978 loss=3.005, nll_loss=0.857, word_ins=2.686, length=3.192, ppl=8.03, wps=23743.8, ups=0.4, wpb=58964.2, bsz=1989.8, num_updates=185900, lr=0.000231932, gnorm=1.249, loss_scale=8192, train_wall=248, wall=0
2023-03-02 04:59:04 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 04:59:23 | INFO | valid | epoch 094 | valid on 'valid' subset | loss 4.068 | nll_loss 1.921 | word_ins 3.684 | length 3.838 | ppl 16.77 | wps 27109.9 | wpb 40242.5 | bsz 1500 | num_updates 185900 | best_loss 4.043
2023-03-02 04:59:23 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 04:59:30 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint94.pt (epoch 94 @ 185900 updates, score 4.068) (writing took 6.435079537332058 seconds)
2023-03-02 04:59:30 | INFO | fairseq_cli.train | end of epoch 94 (average epoch stats below)
2023-03-02 04:59:30 | INFO | train | epoch 094 | loss 2.993 | nll_loss 0.848 | word_ins 2.677 | length 3.162 | ppl 7.96 | wps 24015.5 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 185900 | lr 0.000231932 | gnorm 1.236 | loss_scale 8192 | train_wall 4842 | wall 0
2023-03-02 04:59:30 | INFO | fairseq.trainer | begin training epoch 95
2023-03-02 05:03:47 | INFO | train_inner | epoch 095:    100 / 1978 loss=2.972, nll_loss=0.835, word_ins=2.665, length=3.062, ppl=7.84, wps=21182.9, ups=0.35, wpb=59849.7, bsz=2021.5, num_updates=186000, lr=0.000231869, gnorm=1.233, loss_scale=8192, train_wall=246, wall=0
2023-03-02 05:07:49 | INFO | train_inner | epoch 095:    200 / 1978 loss=3.002, nll_loss=0.853, word_ins=2.682, length=3.201, ppl=8.01, wps=24209.7, ups=0.41, wpb=58774.8, bsz=1932.6, num_updates=186100, lr=0.000231807, gnorm=1.233, loss_scale=8192, train_wall=242, wall=0
2023-03-02 05:11:54 | INFO | train_inner | epoch 095:    300 / 1978 loss=2.984, nll_loss=0.84, word_ins=2.67, length=3.135, ppl=7.91, wps=24209.5, ups=0.41, wpb=59146.8, bsz=1999.3, num_updates=186200, lr=0.000231745, gnorm=1.246, loss_scale=8192, train_wall=244, wall=0
2023-03-02 05:15:59 | INFO | train_inner | epoch 095:    400 / 1978 loss=2.978, nll_loss=0.832, word_ins=2.663, length=3.155, ppl=7.88, wps=24107.5, ups=0.41, wpb=59211.3, bsz=2009.6, num_updates=186300, lr=0.000231683, gnorm=1.217, loss_scale=8192, train_wall=245, wall=0
2023-03-02 05:20:07 | INFO | train_inner | epoch 095:    500 / 1978 loss=2.996, nll_loss=0.856, word_ins=2.685, length=3.109, ppl=7.98, wps=23862.4, ups=0.4, wpb=59113.6, bsz=2001.1, num_updates=186400, lr=0.000231621, gnorm=1.187, loss_scale=8192, train_wall=247, wall=0
2023-03-02 05:24:14 | INFO | train_inner | epoch 095:    600 / 1978 loss=2.981, nll_loss=0.842, word_ins=2.672, length=3.089, ppl=7.89, wps=24011.3, ups=0.4, wpb=59416.7, bsz=2079.9, num_updates=186500, lr=0.000231558, gnorm=1.285, loss_scale=8192, train_wall=247, wall=0
2023-03-02 05:28:22 | INFO | train_inner | epoch 095:    700 / 1978 loss=2.984, nll_loss=0.835, word_ins=2.665, length=3.186, ppl=7.91, wps=23799.3, ups=0.4, wpb=58961.4, bsz=2049.7, num_updates=186600, lr=0.000231496, gnorm=1.176, loss_scale=8192, train_wall=247, wall=0
2023-03-02 05:32:14 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 05:32:32 | INFO | train_inner | epoch 095:    801 / 1978 loss=2.986, nll_loss=0.841, word_ins=2.67, length=3.159, ppl=7.92, wps=23903.1, ups=0.4, wpb=59716, bsz=2011, num_updates=186700, lr=0.000231434, gnorm=1.224, loss_scale=8192, train_wall=250, wall=0
2023-03-02 05:36:39 | INFO | train_inner | epoch 095:    901 / 1978 loss=2.979, nll_loss=0.831, word_ins=2.661, length=3.182, ppl=7.88, wps=24139.2, ups=0.4, wpb=59667.5, bsz=1987.5, num_updates=186800, lr=0.000231372, gnorm=1.205, loss_scale=8192, train_wall=247, wall=0
2023-03-02 05:40:45 | INFO | train_inner | epoch 095:   1001 / 1978 loss=2.998, nll_loss=0.851, word_ins=2.68, length=3.182, ppl=7.99, wps=24061.7, ups=0.41, wpb=59081.7, bsz=1984.4, num_updates=186900, lr=0.000231311, gnorm=1.197, loss_scale=8192, train_wall=245, wall=0
2023-03-02 05:44:52 | INFO | train_inner | epoch 095:   1101 / 1978 loss=3.006, nll_loss=0.849, word_ins=2.678, length=3.283, ppl=8.03, wps=23812.1, ups=0.4, wpb=58985.5, bsz=2044, num_updates=187000, lr=0.000231249, gnorm=1.263, loss_scale=8192, train_wall=247, wall=0
2023-03-02 05:48:59 | INFO | train_inner | epoch 095:   1201 / 1978 loss=2.991, nll_loss=0.843, word_ins=2.673, length=3.179, ppl=7.95, wps=24101.9, ups=0.41, wpb=59356.7, bsz=1930, num_updates=187100, lr=0.000231187, gnorm=1.221, loss_scale=8192, train_wall=246, wall=0
2023-03-02 05:53:06 | INFO | train_inner | epoch 095:   1301 / 1978 loss=2.998, nll_loss=0.851, word_ins=2.68, length=3.185, ppl=7.99, wps=23951.5, ups=0.4, wpb=59308.5, bsz=2003.8, num_updates=187200, lr=0.000231125, gnorm=1.267, loss_scale=8192, train_wall=247, wall=0
2023-03-02 05:57:13 | INFO | train_inner | epoch 095:   1401 / 1978 loss=2.993, nll_loss=0.846, word_ins=2.675, length=3.186, ppl=7.96, wps=24114.2, ups=0.4, wpb=59575, bsz=1995.9, num_updates=187300, lr=0.000231063, gnorm=1.218, loss_scale=8192, train_wall=247, wall=0
2023-03-02 06:01:21 | INFO | train_inner | epoch 095:   1501 / 1978 loss=2.992, nll_loss=0.845, word_ins=2.675, length=3.176, ppl=7.96, wps=23956.1, ups=0.4, wpb=59213, bsz=1979.6, num_updates=187400, lr=0.000231002, gnorm=1.262, loss_scale=8192, train_wall=247, wall=0
2023-03-02 06:05:28 | INFO | train_inner | epoch 095:   1601 / 1978 loss=2.996, nll_loss=0.853, word_ins=2.682, length=3.137, ppl=7.98, wps=23820.8, ups=0.4, wpb=58858.2, bsz=2000.6, num_updates=187500, lr=0.00023094, gnorm=1.265, loss_scale=8192, train_wall=247, wall=0
2023-03-02 06:09:33 | INFO | train_inner | epoch 095:   1701 / 1978 loss=2.994, nll_loss=0.847, word_ins=2.677, length=3.172, ppl=7.97, wps=24067.6, ups=0.41, wpb=59133, bsz=2012.6, num_updates=187600, lr=0.000230879, gnorm=1.244, loss_scale=8192, train_wall=245, wall=0
2023-03-02 06:13:41 | INFO | train_inner | epoch 095:   1801 / 1978 loss=3.017, nll_loss=0.872, word_ins=2.699, length=3.183, ppl=8.1, wps=23952.5, ups=0.4, wpb=59267.2, bsz=1956.9, num_updates=187700, lr=0.000230817, gnorm=1.254, loss_scale=8192, train_wall=247, wall=0
2023-03-02 06:17:49 | INFO | train_inner | epoch 095:   1901 / 1978 loss=2.974, nll_loss=0.834, word_ins=2.664, length=3.095, ppl=7.86, wps=24095, ups=0.4, wpb=59847.1, bsz=2089.7, num_updates=187800, lr=0.000230756, gnorm=1.278, loss_scale=8192, train_wall=248, wall=0
2023-03-02 06:21:00 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 06:21:16 | INFO | valid | epoch 095 | valid on 'valid' subset | loss 4.054 | nll_loss 1.914 | word_ins 3.685 | length 3.69 | ppl 16.61 | wps 27880.6 | wpb 40242.5 | bsz 1500 | num_updates 187877 | best_loss 4.043
2023-03-02 06:21:16 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 06:21:22 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint95.pt (epoch 95 @ 187877 updates, score 4.054) (writing took 6.147544953972101 seconds)
2023-03-02 06:21:22 | INFO | fairseq_cli.train | end of epoch 95 (average epoch stats below)
2023-03-02 06:21:22 | INFO | train | epoch 095 | loss 2.99 | nll_loss 0.845 | word_ins 2.674 | length 3.164 | ppl 7.95 | wps 23860.7 | ups 0.4 | wpb 59285.3 | bsz 2002.9 | num_updates 187877 | lr 0.000230708 | gnorm 1.235 | loss_scale 8192 | train_wall 4873 | wall 0
2023-03-02 06:21:22 | INFO | fairseq.trainer | begin training epoch 96
2023-03-02 06:22:28 | INFO | train_inner | epoch 096:     23 / 1978 loss=2.999, nll_loss=0.847, word_ins=2.676, length=3.228, ppl=7.99, wps=21180.7, ups=0.36, wpb=59125.4, bsz=1937.3, num_updates=187900, lr=0.000230694, gnorm=1.239, loss_scale=8192, train_wall=246, wall=0
2023-03-02 06:26:35 | INFO | train_inner | epoch 096:    123 / 1978 loss=2.982, nll_loss=0.839, word_ins=2.67, length=3.118, ppl=7.9, wps=23888.8, ups=0.41, wpb=58970.1, bsz=1994, num_updates=188000, lr=0.000230633, gnorm=1.254, loss_scale=8192, train_wall=246, wall=0
2023-03-02 06:30:43 | INFO | train_inner | epoch 096:    223 / 1978 loss=2.991, nll_loss=0.849, word_ins=2.678, length=3.13, ppl=7.95, wps=24046.2, ups=0.4, wpb=59610.4, bsz=2021.4, num_updates=188100, lr=0.000230571, gnorm=1.281, loss_scale=8192, train_wall=248, wall=0
2023-03-02 06:34:49 | INFO | train_inner | epoch 096:    323 / 1978 loss=2.997, nll_loss=0.847, word_ins=2.677, length=3.198, ppl=7.98, wps=23927.1, ups=0.41, wpb=58881.6, bsz=1934.8, num_updates=188200, lr=0.00023051, gnorm=1.238, loss_scale=8192, train_wall=246, wall=0
2023-03-02 06:38:56 | INFO | train_inner | epoch 096:    423 / 1978 loss=2.965, nll_loss=0.822, word_ins=2.654, length=3.109, ppl=7.81, wps=24133.4, ups=0.41, wpb=59475.3, bsz=2057.4, num_updates=188300, lr=0.000230449, gnorm=1.214, loss_scale=8192, train_wall=246, wall=0
2023-03-02 06:43:03 | INFO | train_inner | epoch 096:    523 / 1978 loss=2.991, nll_loss=0.845, word_ins=2.675, length=3.158, ppl=7.95, wps=23785.2, ups=0.4, wpb=58791.2, bsz=2007.6, num_updates=188400, lr=0.000230388, gnorm=1.216, loss_scale=8192, train_wall=247, wall=0
2023-03-02 06:47:10 | INFO | train_inner | epoch 096:    623 / 1978 loss=2.99, nll_loss=0.845, word_ins=2.675, length=3.149, ppl=7.95, wps=23943.2, ups=0.4, wpb=59175.1, bsz=2023.6, num_updates=188500, lr=0.000230327, gnorm=1.255, loss_scale=8192, train_wall=247, wall=0
2023-03-02 06:51:19 | INFO | train_inner | epoch 096:    723 / 1978 loss=2.971, nll_loss=0.827, word_ins=2.657, length=3.139, ppl=7.84, wps=23810.8, ups=0.4, wpb=59179.3, bsz=2112.7, num_updates=188600, lr=0.000230266, gnorm=1.199, loss_scale=8192, train_wall=248, wall=0
2023-03-02 06:55:25 | INFO | train_inner | epoch 096:    823 / 1978 loss=3.001, nll_loss=0.852, word_ins=2.68, length=3.212, ppl=8.01, wps=24277.9, ups=0.41, wpb=59876.9, bsz=1913.4, num_updates=188700, lr=0.000230205, gnorm=1.256, loss_scale=8192, train_wall=246, wall=0
2023-03-02 06:59:33 | INFO | train_inner | epoch 096:    923 / 1978 loss=2.99, nll_loss=0.848, word_ins=2.677, length=3.13, ppl=7.94, wps=23848.9, ups=0.4, wpb=59190.3, bsz=2014.8, num_updates=188800, lr=0.000230144, gnorm=1.21, loss_scale=8192, train_wall=248, wall=0
2023-03-02 07:03:40 | INFO | train_inner | epoch 096:   1023 / 1978 loss=2.985, nll_loss=0.838, word_ins=2.668, length=3.177, ppl=7.92, wps=24296.4, ups=0.4, wpb=60020.4, bsz=1967.3, num_updates=188900, lr=0.000230083, gnorm=1.28, loss_scale=8192, train_wall=247, wall=0
2023-03-02 07:07:47 | INFO | train_inner | epoch 096:   1123 / 1978 loss=2.981, nll_loss=0.838, word_ins=2.668, length=3.134, ppl=7.9, wps=24288.5, ups=0.41, wpb=59828.8, bsz=1955.1, num_updates=189000, lr=0.000230022, gnorm=1.204, loss_scale=8192, train_wall=246, wall=0
2023-03-02 07:11:52 | INFO | train_inner | epoch 096:   1223 / 1978 loss=3.003, nll_loss=0.857, word_ins=2.686, length=3.175, ppl=8.02, wps=24078.6, ups=0.41, wpb=59038.4, bsz=1995.9, num_updates=189100, lr=0.000229961, gnorm=1.245, loss_scale=8192, train_wall=245, wall=0
2023-03-02 07:15:59 | INFO | train_inner | epoch 096:   1323 / 1978 loss=2.99, nll_loss=0.849, word_ins=2.678, length=3.118, ppl=7.94, wps=23981.7, ups=0.41, wpb=59189.5, bsz=2011, num_updates=189200, lr=0.0002299, gnorm=1.271, loss_scale=8192, train_wall=247, wall=0
2023-03-02 07:20:07 | INFO | train_inner | epoch 096:   1423 / 1978 loss=2.989, nll_loss=0.846, word_ins=2.675, length=3.137, ppl=7.94, wps=24130.3, ups=0.4, wpb=59832, bsz=2021.3, num_updates=189300, lr=0.00022984, gnorm=1.243, loss_scale=8192, train_wall=248, wall=0
2023-03-02 07:24:13 | INFO | train_inner | epoch 096:   1523 / 1978 loss=2.98, nll_loss=0.833, word_ins=2.664, length=3.161, ppl=7.89, wps=23968.9, ups=0.41, wpb=59062.6, bsz=2003, num_updates=189400, lr=0.000229779, gnorm=1.234, loss_scale=8192, train_wall=246, wall=0
2023-03-02 07:28:21 | INFO | train_inner | epoch 096:   1623 / 1978 loss=2.993, nll_loss=0.845, word_ins=2.674, length=3.187, ppl=7.96, wps=23825.6, ups=0.4, wpb=59062.6, bsz=2026.1, num_updates=189500, lr=0.000229718, gnorm=1.248, loss_scale=8192, train_wall=248, wall=0
2023-03-02 07:32:28 | INFO | train_inner | epoch 096:   1723 / 1978 loss=2.991, nll_loss=0.843, word_ins=2.672, length=3.184, ppl=7.95, wps=23923.5, ups=0.4, wpb=59186.7, bsz=2007.2, num_updates=189600, lr=0.000229658, gnorm=1.214, loss_scale=8192, train_wall=247, wall=0
2023-03-02 07:36:36 | INFO | train_inner | epoch 096:   1823 / 1978 loss=3.002, nll_loss=0.855, word_ins=2.683, length=3.19, ppl=8.01, wps=23893.5, ups=0.4, wpb=59111.2, bsz=2000.6, num_updates=189700, lr=0.000229597, gnorm=1.269, loss_scale=8192, train_wall=247, wall=0
2023-03-02 07:40:43 | INFO | train_inner | epoch 096:   1923 / 1978 loss=2.99, nll_loss=0.847, word_ins=2.676, length=3.142, ppl=7.94, wps=24009, ups=0.41, wpb=59259.4, bsz=2008, num_updates=189800, lr=0.000229537, gnorm=1.271, loss_scale=8192, train_wall=247, wall=0
2023-03-02 07:42:59 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 07:43:18 | INFO | valid | epoch 096 | valid on 'valid' subset | loss 4.052 | nll_loss 1.906 | word_ins 3.674 | length 3.786 | ppl 16.59 | wps 26351.1 | wpb 40242.5 | bsz 1500 | num_updates 189855 | best_loss 4.043
2023-03-02 07:43:18 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 07:43:24 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint96.pt (epoch 96 @ 189855 updates, score 4.052) (writing took 6.245239162817597 seconds)
2023-03-02 07:43:24 | INFO | fairseq_cli.train | end of epoch 96 (average epoch stats below)
2023-03-02 07:43:24 | INFO | train | epoch 096 | loss 2.989 | nll_loss 0.844 | word_ins 2.674 | length 3.156 | ppl 7.94 | wps 23822.2 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 189855 | lr 0.000229503 | gnorm 1.241 | loss_scale 8192 | train_wall 4880 | wall 0
2023-03-02 07:43:24 | INFO | fairseq.trainer | begin training epoch 97
2023-03-02 07:45:25 | INFO | train_inner | epoch 097:     45 / 1978 loss=2.98, nll_loss=0.836, word_ins=2.666, length=3.14, ppl=7.89, wps=20930.3, ups=0.35, wpb=59067.8, bsz=2007.1, num_updates=189900, lr=0.000229476, gnorm=1.229, loss_scale=8192, train_wall=245, wall=0
2023-03-02 07:49:30 | INFO | train_inner | epoch 097:    145 / 1978 loss=2.961, nll_loss=0.823, word_ins=2.654, length=3.063, ppl=7.79, wps=24140.6, ups=0.41, wpb=59143.3, bsz=2062.7, num_updates=190000, lr=0.000229416, gnorm=1.203, loss_scale=8192, train_wall=245, wall=0
2023-03-02 07:53:37 | INFO | train_inner | epoch 097:    245 / 1978 loss=2.978, nll_loss=0.83, word_ins=2.66, length=3.176, ppl=7.88, wps=23934.1, ups=0.41, wpb=59077.7, bsz=1998.5, num_updates=190100, lr=0.000229355, gnorm=1.233, loss_scale=8192, train_wall=247, wall=0
2023-03-02 07:57:46 | INFO | train_inner | epoch 097:    345 / 1978 loss=2.98, nll_loss=0.832, word_ins=2.662, length=3.178, ppl=7.89, wps=23753.5, ups=0.4, wpb=59187.1, bsz=2044.2, num_updates=190200, lr=0.000229295, gnorm=1.251, loss_scale=8192, train_wall=249, wall=0
2023-03-02 08:01:54 | INFO | train_inner | epoch 097:    445 / 1978 loss=2.995, nll_loss=0.854, word_ins=2.683, length=3.121, ppl=7.97, wps=23909.8, ups=0.4, wpb=59342.2, bsz=2008.4, num_updates=190300, lr=0.000229235, gnorm=1.217, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:06:02 | INFO | train_inner | epoch 097:    545 / 1978 loss=2.989, nll_loss=0.846, word_ins=2.676, length=3.134, ppl=7.94, wps=23800.9, ups=0.4, wpb=59031.7, bsz=1983.6, num_updates=190400, lr=0.000229175, gnorm=1.246, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:10:11 | INFO | train_inner | epoch 097:    645 / 1978 loss=2.988, nll_loss=0.842, word_ins=2.672, length=3.166, ppl=7.93, wps=23856.3, ups=0.4, wpb=59249.2, bsz=1994.2, num_updates=190500, lr=0.000229114, gnorm=1.257, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:14:19 | INFO | train_inner | epoch 097:    745 / 1978 loss=2.974, nll_loss=0.829, word_ins=2.659, length=3.142, ppl=7.86, wps=23659.2, ups=0.4, wpb=58783.5, bsz=2062.6, num_updates=190600, lr=0.000229054, gnorm=1.238, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:18:27 | INFO | train_inner | epoch 097:    845 / 1978 loss=2.986, nll_loss=0.842, word_ins=2.671, length=3.145, ppl=7.92, wps=23817.8, ups=0.4, wpb=59069.4, bsz=1980.3, num_updates=190700, lr=0.000228994, gnorm=1.227, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:22:35 | INFO | train_inner | epoch 097:    945 / 1978 loss=2.962, nll_loss=0.824, word_ins=2.655, length=3.069, ppl=7.79, wps=24069.2, ups=0.4, wpb=59705.3, bsz=2060.2, num_updates=190800, lr=0.000228934, gnorm=1.222, loss_scale=16384, train_wall=248, wall=0
2023-03-02 08:23:35 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 08:26:45 | INFO | train_inner | epoch 097:   1046 / 1978 loss=2.996, nll_loss=0.852, word_ins=2.68, length=3.158, ppl=7.98, wps=23818.1, ups=0.4, wpb=59462.2, bsz=1982.2, num_updates=190900, lr=0.000228874, gnorm=1.279, loss_scale=8192, train_wall=249, wall=0
2023-03-02 08:30:53 | INFO | train_inner | epoch 097:   1146 / 1978 loss=2.989, nll_loss=0.842, word_ins=2.671, length=3.184, ppl=7.94, wps=23951.2, ups=0.4, wpb=59471.9, bsz=2022.7, num_updates=191000, lr=0.000228814, gnorm=1.292, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:35:01 | INFO | train_inner | epoch 097:   1246 / 1978 loss=2.984, nll_loss=0.844, word_ins=2.673, length=3.115, ppl=7.91, wps=23907.5, ups=0.4, wpb=59303, bsz=2052.6, num_updates=191100, lr=0.000228755, gnorm=1.28, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:39:10 | INFO | train_inner | epoch 097:   1346 / 1978 loss=2.991, nll_loss=0.843, word_ins=2.672, length=3.186, ppl=7.95, wps=23898.3, ups=0.4, wpb=59484.2, bsz=1963.5, num_updates=191200, lr=0.000228695, gnorm=1.287, loss_scale=8192, train_wall=249, wall=0
2023-03-02 08:43:17 | INFO | train_inner | epoch 097:   1446 / 1978 loss=3.006, nll_loss=0.86, word_ins=2.688, length=3.178, ppl=8.03, wps=24142.9, ups=0.4, wpb=59734, bsz=1926.4, num_updates=191300, lr=0.000228635, gnorm=1.29, loss_scale=8192, train_wall=247, wall=0
2023-03-02 08:47:26 | INFO | train_inner | epoch 097:   1546 / 1978 loss=2.985, nll_loss=0.839, word_ins=2.668, length=3.171, ppl=7.92, wps=23824.2, ups=0.4, wpb=59265.4, bsz=1993, num_updates=191400, lr=0.000228575, gnorm=1.238, loss_scale=8192, train_wall=248, wall=0
2023-03-02 08:51:34 | INFO | train_inner | epoch 097:   1646 / 1978 loss=2.996, nll_loss=0.855, word_ins=2.683, length=3.135, ppl=7.98, wps=24055.5, ups=0.4, wpb=59506, bsz=1973.5, num_updates=191500, lr=0.000228515, gnorm=1.262, loss_scale=8192, train_wall=247, wall=0
2023-03-02 08:55:40 | INFO | train_inner | epoch 097:   1746 / 1978 loss=2.997, nll_loss=0.849, word_ins=2.677, length=3.199, ppl=7.98, wps=23863.2, ups=0.41, wpb=58914.9, bsz=1958.6, num_updates=191600, lr=0.000228456, gnorm=1.204, loss_scale=8192, train_wall=247, wall=0
2023-03-02 08:59:45 | INFO | train_inner | epoch 097:   1846 / 1978 loss=2.999, nll_loss=0.851, word_ins=2.679, length=3.198, ppl=7.99, wps=23995, ups=0.41, wpb=58638.5, bsz=1974.3, num_updates=191700, lr=0.000228396, gnorm=1.241, loss_scale=8192, train_wall=244, wall=0
2023-03-02 09:03:46 | INFO | train_inner | epoch 097:   1946 / 1978 loss=2.988, nll_loss=0.845, word_ins=2.674, length=3.145, ppl=7.93, wps=24785.9, ups=0.41, wpb=59727.4, bsz=1989.4, num_updates=191800, lr=0.000228337, gnorm=1.266, loss_scale=8192, train_wall=241, wall=0
2023-03-02 09:05:03 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 09:05:19 | INFO | valid | epoch 097 | valid on 'valid' subset | loss 4.034 | nll_loss 1.913 | word_ins 3.675 | length 3.593 | ppl 16.38 | wps 27991.3 | wpb 40242.5 | bsz 1500 | num_updates 191832 | best_loss 4.034
2023-03-02 09:05:19 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 09:05:28 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint97.pt (epoch 97 @ 191832 updates, score 4.034) (writing took 8.754737069830298 seconds)
2023-03-02 09:05:28 | INFO | fairseq_cli.train | end of epoch 97 (average epoch stats below)
2023-03-02 09:05:28 | INFO | train | epoch 097 | loss 2.986 | nll_loss 0.841 | word_ins 2.671 | length 3.149 | ppl 7.92 | wps 23803.8 | ups 0.4 | wpb 59281.7 | bsz 2002.5 | num_updates 191832 | lr 0.000228318 | gnorm 1.249 | loss_scale 8192 | train_wall 4881 | wall 0
2023-03-02 09:05:28 | INFO | fairseq.trainer | begin training epoch 98
2023-03-02 09:08:21 | INFO | train_inner | epoch 098:     68 / 1978 loss=2.988, nll_loss=0.84, word_ins=2.669, length=3.186, ppl=7.93, wps=21545.7, ups=0.36, wpb=59383.9, bsz=1986.9, num_updates=191900, lr=0.000228277, gnorm=1.239, loss_scale=8192, train_wall=240, wall=0
2023-03-02 09:12:23 | INFO | train_inner | epoch 098:    168 / 1978 loss=2.955, nll_loss=0.819, word_ins=2.651, length=3.046, ppl=7.76, wps=24697.9, ups=0.41, wpb=59773.2, bsz=2036.5, num_updates=192000, lr=0.000228218, gnorm=1.231, loss_scale=8192, train_wall=242, wall=0
2023-03-02 09:16:25 | INFO | train_inner | epoch 098:    268 / 1978 loss=2.978, nll_loss=0.836, word_ins=2.667, length=3.112, ppl=7.88, wps=24579.1, ups=0.41, wpb=59475.2, bsz=2026.4, num_updates=192100, lr=0.000228158, gnorm=1.283, loss_scale=8192, train_wall=242, wall=0
2023-03-02 09:20:27 | INFO | train_inner | epoch 098:    368 / 1978 loss=2.997, nll_loss=0.847, word_ins=2.676, length=3.21, ppl=7.98, wps=24413.3, ups=0.41, wpb=59048.2, bsz=1980.5, num_updates=192200, lr=0.000228099, gnorm=1.276, loss_scale=8192, train_wall=242, wall=0
2023-03-02 09:24:29 | INFO | train_inner | epoch 098:    468 / 1978 loss=2.983, nll_loss=0.837, word_ins=2.667, length=3.166, ppl=7.91, wps=24439.7, ups=0.41, wpb=59128.2, bsz=2009.5, num_updates=192300, lr=0.00022804, gnorm=1.244, loss_scale=8192, train_wall=242, wall=0
2023-03-02 09:28:34 | INFO | train_inner | epoch 098:    568 / 1978 loss=2.977, nll_loss=0.833, word_ins=2.664, length=3.13, ppl=7.87, wps=24327.2, ups=0.41, wpb=59435.3, bsz=2059, num_updates=192400, lr=0.00022798, gnorm=1.271, loss_scale=8192, train_wall=244, wall=0
2023-03-02 09:32:29 | INFO | train_inner | epoch 098:    668 / 1978 loss=2.989, nll_loss=0.841, word_ins=2.671, length=3.179, ppl=7.94, wps=25237.1, ups=0.43, wpb=59362.6, bsz=1939.2, num_updates=192500, lr=0.000227921, gnorm=1.258, loss_scale=8192, train_wall=235, wall=0
2023-03-02 09:36:21 | INFO | train_inner | epoch 098:    768 / 1978 loss=2.964, nll_loss=0.822, word_ins=2.652, length=3.115, ppl=7.8, wps=25867.3, ups=0.43, wpb=59971.7, bsz=2052.9, num_updates=192600, lr=0.000227862, gnorm=1.248, loss_scale=8192, train_wall=232, wall=0
2023-03-02 09:40:11 | INFO | train_inner | epoch 098:    868 / 1978 loss=2.994, nll_loss=0.848, word_ins=2.677, length=3.171, ppl=7.97, wps=25543, ups=0.43, wpb=58856.7, bsz=1977.4, num_updates=192700, lr=0.000227803, gnorm=1.278, loss_scale=8192, train_wall=230, wall=0
2023-03-02 09:44:04 | INFO | train_inner | epoch 098:    968 / 1978 loss=2.998, nll_loss=0.855, word_ins=2.684, length=3.141, ppl=7.99, wps=25214.3, ups=0.43, wpb=58674.8, bsz=2057.7, num_updates=192800, lr=0.000227744, gnorm=1.26, loss_scale=8192, train_wall=232, wall=0
2023-03-02 09:48:06 | INFO | train_inner | epoch 098:   1068 / 1978 loss=2.98, nll_loss=0.835, word_ins=2.665, length=3.147, ppl=7.89, wps=24556.1, ups=0.41, wpb=59520.3, bsz=2018.6, num_updates=192900, lr=0.000227685, gnorm=1.249, loss_scale=8192, train_wall=242, wall=0
2023-03-02 09:53:02 | INFO | train_inner | epoch 098:   1168 / 1978 loss=2.984, nll_loss=0.838, word_ins=2.668, length=3.159, ppl=7.91, wps=19950.4, ups=0.34, wpb=59026.6, bsz=2009.4, num_updates=193000, lr=0.000227626, gnorm=1.222, loss_scale=8192, train_wall=296, wall=0
2023-03-02 09:57:58 | INFO | train_inner | epoch 098:   1268 / 1978 loss=2.978, nll_loss=0.836, word_ins=2.666, length=3.121, ppl=7.88, wps=19995.8, ups=0.34, wpb=59226.2, bsz=2028.3, num_updates=193100, lr=0.000227567, gnorm=1.227, loss_scale=8192, train_wall=296, wall=0
2023-03-02 10:02:53 | INFO | train_inner | epoch 098:   1368 / 1978 loss=2.985, nll_loss=0.84, word_ins=2.669, length=3.161, ppl=7.92, wps=20106.8, ups=0.34, wpb=59206.9, bsz=1973, num_updates=193200, lr=0.000227508, gnorm=1.275, loss_scale=8192, train_wall=294, wall=0
2023-03-02 10:07:14 | INFO | train_inner | epoch 098:   1468 / 1978 loss=3.004, nll_loss=0.855, word_ins=2.684, length=3.206, ppl=8.02, wps=22516.2, ups=0.38, wpb=58815.5, bsz=1937, num_updates=193300, lr=0.000227449, gnorm=1.262, loss_scale=8192, train_wall=261, wall=0
2023-03-02 10:11:17 | INFO | train_inner | epoch 098:   1568 / 1978 loss=2.976, nll_loss=0.83, word_ins=2.66, length=3.166, ppl=7.87, wps=24658.1, ups=0.41, wpb=59879.9, bsz=2015.3, num_updates=193400, lr=0.00022739, gnorm=1.244, loss_scale=8192, train_wall=243, wall=0
2023-03-02 10:15:19 | INFO | train_inner | epoch 098:   1668 / 1978 loss=2.959, nll_loss=0.82, word_ins=2.651, length=3.084, ppl=7.78, wps=24607.7, ups=0.41, wpb=59505.7, bsz=2074.9, num_updates=193500, lr=0.000227331, gnorm=1.238, loss_scale=8192, train_wall=242, wall=0
2023-03-02 10:19:19 | INFO | train_inner | epoch 098:   1768 / 1978 loss=3.009, nll_loss=0.86, word_ins=2.688, length=3.217, ppl=8.05, wps=24566.2, ups=0.42, wpb=58998.9, bsz=1893.4, num_updates=193600, lr=0.000227273, gnorm=1.295, loss_scale=8192, train_wall=240, wall=0
2023-03-02 10:23:20 | INFO | train_inner | epoch 098:   1868 / 1978 loss=3, nll_loss=0.856, word_ins=2.684, length=3.16, ppl=8, wps=24693.1, ups=0.41, wpb=59667.9, bsz=1997.3, num_updates=193700, lr=0.000227214, gnorm=1.318, loss_scale=8192, train_wall=241, wall=0
2023-03-02 10:27:27 | INFO | train_inner | epoch 098:   1968 / 1978 loss=2.992, nll_loss=0.849, word_ins=2.678, length=3.142, ppl=7.96, wps=23955.8, ups=0.41, wpb=59040.5, bsz=1989.2, num_updates=193800, lr=0.000227155, gnorm=1.218, loss_scale=8192, train_wall=246, wall=0
2023-03-02 10:27:51 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 10:28:07 | INFO | valid | epoch 098 | valid on 'valid' subset | loss 4.079 | nll_loss 1.913 | word_ins 3.681 | length 3.978 | ppl 16.9 | wps 28364.2 | wpb 40242.5 | bsz 1500 | num_updates 193810 | best_loss 4.034
2023-03-02 10:28:07 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 10:28:13 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint98.pt (epoch 98 @ 193810 updates, score 4.079) (writing took 5.739782968536019 seconds)
2023-03-02 10:28:13 | INFO | fairseq_cli.train | end of epoch 98 (average epoch stats below)
2023-03-02 10:28:13 | INFO | train | epoch 098 | loss 2.985 | nll_loss 0.84 | word_ins 2.67 | length 3.15 | ppl 7.92 | wps 23619.6 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 193810 | lr 0.00022715 | gnorm 1.258 | loss_scale 8192 | train_wall 4928 | wall 0
2023-03-02 10:28:13 | INFO | fairseq.trainer | begin training epoch 99
2023-03-02 10:31:59 | INFO | train_inner | epoch 099:     90 / 1978 loss=2.987, nll_loss=0.844, word_ins=2.673, length=3.138, ppl=7.93, wps=21653.5, ups=0.37, wpb=59015.8, bsz=1978.5, num_updates=193900, lr=0.000227097, gnorm=1.29, loss_scale=8192, train_wall=240, wall=0
2023-03-02 10:36:00 | INFO | train_inner | epoch 099:    190 / 1978 loss=2.954, nll_loss=0.816, word_ins=2.648, length=3.065, ppl=7.75, wps=24758.9, ups=0.42, wpb=59562.4, bsz=2005.3, num_updates=194000, lr=0.000227038, gnorm=1.266, loss_scale=8192, train_wall=240, wall=0
2023-03-02 10:40:01 | INFO | train_inner | epoch 099:    290 / 1978 loss=3.003, nll_loss=0.856, word_ins=2.684, length=3.187, ppl=8.02, wps=24447.9, ups=0.42, wpb=58802.6, bsz=1927.7, num_updates=194100, lr=0.00022698, gnorm=1.309, loss_scale=8192, train_wall=240, wall=0
2023-03-02 10:43:59 | INFO | train_inner | epoch 099:    390 / 1978 loss=2.98, nll_loss=0.835, word_ins=2.665, length=3.147, ppl=7.89, wps=24632.8, ups=0.42, wpb=58853.8, bsz=2036.3, num_updates=194200, lr=0.000226921, gnorm=1.313, loss_scale=8192, train_wall=239, wall=0
2023-03-02 10:47:52 | INFO | train_inner | epoch 099:    490 / 1978 loss=2.991, nll_loss=0.849, word_ins=2.678, length=3.131, ppl=7.95, wps=25711.6, ups=0.43, wpb=59673.6, bsz=1998.7, num_updates=194300, lr=0.000226863, gnorm=1.276, loss_scale=8192, train_wall=232, wall=0
2023-03-02 10:51:44 | INFO | train_inner | epoch 099:    590 / 1978 loss=2.962, nll_loss=0.821, word_ins=2.652, length=3.099, ppl=7.79, wps=25319.6, ups=0.43, wpb=58908.5, bsz=2075.4, num_updates=194400, lr=0.000226805, gnorm=1.224, loss_scale=8192, train_wall=232, wall=0
2023-03-02 10:55:37 | INFO | train_inner | epoch 099:    690 / 1978 loss=2.992, nll_loss=0.855, word_ins=2.683, length=3.089, ppl=7.96, wps=25616.9, ups=0.43, wpb=59512.6, bsz=1960.2, num_updates=194500, lr=0.000226746, gnorm=1.263, loss_scale=8192, train_wall=232, wall=0
2023-03-02 10:59:29 | INFO | train_inner | epoch 099:    790 / 1978 loss=2.991, nll_loss=0.845, word_ins=2.673, length=3.173, ppl=7.95, wps=25497.9, ups=0.43, wpb=59370.6, bsz=2022.5, num_updates=194600, lr=0.000226688, gnorm=1.295, loss_scale=8192, train_wall=233, wall=0
2023-03-02 11:03:21 | INFO | train_inner | epoch 099:    890 / 1978 loss=2.974, nll_loss=0.829, word_ins=2.66, length=3.139, ppl=7.86, wps=25515.1, ups=0.43, wpb=59223.2, bsz=1962.6, num_updates=194700, lr=0.00022663, gnorm=1.306, loss_scale=8192, train_wall=232, wall=0
2023-03-02 11:07:19 | INFO | train_inner | epoch 099:    990 / 1978 loss=2.972, nll_loss=0.83, word_ins=2.66, length=3.119, ppl=7.84, wps=25109.2, ups=0.42, wpb=59539.8, bsz=2029.4, num_updates=194800, lr=0.000226572, gnorm=1.253, loss_scale=8192, train_wall=237, wall=0
2023-03-02 11:11:18 | INFO | train_inner | epoch 099:   1090 / 1978 loss=2.96, nll_loss=0.819, word_ins=2.65, length=3.097, ppl=7.78, wps=24881.7, ups=0.42, wpb=59555.6, bsz=2131, num_updates=194900, lr=0.000226513, gnorm=1.239, loss_scale=8192, train_wall=239, wall=0
2023-03-02 11:12:28 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 11:15:16 | INFO | train_inner | epoch 099:   1191 / 1978 loss=2.978, nll_loss=0.832, word_ins=2.662, length=3.154, ppl=7.88, wps=24889, ups=0.42, wpb=59136.8, bsz=2013.6, num_updates=195000, lr=0.000226455, gnorm=1.255, loss_scale=8192, train_wall=237, wall=0
2023-03-02 11:19:11 | INFO | train_inner | epoch 099:   1291 / 1978 loss=2.972, nll_loss=0.833, word_ins=2.663, length=3.09, ppl=7.84, wps=25284.7, ups=0.42, wpb=59571.6, bsz=2012.6, num_updates=195100, lr=0.000226397, gnorm=1.194, loss_scale=8192, train_wall=235, wall=0
2023-03-02 11:23:05 | INFO | train_inner | epoch 099:   1391 / 1978 loss=2.994, nll_loss=0.842, word_ins=2.671, length=3.225, ppl=7.96, wps=25275.2, ups=0.43, wpb=59187.5, bsz=1929.7, num_updates=195200, lr=0.000226339, gnorm=1.276, loss_scale=8192, train_wall=234, wall=0
2023-03-02 11:27:01 | INFO | train_inner | epoch 099:   1491 / 1978 loss=2.985, nll_loss=0.84, word_ins=2.669, length=3.154, ppl=7.92, wps=25182.7, ups=0.42, wpb=59340.4, bsz=2061.4, num_updates=195300, lr=0.000226281, gnorm=1.267, loss_scale=8192, train_wall=235, wall=0
2023-03-02 11:31:02 | INFO | train_inner | epoch 099:   1591 / 1978 loss=2.996, nll_loss=0.847, word_ins=2.676, length=3.197, ppl=7.98, wps=24643.9, ups=0.42, wpb=59364, bsz=1919.4, num_updates=195400, lr=0.000226224, gnorm=1.314, loss_scale=8192, train_wall=241, wall=0
2023-03-02 11:35:03 | INFO | train_inner | epoch 099:   1691 / 1978 loss=3.027, nll_loss=0.879, word_ins=2.705, length=3.228, ppl=8.15, wps=24459.1, ups=0.41, wpb=58970.1, bsz=1947.8, num_updates=195500, lr=0.000226166, gnorm=1.31, loss_scale=8192, train_wall=241, wall=0
2023-03-02 11:39:04 | INFO | train_inner | epoch 099:   1791 / 1978 loss=2.973, nll_loss=0.829, word_ins=2.659, length=3.14, ppl=7.85, wps=24626.1, ups=0.41, wpb=59414.8, bsz=2027.2, num_updates=195600, lr=0.000226108, gnorm=1.197, loss_scale=8192, train_wall=241, wall=0
2023-03-02 11:43:04 | INFO | train_inner | epoch 099:   1891 / 1978 loss=2.983, nll_loss=0.838, word_ins=2.667, length=3.163, ppl=7.91, wps=24780.6, ups=0.42, wpb=59332.5, bsz=2027.2, num_updates=195700, lr=0.00022605, gnorm=1.244, loss_scale=8192, train_wall=239, wall=0
2023-03-02 11:46:30 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 11:46:46 | INFO | valid | epoch 099 | valid on 'valid' subset | loss 4.062 | nll_loss 1.885 | word_ins 3.653 | length 4.085 | ppl 16.7 | wps 29259.5 | wpb 40242.5 | bsz 1500 | num_updates 195787 | best_loss 4.034
2023-03-02 11:46:46 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 11:46:52 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint99.pt (epoch 99 @ 195787 updates, score 4.062) (writing took 5.77924704644829 seconds)
2023-03-02 11:46:52 | INFO | fairseq_cli.train | end of epoch 99 (average epoch stats below)
2023-03-02 11:46:52 | INFO | train | epoch 099 | loss 2.983 | nll_loss 0.839 | word_ins 2.668 | length 3.146 | ppl 7.91 | wps 24835.3 | ups 0.42 | wpb 59281.7 | bsz 2002.7 | num_updates 195787 | lr 0.000226 | gnorm 1.266 | loss_scale 8192 | train_wall 4682 | wall 0
2023-03-02 11:46:52 | INFO | fairseq.trainer | begin training epoch 100
2023-03-02 11:47:31 | INFO | train_inner | epoch 100:     13 / 1978 loss=2.987, nll_loss=0.843, word_ins=2.672, length=3.146, ppl=7.93, wps=22111.2, ups=0.37, wpb=59174.9, bsz=1981.9, num_updates=195800, lr=0.000225992, gnorm=1.235, loss_scale=8192, train_wall=236, wall=0
2023-03-02 11:51:36 | INFO | train_inner | epoch 100:    113 / 1978 loss=2.944, nll_loss=0.808, word_ins=2.641, length=3.029, ppl=7.69, wps=24338, ups=0.41, wpb=59532.3, bsz=2015.2, num_updates=195900, lr=0.000225935, gnorm=1.254, loss_scale=8192, train_wall=244, wall=0
2023-03-02 11:55:44 | INFO | train_inner | epoch 100:    213 / 1978 loss=2.968, nll_loss=0.823, word_ins=2.654, length=3.14, ppl=7.83, wps=23894.6, ups=0.4, wpb=59294.3, bsz=2012.1, num_updates=196000, lr=0.000225877, gnorm=1.274, loss_scale=8192, train_wall=248, wall=0
2023-03-02 11:59:44 | INFO | train_inner | epoch 100:    313 / 1978 loss=2.985, nll_loss=0.835, word_ins=2.665, length=3.201, ppl=7.92, wps=24679.6, ups=0.42, wpb=59176.1, bsz=1969.3, num_updates=196100, lr=0.000225819, gnorm=1.246, loss_scale=8192, train_wall=239, wall=0
2023-03-02 12:03:44 | INFO | train_inner | epoch 100:    413 / 1978 loss=2.984, nll_loss=0.837, word_ins=2.667, length=3.167, ppl=7.91, wps=24365, ups=0.42, wpb=58503, bsz=1980.1, num_updates=196200, lr=0.000225762, gnorm=1.268, loss_scale=8192, train_wall=240, wall=0
2023-03-02 12:07:39 | INFO | train_inner | epoch 100:    513 / 1978 loss=2.978, nll_loss=0.83, word_ins=2.66, length=3.177, ppl=7.88, wps=25372.6, ups=0.43, wpb=59499.3, bsz=1981.2, num_updates=196300, lr=0.000225704, gnorm=1.323, loss_scale=8192, train_wall=234, wall=0
2023-03-02 12:11:34 | INFO | train_inner | epoch 100:    613 / 1978 loss=2.957, nll_loss=0.819, word_ins=2.65, length=3.067, ppl=7.76, wps=25240.1, ups=0.42, wpb=59561.3, bsz=2121.6, num_updates=196400, lr=0.000225647, gnorm=1.26, loss_scale=8192, train_wall=236, wall=0
2023-03-02 12:15:31 | INFO | train_inner | epoch 100:    713 / 1978 loss=2.968, nll_loss=0.826, word_ins=2.657, length=3.114, ppl=7.83, wps=25354.9, ups=0.42, wpb=59944.1, bsz=2026.2, num_updates=196500, lr=0.000225589, gnorm=1.286, loss_scale=8192, train_wall=236, wall=0
2023-03-02 12:19:24 | INFO | train_inner | epoch 100:    813 / 1978 loss=2.975, nll_loss=0.834, word_ins=2.663, length=3.111, ppl=7.86, wps=25348.6, ups=0.43, wpb=59178.2, bsz=2061.3, num_updates=196600, lr=0.000225532, gnorm=1.302, loss_scale=8192, train_wall=233, wall=0
2023-03-02 12:23:50 | INFO | train_inner | epoch 100:    913 / 1978 loss=2.974, nll_loss=0.829, word_ins=2.66, length=3.148, ppl=7.86, wps=22271.5, ups=0.38, wpb=59226.1, bsz=1967, num_updates=196700, lr=0.000225475, gnorm=1.231, loss_scale=8192, train_wall=266, wall=0
2023-03-02 12:28:30 | INFO | train_inner | epoch 100:   1013 / 1978 loss=2.987, nll_loss=0.845, word_ins=2.674, length=3.13, ppl=7.93, wps=21181.6, ups=0.36, wpb=59248.5, bsz=1979.5, num_updates=196800, lr=0.000225417, gnorm=1.296, loss_scale=8192, train_wall=279, wall=0
2023-03-02 12:32:37 | INFO | train_inner | epoch 100:   1113 / 1978 loss=2.977, nll_loss=0.837, word_ins=2.667, length=3.105, ppl=7.88, wps=23958.7, ups=0.41, wpb=59061.7, bsz=2023.1, num_updates=196900, lr=0.00022536, gnorm=1.262, loss_scale=8192, train_wall=246, wall=0
2023-03-02 12:36:29 | INFO | train_inner | epoch 100:   1213 / 1978 loss=2.984, nll_loss=0.838, word_ins=2.667, length=3.162, ppl=7.91, wps=25471.9, ups=0.43, wpb=59259.3, bsz=2022.2, num_updates=197000, lr=0.000225303, gnorm=1.268, loss_scale=8192, train_wall=232, wall=0
2023-03-02 12:40:24 | INFO | train_inner | epoch 100:   1313 / 1978 loss=2.985, nll_loss=0.843, word_ins=2.673, length=3.121, ppl=7.92, wps=25462.7, ups=0.43, wpb=59663, bsz=1973.1, num_updates=197100, lr=0.000225246, gnorm=1.349, loss_scale=8192, train_wall=234, wall=0
2023-03-02 12:44:16 | INFO | train_inner | epoch 100:   1413 / 1978 loss=3.002, nll_loss=0.851, word_ins=2.679, length=3.228, ppl=8.01, wps=25315.8, ups=0.43, wpb=58837.6, bsz=1974, num_updates=197200, lr=0.000225189, gnorm=1.296, loss_scale=8192, train_wall=232, wall=0
2023-03-02 12:48:09 | INFO | train_inner | epoch 100:   1513 / 1978 loss=2.979, nll_loss=0.837, word_ins=2.667, length=3.126, ppl=7.89, wps=25516.4, ups=0.43, wpb=59455.9, bsz=2039, num_updates=197300, lr=0.000225132, gnorm=1.319, loss_scale=8192, train_wall=233, wall=0
2023-03-02 12:52:05 | INFO | train_inner | epoch 100:   1613 / 1978 loss=2.987, nll_loss=0.843, word_ins=2.671, length=3.155, ppl=7.93, wps=25283.3, ups=0.42, wpb=59611, bsz=2023.8, num_updates=197400, lr=0.000225075, gnorm=1.304, loss_scale=8192, train_wall=236, wall=0
2023-03-02 12:55:56 | INFO | train_inner | epoch 100:   1713 / 1978 loss=3.007, nll_loss=0.859, word_ins=2.687, length=3.204, ppl=8.04, wps=25444.5, ups=0.43, wpb=58901.5, bsz=1923.2, num_updates=197500, lr=0.000225018, gnorm=1.325, loss_scale=8192, train_wall=231, wall=0
2023-03-02 12:59:47 | INFO | train_inner | epoch 100:   1813 / 1978 loss=2.999, nll_loss=0.851, word_ins=2.68, length=3.186, ppl=7.99, wps=25570.7, ups=0.43, wpb=59122.5, bsz=1940.5, num_updates=197600, lr=0.000224961, gnorm=1.274, loss_scale=8192, train_wall=231, wall=0
2023-03-02 13:03:39 | INFO | train_inner | epoch 100:   1913 / 1978 loss=2.98, nll_loss=0.834, word_ins=2.664, length=3.159, ppl=7.89, wps=25498.8, ups=0.43, wpb=59135.7, bsz=2065.2, num_updates=197700, lr=0.000224904, gnorm=1.257, loss_scale=8192, train_wall=232, wall=0
2023-03-02 13:06:10 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 13:06:26 | INFO | valid | epoch 100 | valid on 'valid' subset | loss 4.07 | nll_loss 1.923 | word_ins 3.689 | length 3.813 | ppl 16.8 | wps 31650.6 | wpb 40242.5 | bsz 1500 | num_updates 197765 | best_loss 4.034
2023-03-02 13:06:26 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 13:06:33 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint100.pt (epoch 100 @ 197765 updates, score 4.07) (writing took 6.070059613324702 seconds)
2023-03-02 13:06:33 | INFO | fairseq_cli.train | end of epoch 100 (average epoch stats below)
2023-03-02 13:06:33 | INFO | train | epoch 100 | loss 2.98 | nll_loss 0.836 | word_ins 2.666 | length 3.143 | ppl 7.89 | wps 24528.2 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 197765 | lr 0.000224867 | gnorm 1.283 | loss_scale 8192 | train_wall 4743 | wall 0
2023-03-02 13:06:33 | INFO | fairseq.trainer | begin training epoch 101
2023-03-02 13:08:06 | INFO | train_inner | epoch 101:     35 / 1978 loss=2.969, nll_loss=0.828, word_ins=2.658, length=3.111, ppl=7.83, wps=22278.2, ups=0.38, wpb=59303.4, bsz=1987.8, num_updates=197800, lr=0.000224847, gnorm=1.246, loss_scale=8192, train_wall=233, wall=0
2023-03-02 13:12:00 | INFO | train_inner | epoch 101:    135 / 1978 loss=2.951, nll_loss=0.807, word_ins=2.64, length=3.113, ppl=7.73, wps=25233.6, ups=0.43, wpb=59241.3, bsz=2053.4, num_updates=197900, lr=0.00022479, gnorm=1.248, loss_scale=8192, train_wall=235, wall=0
2023-03-02 13:15:56 | INFO | train_inner | epoch 101:    235 / 1978 loss=2.978, nll_loss=0.833, word_ins=2.663, length=3.153, ppl=7.88, wps=24998.4, ups=0.42, wpb=58884.5, bsz=1964.2, num_updates=198000, lr=0.000224733, gnorm=1.24, loss_scale=8192, train_wall=235, wall=0
2023-03-02 13:19:52 | INFO | train_inner | epoch 101:    335 / 1978 loss=2.997, nll_loss=0.852, word_ins=2.681, length=3.168, ppl=7.99, wps=25043.1, ups=0.42, wpb=59049.5, bsz=1887.3, num_updates=198100, lr=0.000224677, gnorm=1.296, loss_scale=8192, train_wall=236, wall=0
2023-03-02 13:23:48 | INFO | train_inner | epoch 101:    435 / 1978 loss=2.953, nll_loss=0.813, word_ins=2.645, length=3.083, ppl=7.74, wps=25191.6, ups=0.42, wpb=59639.3, bsz=2097, num_updates=198200, lr=0.00022462, gnorm=1.282, loss_scale=8192, train_wall=236, wall=0
2023-03-02 13:27:49 | INFO | train_inner | epoch 101:    535 / 1978 loss=2.972, nll_loss=0.833, word_ins=2.663, length=3.086, ppl=7.84, wps=24613.9, ups=0.42, wpb=59189.8, bsz=2041, num_updates=198300, lr=0.000224563, gnorm=1.281, loss_scale=8192, train_wall=240, wall=0
2023-03-02 13:31:52 | INFO | train_inner | epoch 101:    635 / 1978 loss=2.961, nll_loss=0.821, word_ins=2.652, length=3.087, ppl=7.79, wps=24354.5, ups=0.41, wpb=59297.2, bsz=2030.8, num_updates=198400, lr=0.000224507, gnorm=1.242, loss_scale=8192, train_wall=243, wall=0
2023-03-02 13:35:55 | INFO | train_inner | epoch 101:    735 / 1978 loss=2.991, nll_loss=0.845, word_ins=2.674, length=3.167, ppl=7.95, wps=24380.3, ups=0.41, wpb=59180.3, bsz=1983.4, num_updates=198500, lr=0.00022445, gnorm=1.304, loss_scale=8192, train_wall=242, wall=0
2023-03-02 13:39:55 | INFO | train_inner | epoch 101:    835 / 1978 loss=2.992, nll_loss=0.849, word_ins=2.678, length=3.142, ppl=7.96, wps=24905.9, ups=0.42, wpb=59671.9, bsz=2004.6, num_updates=198600, lr=0.000224394, gnorm=1.329, loss_scale=8192, train_wall=239, wall=0
2023-03-02 13:43:58 | INFO | train_inner | epoch 101:    935 / 1978 loss=2.964, nll_loss=0.822, word_ins=2.653, length=3.112, ppl=7.8, wps=24594.5, ups=0.41, wpb=59721.5, bsz=2100.6, num_updates=198700, lr=0.000224337, gnorm=1.244, loss_scale=8192, train_wall=243, wall=0
2023-03-02 13:48:00 | INFO | train_inner | epoch 101:   1035 / 1978 loss=2.982, nll_loss=0.838, word_ins=2.667, length=3.145, ppl=7.9, wps=24614.8, ups=0.41, wpb=59730.7, bsz=1957.7, num_updates=198800, lr=0.000224281, gnorm=1.276, loss_scale=8192, train_wall=242, wall=0
2023-03-02 13:52:02 | INFO | train_inner | epoch 101:   1135 / 1978 loss=2.98, nll_loss=0.834, word_ins=2.663, length=3.164, ppl=7.89, wps=24383.3, ups=0.41, wpb=59060, bsz=2031.3, num_updates=198900, lr=0.000224224, gnorm=1.261, loss_scale=8192, train_wall=242, wall=0
2023-03-02 13:56:05 | INFO | train_inner | epoch 101:   1235 / 1978 loss=2.982, nll_loss=0.837, word_ins=2.667, length=3.153, ppl=7.9, wps=24527.5, ups=0.41, wpb=59492.4, bsz=2000.9, num_updates=199000, lr=0.000224168, gnorm=1.291, loss_scale=8192, train_wall=242, wall=0
2023-03-02 13:57:15 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 14:00:09 | INFO | train_inner | epoch 101:   1336 / 1978 loss=2.99, nll_loss=0.837, word_ins=2.668, length=3.224, ppl=7.95, wps=23921.6, ups=0.41, wpb=58453.7, bsz=1932.7, num_updates=199100, lr=0.000224112, gnorm=1.258, loss_scale=8192, train_wall=244, wall=0
2023-03-02 14:04:14 | INFO | train_inner | epoch 101:   1436 / 1978 loss=2.955, nll_loss=0.818, word_ins=2.649, length=3.057, ppl=7.76, wps=24313.3, ups=0.41, wpb=59422.4, bsz=2123, num_updates=199200, lr=0.000224055, gnorm=1.288, loss_scale=8192, train_wall=244, wall=0
2023-03-02 14:08:10 | INFO | train_inner | epoch 101:   1536 / 1978 loss=3.002, nll_loss=0.856, word_ins=2.684, length=3.179, ppl=8.01, wps=24939.3, ups=0.42, wpb=58870.1, bsz=1955.1, num_updates=199300, lr=0.000223999, gnorm=1.306, loss_scale=8192, train_wall=236, wall=0
2023-03-02 14:12:03 | INFO | train_inner | epoch 101:   1636 / 1978 loss=3.012, nll_loss=0.865, word_ins=2.691, length=3.204, ppl=8.07, wps=25517.7, ups=0.43, wpb=59452.4, bsz=1843.6, num_updates=199400, lr=0.000223943, gnorm=1.33, loss_scale=8192, train_wall=233, wall=0
2023-03-02 14:15:58 | INFO | train_inner | epoch 101:   1736 / 1978 loss=2.978, nll_loss=0.839, word_ins=2.669, length=3.094, ppl=7.88, wps=25354.9, ups=0.43, wpb=59547.6, bsz=2003.4, num_updates=199500, lr=0.000223887, gnorm=1.31, loss_scale=8192, train_wall=235, wall=0
2023-03-02 14:19:52 | INFO | train_inner | epoch 101:   1836 / 1978 loss=2.994, nll_loss=0.849, word_ins=2.677, length=3.174, ppl=7.97, wps=25398.5, ups=0.43, wpb=59460.5, bsz=1988.4, num_updates=199600, lr=0.000223831, gnorm=1.296, loss_scale=8192, train_wall=234, wall=0
2023-03-02 14:23:46 | INFO | train_inner | epoch 101:   1936 / 1978 loss=2.962, nll_loss=0.824, word_ins=2.654, length=3.082, ppl=7.79, wps=25318.6, ups=0.43, wpb=59371.4, bsz=2067.4, num_updates=199700, lr=0.000223775, gnorm=1.277, loss_scale=8192, train_wall=234, wall=0
2023-03-02 14:25:25 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 14:25:41 | INFO | valid | epoch 101 | valid on 'valid' subset | loss 4.096 | nll_loss 1.907 | word_ins 3.676 | length 4.194 | ppl 17.1 | wps 30907 | wpb 40242.5 | bsz 1500 | num_updates 199742 | best_loss 4.034
2023-03-02 14:25:41 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 14:25:47 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint101.pt (epoch 101 @ 199742 updates, score 4.096) (writing took 5.725517338141799 seconds)
2023-03-02 14:25:47 | INFO | fairseq_cli.train | end of epoch 101 (average epoch stats below)
2023-03-02 14:25:47 | INFO | train | epoch 101 | loss 2.978 | nll_loss 0.835 | word_ins 2.665 | length 3.136 | ppl 7.88 | wps 24651.4 | ups 0.42 | wpb 59284.5 | bsz 2002.9 | num_updates 199742 | lr 0.000223751 | gnorm 1.282 | loss_scale 8192 | train_wall 4716 | wall 0
2023-03-02 14:25:47 | INFO | fairseq.trainer | begin training epoch 102
2023-03-02 14:28:12 | INFO | train_inner | epoch 102:     58 / 1978 loss=2.989, nll_loss=0.843, word_ins=2.673, length=3.164, ppl=7.94, wps=22242.7, ups=0.38, wpb=59150.1, bsz=1908.7, num_updates=199800, lr=0.000223719, gnorm=1.354, loss_scale=8192, train_wall=233, wall=0
2023-03-02 14:32:07 | INFO | train_inner | epoch 102:    158 / 1978 loss=2.982, nll_loss=0.836, word_ins=2.666, length=3.165, ppl=7.9, wps=25349.1, ups=0.43, wpb=59523.3, bsz=1957.2, num_updates=199900, lr=0.000223663, gnorm=1.335, loss_scale=8192, train_wall=235, wall=0
2023-03-02 14:36:02 | INFO | train_inner | epoch 102:    258 / 1978 loss=2.952, nll_loss=0.815, word_ins=2.647, length=3.057, ppl=7.74, wps=25198.8, ups=0.43, wpb=59280.9, bsz=2092.5, num_updates=200000, lr=0.000223607, gnorm=1.293, loss_scale=8192, train_wall=235, wall=0
2023-03-02 14:39:58 | INFO | train_inner | epoch 102:    358 / 1978 loss=2.98, nll_loss=0.839, word_ins=2.669, length=3.11, ppl=7.89, wps=25189.1, ups=0.42, wpb=59397.8, bsz=2003.7, num_updates=200100, lr=0.000223551, gnorm=1.315, loss_scale=8192, train_wall=236, wall=0
2023-03-02 14:43:52 | INFO | train_inner | epoch 102:    458 / 1978 loss=2.974, nll_loss=0.831, word_ins=2.662, length=3.128, ppl=7.86, wps=25415.2, ups=0.43, wpb=59444.7, bsz=1922.2, num_updates=200200, lr=0.000223495, gnorm=1.301, loss_scale=8192, train_wall=234, wall=0
2023-03-02 14:47:48 | INFO | train_inner | epoch 102:    558 / 1978 loss=2.977, nll_loss=0.836, word_ins=2.666, length=3.112, ppl=7.87, wps=24996.9, ups=0.42, wpb=58977.8, bsz=2022.7, num_updates=200300, lr=0.000223439, gnorm=1.234, loss_scale=8192, train_wall=236, wall=0
2023-03-02 14:51:44 | INFO | train_inner | epoch 102:    658 / 1978 loss=2.97, nll_loss=0.823, word_ins=2.654, length=3.156, ppl=7.83, wps=24990.2, ups=0.42, wpb=58929, bsz=2031.7, num_updates=200400, lr=0.000223384, gnorm=1.286, loss_scale=8192, train_wall=236, wall=0
2023-03-02 14:55:38 | INFO | train_inner | epoch 102:    758 / 1978 loss=2.994, nll_loss=0.846, word_ins=2.675, length=3.191, ppl=7.97, wps=25247.6, ups=0.43, wpb=59229.7, bsz=1933.7, num_updates=200500, lr=0.000223328, gnorm=1.284, loss_scale=8192, train_wall=234, wall=0
2023-03-02 14:59:38 | INFO | train_inner | epoch 102:    858 / 1978 loss=2.956, nll_loss=0.811, word_ins=2.643, length=3.126, ppl=7.76, wps=24812.4, ups=0.42, wpb=59523.3, bsz=2008.9, num_updates=200600, lr=0.000223272, gnorm=1.305, loss_scale=8192, train_wall=240, wall=0
2023-03-02 15:03:32 | INFO | train_inner | epoch 102:    958 / 1978 loss=3.005, nll_loss=0.855, word_ins=2.683, length=3.226, ppl=8.03, wps=25079.3, ups=0.43, wpb=58728.7, bsz=1980.7, num_updates=200700, lr=0.000223217, gnorm=1.332, loss_scale=8192, train_wall=234, wall=0
2023-03-02 15:07:27 | INFO | train_inner | epoch 102:   1058 / 1978 loss=2.981, nll_loss=0.836, word_ins=2.666, length=3.15, ppl=7.89, wps=25295.1, ups=0.43, wpb=59434.2, bsz=1989.4, num_updates=200800, lr=0.000223161, gnorm=1.336, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:11:22 | INFO | train_inner | epoch 102:   1158 / 1978 loss=2.996, nll_loss=0.848, word_ins=2.677, length=3.197, ppl=7.98, wps=25127.5, ups=0.43, wpb=59019.9, bsz=1966.2, num_updates=200900, lr=0.000223105, gnorm=1.347, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:15:19 | INFO | train_inner | epoch 102:   1258 / 1978 loss=2.96, nll_loss=0.819, word_ins=2.65, length=3.097, ppl=7.78, wps=25169.1, ups=0.42, wpb=59539, bsz=2107.1, num_updates=201000, lr=0.00022305, gnorm=1.249, loss_scale=8192, train_wall=236, wall=0
2023-03-02 15:19:14 | INFO | train_inner | epoch 102:   1358 / 1978 loss=2.967, nll_loss=0.828, word_ins=2.658, length=3.09, ppl=7.82, wps=25069.4, ups=0.42, wpb=59002.6, bsz=2038.8, num_updates=201100, lr=0.000222994, gnorm=1.28, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:23:10 | INFO | train_inner | epoch 102:   1458 / 1978 loss=2.967, nll_loss=0.823, word_ins=2.654, length=3.128, ppl=7.82, wps=25419.9, ups=0.42, wpb=59822.1, bsz=2009, num_updates=201200, lr=0.000222939, gnorm=1.294, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:27:05 | INFO | train_inner | epoch 102:   1558 / 1978 loss=2.991, nll_loss=0.842, word_ins=2.672, length=3.195, ppl=7.95, wps=25104.9, ups=0.43, wpb=58999, bsz=1990.9, num_updates=201300, lr=0.000222884, gnorm=1.239, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:30:59 | INFO | train_inner | epoch 102:   1658 / 1978 loss=2.988, nll_loss=0.837, word_ins=2.667, length=3.209, ppl=7.94, wps=25024, ups=0.43, wpb=58706.8, bsz=1983.1, num_updates=201400, lr=0.000222828, gnorm=1.287, loss_scale=8192, train_wall=234, wall=0
2023-03-02 15:34:54 | INFO | train_inner | epoch 102:   1758 / 1978 loss=2.964, nll_loss=0.827, word_ins=2.657, length=3.07, ppl=7.8, wps=25451.4, ups=0.43, wpb=59650.7, bsz=2028.1, num_updates=201500, lr=0.000222773, gnorm=1.298, loss_scale=8192, train_wall=234, wall=0
2023-03-02 15:38:49 | INFO | train_inner | epoch 102:   1858 / 1978 loss=2.98, nll_loss=0.836, word_ins=2.666, length=3.148, ppl=7.89, wps=25320.1, ups=0.42, wpb=59577.1, bsz=1960.9, num_updates=201600, lr=0.000222718, gnorm=1.295, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:42:44 | INFO | train_inner | epoch 102:   1958 / 1978 loss=2.955, nll_loss=0.814, word_ins=2.645, length=3.103, ppl=7.76, wps=25361.3, ups=0.42, wpb=59727.2, bsz=2100.3, num_updates=201700, lr=0.000222662, gnorm=1.273, loss_scale=8192, train_wall=235, wall=0
2023-03-02 15:43:31 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 15:43:49 | INFO | valid | epoch 102 | valid on 'valid' subset | loss 4.041 | nll_loss 1.896 | word_ins 3.667 | length 3.745 | ppl 16.47 | wps 30198.3 | wpb 40242.5 | bsz 1500 | num_updates 201720 | best_loss 4.034
2023-03-02 15:43:49 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 15:43:55 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint102.pt (epoch 102 @ 201720 updates, score 4.041) (writing took 5.626761998049915 seconds)
2023-03-02 15:43:55 | INFO | fairseq_cli.train | end of epoch 102 (average epoch stats below)
2023-03-02 15:43:55 | INFO | train | epoch 102 | loss 2.977 | nll_loss 0.833 | word_ins 2.663 | length 3.142 | ppl 7.87 | wps 25016 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 201720 | lr 0.000222651 | gnorm 1.297 | loss_scale 8192 | train_wall 4650 | wall 0
2023-03-02 15:43:55 | INFO | fairseq.trainer | begin training epoch 103
2023-03-02 15:47:12 | INFO | train_inner | epoch 103:     80 / 1978 loss=2.971, nll_loss=0.83, word_ins=2.66, length=3.109, ppl=7.84, wps=22133.9, ups=0.37, wpb=59307.4, bsz=2047.1, num_updates=201800, lr=0.000222607, gnorm=1.334, loss_scale=8192, train_wall=234, wall=0
2023-03-02 15:51:07 | INFO | train_inner | epoch 103:    180 / 1978 loss=2.963, nll_loss=0.82, word_ins=2.651, length=3.125, ppl=7.8, wps=25249.2, ups=0.43, wpb=59249.4, bsz=1976.6, num_updates=201900, lr=0.000222552, gnorm=1.359, loss_scale=8192, train_wall=234, wall=0
2023-03-02 15:55:01 | INFO | train_inner | epoch 103:    280 / 1978 loss=2.948, nll_loss=0.808, word_ins=2.641, length=3.077, ppl=7.72, wps=25478.3, ups=0.43, wpb=59618.8, bsz=2008.3, num_updates=202000, lr=0.000222497, gnorm=1.316, loss_scale=8192, train_wall=234, wall=0
2023-03-02 15:58:52 | INFO | train_inner | epoch 103:    380 / 1978 loss=2.982, nll_loss=0.838, word_ins=2.668, length=3.138, ppl=7.9, wps=25618.3, ups=0.43, wpb=59303.3, bsz=1992.6, num_updates=202100, lr=0.000222442, gnorm=1.293, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:02:44 | INFO | train_inner | epoch 103:    480 / 1978 loss=2.991, nll_loss=0.85, word_ins=2.679, length=3.119, ppl=7.95, wps=25490, ups=0.43, wpb=59063.9, bsz=1954.4, num_updates=202200, lr=0.000222387, gnorm=1.32, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:06:35 | INFO | train_inner | epoch 103:    580 / 1978 loss=2.983, nll_loss=0.834, word_ins=2.664, length=3.187, ppl=7.91, wps=25676.1, ups=0.43, wpb=59181.3, bsz=1927, num_updates=202300, lr=0.000222332, gnorm=1.29, loss_scale=8192, train_wall=230, wall=0
2023-03-02 16:10:25 | INFO | train_inner | epoch 103:    680 / 1978 loss=2.989, nll_loss=0.841, word_ins=2.671, length=3.18, ppl=7.94, wps=25285.5, ups=0.43, wpb=58350, bsz=1980.5, num_updates=202400, lr=0.000222277, gnorm=1.258, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:14:18 | INFO | train_inner | epoch 103:    780 / 1978 loss=2.957, nll_loss=0.815, word_ins=2.647, length=3.099, ppl=7.76, wps=25492.8, ups=0.43, wpb=59393.8, bsz=2127.4, num_updates=202500, lr=0.000222222, gnorm=1.318, loss_scale=8192, train_wall=233, wall=0
2023-03-02 16:18:10 | INFO | train_inner | epoch 103:    880 / 1978 loss=2.966, nll_loss=0.825, word_ins=2.655, length=3.101, ppl=7.81, wps=25842.3, ups=0.43, wpb=59821.1, bsz=2068.7, num_updates=202600, lr=0.000222167, gnorm=1.285, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:22:00 | INFO | train_inner | epoch 103:    980 / 1978 loss=2.982, nll_loss=0.839, word_ins=2.668, length=3.139, ppl=7.9, wps=26100.8, ups=0.43, wpb=60063.4, bsz=1961.4, num_updates=202700, lr=0.000222113, gnorm=1.277, loss_scale=8192, train_wall=230, wall=0
2023-03-02 16:25:52 | INFO | train_inner | epoch 103:   1080 / 1978 loss=2.973, nll_loss=0.827, word_ins=2.657, length=3.161, ppl=7.85, wps=25603.9, ups=0.43, wpb=59340.2, bsz=1957.6, num_updates=202800, lr=0.000222058, gnorm=1.287, loss_scale=8192, train_wall=232, wall=0
2023-03-02 16:29:43 | INFO | train_inner | epoch 103:   1180 / 1978 loss=2.966, nll_loss=0.827, word_ins=2.657, length=3.089, ppl=7.81, wps=25911.3, ups=0.43, wpb=59799.2, bsz=2028.3, num_updates=202900, lr=0.000222003, gnorm=1.391, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:33:34 | INFO | train_inner | epoch 103:   1280 / 1978 loss=2.99, nll_loss=0.846, word_ins=2.675, length=3.151, ppl=7.94, wps=25623.8, ups=0.43, wpb=59217.2, bsz=1966.6, num_updates=203000, lr=0.000221948, gnorm=1.271, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:37:24 | INFO | train_inner | epoch 103:   1380 / 1978 loss=2.978, nll_loss=0.828, word_ins=2.659, length=3.197, ppl=7.88, wps=25635.8, ups=0.43, wpb=59156.8, bsz=2046.2, num_updates=203100, lr=0.000221894, gnorm=1.335, loss_scale=8192, train_wall=231, wall=0
2023-03-02 16:38:39 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 16:41:18 | INFO | train_inner | epoch 103:   1481 / 1978 loss=2.968, nll_loss=0.826, word_ins=2.657, length=3.112, ppl=7.82, wps=25287.6, ups=0.43, wpb=59140, bsz=2019.5, num_updates=203200, lr=0.000221839, gnorm=1.318, loss_scale=8192, train_wall=234, wall=0
2023-03-02 16:45:08 | INFO | train_inner | epoch 103:   1581 / 1978 loss=2.987, nll_loss=0.84, word_ins=2.669, length=3.182, ppl=7.93, wps=25922.6, ups=0.44, wpb=59460.8, bsz=1905.8, num_updates=203300, lr=0.000221785, gnorm=1.312, loss_scale=8192, train_wall=229, wall=0
2023-03-02 16:48:57 | INFO | train_inner | epoch 103:   1681 / 1978 loss=2.987, nll_loss=0.839, word_ins=2.668, length=3.186, ppl=7.93, wps=25854, ups=0.44, wpb=59360.3, bsz=1924.2, num_updates=203400, lr=0.00022173, gnorm=1.328, loss_scale=8192, train_wall=229, wall=0
2023-03-02 16:52:48 | INFO | train_inner | epoch 103:   1781 / 1978 loss=2.982, nll_loss=0.836, word_ins=2.666, length=3.168, ppl=7.9, wps=25569.2, ups=0.43, wpb=58881.2, bsz=2010.3, num_updates=203500, lr=0.000221676, gnorm=1.279, loss_scale=8192, train_wall=230, wall=0
2023-03-02 16:56:40 | INFO | train_inner | epoch 103:   1881 / 1978 loss=2.956, nll_loss=0.812, word_ins=2.643, length=3.124, ppl=7.76, wps=25400.8, ups=0.43, wpb=59053.5, bsz=2099.1, num_updates=203600, lr=0.000221621, gnorm=1.265, loss_scale=8192, train_wall=232, wall=0
2023-03-02 17:00:23 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 17:00:40 | INFO | valid | epoch 103 | valid on 'valid' subset | loss 4.083 | nll_loss 1.923 | word_ins 3.687 | length 3.96 | ppl 16.94 | wps 31137.1 | wpb 40242.5 | bsz 1500 | num_updates 203697 | best_loss 4.034
2023-03-02 17:00:40 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 17:00:46 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint103.pt (epoch 103 @ 203697 updates, score 4.083) (writing took 5.608128745108843 seconds)
2023-03-02 17:00:46 | INFO | fairseq_cli.train | end of epoch 103 (average epoch stats below)
2023-03-02 17:00:46 | INFO | train | epoch 103 | loss 2.975 | nll_loss 0.831 | word_ins 2.661 | length 3.14 | ppl 7.86 | wps 25416 | ups 0.43 | wpb 59282.6 | bsz 2002.5 | num_updates 203697 | lr 0.000221568 | gnorm 1.306 | loss_scale 8192 | train_wall 4574 | wall 0
2023-03-02 17:00:46 | INFO | fairseq.trainer | begin training epoch 104
2023-03-02 17:01:02 | INFO | train_inner | epoch 104:      3 / 1978 loss=2.984, nll_loss=0.837, word_ins=2.667, length=3.174, ppl=7.91, wps=22449.1, ups=0.38, wpb=58742.4, bsz=2030.2, num_updates=203700, lr=0.000221567, gnorm=1.307, loss_scale=8192, train_wall=229, wall=0
2023-03-02 17:04:54 | INFO | train_inner | epoch 104:    103 / 1978 loss=2.97, nll_loss=0.827, word_ins=2.658, length=3.12, ppl=7.83, wps=25521, ups=0.43, wpb=59236.1, bsz=2049.8, num_updates=203800, lr=0.000221512, gnorm=1.246, loss_scale=8192, train_wall=232, wall=0
2023-03-02 17:08:46 | INFO | train_inner | epoch 104:    203 / 1978 loss=2.965, nll_loss=0.823, word_ins=2.654, length=3.104, ppl=7.81, wps=25700.4, ups=0.43, wpb=59537.3, bsz=2012.2, num_updates=203900, lr=0.000221458, gnorm=1.376, loss_scale=8192, train_wall=231, wall=0
2023-03-02 17:12:36 | INFO | train_inner | epoch 104:    303 / 1978 loss=2.957, nll_loss=0.817, word_ins=2.648, length=3.09, ppl=7.77, wps=25603.7, ups=0.43, wpb=58966.4, bsz=1973.1, num_updates=204000, lr=0.000221404, gnorm=1.29, loss_scale=8192, train_wall=230, wall=0
2023-03-02 17:16:29 | INFO | train_inner | epoch 104:    403 / 1978 loss=2.957, nll_loss=0.817, word_ins=2.648, length=3.091, ppl=7.77, wps=25664.4, ups=0.43, wpb=59849.8, bsz=2086.6, num_updates=204100, lr=0.000221349, gnorm=1.284, loss_scale=8192, train_wall=233, wall=0
2023-03-02 17:20:20 | INFO | train_inner | epoch 104:    503 / 1978 loss=2.984, nll_loss=0.84, word_ins=2.669, length=3.152, ppl=7.91, wps=25499.5, ups=0.43, wpb=58774.5, bsz=1987.1, num_updates=204200, lr=0.000221295, gnorm=1.322, loss_scale=8192, train_wall=230, wall=0
2023-03-02 17:24:12 | INFO | train_inner | epoch 104:    603 / 1978 loss=2.939, nll_loss=0.802, word_ins=2.634, length=3.05, ppl=7.67, wps=25680.4, ups=0.43, wpb=59673.2, bsz=2044.1, num_updates=204300, lr=0.000221241, gnorm=1.289, loss_scale=8192, train_wall=232, wall=0
2023-03-02 17:28:04 | INFO | train_inner | epoch 104:    703 / 1978 loss=2.972, nll_loss=0.828, word_ins=2.659, length=3.13, ppl=7.85, wps=25738.6, ups=0.43, wpb=59794.7, bsz=1976.6, num_updates=204400, lr=0.000221187, gnorm=1.319, loss_scale=8192, train_wall=232, wall=0
2023-03-02 17:31:56 | INFO | train_inner | epoch 104:    803 / 1978 loss=2.972, nll_loss=0.828, word_ins=2.658, length=3.143, ppl=7.85, wps=25463.5, ups=0.43, wpb=59110.8, bsz=2027.6, num_updates=204500, lr=0.000221133, gnorm=1.318, loss_scale=8192, train_wall=232, wall=0
2023-03-02 17:35:48 | INFO | train_inner | epoch 104:    903 / 1978 loss=2.978, nll_loss=0.837, word_ins=2.666, length=3.122, ppl=7.88, wps=25674.8, ups=0.43, wpb=59417.2, bsz=2001.4, num_updates=204600, lr=0.000221079, gnorm=1.347, loss_scale=8192, train_wall=231, wall=0
2023-03-02 17:39:39 | INFO | train_inner | epoch 104:   1003 / 1978 loss=2.971, nll_loss=0.826, word_ins=2.657, length=3.14, ppl=7.84, wps=25664.8, ups=0.43, wpb=59319.3, bsz=2007.1, num_updates=204700, lr=0.000221025, gnorm=1.28, loss_scale=8192, train_wall=231, wall=0
2023-03-02 17:43:33 | INFO | train_inner | epoch 104:   1103 / 1978 loss=2.988, nll_loss=0.845, word_ins=2.674, length=3.133, ppl=7.93, wps=25192.6, ups=0.43, wpb=59051.7, bsz=1990.2, num_updates=204800, lr=0.000220971, gnorm=1.308, loss_scale=8192, train_wall=234, wall=0
2023-03-02 17:47:25 | INFO | train_inner | epoch 104:   1203 / 1978 loss=2.984, nll_loss=0.839, word_ins=2.669, length=3.159, ppl=7.91, wps=25759, ups=0.43, wpb=59690.8, bsz=2006.2, num_updates=204900, lr=0.000220917, gnorm=1.332, loss_scale=8192, train_wall=231, wall=0
2023-03-02 17:51:15 | INFO | train_inner | epoch 104:   1303 / 1978 loss=3.019, nll_loss=0.865, word_ins=2.693, length=3.262, ppl=8.11, wps=25520, ups=0.44, wpb=58616.1, bsz=1852.6, num_updates=205000, lr=0.000220863, gnorm=1.345, loss_scale=8192, train_wall=229, wall=0
2023-03-02 17:55:04 | INFO | train_inner | epoch 104:   1403 / 1978 loss=2.98, nll_loss=0.832, word_ins=2.663, length=3.171, ppl=7.89, wps=25655.3, ups=0.44, wpb=58853.3, bsz=1910.6, num_updates=205100, lr=0.000220809, gnorm=1.349, loss_scale=8192, train_wall=229, wall=0
2023-03-02 17:58:56 | INFO | train_inner | epoch 104:   1503 / 1978 loss=2.988, nll_loss=0.844, word_ins=2.673, length=3.153, ppl=7.93, wps=25502.6, ups=0.43, wpb=59167, bsz=1966.5, num_updates=205200, lr=0.000220755, gnorm=1.319, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:02:49 | INFO | train_inner | epoch 104:   1603 / 1978 loss=2.957, nll_loss=0.817, word_ins=2.648, length=3.091, ppl=7.77, wps=25596.1, ups=0.43, wpb=59518, bsz=2078.1, num_updates=205300, lr=0.000220702, gnorm=1.281, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:06:39 | INFO | train_inner | epoch 104:   1703 / 1978 loss=2.963, nll_loss=0.822, word_ins=2.653, length=3.101, ppl=7.8, wps=25858.8, ups=0.43, wpb=59531.6, bsz=2026.2, num_updates=205400, lr=0.000220648, gnorm=1.292, loss_scale=8192, train_wall=230, wall=0
2023-03-02 18:10:32 | INFO | train_inner | epoch 104:   1803 / 1978 loss=2.958, nll_loss=0.815, word_ins=2.646, length=3.116, ppl=7.77, wps=25600.9, ups=0.43, wpb=59532.1, bsz=2083.2, num_updates=205500, lr=0.000220594, gnorm=1.291, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:14:20 | INFO | train_inner | epoch 104:   1903 / 1978 loss=2.996, nll_loss=0.848, word_ins=2.677, length=3.187, ppl=7.98, wps=25744.2, ups=0.44, wpb=58924.4, bsz=1896.3, num_updates=205600, lr=0.000220541, gnorm=1.299, loss_scale=8192, train_wall=229, wall=0
2023-03-02 18:17:14 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 18:17:29 | INFO | valid | epoch 104 | valid on 'valid' subset | loss 4.079 | nll_loss 1.915 | word_ins 3.681 | length 3.98 | ppl 16.9 | wps 31320.3 | wpb 40242.5 | bsz 1500 | num_updates 205675 | best_loss 4.034
2023-03-02 18:17:29 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 18:17:35 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint104.pt (epoch 104 @ 205675 updates, score 4.079) (writing took 5.740627129562199 seconds)
2023-03-02 18:17:35 | INFO | fairseq_cli.train | end of epoch 104 (average epoch stats below)
2023-03-02 18:17:35 | INFO | train | epoch 104 | loss 2.973 | nll_loss 0.83 | word_ins 2.66 | length 3.131 | ppl 7.85 | wps 25442 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 205675 | lr 0.0002205 | gnorm 1.311 | loss_scale 8192 | train_wall 4573 | wall 0
2023-03-02 18:17:35 | INFO | fairseq.trainer | begin training epoch 105
2023-03-02 18:18:40 | INFO | train_inner | epoch 105:     25 / 1978 loss=2.972, nll_loss=0.831, word_ins=2.661, length=3.118, ppl=7.85, wps=22715.7, ups=0.39, wpb=58991.7, bsz=2017.7, num_updates=205700, lr=0.000220487, gnorm=1.316, loss_scale=8192, train_wall=229, wall=0
2023-03-02 18:22:32 | INFO | train_inner | epoch 105:    125 / 1978 loss=2.966, nll_loss=0.821, word_ins=2.652, length=3.149, ppl=7.82, wps=25354.7, ups=0.43, wpb=58679.7, bsz=2084.6, num_updates=205800, lr=0.000220433, gnorm=1.306, loss_scale=8192, train_wall=231, wall=0
2023-03-02 18:26:24 | INFO | train_inner | epoch 105:    225 / 1978 loss=2.943, nll_loss=0.806, word_ins=2.638, length=3.051, ppl=7.69, wps=25707.7, ups=0.43, wpb=59703.5, bsz=2151, num_updates=205900, lr=0.00022038, gnorm=1.277, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:30:14 | INFO | train_inner | epoch 105:    325 / 1978 loss=2.964, nll_loss=0.823, word_ins=2.654, length=3.094, ppl=7.8, wps=25842.9, ups=0.43, wpb=59482.1, bsz=2002.3, num_updates=206000, lr=0.000220326, gnorm=1.318, loss_scale=8192, train_wall=230, wall=0
2023-03-02 18:34:06 | INFO | train_inner | epoch 105:    425 / 1978 loss=2.988, nll_loss=0.846, word_ins=2.675, length=3.134, ppl=7.93, wps=25519.4, ups=0.43, wpb=59236.7, bsz=1981.4, num_updates=206100, lr=0.000220273, gnorm=1.332, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:37:58 | INFO | train_inner | epoch 105:    525 / 1978 loss=2.957, nll_loss=0.812, word_ins=2.644, length=3.131, ppl=7.76, wps=25505.9, ups=0.43, wpb=59123.6, bsz=2048.4, num_updates=206200, lr=0.000220219, gnorm=1.305, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:41:50 | INFO | train_inner | epoch 105:    625 / 1978 loss=2.984, nll_loss=0.84, word_ins=2.669, length=3.143, ppl=7.91, wps=25449.2, ups=0.43, wpb=59108.7, bsz=1899, num_updates=206300, lr=0.000220166, gnorm=1.332, loss_scale=8192, train_wall=232, wall=0
2023-03-02 18:45:44 | INFO | train_inner | epoch 105:    725 / 1978 loss=2.958, nll_loss=0.816, word_ins=2.647, length=3.108, ppl=7.77, wps=25518.6, ups=0.43, wpb=59613.1, bsz=2017.4, num_updates=206400, lr=0.000220113, gnorm=1.326, loss_scale=8192, train_wall=233, wall=0
2023-03-02 18:49:38 | INFO | train_inner | epoch 105:    825 / 1978 loss=2.962, nll_loss=0.822, word_ins=2.653, length=3.095, ppl=7.79, wps=25470.1, ups=0.43, wpb=59707.1, bsz=2049.8, num_updates=206500, lr=0.000220059, gnorm=1.36, loss_scale=8192, train_wall=234, wall=0
2023-03-02 18:53:33 | INFO | train_inner | epoch 105:    925 / 1978 loss=2.961, nll_loss=0.817, word_ins=2.647, length=3.141, ppl=7.79, wps=25463.7, ups=0.43, wpb=59693.5, bsz=1989.2, num_updates=206600, lr=0.000220006, gnorm=1.295, loss_scale=8192, train_wall=234, wall=0
2023-03-02 18:57:25 | INFO | train_inner | epoch 105:   1025 / 1978 loss=2.961, nll_loss=0.818, word_ins=2.65, length=3.113, ppl=7.79, wps=25527.1, ups=0.43, wpb=59349.5, bsz=2005, num_updates=206700, lr=0.000219953, gnorm=1.309, loss_scale=8192, train_wall=232, wall=0
2023-03-02 19:01:17 | INFO | train_inner | epoch 105:   1125 / 1978 loss=2.992, nll_loss=0.842, word_ins=2.671, length=3.209, ppl=7.95, wps=25414.3, ups=0.43, wpb=59021, bsz=1891.7, num_updates=206800, lr=0.0002199, gnorm=1.346, loss_scale=8192, train_wall=232, wall=0
2023-03-02 19:05:12 | INFO | train_inner | epoch 105:   1225 / 1978 loss=2.965, nll_loss=0.819, word_ins=2.65, length=3.144, ppl=7.81, wps=25285.5, ups=0.43, wpb=59224.3, bsz=2014.6, num_updates=206900, lr=0.000219847, gnorm=1.283, loss_scale=8192, train_wall=234, wall=0
2023-03-02 19:09:05 | INFO | train_inner | epoch 105:   1325 / 1978 loss=2.987, nll_loss=0.841, word_ins=2.67, length=3.169, ppl=7.93, wps=25405.5, ups=0.43, wpb=59403.4, bsz=2001.7, num_updates=207000, lr=0.000219793, gnorm=1.312, loss_scale=8192, train_wall=234, wall=0
2023-03-02 19:12:58 | INFO | train_inner | epoch 105:   1425 / 1978 loss=2.99, nll_loss=0.842, word_ins=2.671, length=3.188, ppl=7.94, wps=25389.5, ups=0.43, wpb=59133.8, bsz=1904.1, num_updates=207100, lr=0.00021974, gnorm=1.318, loss_scale=8192, train_wall=233, wall=0
2023-03-02 19:16:53 | INFO | train_inner | epoch 105:   1525 / 1978 loss=2.961, nll_loss=0.821, word_ins=2.651, length=3.101, ppl=7.79, wps=25347, ups=0.43, wpb=59430.8, bsz=2042.7, num_updates=207200, lr=0.000219687, gnorm=1.28, loss_scale=8192, train_wall=234, wall=0
2023-03-02 19:18:25 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 19:20:48 | INFO | train_inner | epoch 105:   1626 / 1978 loss=2.984, nll_loss=0.844, word_ins=2.673, length=3.112, ppl=7.91, wps=25055.2, ups=0.42, wpb=59005.5, bsz=2050.4, num_updates=207300, lr=0.000219634, gnorm=1.326, loss_scale=8192, train_wall=235, wall=0
2023-03-02 19:24:41 | INFO | train_inner | epoch 105:   1726 / 1978 loss=2.989, nll_loss=0.842, word_ins=2.671, length=3.18, ppl=7.94, wps=25352.6, ups=0.43, wpb=59065.2, bsz=1945.1, num_updates=207400, lr=0.000219581, gnorm=1.365, loss_scale=8192, train_wall=233, wall=0
2023-03-02 19:28:35 | INFO | train_inner | epoch 105:   1826 / 1978 loss=2.97, nll_loss=0.83, word_ins=2.66, length=3.105, ppl=7.84, wps=25505.4, ups=0.43, wpb=59680.6, bsz=2036.5, num_updates=207500, lr=0.000219529, gnorm=1.236, loss_scale=8192, train_wall=234, wall=0
2023-03-02 19:32:30 | INFO | train_inner | epoch 105:   1926 / 1978 loss=2.991, nll_loss=0.846, word_ins=2.675, length=3.161, ppl=7.95, wps=25060.9, ups=0.43, wpb=58750, bsz=1971, num_updates=207600, lr=0.000219476, gnorm=1.354, loss_scale=8192, train_wall=234, wall=0
2023-03-02 19:34:32 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 19:34:47 | INFO | valid | epoch 105 | valid on 'valid' subset | loss 4.045 | nll_loss 1.903 | word_ins 3.668 | length 3.773 | ppl 16.51 | wps 31274.5 | wpb 40242.5 | bsz 1500 | num_updates 207652 | best_loss 4.034
2023-03-02 19:34:47 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 19:34:53 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint105.pt (epoch 105 @ 207652 updates, score 4.045) (writing took 5.99975298717618 seconds)
2023-03-02 19:34:53 | INFO | fairseq_cli.train | end of epoch 105 (average epoch stats below)
2023-03-02 19:34:53 | INFO | train | epoch 105 | loss 2.972 | nll_loss 0.829 | word_ins 2.659 | length 3.133 | ppl 7.85 | wps 25272 | ups 0.43 | wpb 59283.7 | bsz 2002.7 | num_updates 207652 | lr 0.000219448 | gnorm 1.314 | loss_scale 8192 | train_wall 4602 | wall 0
2023-03-02 19:34:53 | INFO | fairseq.trainer | begin training epoch 106
2023-03-02 19:36:53 | INFO | train_inner | epoch 106:     48 / 1978 loss=2.951, nll_loss=0.81, word_ins=2.642, length=3.084, ppl=7.73, wps=22661.5, ups=0.38, wpb=59699.6, bsz=1994.6, num_updates=207700, lr=0.000219423, gnorm=1.316, loss_scale=8192, train_wall=232, wall=0
2023-03-02 19:40:46 | INFO | train_inner | epoch 106:    148 / 1978 loss=2.962, nll_loss=0.82, word_ins=2.652, length=3.106, ppl=7.79, wps=25265, ups=0.43, wpb=58842.5, bsz=1969, num_updates=207800, lr=0.00021937, gnorm=1.338, loss_scale=8192, train_wall=233, wall=0
2023-03-02 19:44:40 | INFO | train_inner | epoch 106:    248 / 1978 loss=2.954, nll_loss=0.815, word_ins=2.646, length=3.079, ppl=7.75, wps=25572.3, ups=0.43, wpb=59757.4, bsz=2044.4, num_updates=207900, lr=0.000219317, gnorm=1.398, loss_scale=8192, train_wall=233, wall=0
2023-03-02 19:48:34 | INFO | train_inner | epoch 106:    348 / 1978 loss=2.951, nll_loss=0.811, word_ins=2.643, length=3.085, ppl=7.73, wps=25285.9, ups=0.43, wpb=59128.9, bsz=2023.1, num_updates=208000, lr=0.000219265, gnorm=1.254, loss_scale=8192, train_wall=234, wall=0
2023-03-02 19:52:26 | INFO | train_inner | epoch 106:    448 / 1978 loss=2.982, nll_loss=0.837, word_ins=2.666, length=3.16, ppl=7.9, wps=25602.5, ups=0.43, wpb=59619.8, bsz=1905.9, num_updates=208100, lr=0.000219212, gnorm=1.402, loss_scale=8192, train_wall=233, wall=0
2023-03-02 19:56:19 | INFO | train_inner | epoch 106:    548 / 1978 loss=2.977, nll_loss=0.833, word_ins=2.662, length=3.151, ppl=7.88, wps=25513.6, ups=0.43, wpb=59410.8, bsz=1937.9, num_updates=208200, lr=0.000219159, gnorm=1.331, loss_scale=8192, train_wall=233, wall=0
2023-03-02 20:00:14 | INFO | train_inner | epoch 106:    648 / 1978 loss=2.981, nll_loss=0.837, word_ins=2.667, length=3.139, ppl=7.89, wps=25330, ups=0.43, wpb=59364.7, bsz=2020.7, num_updates=208300, lr=0.000219107, gnorm=1.302, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:04:08 | INFO | train_inner | epoch 106:    748 / 1978 loss=3.005, nll_loss=0.854, word_ins=2.683, length=3.229, ppl=8.03, wps=25297, ups=0.43, wpb=59211.5, bsz=1949.8, num_updates=208400, lr=0.000219054, gnorm=1.387, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:08:03 | INFO | train_inner | epoch 106:    848 / 1978 loss=2.973, nll_loss=0.832, word_ins=2.662, length=3.106, ppl=7.85, wps=25046.5, ups=0.43, wpb=58820.6, bsz=1996.2, num_updates=208500, lr=0.000219001, gnorm=1.32, loss_scale=8192, train_wall=235, wall=0
2023-03-02 20:11:57 | INFO | train_inner | epoch 106:    948 / 1978 loss=2.961, nll_loss=0.82, word_ins=2.651, length=3.097, ppl=7.79, wps=25388.5, ups=0.43, wpb=59518.2, bsz=2009.3, num_updates=208600, lr=0.000218949, gnorm=1.32, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:15:51 | INFO | train_inner | epoch 106:   1048 / 1978 loss=2.975, nll_loss=0.832, word_ins=2.662, length=3.129, ppl=7.86, wps=25306.7, ups=0.43, wpb=59328.6, bsz=2048.2, num_updates=208700, lr=0.000218896, gnorm=1.339, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:19:45 | INFO | train_inner | epoch 106:   1148 / 1978 loss=2.956, nll_loss=0.813, word_ins=2.645, length=3.11, ppl=7.76, wps=25305.7, ups=0.43, wpb=59153.5, bsz=2074.4, num_updates=208800, lr=0.000218844, gnorm=1.284, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:23:41 | INFO | train_inner | epoch 106:   1248 / 1978 loss=2.962, nll_loss=0.814, word_ins=2.646, length=3.161, ppl=7.79, wps=25151.3, ups=0.42, wpb=59269, bsz=2066.9, num_updates=208900, lr=0.000218792, gnorm=1.294, loss_scale=8192, train_wall=235, wall=0
2023-03-02 20:27:34 | INFO | train_inner | epoch 106:   1348 / 1978 loss=2.986, nll_loss=0.843, word_ins=2.672, length=3.141, ppl=7.92, wps=25437.3, ups=0.43, wpb=59333.7, bsz=1929.5, num_updates=209000, lr=0.000218739, gnorm=1.342, loss_scale=8192, train_wall=233, wall=0
2023-03-02 20:31:28 | INFO | train_inner | epoch 106:   1448 / 1978 loss=2.962, nll_loss=0.823, word_ins=2.653, length=3.091, ppl=7.79, wps=25470.6, ups=0.43, wpb=59650.2, bsz=2077.6, num_updates=209100, lr=0.000218687, gnorm=1.333, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:35:21 | INFO | train_inner | epoch 106:   1548 / 1978 loss=2.996, nll_loss=0.844, word_ins=2.673, length=3.228, ppl=7.98, wps=25232.9, ups=0.43, wpb=58700.9, bsz=1911.3, num_updates=209200, lr=0.000218635, gnorm=1.342, loss_scale=8192, train_wall=232, wall=0
2023-03-02 20:39:16 | INFO | train_inner | epoch 106:   1648 / 1978 loss=2.952, nll_loss=0.811, word_ins=2.642, length=3.094, ppl=7.74, wps=25235.2, ups=0.43, wpb=59301.6, bsz=2054.1, num_updates=209300, lr=0.000218582, gnorm=1.29, loss_scale=8192, train_wall=235, wall=0
2023-03-02 20:43:10 | INFO | train_inner | epoch 106:   1748 / 1978 loss=2.967, nll_loss=0.826, word_ins=2.656, length=3.111, ppl=7.82, wps=25407.2, ups=0.43, wpb=59475.3, bsz=1993.8, num_updates=209400, lr=0.00021853, gnorm=1.34, loss_scale=8192, train_wall=234, wall=0
2023-03-02 20:47:10 | INFO | train_inner | epoch 106:   1848 / 1978 loss=2.963, nll_loss=0.823, word_ins=2.653, length=3.094, ppl=7.8, wps=24791.4, ups=0.42, wpb=59521.3, bsz=2055.8, num_updates=209500, lr=0.000218478, gnorm=1.299, loss_scale=8192, train_wall=240, wall=0
2023-03-02 20:51:03 | INFO | train_inner | epoch 106:   1948 / 1978 loss=2.974, nll_loss=0.826, word_ins=2.657, length=3.177, ppl=7.86, wps=25241.5, ups=0.43, wpb=58855.2, bsz=2018.8, num_updates=209600, lr=0.000218426, gnorm=1.274, loss_scale=8192, train_wall=233, wall=0
2023-03-02 20:52:13 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 20:52:31 | INFO | valid | epoch 106 | valid on 'valid' subset | loss 4.073 | nll_loss 1.913 | word_ins 3.676 | length 3.963 | ppl 16.83 | wps 30337.2 | wpb 40242.5 | bsz 1500 | num_updates 209630 | best_loss 4.034
2023-03-02 20:52:31 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 20:52:37 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint106.pt (epoch 106 @ 209630 updates, score 4.073) (writing took 5.794498669914901 seconds)
2023-03-02 20:52:37 | INFO | fairseq_cli.train | end of epoch 106 (average epoch stats below)
2023-03-02 20:52:37 | INFO | train | epoch 106 | loss 2.97 | nll_loss 0.826 | word_ins 2.657 | length 3.129 | ppl 7.83 | wps 25141.8 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 209630 | lr 0.00021841 | gnorm 1.326 | loss_scale 8192 | train_wall 4626 | wall 0
2023-03-02 20:52:37 | INFO | fairseq.trainer | begin training epoch 107
2023-03-02 20:55:31 | INFO | train_inner | epoch 107:     70 / 1978 loss=2.939, nll_loss=0.802, word_ins=2.634, length=3.053, ppl=7.67, wps=22323.7, ups=0.37, wpb=59658, bsz=2072.1, num_updates=209700, lr=0.000218374, gnorm=1.321, loss_scale=8192, train_wall=233, wall=0
2023-03-02 20:59:24 | INFO | train_inner | epoch 107:    170 / 1978 loss=2.961, nll_loss=0.818, word_ins=2.649, length=3.124, ppl=7.79, wps=25315.2, ups=0.43, wpb=59137.4, bsz=1982.6, num_updates=209800, lr=0.000218322, gnorm=1.341, loss_scale=8192, train_wall=233, wall=0
2023-03-02 21:03:18 | INFO | train_inner | epoch 107:    270 / 1978 loss=2.964, nll_loss=0.821, word_ins=2.652, length=3.114, ppl=7.8, wps=25366.5, ups=0.43, wpb=59420.4, bsz=2001.9, num_updates=209900, lr=0.00021827, gnorm=1.328, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:07:11 | INFO | train_inner | epoch 107:    370 / 1978 loss=2.962, nll_loss=0.82, word_ins=2.651, length=3.116, ppl=7.79, wps=25524.2, ups=0.43, wpb=59453.4, bsz=1932.1, num_updates=210000, lr=0.000218218, gnorm=1.28, loss_scale=8192, train_wall=233, wall=0
2023-03-02 21:11:06 | INFO | train_inner | epoch 107:    470 / 1978 loss=2.947, nll_loss=0.807, word_ins=2.638, length=3.088, ppl=7.71, wps=25433.6, ups=0.43, wpb=59703.1, bsz=2048.7, num_updates=210100, lr=0.000218166, gnorm=1.317, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:15:01 | INFO | train_inner | epoch 107:    570 / 1978 loss=2.959, nll_loss=0.819, word_ins=2.65, length=3.093, ppl=7.78, wps=25358, ups=0.43, wpb=59467.7, bsz=2038.7, num_updates=210200, lr=0.000218114, gnorm=1.322, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:18:55 | INFO | train_inner | epoch 107:    670 / 1978 loss=2.992, nll_loss=0.849, word_ins=2.677, length=3.15, ppl=7.96, wps=25149.2, ups=0.43, wpb=58931.3, bsz=1973.6, num_updates=210300, lr=0.000218062, gnorm=1.344, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:22:49 | INFO | train_inner | epoch 107:    770 / 1978 loss=2.977, nll_loss=0.834, word_ins=2.664, length=3.135, ppl=7.88, wps=25494.3, ups=0.43, wpb=59677.2, bsz=1948.2, num_updates=210400, lr=0.00021801, gnorm=1.376, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:26:43 | INFO | train_inner | epoch 107:    870 / 1978 loss=2.97, nll_loss=0.828, word_ins=2.659, length=3.109, ppl=7.84, wps=25291.1, ups=0.43, wpb=59123.8, bsz=1989.2, num_updates=210500, lr=0.000217959, gnorm=1.342, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:30:37 | INFO | train_inner | epoch 107:    970 / 1978 loss=2.968, nll_loss=0.826, word_ins=2.656, length=3.122, ppl=7.83, wps=25200.9, ups=0.43, wpb=59087, bsz=1985.3, num_updates=210600, lr=0.000217907, gnorm=1.364, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:34:31 | INFO | train_inner | epoch 107:   1070 / 1978 loss=2.953, nll_loss=0.815, word_ins=2.647, length=3.066, ppl=7.74, wps=25454.8, ups=0.43, wpb=59493.6, bsz=2041.9, num_updates=210700, lr=0.000217855, gnorm=1.302, loss_scale=8192, train_wall=233, wall=0
2023-03-02 21:38:25 | INFO | train_inner | epoch 107:   1170 / 1978 loss=2.964, nll_loss=0.822, word_ins=2.652, length=3.119, ppl=7.8, wps=25688.7, ups=0.43, wpb=60127.5, bsz=1955, num_updates=210800, lr=0.000217803, gnorm=1.367, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:42:18 | INFO | train_inner | epoch 107:   1270 / 1978 loss=2.987, nll_loss=0.839, word_ins=2.668, length=3.189, ppl=7.93, wps=25158.9, ups=0.43, wpb=58538.8, bsz=1983.9, num_updates=210900, lr=0.000217752, gnorm=1.342, loss_scale=8192, train_wall=232, wall=0
2023-03-02 21:46:11 | INFO | train_inner | epoch 107:   1370 / 1978 loss=2.975, nll_loss=0.831, word_ins=2.661, length=3.138, ppl=7.86, wps=25361, ups=0.43, wpb=59176.8, bsz=2028, num_updates=211000, lr=0.0002177, gnorm=1.335, loss_scale=8192, train_wall=233, wall=0
2023-03-02 21:50:06 | INFO | train_inner | epoch 107:   1470 / 1978 loss=2.962, nll_loss=0.82, word_ins=2.651, length=3.113, ppl=7.79, wps=25229.9, ups=0.43, wpb=59196.5, bsz=2045.9, num_updates=211100, lr=0.000217649, gnorm=1.335, loss_scale=8192, train_wall=234, wall=0
2023-03-02 21:53:59 | INFO | train_inner | epoch 107:   1570 / 1978 loss=2.967, nll_loss=0.819, word_ins=2.65, length=3.171, ppl=7.82, wps=25145.8, ups=0.43, wpb=58611.6, bsz=1992.6, num_updates=211200, lr=0.000217597, gnorm=1.278, loss_scale=8192, train_wall=233, wall=0
2023-03-02 21:57:52 | INFO | train_inner | epoch 107:   1670 / 1978 loss=2.991, nll_loss=0.841, word_ins=2.67, length=3.21, ppl=7.95, wps=25203.7, ups=0.43, wpb=58745, bsz=1969.6, num_updates=211300, lr=0.000217546, gnorm=1.298, loss_scale=8192, train_wall=233, wall=0
2023-03-02 21:59:54 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-02 22:01:48 | INFO | train_inner | epoch 107:   1771 / 1978 loss=2.976, nll_loss=0.831, word_ins=2.661, length=3.148, ppl=7.87, wps=24997.1, ups=0.42, wpb=59029.3, bsz=2044.8, num_updates=211400, lr=0.000217494, gnorm=1.294, loss_scale=8192, train_wall=236, wall=0
2023-03-02 22:05:44 | INFO | train_inner | epoch 107:   1871 / 1978 loss=2.966, nll_loss=0.823, word_ins=2.653, length=3.13, ppl=7.81, wps=25255.6, ups=0.42, wpb=59458.7, bsz=2038, num_updates=211500, lr=0.000217443, gnorm=1.347, loss_scale=8192, train_wall=235, wall=0
2023-03-02 22:09:38 | INFO | train_inner | epoch 107:   1971 / 1978 loss=2.973, nll_loss=0.831, word_ins=2.661, length=3.112, ppl=7.85, wps=25424.6, ups=0.43, wpb=59520.7, bsz=1986.2, num_updates=211600, lr=0.000217391, gnorm=1.341, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:09:54 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 22:10:11 | INFO | valid | epoch 107 | valid on 'valid' subset | loss 4.039 | nll_loss 1.911 | word_ins 3.672 | length 3.667 | ppl 16.44 | wps 31494.4 | wpb 40242.5 | bsz 1500 | num_updates 211607 | best_loss 4.034
2023-03-02 22:10:11 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 22:10:17 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint107.pt (epoch 107 @ 211607 updates, score 4.039) (writing took 5.685920405201614 seconds)
2023-03-02 22:10:17 | INFO | fairseq_cli.train | end of epoch 107 (average epoch stats below)
2023-03-02 22:10:17 | INFO | train | epoch 107 | loss 2.968 | nll_loss 0.825 | word_ins 2.655 | length 3.126 | ppl 7.82 | wps 25150.6 | ups 0.42 | wpb 59282.8 | bsz 2002.8 | num_updates 211607 | lr 0.000217388 | gnorm 1.328 | loss_scale 8192 | train_wall 4622 | wall 0
2023-03-02 22:10:17 | INFO | fairseq.trainer | begin training epoch 108
2023-03-02 22:14:04 | INFO | train_inner | epoch 108:     93 / 1978 loss=2.96, nll_loss=0.816, word_ins=2.646, length=3.137, ppl=7.78, wps=22175.2, ups=0.38, wpb=59043.9, bsz=1913.6, num_updates=211700, lr=0.00021734, gnorm=1.299, loss_scale=8192, train_wall=233, wall=0
2023-03-02 22:17:57 | INFO | train_inner | epoch 108:    193 / 1978 loss=2.974, nll_loss=0.83, word_ins=2.661, length=3.135, ppl=7.86, wps=25307.5, ups=0.43, wpb=59076.3, bsz=1950, num_updates=211800, lr=0.000217289, gnorm=1.296, loss_scale=8192, train_wall=233, wall=0
2023-03-02 22:21:52 | INFO | train_inner | epoch 108:    293 / 1978 loss=2.957, nll_loss=0.821, word_ins=2.652, length=3.054, ppl=7.77, wps=25390.8, ups=0.43, wpb=59480.8, bsz=2031.2, num_updates=211900, lr=0.000217237, gnorm=1.329, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:25:47 | INFO | train_inner | epoch 108:    393 / 1978 loss=2.947, nll_loss=0.808, word_ins=2.639, length=3.08, ppl=7.71, wps=25369.8, ups=0.42, wpb=59778, bsz=2066.2, num_updates=212000, lr=0.000217186, gnorm=1.326, loss_scale=8192, train_wall=235, wall=0
2023-03-02 22:29:41 | INFO | train_inner | epoch 108:    493 / 1978 loss=2.974, nll_loss=0.831, word_ins=2.662, length=3.122, ppl=7.86, wps=25296.6, ups=0.43, wpb=59212.5, bsz=1973.8, num_updates=212100, lr=0.000217135, gnorm=1.327, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:33:35 | INFO | train_inner | epoch 108:    593 / 1978 loss=2.95, nll_loss=0.807, word_ins=2.639, length=3.108, ppl=7.73, wps=25470.7, ups=0.43, wpb=59564.6, bsz=2014.6, num_updates=212200, lr=0.000217084, gnorm=1.394, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:37:29 | INFO | train_inner | epoch 108:    693 / 1978 loss=2.961, nll_loss=0.818, word_ins=2.648, length=3.128, ppl=7.79, wps=25432.8, ups=0.43, wpb=59560.6, bsz=2036.2, num_updates=212300, lr=0.000217033, gnorm=1.342, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:41:24 | INFO | train_inner | epoch 108:    793 / 1978 loss=2.944, nll_loss=0.806, word_ins=2.638, length=3.06, ppl=7.7, wps=25223.2, ups=0.43, wpb=59128, bsz=2055.1, num_updates=212400, lr=0.000216982, gnorm=1.28, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:45:17 | INFO | train_inner | epoch 108:    893 / 1978 loss=2.99, nll_loss=0.851, word_ins=2.679, length=3.112, ppl=7.95, wps=25105.5, ups=0.43, wpb=58571.6, bsz=2020.5, num_updates=212500, lr=0.00021693, gnorm=1.341, loss_scale=8192, train_wall=233, wall=0
2023-03-02 22:49:11 | INFO | train_inner | epoch 108:    993 / 1978 loss=2.958, nll_loss=0.815, word_ins=2.646, length=3.119, ppl=7.77, wps=25611.6, ups=0.43, wpb=59896.5, bsz=1997.6, num_updates=212600, lr=0.000216879, gnorm=1.303, loss_scale=8192, train_wall=234, wall=0
2023-03-02 22:53:05 | INFO | train_inner | epoch 108:   1093 / 1978 loss=2.965, nll_loss=0.819, word_ins=2.65, length=3.151, ppl=7.81, wps=25230.7, ups=0.43, wpb=58945.7, bsz=1938, num_updates=212700, lr=0.000216828, gnorm=1.346, loss_scale=8192, train_wall=233, wall=0
2023-03-02 22:57:00 | INFO | train_inner | epoch 108:   1193 / 1978 loss=2.963, nll_loss=0.822, word_ins=2.653, length=3.101, ppl=7.8, wps=25380.2, ups=0.43, wpb=59635.4, bsz=1986.8, num_updates=212800, lr=0.000216777, gnorm=1.324, loss_scale=8192, train_wall=235, wall=0
2023-03-02 23:00:51 | INFO | train_inner | epoch 108:   1293 / 1978 loss=2.987, nll_loss=0.844, word_ins=2.672, length=3.147, ppl=7.93, wps=25521, ups=0.43, wpb=59150.1, bsz=1953.7, num_updates=212900, lr=0.000216727, gnorm=1.355, loss_scale=8192, train_wall=232, wall=0
2023-03-02 23:04:43 | INFO | train_inner | epoch 108:   1393 / 1978 loss=2.972, nll_loss=0.833, word_ins=2.662, length=3.093, ppl=7.84, wps=25687.4, ups=0.43, wpb=59469.1, bsz=1947.8, num_updates=213000, lr=0.000216676, gnorm=1.329, loss_scale=8192, train_wall=231, wall=0
2023-03-02 23:08:36 | INFO | train_inner | epoch 108:   1493 / 1978 loss=2.958, nll_loss=0.813, word_ins=2.644, length=3.141, ppl=7.77, wps=25589.7, ups=0.43, wpb=59757.2, bsz=2007, num_updates=213100, lr=0.000216625, gnorm=1.334, loss_scale=8192, train_wall=233, wall=0
2023-03-02 23:12:30 | INFO | train_inner | epoch 108:   1593 / 1978 loss=2.994, nll_loss=0.847, word_ins=2.676, length=3.181, ppl=7.97, wps=25284.9, ups=0.43, wpb=59109.7, bsz=1951.1, num_updates=213200, lr=0.000216574, gnorm=1.338, loss_scale=8192, train_wall=234, wall=0
2023-03-02 23:16:27 | INFO | train_inner | epoch 108:   1693 / 1978 loss=2.94, nll_loss=0.807, word_ins=2.638, length=3.022, ppl=7.68, wps=25115.1, ups=0.42, wpb=59450.7, bsz=2118.1, num_updates=213300, lr=0.000216523, gnorm=1.311, loss_scale=8192, train_wall=236, wall=0
2023-03-02 23:20:22 | INFO | train_inner | epoch 108:   1793 / 1978 loss=2.981, nll_loss=0.833, word_ins=2.663, length=3.171, ppl=7.89, wps=24939.8, ups=0.43, wpb=58635.5, bsz=2064.8, num_updates=213400, lr=0.000216473, gnorm=1.334, loss_scale=8192, train_wall=235, wall=0
2023-03-02 23:24:15 | INFO | train_inner | epoch 108:   1893 / 1978 loss=2.981, nll_loss=0.838, word_ins=2.667, length=3.141, ppl=7.9, wps=25296.7, ups=0.43, wpb=58815.9, bsz=1996.8, num_updates=213500, lr=0.000216422, gnorm=1.331, loss_scale=8192, train_wall=232, wall=0
2023-03-02 23:27:35 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-02 23:27:52 | INFO | valid | epoch 108 | valid on 'valid' subset | loss 4.056 | nll_loss 1.925 | word_ins 3.689 | length 3.672 | ppl 16.64 | wps 29912.9 | wpb 40242.5 | bsz 1500 | num_updates 213585 | best_loss 4.034
2023-03-02 23:27:52 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-02 23:27:57 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint108.pt (epoch 108 @ 213585 updates, score 4.056) (writing took 5.779139106161892 seconds)
2023-03-02 23:27:57 | INFO | fairseq_cli.train | end of epoch 108 (average epoch stats below)
2023-03-02 23:27:57 | INFO | train | epoch 108 | loss 2.966 | nll_loss 0.824 | word_ins 2.655 | length 3.117 | ppl 7.82 | wps 25161.7 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 213585 | lr 0.000216379 | gnorm 1.329 | loss_scale 8192 | train_wall 4622 | wall 0
2023-03-02 23:27:57 | INFO | fairseq.trainer | begin training epoch 109
2023-03-02 23:28:42 | INFO | train_inner | epoch 109:     15 / 1978 loss=2.969, nll_loss=0.824, word_ins=2.655, length=3.144, ppl=7.83, wps=22238.1, ups=0.37, wpb=59497.5, bsz=2015.9, num_updates=213600, lr=0.000216371, gnorm=1.331, loss_scale=8192, train_wall=234, wall=0
2023-03-02 23:32:35 | INFO | train_inner | epoch 109:    115 / 1978 loss=2.959, nll_loss=0.818, word_ins=2.649, length=3.106, ppl=7.78, wps=25456.1, ups=0.43, wpb=59356.6, bsz=1981.9, num_updates=213700, lr=0.000216321, gnorm=1.296, loss_scale=8192, train_wall=233, wall=0
2023-03-02 23:36:30 | INFO | train_inner | epoch 109:    215 / 1978 loss=2.941, nll_loss=0.801, word_ins=2.634, length=3.065, ppl=7.68, wps=25200.2, ups=0.43, wpb=59211.5, bsz=2089.1, num_updates=213800, lr=0.00021627, gnorm=1.331, loss_scale=8192, train_wall=235, wall=0
2023-03-02 23:40:25 | INFO | train_inner | epoch 109:    315 / 1978 loss=2.949, nll_loss=0.812, word_ins=2.644, length=3.059, ppl=7.72, wps=25528.3, ups=0.43, wpb=59994.8, bsz=2056.1, num_updates=213900, lr=0.000216219, gnorm=1.331, loss_scale=8192, train_wall=235, wall=0
2023-03-02 23:44:18 | INFO | train_inner | epoch 109:    415 / 1978 loss=2.992, nll_loss=0.842, word_ins=2.671, length=3.213, ppl=7.96, wps=25288.9, ups=0.43, wpb=58872, bsz=1900.5, num_updates=214000, lr=0.000216169, gnorm=1.372, loss_scale=8192, train_wall=233, wall=0
2023-03-02 23:48:12 | INFO | train_inner | epoch 109:    515 / 1978 loss=2.977, nll_loss=0.837, word_ins=2.667, length=3.105, ppl=7.87, wps=25293.4, ups=0.43, wpb=59063.4, bsz=1969.1, num_updates=214100, lr=0.000216118, gnorm=1.352, loss_scale=8192, train_wall=233, wall=0
2023-03-02 23:52:06 | INFO | train_inner | epoch 109:    615 / 1978 loss=2.94, nll_loss=0.801, word_ins=2.634, length=3.064, ppl=7.67, wps=25469.3, ups=0.43, wpb=59738.1, bsz=2031.4, num_updates=214200, lr=0.000216068, gnorm=1.284, loss_scale=8192, train_wall=234, wall=0
2023-03-02 23:56:00 | INFO | train_inner | epoch 109:    715 / 1978 loss=2.97, nll_loss=0.826, word_ins=2.657, length=3.127, ppl=7.83, wps=25286.1, ups=0.43, wpb=59043.7, bsz=1968.2, num_updates=214300, lr=0.000216017, gnorm=1.393, loss_scale=8192, train_wall=233, wall=0
2023-03-02 23:59:55 | INFO | train_inner | epoch 109:    815 / 1978 loss=2.946, nll_loss=0.806, word_ins=2.638, length=3.076, ppl=7.7, wps=25126.3, ups=0.43, wpb=59039.3, bsz=2094.3, num_updates=214400, lr=0.000215967, gnorm=1.274, loss_scale=8192, train_wall=235, wall=0
2023-03-03 00:03:49 | INFO | train_inner | epoch 109:    915 / 1978 loss=2.946, nll_loss=0.809, word_ins=2.64, length=3.058, ppl=7.71, wps=25542.3, ups=0.43, wpb=59986.7, bsz=2072.4, num_updates=214500, lr=0.000215917, gnorm=1.314, loss_scale=8192, train_wall=235, wall=0
2023-03-03 00:07:44 | INFO | train_inner | epoch 109:   1015 / 1978 loss=2.951, nll_loss=0.811, word_ins=2.643, length=3.085, ppl=7.73, wps=25209.1, ups=0.43, wpb=59122.9, bsz=2031.4, num_updates=214600, lr=0.000215866, gnorm=1.257, loss_scale=8192, train_wall=234, wall=0
2023-03-03 00:11:38 | INFO | train_inner | epoch 109:   1115 / 1978 loss=2.962, nll_loss=0.822, word_ins=2.652, length=3.102, ppl=7.79, wps=25397.1, ups=0.43, wpb=59510.8, bsz=1991.1, num_updates=214700, lr=0.000215816, gnorm=1.35, loss_scale=8192, train_wall=234, wall=0
2023-03-03 00:15:34 | INFO | train_inner | epoch 109:   1215 / 1978 loss=2.957, nll_loss=0.815, word_ins=2.646, length=3.118, ppl=7.77, wps=25141.3, ups=0.42, wpb=59302.8, bsz=2113, num_updates=214800, lr=0.000215766, gnorm=1.323, loss_scale=8192, train_wall=236, wall=0
2023-03-03 00:19:29 | INFO | train_inner | epoch 109:   1315 / 1978 loss=2.972, nll_loss=0.831, word_ins=2.66, length=3.119, ppl=7.85, wps=25538.6, ups=0.43, wpb=59962.3, bsz=1993.5, num_updates=214900, lr=0.000215716, gnorm=1.334, loss_scale=8192, train_wall=235, wall=0
2023-03-03 00:23:23 | INFO | train_inner | epoch 109:   1415 / 1978 loss=2.974, nll_loss=0.832, word_ins=2.662, length=3.121, ppl=7.86, wps=25153.2, ups=0.43, wpb=58766.8, bsz=1943, num_updates=215000, lr=0.000215666, gnorm=1.34, loss_scale=8192, train_wall=233, wall=0
2023-03-03 00:27:17 | INFO | train_inner | epoch 109:   1515 / 1978 loss=2.978, nll_loss=0.829, word_ins=2.659, length=3.183, ppl=7.88, wps=25484.5, ups=0.43, wpb=59622.9, bsz=1966.3, num_updates=215100, lr=0.000215615, gnorm=1.392, loss_scale=8192, train_wall=234, wall=0
2023-03-03 00:31:10 | INFO | train_inner | epoch 109:   1615 / 1978 loss=2.981, nll_loss=0.838, word_ins=2.667, length=3.135, ppl=7.89, wps=25291.1, ups=0.43, wpb=59050.4, bsz=1973, num_updates=215200, lr=0.000215565, gnorm=1.37, loss_scale=8192, train_wall=233, wall=0
2023-03-03 00:35:05 | INFO | train_inner | epoch 109:   1715 / 1978 loss=2.968, nll_loss=0.826, word_ins=2.656, length=3.121, ppl=7.83, wps=25361.8, ups=0.43, wpb=59505.3, bsz=2015.8, num_updates=215300, lr=0.000215515, gnorm=1.348, loss_scale=8192, train_wall=234, wall=0
2023-03-03 00:38:58 | INFO | train_inner | epoch 109:   1815 / 1978 loss=2.983, nll_loss=0.833, word_ins=2.663, length=3.202, ppl=7.91, wps=25198.1, ups=0.43, wpb=58735.3, bsz=1923.4, num_updates=215400, lr=0.000215465, gnorm=1.365, loss_scale=8192, train_wall=233, wall=0
2023-03-03 00:41:23 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 00:42:54 | INFO | train_inner | epoch 109:   1916 / 1978 loss=2.968, nll_loss=0.825, word_ins=2.655, length=3.131, ppl=7.82, wps=24866.3, ups=0.42, wpb=58797.6, bsz=2004.7, num_updates=215500, lr=0.000215415, gnorm=1.344, loss_scale=8192, train_wall=236, wall=0
2023-03-03 00:45:18 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 00:45:33 | INFO | valid | epoch 109 | valid on 'valid' subset | loss 4.107 | nll_loss 1.904 | word_ins 3.67 | length 4.368 | ppl 17.23 | wps 30000.4 | wpb 40242.5 | bsz 1500 | num_updates 215562 | best_loss 4.034
2023-03-03 00:45:33 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 00:45:39 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint109.pt (epoch 109 @ 215562 updates, score 4.107) (writing took 5.875758837908506 seconds)
2023-03-03 00:45:39 | INFO | fairseq_cli.train | end of epoch 109 (average epoch stats below)
2023-03-03 00:45:39 | INFO | train | epoch 109 | loss 2.964 | nll_loss 0.822 | word_ins 2.653 | length 3.118 | ppl 7.81 | wps 25140.6 | ups 0.42 | wpb 59282.8 | bsz 2002.7 | num_updates 215562 | lr 0.000215384 | gnorm 1.336 | loss_scale 8192 | train_wall 4625 | wall 0
2023-03-03 00:45:39 | INFO | fairseq.trainer | begin training epoch 110
2023-03-03 00:47:17 | INFO | train_inner | epoch 110:     38 / 1978 loss=2.98, nll_loss=0.83, word_ins=2.66, length=3.198, ppl=7.89, wps=22397.5, ups=0.38, wpb=58772.1, bsz=1907.2, num_updates=215600, lr=0.000215365, gnorm=1.336, loss_scale=8192, train_wall=231, wall=0
2023-03-03 00:51:10 | INFO | train_inner | epoch 110:    138 / 1978 loss=2.979, nll_loss=0.837, word_ins=2.666, length=3.127, ppl=7.88, wps=25520.1, ups=0.43, wpb=59521.7, bsz=1947, num_updates=215700, lr=0.000215315, gnorm=1.316, loss_scale=8192, train_wall=233, wall=0
2023-03-03 00:55:04 | INFO | train_inner | epoch 110:    238 / 1978 loss=2.961, nll_loss=0.816, word_ins=2.647, length=3.143, ppl=7.79, wps=25177.9, ups=0.43, wpb=58861.8, bsz=1965.1, num_updates=215800, lr=0.000215265, gnorm=1.337, loss_scale=8192, train_wall=234, wall=0
2023-03-03 00:58:58 | INFO | train_inner | epoch 110:    338 / 1978 loss=2.964, nll_loss=0.82, word_ins=2.651, length=3.123, ppl=7.8, wps=25370.3, ups=0.43, wpb=59418.8, bsz=1967.6, num_updates=215900, lr=0.000215216, gnorm=1.423, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:02:52 | INFO | train_inner | epoch 110:    438 / 1978 loss=2.955, nll_loss=0.813, word_ins=2.644, length=3.108, ppl=7.76, wps=25268.9, ups=0.43, wpb=59078.5, bsz=2000, num_updates=216000, lr=0.000215166, gnorm=1.396, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:06:47 | INFO | train_inner | epoch 110:    538 / 1978 loss=2.953, nll_loss=0.811, word_ins=2.642, length=3.11, ppl=7.75, wps=25151.3, ups=0.42, wpb=59264.1, bsz=2065.8, num_updates=216100, lr=0.000215116, gnorm=1.353, loss_scale=8192, train_wall=235, wall=0
2023-03-03 01:10:42 | INFO | train_inner | epoch 110:    638 / 1978 loss=2.96, nll_loss=0.819, word_ins=2.649, length=3.111, ppl=7.78, wps=25338.3, ups=0.43, wpb=59451.9, bsz=2030.5, num_updates=216200, lr=0.000215066, gnorm=1.327, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:14:36 | INFO | train_inner | epoch 110:    738 / 1978 loss=2.949, nll_loss=0.813, word_ins=2.644, length=3.051, ppl=7.72, wps=25359.8, ups=0.43, wpb=59448.5, bsz=2061.8, num_updates=216300, lr=0.000215016, gnorm=1.323, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:18:31 | INFO | train_inner | epoch 110:    838 / 1978 loss=2.954, nll_loss=0.813, word_ins=2.644, length=3.102, ppl=7.75, wps=25626.6, ups=0.43, wpb=60179.3, bsz=2013.7, num_updates=216400, lr=0.000214967, gnorm=1.393, loss_scale=8192, train_wall=235, wall=0
2023-03-03 01:22:26 | INFO | train_inner | epoch 110:    938 / 1978 loss=2.963, nll_loss=0.822, word_ins=2.652, length=3.104, ppl=7.8, wps=25153.8, ups=0.43, wpb=59081.1, bsz=1964.6, num_updates=216500, lr=0.000214917, gnorm=1.3, loss_scale=8192, train_wall=235, wall=0
2023-03-03 01:26:20 | INFO | train_inner | epoch 110:   1038 / 1978 loss=2.976, nll_loss=0.83, word_ins=2.66, length=3.155, ppl=7.87, wps=25089.4, ups=0.43, wpb=58733.1, bsz=2008, num_updates=216600, lr=0.000214868, gnorm=1.343, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:30:13 | INFO | train_inner | epoch 110:   1138 / 1978 loss=2.981, nll_loss=0.833, word_ins=2.663, length=3.185, ppl=7.9, wps=25206.6, ups=0.43, wpb=58758.6, bsz=1954.5, num_updates=216700, lr=0.000214818, gnorm=1.365, loss_scale=8192, train_wall=233, wall=0
2023-03-03 01:34:08 | INFO | train_inner | epoch 110:   1238 / 1978 loss=2.944, nll_loss=0.804, word_ins=2.636, length=3.083, ppl=7.7, wps=25262.2, ups=0.43, wpb=59228.8, bsz=2080.8, num_updates=216800, lr=0.000214768, gnorm=1.325, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:38:02 | INFO | train_inner | epoch 110:   1338 / 1978 loss=2.955, nll_loss=0.816, word_ins=2.647, length=3.085, ppl=7.75, wps=25437.1, ups=0.43, wpb=59629.2, bsz=2079.6, num_updates=216900, lr=0.000214719, gnorm=1.316, loss_scale=8192, train_wall=234, wall=0
2023-03-03 01:41:55 | INFO | train_inner | epoch 110:   1438 / 1978 loss=2.978, nll_loss=0.836, word_ins=2.665, length=3.129, ppl=7.88, wps=25474.8, ups=0.43, wpb=59327.7, bsz=1949.1, num_updates=217000, lr=0.000214669, gnorm=1.326, loss_scale=8192, train_wall=233, wall=0
2023-03-03 01:45:50 | INFO | train_inner | epoch 110:   1538 / 1978 loss=2.964, nll_loss=0.822, word_ins=2.652, length=3.12, ppl=7.8, wps=25292.3, ups=0.43, wpb=59383.2, bsz=2013.3, num_updates=217100, lr=0.00021462, gnorm=1.378, loss_scale=8192, train_wall=235, wall=0
2023-03-03 01:49:43 | INFO | train_inner | epoch 110:   1638 / 1978 loss=2.976, nll_loss=0.832, word_ins=2.661, length=3.144, ppl=7.87, wps=25382.8, ups=0.43, wpb=59073.5, bsz=2006.9, num_updates=217200, lr=0.000214571, gnorm=1.325, loss_scale=8192, train_wall=232, wall=0
2023-03-03 01:53:36 | INFO | train_inner | epoch 110:   1738 / 1978 loss=2.961, nll_loss=0.82, word_ins=2.65, length=3.11, ppl=7.79, wps=25451.3, ups=0.43, wpb=59346.7, bsz=1995.7, num_updates=217300, lr=0.000214521, gnorm=1.308, loss_scale=8192, train_wall=233, wall=0
2023-03-03 01:57:28 | INFO | train_inner | epoch 110:   1838 / 1978 loss=2.983, nll_loss=0.838, word_ins=2.667, length=3.164, ppl=7.91, wps=25487.8, ups=0.43, wpb=59266.8, bsz=1938.6, num_updates=217400, lr=0.000214472, gnorm=1.342, loss_scale=8192, train_wall=232, wall=0
2023-03-03 02:01:23 | INFO | train_inner | epoch 110:   1938 / 1978 loss=2.964, nll_loss=0.821, word_ins=2.651, length=3.123, ppl=7.8, wps=25378.8, ups=0.43, wpb=59441.9, bsz=2029.1, num_updates=217500, lr=0.000214423, gnorm=1.368, loss_scale=8192, train_wall=234, wall=0
2023-03-03 02:02:57 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 02:03:14 | INFO | valid | epoch 110 | valid on 'valid' subset | loss 4.111 | nll_loss 1.901 | word_ins 3.668 | length 4.44 | ppl 17.28 | wps 30714.6 | wpb 40242.5 | bsz 1500 | num_updates 217540 | best_loss 4.034
2023-03-03 02:03:14 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 02:03:20 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint110.pt (epoch 110 @ 217540 updates, score 4.111) (writing took 5.780062637291849 seconds)
2023-03-03 02:03:20 | INFO | fairseq_cli.train | end of epoch 110 (average epoch stats below)
2023-03-03 02:03:20 | INFO | train | epoch 110 | loss 2.964 | nll_loss 0.821 | word_ins 2.652 | length 3.12 | ppl 7.8 | wps 25159.9 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 217540 | lr 0.000214403 | gnorm 1.344 | loss_scale 8192 | train_wall 4623 | wall 0
2023-03-03 02:03:20 | INFO | fairseq.trainer | begin training epoch 111
2023-03-03 02:05:49 | INFO | train_inner | epoch 111:     60 / 1978 loss=2.956, nll_loss=0.811, word_ins=2.643, length=3.127, ppl=7.76, wps=22355, ups=0.38, wpb=59482.6, bsz=1930.6, num_updates=217600, lr=0.000214373, gnorm=1.334, loss_scale=8192, train_wall=233, wall=0
2023-03-03 02:09:43 | INFO | train_inner | epoch 111:    160 / 1978 loss=2.93, nll_loss=0.793, word_ins=2.625, length=3.041, ppl=7.62, wps=25328.1, ups=0.43, wpb=59472.3, bsz=2067.4, num_updates=217700, lr=0.000214324, gnorm=1.306, loss_scale=8192, train_wall=235, wall=0
2023-03-03 02:13:37 | INFO | train_inner | epoch 111:    260 / 1978 loss=2.956, nll_loss=0.815, word_ins=2.647, length=3.092, ppl=7.76, wps=25043, ups=0.43, wpb=58597.2, bsz=2020.4, num_updates=217800, lr=0.000214275, gnorm=1.331, loss_scale=8192, train_wall=234, wall=0
2023-03-03 02:17:31 | INFO | train_inner | epoch 111:    360 / 1978 loss=2.962, nll_loss=0.818, word_ins=2.649, length=3.124, ppl=7.79, wps=25442.3, ups=0.43, wpb=59360.4, bsz=1967.6, num_updates=217900, lr=0.000214226, gnorm=1.327, loss_scale=8192, train_wall=233, wall=0
2023-03-03 02:21:25 | INFO | train_inner | epoch 111:    460 / 1978 loss=2.955, nll_loss=0.821, word_ins=2.652, length=3.037, ppl=7.76, wps=25229, ups=0.43, wpb=59141.5, bsz=2067.2, num_updates=218000, lr=0.000214176, gnorm=1.31, loss_scale=8192, train_wall=234, wall=0
2023-03-03 02:25:19 | INFO | train_inner | epoch 111:    560 / 1978 loss=2.947, nll_loss=0.807, word_ins=2.639, length=3.081, ppl=7.71, wps=25477.3, ups=0.43, wpb=59639.1, bsz=2033, num_updates=218100, lr=0.000214127, gnorm=1.326, loss_scale=8192, train_wall=234, wall=0
2023-03-03 02:29:13 | INFO | train_inner | epoch 111:    660 / 1978 loss=2.958, nll_loss=0.816, word_ins=2.648, length=3.102, ppl=7.77, wps=25475.6, ups=0.43, wpb=59446.2, bsz=1988.5, num_updates=218200, lr=0.000214078, gnorm=1.354, loss_scale=8192, train_wall=233, wall=0
2023-03-03 02:33:07 | INFO | train_inner | epoch 111:    760 / 1978 loss=2.992, nll_loss=0.845, word_ins=2.674, length=3.181, ppl=7.96, wps=25034.2, ups=0.43, wpb=58586.9, bsz=1927.8, num_updates=218300, lr=0.000214029, gnorm=1.37, loss_scale=8192, train_wall=234, wall=0
2023-03-03 02:37:00 | INFO | train_inner | epoch 111:    860 / 1978 loss=2.949, nll_loss=0.809, word_ins=2.641, length=3.085, ppl=7.72, wps=25573.9, ups=0.43, wpb=59711.1, bsz=1983.6, num_updates=218400, lr=0.00021398, gnorm=1.379, loss_scale=8192, train_wall=233, wall=0
2023-03-03 02:40:54 | INFO | train_inner | epoch 111:    960 / 1978 loss=2.963, nll_loss=0.818, word_ins=2.648, length=3.144, ppl=7.79, wps=25500.4, ups=0.43, wpb=59517.9, bsz=1966.7, num_updates=218500, lr=0.000213931, gnorm=1.376, loss_scale=8192, train_wall=233, wall=0
2023-03-03 02:44:49 | INFO | train_inner | epoch 111:   1060 / 1978 loss=2.953, nll_loss=0.817, word_ins=2.648, length=3.058, ppl=7.75, wps=25154.3, ups=0.43, wpb=59135.2, bsz=2096.9, num_updates=218600, lr=0.000213882, gnorm=1.35, loss_scale=8192, train_wall=235, wall=0
2023-03-03 02:48:42 | INFO | train_inner | epoch 111:   1160 / 1978 loss=2.968, nll_loss=0.823, word_ins=2.653, length=3.157, ppl=7.83, wps=25351.3, ups=0.43, wpb=59159.3, bsz=1958.9, num_updates=218700, lr=0.000213833, gnorm=1.367, loss_scale=8192, train_wall=233, wall=0
2023-03-03 02:52:36 | INFO | train_inner | epoch 111:   1260 / 1978 loss=2.965, nll_loss=0.823, word_ins=2.654, length=3.111, ppl=7.81, wps=25314.5, ups=0.43, wpb=59194, bsz=2028.8, num_updates=218800, lr=0.000213785, gnorm=1.312, loss_scale=8192, train_wall=234, wall=0
2023-03-03 02:56:28 | INFO | train_inner | epoch 111:   1360 / 1978 loss=2.958, nll_loss=0.816, word_ins=2.647, length=3.109, ppl=7.77, wps=25286.8, ups=0.43, wpb=58818.4, bsz=1994.9, num_updates=218900, lr=0.000213736, gnorm=1.31, loss_scale=8192, train_wall=232, wall=0
2023-03-03 03:00:23 | INFO | train_inner | epoch 111:   1460 / 1978 loss=2.965, nll_loss=0.824, word_ins=2.654, length=3.11, ppl=7.81, wps=25378.5, ups=0.43, wpb=59553.2, bsz=2032.7, num_updates=219000, lr=0.000213687, gnorm=1.358, loss_scale=8192, train_wall=234, wall=0
2023-03-03 03:04:17 | INFO | train_inner | epoch 111:   1560 / 1978 loss=2.96, nll_loss=0.819, word_ins=2.649, length=3.108, ppl=7.78, wps=25433.6, ups=0.43, wpb=59525.9, bsz=1980.3, num_updates=219100, lr=0.000213638, gnorm=1.303, loss_scale=8192, train_wall=234, wall=0
2023-03-03 03:08:10 | INFO | train_inner | epoch 111:   1660 / 1978 loss=2.969, nll_loss=0.822, word_ins=2.652, length=3.169, ppl=7.83, wps=25291.3, ups=0.43, wpb=58963.9, bsz=1982.8, num_updates=219200, lr=0.000213589, gnorm=1.346, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:12:04 | INFO | train_inner | epoch 111:   1760 / 1978 loss=2.988, nll_loss=0.841, word_ins=2.67, length=3.177, ppl=7.93, wps=25231.8, ups=0.43, wpb=58899.2, bsz=1931, num_updates=219300, lr=0.000213541, gnorm=1.353, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:15:58 | INFO | train_inner | epoch 111:   1860 / 1978 loss=2.945, nll_loss=0.805, word_ins=2.637, length=3.085, ppl=7.7, wps=25534.5, ups=0.43, wpb=59776.3, bsz=2042.5, num_updates=219400, lr=0.000213492, gnorm=1.329, loss_scale=8192, train_wall=234, wall=0
2023-03-03 03:19:52 | INFO | train_inner | epoch 111:   1960 / 1978 loss=2.962, nll_loss=0.82, word_ins=2.65, length=3.128, ppl=7.79, wps=25515.8, ups=0.43, wpb=59640.7, bsz=2022.6, num_updates=219500, lr=0.000213443, gnorm=1.347, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:20:34 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 03:20:51 | INFO | valid | epoch 111 | valid on 'valid' subset | loss 4.06 | nll_loss 1.925 | word_ins 3.691 | length 3.695 | ppl 16.68 | wps 30662.3 | wpb 40242.5 | bsz 1500 | num_updates 219518 | best_loss 4.034
2023-03-03 03:20:51 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 03:20:56 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint111.pt (epoch 111 @ 219518 updates, score 4.06) (writing took 5.580051336437464 seconds)
2023-03-03 03:20:56 | INFO | fairseq_cli.train | end of epoch 111 (average epoch stats below)
2023-03-03 03:20:56 | INFO | train | epoch 111 | loss 2.96 | nll_loss 0.818 | word_ins 2.649 | length 3.11 | ppl 7.78 | wps 25183.2 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 219518 | lr 0.000213435 | gnorm 1.339 | loss_scale 8192 | train_wall 4619 | wall 0
2023-03-03 03:20:56 | INFO | fairseq.trainer | begin training epoch 112
2023-03-03 03:22:49 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 03:24:21 | INFO | train_inner | epoch 112:     83 / 1978 loss=2.933, nll_loss=0.799, word_ins=2.632, length=3.02, ppl=7.64, wps=22072.9, ups=0.37, wpb=59453.9, bsz=2147.8, num_updates=219600, lr=0.000213395, gnorm=1.35, loss_scale=8192, train_wall=236, wall=0
2023-03-03 03:28:15 | INFO | train_inner | epoch 112:    183 / 1978 loss=2.949, nll_loss=0.809, word_ins=2.641, length=3.084, ppl=7.72, wps=25414.9, ups=0.43, wpb=59503.4, bsz=2018.5, num_updates=219700, lr=0.000213346, gnorm=1.348, loss_scale=8192, train_wall=234, wall=0
2023-03-03 03:32:08 | INFO | train_inner | epoch 112:    283 / 1978 loss=2.962, nll_loss=0.822, word_ins=2.653, length=3.094, ppl=7.79, wps=25419.8, ups=0.43, wpb=59309.4, bsz=2020.6, num_updates=219800, lr=0.000213298, gnorm=1.312, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:36:01 | INFO | train_inner | epoch 112:    383 / 1978 loss=2.951, nll_loss=0.81, word_ins=2.641, length=3.095, ppl=7.73, wps=25528.2, ups=0.43, wpb=59461.8, bsz=1981.6, num_updates=219900, lr=0.000213249, gnorm=1.375, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:39:55 | INFO | train_inner | epoch 112:    483 / 1978 loss=2.975, nll_loss=0.829, word_ins=2.659, length=3.157, ppl=7.86, wps=25534.4, ups=0.43, wpb=59535.2, bsz=1895, num_updates=220000, lr=0.000213201, gnorm=1.341, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:43:49 | INFO | train_inner | epoch 112:    583 / 1978 loss=2.956, nll_loss=0.813, word_ins=2.644, length=3.119, ppl=7.76, wps=25429.4, ups=0.43, wpb=59579.9, bsz=2008.6, num_updates=220100, lr=0.000213152, gnorm=1.354, loss_scale=8192, train_wall=234, wall=0
2023-03-03 03:47:42 | INFO | train_inner | epoch 112:    683 / 1978 loss=2.967, nll_loss=0.82, word_ins=2.651, length=3.158, ppl=7.82, wps=25296.5, ups=0.43, wpb=58859.4, bsz=1975, num_updates=220200, lr=0.000213104, gnorm=1.333, loss_scale=8192, train_wall=232, wall=0
2023-03-03 03:51:35 | INFO | train_inner | epoch 112:    783 / 1978 loss=2.963, nll_loss=0.816, word_ins=2.648, length=3.151, ppl=7.8, wps=25283.1, ups=0.43, wpb=59132.7, bsz=1972.6, num_updates=220300, lr=0.000213056, gnorm=1.361, loss_scale=8192, train_wall=234, wall=0
2023-03-03 03:55:29 | INFO | train_inner | epoch 112:    883 / 1978 loss=2.957, nll_loss=0.812, word_ins=2.643, length=3.138, ppl=7.77, wps=25242.1, ups=0.43, wpb=58955.7, bsz=1975.7, num_updates=220400, lr=0.000213007, gnorm=1.313, loss_scale=8192, train_wall=233, wall=0
2023-03-03 03:59:23 | INFO | train_inner | epoch 112:    983 / 1978 loss=2.95, nll_loss=0.81, word_ins=2.642, length=3.084, ppl=7.73, wps=25262.2, ups=0.43, wpb=59179.7, bsz=2039.7, num_updates=220500, lr=0.000212959, gnorm=1.371, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:03:15 | INFO | train_inner | epoch 112:   1083 / 1978 loss=2.976, nll_loss=0.829, word_ins=2.658, length=3.171, ppl=7.87, wps=25531.3, ups=0.43, wpb=59262.3, bsz=1910.2, num_updates=220600, lr=0.000212911, gnorm=1.373, loss_scale=8192, train_wall=232, wall=0
2023-03-03 04:07:09 | INFO | train_inner | epoch 112:   1183 / 1978 loss=2.976, nll_loss=0.837, word_ins=2.666, length=3.096, ppl=7.87, wps=25482.9, ups=0.43, wpb=59599.6, bsz=1974.2, num_updates=220700, lr=0.000212862, gnorm=1.36, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:11:04 | INFO | train_inner | epoch 112:   1283 / 1978 loss=2.953, nll_loss=0.814, word_ins=2.645, length=3.086, ppl=7.74, wps=25540.6, ups=0.43, wpb=59900.3, bsz=2018.6, num_updates=220800, lr=0.000212814, gnorm=1.369, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:14:58 | INFO | train_inner | epoch 112:   1383 / 1978 loss=2.979, nll_loss=0.832, word_ins=2.661, length=3.184, ppl=7.89, wps=25163.3, ups=0.43, wpb=58818.8, bsz=1955.5, num_updates=220900, lr=0.000212766, gnorm=1.357, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:18:51 | INFO | train_inner | epoch 112:   1483 / 1978 loss=2.954, nll_loss=0.811, word_ins=2.642, length=3.119, ppl=7.75, wps=25230.7, ups=0.43, wpb=58920.5, bsz=2002.6, num_updates=221000, lr=0.000212718, gnorm=1.297, loss_scale=8192, train_wall=233, wall=0
2023-03-03 04:22:45 | INFO | train_inner | epoch 112:   1583 / 1978 loss=2.942, nll_loss=0.803, word_ins=2.634, length=3.08, ppl=7.69, wps=25347.1, ups=0.43, wpb=59387.1, bsz=2031.8, num_updates=221100, lr=0.00021267, gnorm=1.342, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:26:39 | INFO | train_inner | epoch 112:   1683 / 1978 loss=2.962, nll_loss=0.822, word_ins=2.653, length=3.092, ppl=7.79, wps=25306.8, ups=0.43, wpb=59151.3, bsz=2041.4, num_updates=221200, lr=0.000212622, gnorm=1.372, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:30:33 | INFO | train_inner | epoch 112:   1783 / 1978 loss=2.96, nll_loss=0.818, word_ins=2.649, length=3.106, ppl=7.78, wps=25262.7, ups=0.43, wpb=59131.8, bsz=2024.2, num_updates=221300, lr=0.000212574, gnorm=1.378, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:34:27 | INFO | train_inner | epoch 112:   1883 / 1978 loss=2.954, nll_loss=0.817, word_ins=2.647, length=3.065, ppl=7.75, wps=25480.1, ups=0.43, wpb=59546.7, bsz=2069.7, num_updates=221400, lr=0.000212526, gnorm=1.347, loss_scale=8192, train_wall=233, wall=0
2023-03-03 04:38:09 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 04:38:26 | INFO | valid | epoch 112 | valid on 'valid' subset | loss 4.055 | nll_loss 1.921 | word_ins 3.685 | length 3.703 | ppl 16.62 | wps 30762.2 | wpb 40242.5 | bsz 1500 | num_updates 221495 | best_loss 4.034
2023-03-03 04:38:26 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 04:38:32 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint112.pt (epoch 112 @ 221495 updates, score 4.055) (writing took 5.830180325545371 seconds)
2023-03-03 04:38:32 | INFO | fairseq_cli.train | end of epoch 112 (average epoch stats below)
2023-03-03 04:38:32 | INFO | train | epoch 112 | loss 2.96 | nll_loss 0.818 | word_ins 2.648 | length 3.113 | ppl 7.78 | wps 25174.6 | ups 0.42 | wpb 59285.1 | bsz 2002.6 | num_updates 221495 | lr 0.00021248 | gnorm 1.352 | loss_scale 8192 | train_wall 4617 | wall 0
2023-03-03 04:38:32 | INFO | fairseq.trainer | begin training epoch 113
2023-03-03 04:38:52 | INFO | train_inner | epoch 113:      5 / 1978 loss=2.962, nll_loss=0.82, word_ins=2.65, length=3.116, ppl=7.79, wps=22240.9, ups=0.38, wpb=59070.8, bsz=2027.1, num_updates=221500, lr=0.000212478, gnorm=1.359, loss_scale=8192, train_wall=232, wall=0
2023-03-03 04:42:47 | INFO | train_inner | epoch 113:    105 / 1978 loss=2.968, nll_loss=0.827, word_ins=2.657, length=3.115, ppl=7.83, wps=25069.2, ups=0.43, wpb=58686, bsz=2024.1, num_updates=221600, lr=0.00021243, gnorm=1.32, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:46:40 | INFO | train_inner | epoch 113:    205 / 1978 loss=2.951, nll_loss=0.816, word_ins=2.647, length=3.043, ppl=7.73, wps=25574.9, ups=0.43, wpb=59736.3, bsz=2008.4, num_updates=221700, lr=0.000212382, gnorm=1.367, loss_scale=8192, train_wall=233, wall=0
2023-03-03 04:50:35 | INFO | train_inner | epoch 113:    305 / 1978 loss=2.935, nll_loss=0.797, word_ins=2.63, length=3.055, ppl=7.65, wps=25158.6, ups=0.43, wpb=59038.4, bsz=2100.5, num_updates=221800, lr=0.000212334, gnorm=1.301, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:54:29 | INFO | train_inner | epoch 113:    405 / 1978 loss=2.93, nll_loss=0.795, word_ins=2.627, length=3.025, ppl=7.62, wps=25468.2, ups=0.43, wpb=59719.4, bsz=2127.8, num_updates=221900, lr=0.000212286, gnorm=1.333, loss_scale=8192, train_wall=234, wall=0
2023-03-03 04:58:22 | INFO | train_inner | epoch 113:    505 / 1978 loss=2.959, nll_loss=0.815, word_ins=2.646, length=3.133, ppl=7.78, wps=25258.1, ups=0.43, wpb=58800.8, bsz=1975.4, num_updates=222000, lr=0.000212238, gnorm=1.363, loss_scale=8192, train_wall=233, wall=0
2023-03-03 05:02:16 | INFO | train_inner | epoch 113:    605 / 1978 loss=2.964, nll_loss=0.823, word_ins=2.653, length=3.111, ppl=7.81, wps=25244.2, ups=0.43, wpb=59035.4, bsz=1940.1, num_updates=222100, lr=0.00021219, gnorm=1.368, loss_scale=8192, train_wall=234, wall=0
2023-03-03 05:06:09 | INFO | train_inner | epoch 113:    705 / 1978 loss=2.974, nll_loss=0.827, word_ins=2.658, length=3.16, ppl=7.86, wps=25425.2, ups=0.43, wpb=59177.7, bsz=1882.8, num_updates=222200, lr=0.000212143, gnorm=1.378, loss_scale=8192, train_wall=233, wall=0
2023-03-03 05:10:01 | INFO | train_inner | epoch 113:    805 / 1978 loss=2.96, nll_loss=0.82, word_ins=2.651, length=3.097, ppl=7.78, wps=25412, ups=0.43, wpb=59121.8, bsz=1984.9, num_updates=222300, lr=0.000212095, gnorm=1.323, loss_scale=8192, train_wall=232, wall=0
2023-03-03 05:13:56 | INFO | train_inner | epoch 113:    905 / 1978 loss=2.959, nll_loss=0.816, word_ins=2.647, length=3.124, ppl=7.78, wps=25366.5, ups=0.43, wpb=59467.2, bsz=2003, num_updates=222400, lr=0.000212047, gnorm=1.347, loss_scale=8192, train_wall=234, wall=0
2023-03-03 05:17:48 | INFO | train_inner | epoch 113:   1005 / 1978 loss=2.969, nll_loss=0.823, word_ins=2.653, length=3.157, ppl=7.83, wps=25489.1, ups=0.43, wpb=59274, bsz=1920.3, num_updates=222500, lr=0.000212, gnorm=1.365, loss_scale=8192, train_wall=232, wall=0
2023-03-03 05:21:43 | INFO | train_inner | epoch 113:   1105 / 1978 loss=2.952, nll_loss=0.814, word_ins=2.645, length=3.064, ppl=7.74, wps=25271.8, ups=0.43, wpb=59243.9, bsz=2063.4, num_updates=222600, lr=0.000211952, gnorm=1.299, loss_scale=8192, train_wall=234, wall=0
2023-03-03 05:25:37 | INFO | train_inner | epoch 113:   1205 / 1978 loss=2.973, nll_loss=0.831, word_ins=2.66, length=3.126, ppl=7.85, wps=25309.3, ups=0.43, wpb=59247, bsz=1927.8, num_updates=222700, lr=0.000211904, gnorm=1.403, loss_scale=8192, train_wall=234, wall=0
2023-03-03 05:29:31 | INFO | train_inner | epoch 113:   1305 / 1978 loss=2.969, nll_loss=0.827, word_ins=2.657, length=3.115, ppl=7.83, wps=25404.2, ups=0.43, wpb=59322.9, bsz=1992.2, num_updates=222800, lr=0.000211857, gnorm=1.312, loss_scale=8192, train_wall=233, wall=0
2023-03-03 05:33:23 | INFO | train_inner | epoch 113:   1405 / 1978 loss=2.973, nll_loss=0.826, word_ins=2.656, length=3.175, ppl=7.85, wps=25373.9, ups=0.43, wpb=59049.1, bsz=1940.7, num_updates=222900, lr=0.000211809, gnorm=1.335, loss_scale=8192, train_wall=232, wall=0
2023-03-03 05:37:18 | INFO | train_inner | epoch 113:   1505 / 1978 loss=2.937, nll_loss=0.801, word_ins=2.633, length=3.043, ppl=7.66, wps=25445.9, ups=0.43, wpb=59812.8, bsz=2056.3, num_updates=223000, lr=0.000211762, gnorm=1.366, loss_scale=8192, train_wall=235, wall=0
2023-03-03 05:41:11 | INFO | train_inner | epoch 113:   1605 / 1978 loss=2.96, nll_loss=0.817, word_ins=2.647, length=3.132, ppl=7.78, wps=25590.8, ups=0.43, wpb=59656.4, bsz=1973.4, num_updates=223100, lr=0.000211714, gnorm=1.364, loss_scale=8192, train_wall=233, wall=0
2023-03-03 05:45:06 | INFO | train_inner | epoch 113:   1705 / 1978 loss=2.953, nll_loss=0.813, word_ins=2.644, length=3.1, ppl=7.75, wps=25186.3, ups=0.43, wpb=59090.5, bsz=2053.7, num_updates=223200, lr=0.000211667, gnorm=1.307, loss_scale=8192, train_wall=234, wall=0
2023-03-03 05:49:00 | INFO | train_inner | epoch 113:   1805 / 1978 loss=2.974, nll_loss=0.832, word_ins=2.662, length=3.12, ppl=7.86, wps=25253, ups=0.43, wpb=59190.7, bsz=2015.7, num_updates=223300, lr=0.000211619, gnorm=1.394, loss_scale=8192, train_wall=234, wall=0
2023-03-03 05:52:54 | INFO | train_inner | epoch 113:   1905 / 1978 loss=2.948, nll_loss=0.803, word_ins=2.634, length=3.136, ppl=7.72, wps=25371.2, ups=0.43, wpb=59221.8, bsz=2036.6, num_updates=223400, lr=0.000211572, gnorm=1.346, loss_scale=8192, train_wall=233, wall=0
2023-03-03 05:55:45 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 05:56:00 | INFO | valid | epoch 113 | valid on 'valid' subset | loss 4.12 | nll_loss 1.918 | word_ins 3.681 | length 4.383 | ppl 17.39 | wps 31202.6 | wpb 40242.5 | bsz 1500 | num_updates 223473 | best_loss 4.034
2023-03-03 05:56:00 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 05:56:05 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint113.pt (epoch 113 @ 223473 updates, score 4.12) (writing took 5.5146959107369184 seconds)
2023-03-03 05:56:05 | INFO | fairseq_cli.train | end of epoch 113 (average epoch stats below)
2023-03-03 05:56:05 | INFO | train | epoch 113 | loss 2.959 | nll_loss 0.817 | word_ins 2.648 | length 3.106 | ppl 7.77 | wps 25200 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 223473 | lr 0.000211538 | gnorm 1.349 | loss_scale 8192 | train_wall 4619 | wall 0
2023-03-03 05:56:06 | INFO | fairseq.trainer | begin training epoch 114
2023-03-03 05:57:17 | INFO | train_inner | epoch 114:     27 / 1978 loss=2.955, nll_loss=0.816, word_ins=2.646, length=3.082, ppl=7.75, wps=22790.4, ups=0.38, wpb=59983.8, bsz=2039.7, num_updates=223500, lr=0.000211525, gnorm=1.385, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:01:11 | INFO | train_inner | epoch 114:    127 / 1978 loss=2.953, nll_loss=0.817, word_ins=2.647, length=3.057, ppl=7.74, wps=25562.2, ups=0.43, wpb=59794.4, bsz=2000.3, num_updates=223600, lr=0.000211477, gnorm=1.364, loss_scale=8192, train_wall=234, wall=0
2023-03-03 06:03:26 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 06:05:07 | INFO | train_inner | epoch 114:    228 / 1978 loss=2.955, nll_loss=0.811, word_ins=2.642, length=3.129, ppl=7.75, wps=25246.5, ups=0.42, wpb=59584, bsz=1999.1, num_updates=223700, lr=0.00021143, gnorm=1.384, loss_scale=8192, train_wall=236, wall=0
2023-03-03 06:09:01 | INFO | train_inner | epoch 114:    328 / 1978 loss=2.976, nll_loss=0.829, word_ins=2.658, length=3.175, ppl=7.87, wps=25398.4, ups=0.43, wpb=59380.3, bsz=1946.2, num_updates=223800, lr=0.000211383, gnorm=1.404, loss_scale=8192, train_wall=234, wall=0
2023-03-03 06:12:55 | INFO | train_inner | epoch 114:    428 / 1978 loss=2.96, nll_loss=0.818, word_ins=2.649, length=3.115, ppl=7.78, wps=25413.6, ups=0.43, wpb=59426.9, bsz=1999.3, num_updates=223900, lr=0.000211336, gnorm=1.379, loss_scale=8192, train_wall=234, wall=0
2023-03-03 06:16:48 | INFO | train_inner | epoch 114:    528 / 1978 loss=2.947, nll_loss=0.805, word_ins=2.637, length=3.096, ppl=7.71, wps=25219.6, ups=0.43, wpb=58899.3, bsz=2011.5, num_updates=224000, lr=0.000211289, gnorm=1.315, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:20:41 | INFO | train_inner | epoch 114:    628 / 1978 loss=2.946, nll_loss=0.805, word_ins=2.637, length=3.094, ppl=7.71, wps=25399.4, ups=0.43, wpb=59222.9, bsz=2039.8, num_updates=224100, lr=0.000211241, gnorm=1.343, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:24:34 | INFO | train_inner | epoch 114:    728 / 1978 loss=2.98, nll_loss=0.83, word_ins=2.66, length=3.202, ppl=7.89, wps=25248.3, ups=0.43, wpb=58690.6, bsz=1916.3, num_updates=224200, lr=0.000211194, gnorm=1.342, loss_scale=8192, train_wall=232, wall=0
2023-03-03 06:28:29 | INFO | train_inner | epoch 114:    828 / 1978 loss=2.944, nll_loss=0.807, word_ins=2.639, length=3.048, ppl=7.7, wps=25213.5, ups=0.43, wpb=59195.4, bsz=2087.5, num_updates=224300, lr=0.000211147, gnorm=1.322, loss_scale=8192, train_wall=235, wall=0
2023-03-03 06:32:22 | INFO | train_inner | epoch 114:    928 / 1978 loss=2.957, nll_loss=0.82, word_ins=2.65, length=3.066, ppl=7.76, wps=25488.8, ups=0.43, wpb=59490.1, bsz=2049.7, num_updates=224400, lr=0.0002111, gnorm=1.364, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:36:16 | INFO | train_inner | epoch 114:   1028 / 1978 loss=2.95, nll_loss=0.81, word_ins=2.642, length=3.078, ppl=7.73, wps=25441.3, ups=0.43, wpb=59527.7, bsz=2026.9, num_updates=224500, lr=0.000211053, gnorm=1.37, loss_scale=8192, train_wall=234, wall=0
2023-03-03 06:40:11 | INFO | train_inner | epoch 114:   1128 / 1978 loss=2.948, nll_loss=0.807, word_ins=2.639, length=3.096, ppl=7.72, wps=25330.4, ups=0.43, wpb=59447.8, bsz=2032.6, num_updates=224600, lr=0.000211006, gnorm=1.347, loss_scale=8192, train_wall=234, wall=0
2023-03-03 06:44:05 | INFO | train_inner | epoch 114:   1228 / 1978 loss=2.947, nll_loss=0.804, word_ins=2.636, length=3.116, ppl=7.71, wps=25291.4, ups=0.43, wpb=59192.3, bsz=2000.6, num_updates=224700, lr=0.000210959, gnorm=1.354, loss_scale=8192, train_wall=234, wall=0
2023-03-03 06:47:58 | INFO | train_inner | epoch 114:   1328 / 1978 loss=2.956, nll_loss=0.813, word_ins=2.644, length=3.118, ppl=7.76, wps=25466.3, ups=0.43, wpb=59383.2, bsz=1965.1, num_updates=224800, lr=0.000210912, gnorm=1.296, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:51:51 | INFO | train_inner | epoch 114:   1428 / 1978 loss=2.945, nll_loss=0.808, word_ins=2.64, length=3.054, ppl=7.7, wps=25277.4, ups=0.43, wpb=58989.7, bsz=2042.3, num_updates=224900, lr=0.000210865, gnorm=1.327, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:55:44 | INFO | train_inner | epoch 114:   1528 / 1978 loss=2.967, nll_loss=0.825, word_ins=2.655, length=3.116, ppl=7.82, wps=25465.4, ups=0.43, wpb=59385.7, bsz=1978.1, num_updates=225000, lr=0.000210819, gnorm=1.367, loss_scale=8192, train_wall=233, wall=0
2023-03-03 06:59:38 | INFO | train_inner | epoch 114:   1628 / 1978 loss=2.987, nll_loss=0.841, word_ins=2.67, length=3.174, ppl=7.93, wps=25273.6, ups=0.43, wpb=59017.7, bsz=1910.4, num_updates=225100, lr=0.000210772, gnorm=1.407, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:03:31 | INFO | train_inner | epoch 114:   1728 / 1978 loss=2.963, nll_loss=0.822, word_ins=2.652, length=3.117, ppl=7.8, wps=25328.9, ups=0.43, wpb=59058.6, bsz=2011, num_updates=225200, lr=0.000210725, gnorm=1.408, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:07:26 | INFO | train_inner | epoch 114:   1828 / 1978 loss=2.949, nll_loss=0.812, word_ins=2.644, length=3.055, ppl=7.72, wps=25460.1, ups=0.43, wpb=59710.8, bsz=2074.7, num_updates=225300, lr=0.000210678, gnorm=1.295, loss_scale=8192, train_wall=234, wall=0
2023-03-03 07:11:19 | INFO | train_inner | epoch 114:   1928 / 1978 loss=2.975, nll_loss=0.83, word_ins=2.659, length=3.158, ppl=7.86, wps=25170.6, ups=0.43, wpb=58701.6, bsz=1939.8, num_updates=225400, lr=0.000210631, gnorm=1.343, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:13:16 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 07:13:33 | INFO | valid | epoch 114 | valid on 'valid' subset | loss 4.066 | nll_loss 1.917 | word_ins 3.682 | length 3.849 | ppl 16.75 | wps 29519.4 | wpb 40242.5 | bsz 1500 | num_updates 225450 | best_loss 4.034
2023-03-03 07:13:33 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 07:13:39 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint114.pt (epoch 114 @ 225450 updates, score 4.066) (writing took 5.517096858471632 seconds)
2023-03-03 07:13:39 | INFO | fairseq_cli.train | end of epoch 114 (average epoch stats below)
2023-03-03 07:13:39 | INFO | train | epoch 114 | loss 2.957 | nll_loss 0.816 | word_ins 2.647 | length 3.108 | ppl 7.77 | wps 25187.4 | ups 0.42 | wpb 59282.4 | bsz 2003 | num_updates 225450 | lr 0.000210608 | gnorm 1.355 | loss_scale 8192 | train_wall 4616 | wall 0
2023-03-03 07:13:39 | INFO | fairseq.trainer | begin training epoch 115
2023-03-03 07:15:44 | INFO | train_inner | epoch 115:     50 / 1978 loss=2.935, nll_loss=0.798, word_ins=2.63, length=3.052, ppl=7.65, wps=22390.4, ups=0.38, wpb=59393.2, bsz=2033.8, num_updates=225500, lr=0.000210585, gnorm=1.377, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:19:37 | INFO | train_inner | epoch 115:    150 / 1978 loss=2.975, nll_loss=0.828, word_ins=2.658, length=3.175, ppl=7.86, wps=25181.7, ups=0.43, wpb=58625.3, bsz=1964.6, num_updates=225600, lr=0.000210538, gnorm=1.431, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:23:31 | INFO | train_inner | epoch 115:    250 / 1978 loss=2.937, nll_loss=0.798, word_ins=2.63, length=3.073, ppl=7.66, wps=25526, ups=0.43, wpb=59601.9, bsz=2002.2, num_updates=225700, lr=0.000210491, gnorm=1.352, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:27:25 | INFO | train_inner | epoch 115:    350 / 1978 loss=2.951, nll_loss=0.807, word_ins=2.639, length=3.12, ppl=7.73, wps=25366.9, ups=0.43, wpb=59391.3, bsz=1945.8, num_updates=225800, lr=0.000210445, gnorm=1.42, loss_scale=8192, train_wall=234, wall=0
2023-03-03 07:31:17 | INFO | train_inner | epoch 115:    450 / 1978 loss=2.944, nll_loss=0.807, word_ins=2.639, length=3.055, ppl=7.7, wps=25643.9, ups=0.43, wpb=59653.6, bsz=1992.1, num_updates=225900, lr=0.000210398, gnorm=1.347, loss_scale=8192, train_wall=232, wall=0
2023-03-03 07:35:10 | INFO | train_inner | epoch 115:    550 / 1978 loss=2.964, nll_loss=0.824, word_ins=2.654, length=3.1, ppl=7.8, wps=25707.3, ups=0.43, wpb=59947.5, bsz=1979.4, num_updates=226000, lr=0.000210352, gnorm=1.386, loss_scale=8192, train_wall=233, wall=0
2023-03-03 07:39:04 | INFO | train_inner | epoch 115:    650 / 1978 loss=2.956, nll_loss=0.815, word_ins=2.646, length=3.104, ppl=7.76, wps=25237.1, ups=0.43, wpb=59015, bsz=1971.4, num_updates=226100, lr=0.000210305, gnorm=1.327, loss_scale=8192, train_wall=234, wall=0
2023-03-03 07:43:00 | INFO | train_inner | epoch 115:    750 / 1978 loss=2.941, nll_loss=0.804, word_ins=2.635, length=3.054, ppl=7.68, wps=25396.8, ups=0.42, wpb=59864.1, bsz=2025.4, num_updates=226200, lr=0.000210259, gnorm=1.407, loss_scale=8192, train_wall=235, wall=0
2023-03-03 07:46:53 | INFO | train_inner | epoch 115:    850 / 1978 loss=2.977, nll_loss=0.833, word_ins=2.663, length=3.141, ppl=7.87, wps=25374, ups=0.43, wpb=59026.6, bsz=1892.6, num_updates=226300, lr=0.000210212, gnorm=1.353, loss_scale=8192, train_wall=232, wall=0
2023-03-03 07:50:47 | INFO | train_inner | epoch 115:    950 / 1978 loss=2.934, nll_loss=0.796, word_ins=2.628, length=3.062, ppl=7.64, wps=25395.9, ups=0.43, wpb=59541, bsz=2083.8, num_updates=226400, lr=0.000210166, gnorm=1.337, loss_scale=8192, train_wall=234, wall=0
2023-03-03 07:54:42 | INFO | train_inner | epoch 115:   1050 / 1978 loss=2.941, nll_loss=0.804, word_ins=2.636, length=3.055, ppl=7.68, wps=25340.5, ups=0.43, wpb=59506.2, bsz=2082.3, num_updates=226500, lr=0.000210119, gnorm=1.326, loss_scale=8192, train_wall=235, wall=0
2023-03-03 07:58:35 | INFO | train_inner | epoch 115:   1150 / 1978 loss=2.967, nll_loss=0.829, word_ins=2.659, length=3.085, ppl=7.82, wps=25282.6, ups=0.43, wpb=58983.7, bsz=2046.7, num_updates=226600, lr=0.000210073, gnorm=1.355, loss_scale=8192, train_wall=233, wall=0
2023-03-03 08:02:29 | INFO | train_inner | epoch 115:   1250 / 1978 loss=2.949, nll_loss=0.807, word_ins=2.638, length=3.114, ppl=7.72, wps=25407.8, ups=0.43, wpb=59443, bsz=2045.4, num_updates=226700, lr=0.000210027, gnorm=1.349, loss_scale=8192, train_wall=234, wall=0
2023-03-03 08:06:22 | INFO | train_inner | epoch 115:   1350 / 1978 loss=2.976, nll_loss=0.829, word_ins=2.659, length=3.162, ppl=7.87, wps=25262.1, ups=0.43, wpb=58748.4, bsz=1915.4, num_updates=226800, lr=0.00020998, gnorm=1.381, loss_scale=8192, train_wall=232, wall=0
2023-03-03 08:10:15 | INFO | train_inner | epoch 115:   1450 / 1978 loss=2.962, nll_loss=0.821, word_ins=2.651, length=3.107, ppl=7.79, wps=25420.5, ups=0.43, wpb=59378.6, bsz=1968.7, num_updates=226900, lr=0.000209934, gnorm=1.363, loss_scale=8192, train_wall=233, wall=0
2023-03-03 08:14:09 | INFO | train_inner | epoch 115:   1550 / 1978 loss=2.95, nll_loss=0.81, word_ins=2.641, length=3.089, ppl=7.73, wps=25464.1, ups=0.43, wpb=59564.6, bsz=1997.4, num_updates=227000, lr=0.000209888, gnorm=1.364, loss_scale=8192, train_wall=234, wall=0
2023-03-03 08:18:04 | INFO | train_inner | epoch 115:   1650 / 1978 loss=2.95, nll_loss=0.812, word_ins=2.643, length=3.072, ppl=7.73, wps=25276.7, ups=0.43, wpb=59218.1, bsz=2109, num_updates=227100, lr=0.000209842, gnorm=1.306, loss_scale=8192, train_wall=234, wall=0
2023-03-03 08:21:56 | INFO | train_inner | epoch 115:   1750 / 1978 loss=2.97, nll_loss=0.825, word_ins=2.656, length=3.143, ppl=7.84, wps=25238.4, ups=0.43, wpb=58663.6, bsz=1997.6, num_updates=227200, lr=0.000209795, gnorm=1.342, loss_scale=8192, train_wall=232, wall=0
2023-03-03 08:25:51 | INFO | train_inner | epoch 115:   1850 / 1978 loss=2.948, nll_loss=0.807, word_ins=2.638, length=3.096, ppl=7.72, wps=25259.4, ups=0.43, wpb=59288.8, bsz=2043.3, num_updates=227300, lr=0.000209749, gnorm=1.304, loss_scale=8192, train_wall=234, wall=0
2023-03-03 08:29:43 | INFO | train_inner | epoch 115:   1950 / 1978 loss=2.963, nll_loss=0.824, word_ins=2.654, length=3.096, ppl=7.8, wps=25396.4, ups=0.43, wpb=59065.6, bsz=1969.3, num_updates=227400, lr=0.000209703, gnorm=1.369, loss_scale=8192, train_wall=232, wall=0
2023-03-03 08:30:49 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 08:31:04 | INFO | valid | epoch 115 | valid on 'valid' subset | loss 4.109 | nll_loss 1.906 | word_ins 3.669 | length 4.398 | ppl 17.26 | wps 30406.7 | wpb 40242.5 | bsz 1500 | num_updates 227428 | best_loss 4.034
2023-03-03 08:31:04 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 08:31:10 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint115.pt (epoch 115 @ 227428 updates, score 4.109) (writing took 5.746531866490841 seconds)
2023-03-03 08:31:10 | INFO | fairseq_cli.train | end of epoch 115 (average epoch stats below)
2023-03-03 08:31:10 | INFO | train | epoch 115 | loss 2.955 | nll_loss 0.814 | word_ins 2.645 | length 3.097 | ppl 7.75 | wps 25209.6 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 227428 | lr 0.00020969 | gnorm 1.358 | loss_scale 8192 | train_wall 4615 | wall 0
2023-03-03 08:31:10 | INFO | fairseq.trainer | begin training epoch 116
2023-03-03 08:34:06 | INFO | train_inner | epoch 116:     72 / 1978 loss=2.948, nll_loss=0.812, word_ins=2.643, length=3.053, ppl=7.72, wps=22470, ups=0.38, wpb=59128.9, bsz=2009.1, num_updates=227500, lr=0.000209657, gnorm=1.325, loss_scale=8192, train_wall=231, wall=0
2023-03-03 08:38:00 | INFO | train_inner | epoch 116:    172 / 1978 loss=2.937, nll_loss=0.799, word_ins=2.631, length=3.053, ppl=7.66, wps=25731.3, ups=0.43, wpb=60051.1, bsz=1996.2, num_updates=227600, lr=0.000209611, gnorm=1.357, loss_scale=8192, train_wall=233, wall=0
2023-03-03 08:41:53 | INFO | train_inner | epoch 116:    272 / 1978 loss=2.95, nll_loss=0.807, word_ins=2.639, length=3.103, ppl=7.73, wps=25171.7, ups=0.43, wpb=58742.2, bsz=1977.5, num_updates=227700, lr=0.000209565, gnorm=1.382, loss_scale=8192, train_wall=233, wall=0
2023-03-03 08:43:59 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 08:45:51 | INFO | train_inner | epoch 116:    373 / 1978 loss=2.953, nll_loss=0.816, word_ins=2.647, length=3.056, ppl=7.74, wps=24773.1, ups=0.42, wpb=58798.2, bsz=2054.3, num_updates=227800, lr=0.000209519, gnorm=1.279, loss_scale=8192, train_wall=237, wall=0
2023-03-03 08:49:46 | INFO | train_inner | epoch 116:    473 / 1978 loss=2.939, nll_loss=0.804, word_ins=2.636, length=3.022, ppl=7.67, wps=25155, ups=0.43, wpb=59116.3, bsz=2083.4, num_updates=227900, lr=0.000209473, gnorm=1.323, loss_scale=8192, train_wall=235, wall=0
2023-03-03 08:53:39 | INFO | train_inner | epoch 116:    573 / 1978 loss=2.958, nll_loss=0.815, word_ins=2.646, length=3.113, ppl=7.77, wps=25517.5, ups=0.43, wpb=59616.5, bsz=1989.4, num_updates=228000, lr=0.000209427, gnorm=1.362, loss_scale=8192, train_wall=233, wall=0
2023-03-03 08:57:32 | INFO | train_inner | epoch 116:    673 / 1978 loss=2.983, nll_loss=0.837, word_ins=2.666, length=3.177, ppl=7.91, wps=25397.3, ups=0.43, wpb=59024, bsz=1924.1, num_updates=228100, lr=0.000209381, gnorm=1.393, loss_scale=8192, train_wall=232, wall=0
2023-03-03 09:01:25 | INFO | train_inner | epoch 116:    773 / 1978 loss=2.931, nll_loss=0.794, word_ins=2.626, length=3.045, ppl=7.63, wps=25269.1, ups=0.43, wpb=59030.3, bsz=2112.8, num_updates=228200, lr=0.000209335, gnorm=1.303, loss_scale=8192, train_wall=233, wall=0
2023-03-03 09:05:20 | INFO | train_inner | epoch 116:    873 / 1978 loss=2.952, nll_loss=0.815, word_ins=2.646, length=3.067, ppl=7.74, wps=25283.8, ups=0.43, wpb=59305.3, bsz=2005, num_updates=228300, lr=0.000209289, gnorm=1.355, loss_scale=8192, train_wall=234, wall=0
2023-03-03 09:09:13 | INFO | train_inner | epoch 116:    973 / 1978 loss=2.967, nll_loss=0.821, word_ins=2.651, length=3.161, ppl=7.82, wps=25408.7, ups=0.43, wpb=59166.4, bsz=1911.4, num_updates=228400, lr=0.000209243, gnorm=1.384, loss_scale=8192, train_wall=233, wall=0
2023-03-03 09:13:07 | INFO | train_inner | epoch 116:   1073 / 1978 loss=2.937, nll_loss=0.801, word_ins=2.632, length=3.051, ppl=7.66, wps=25446.4, ups=0.43, wpb=59566.7, bsz=2045, num_updates=228500, lr=0.000209198, gnorm=1.373, loss_scale=8192, train_wall=234, wall=0
2023-03-03 09:17:02 | INFO | train_inner | epoch 116:   1173 / 1978 loss=2.925, nll_loss=0.785, word_ins=2.619, length=3.062, ppl=7.59, wps=25350.9, ups=0.43, wpb=59542.5, bsz=2105.8, num_updates=228600, lr=0.000209152, gnorm=1.321, loss_scale=8192, train_wall=235, wall=0
2023-03-03 09:20:56 | INFO | train_inner | epoch 116:   1273 / 1978 loss=2.962, nll_loss=0.819, word_ins=2.649, length=3.121, ppl=7.79, wps=25444.2, ups=0.43, wpb=59585.8, bsz=1973.6, num_updates=228700, lr=0.000209106, gnorm=1.424, loss_scale=8192, train_wall=234, wall=0
2023-03-03 09:24:49 | INFO | train_inner | epoch 116:   1373 / 1978 loss=2.961, nll_loss=0.824, word_ins=2.654, length=3.066, ppl=7.78, wps=25460.5, ups=0.43, wpb=59359.7, bsz=1982, num_updates=228800, lr=0.000209061, gnorm=1.379, loss_scale=8192, train_wall=233, wall=0
2023-03-03 09:28:44 | INFO | train_inner | epoch 116:   1473 / 1978 loss=2.944, nll_loss=0.801, word_ins=2.633, length=3.111, ppl=7.69, wps=25138.8, ups=0.43, wpb=58977.4, bsz=2037.4, num_updates=228900, lr=0.000209015, gnorm=1.335, loss_scale=8192, train_wall=234, wall=0
2023-03-03 09:32:37 | INFO | train_inner | epoch 116:   1573 / 1978 loss=2.965, nll_loss=0.821, word_ins=2.651, length=3.139, ppl=7.81, wps=25526.2, ups=0.43, wpb=59581, bsz=1920.9, num_updates=229000, lr=0.000208969, gnorm=1.371, loss_scale=8192, train_wall=233, wall=0
2023-03-03 09:36:31 | INFO | train_inner | epoch 116:   1673 / 1978 loss=2.954, nll_loss=0.816, word_ins=2.647, length=3.064, ppl=7.75, wps=25296.3, ups=0.43, wpb=59083.1, bsz=1993.8, num_updates=229100, lr=0.000208924, gnorm=1.361, loss_scale=8192, train_wall=233, wall=0
2023-03-03 09:40:24 | INFO | train_inner | epoch 116:   1773 / 1978 loss=2.983, nll_loss=0.833, word_ins=2.662, length=3.214, ppl=7.91, wps=25312.8, ups=0.43, wpb=59203.1, bsz=1969.8, num_updates=229200, lr=0.000208878, gnorm=1.415, loss_scale=8192, train_wall=234, wall=0
2023-03-03 09:44:19 | INFO | train_inner | epoch 116:   1873 / 1978 loss=2.957, nll_loss=0.812, word_ins=2.643, length=3.14, ppl=7.76, wps=25336.2, ups=0.43, wpb=59393.3, bsz=1987.8, num_updates=229300, lr=0.000208832, gnorm=1.413, loss_scale=8192, train_wall=234, wall=0
2023-03-03 09:48:13 | INFO | train_inner | epoch 116:   1973 / 1978 loss=2.964, nll_loss=0.822, word_ins=2.652, length=3.118, ppl=7.8, wps=25435.6, ups=0.43, wpb=59453, bsz=1981.8, num_updates=229400, lr=0.000208787, gnorm=1.339, loss_scale=8192, train_wall=233, wall=0
2023-03-03 09:48:24 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 09:48:40 | INFO | valid | epoch 116 | valid on 'valid' subset | loss 4.097 | nll_loss 1.909 | word_ins 3.675 | length 4.215 | ppl 17.11 | wps 30665.2 | wpb 40242.5 | bsz 1500 | num_updates 229405 | best_loss 4.034
2023-03-03 09:48:40 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 09:48:45 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint116.pt (epoch 116 @ 229405 updates, score 4.097) (writing took 5.535254725255072 seconds)
2023-03-03 09:48:45 | INFO | fairseq_cli.train | end of epoch 116 (average epoch stats below)
2023-03-03 09:48:45 | INFO | train | epoch 116 | loss 2.953 | nll_loss 0.813 | word_ins 2.644 | length 3.097 | ppl 7.75 | wps 25179.3 | ups 0.42 | wpb 59284.5 | bsz 2002.8 | num_updates 229405 | lr 0.000208785 | gnorm 1.36 | loss_scale 8192 | train_wall 4619 | wall 0
2023-03-03 09:48:45 | INFO | fairseq.trainer | begin training epoch 117
2023-03-03 09:52:35 | INFO | train_inner | epoch 117:     95 / 1978 loss=2.944, nll_loss=0.805, word_ins=2.637, length=3.074, ppl=7.7, wps=22528.9, ups=0.38, wpb=59121.1, bsz=1975, num_updates=229500, lr=0.000208741, gnorm=1.38, loss_scale=8192, train_wall=232, wall=0
2023-03-03 09:56:29 | INFO | train_inner | epoch 117:    195 / 1978 loss=2.95, nll_loss=0.806, word_ins=2.638, length=3.124, ppl=7.73, wps=25366.8, ups=0.43, wpb=59467.3, bsz=2013.3, num_updates=229600, lr=0.000208696, gnorm=1.377, loss_scale=8192, train_wall=234, wall=0
2023-03-03 10:00:23 | INFO | train_inner | epoch 117:    295 / 1978 loss=2.963, nll_loss=0.82, word_ins=2.65, length=3.122, ppl=7.8, wps=25376.3, ups=0.43, wpb=59316.5, bsz=1950, num_updates=229700, lr=0.000208651, gnorm=1.428, loss_scale=8192, train_wall=234, wall=0
2023-03-03 10:04:18 | INFO | train_inner | epoch 117:    395 / 1978 loss=2.951, nll_loss=0.811, word_ins=2.643, length=3.086, ppl=7.74, wps=25316.3, ups=0.43, wpb=59315.7, bsz=2020.2, num_updates=229800, lr=0.000208605, gnorm=1.328, loss_scale=8192, train_wall=234, wall=0
2023-03-03 10:08:10 | INFO | train_inner | epoch 117:    495 / 1978 loss=2.953, nll_loss=0.809, word_ins=2.64, length=3.125, ppl=7.74, wps=25345.6, ups=0.43, wpb=59040, bsz=1957, num_updates=229900, lr=0.00020856, gnorm=1.342, loss_scale=8192, train_wall=233, wall=0
2023-03-03 10:12:03 | INFO | train_inner | epoch 117:    595 / 1978 loss=2.955, nll_loss=0.81, word_ins=2.642, length=3.134, ppl=7.76, wps=25438.4, ups=0.43, wpb=59253, bsz=1939.5, num_updates=230000, lr=0.000208514, gnorm=1.406, loss_scale=8192, train_wall=233, wall=0
2023-03-03 10:15:56 | INFO | train_inner | epoch 117:    695 / 1978 loss=2.967, nll_loss=0.821, word_ins=2.651, length=3.153, ppl=7.82, wps=25344.2, ups=0.43, wpb=59037.9, bsz=1955.2, num_updates=230100, lr=0.000208469, gnorm=1.41, loss_scale=8192, train_wall=233, wall=0
2023-03-03 10:19:49 | INFO | train_inner | epoch 117:    795 / 1978 loss=2.949, nll_loss=0.806, word_ins=2.638, length=3.115, ppl=7.72, wps=25444.8, ups=0.43, wpb=59170.8, bsz=1988.2, num_updates=230200, lr=0.000208424, gnorm=1.3, loss_scale=8192, train_wall=232, wall=0
2023-03-03 10:23:44 | INFO | train_inner | epoch 117:    895 / 1978 loss=2.938, nll_loss=0.8, word_ins=2.632, length=3.062, ppl=7.66, wps=25408.7, ups=0.43, wpb=59780.7, bsz=2076.6, num_updates=230300, lr=0.000208379, gnorm=1.347, loss_scale=8192, train_wall=235, wall=0
2023-03-03 10:27:39 | INFO | train_inner | epoch 117:    995 / 1978 loss=2.92, nll_loss=0.787, word_ins=2.62, length=3.001, ppl=7.57, wps=25332.8, ups=0.43, wpb=59490.8, bsz=2121.8, num_updates=230400, lr=0.000208333, gnorm=1.326, loss_scale=8192, train_wall=235, wall=0
2023-03-03 10:31:33 | INFO | train_inner | epoch 117:   1095 / 1978 loss=2.935, nll_loss=0.799, word_ins=2.631, length=3.038, ppl=7.65, wps=25256.8, ups=0.43, wpb=59088, bsz=2075.8, num_updates=230500, lr=0.000208288, gnorm=1.382, loss_scale=8192, train_wall=234, wall=0
2023-03-03 10:35:28 | INFO | train_inner | epoch 117:   1195 / 1978 loss=2.957, nll_loss=0.812, word_ins=2.643, length=3.137, ppl=7.77, wps=25275, ups=0.43, wpb=59318.2, bsz=2042.9, num_updates=230600, lr=0.000208243, gnorm=1.313, loss_scale=8192, train_wall=234, wall=0
2023-03-03 10:39:20 | INFO | train_inner | epoch 117:   1295 / 1978 loss=2.958, nll_loss=0.819, word_ins=2.65, length=3.08, ppl=7.77, wps=25304.1, ups=0.43, wpb=58811.4, bsz=1981.8, num_updates=230700, lr=0.000208198, gnorm=1.409, loss_scale=8192, train_wall=232, wall=0
2023-03-03 10:43:13 | INFO | train_inner | epoch 117:   1395 / 1978 loss=2.968, nll_loss=0.825, word_ins=2.655, length=3.13, ppl=7.82, wps=25218.3, ups=0.43, wpb=58840, bsz=1944.2, num_updates=230800, lr=0.000208153, gnorm=1.319, loss_scale=8192, train_wall=233, wall=0
2023-03-03 10:47:08 | INFO | train_inner | epoch 117:   1495 / 1978 loss=2.951, nll_loss=0.812, word_ins=2.642, length=3.092, ppl=7.74, wps=25248.6, ups=0.43, wpb=59290.5, bsz=2033.7, num_updates=230900, lr=0.000208108, gnorm=1.386, loss_scale=8192, train_wall=235, wall=0
2023-03-03 10:51:01 | INFO | train_inner | epoch 117:   1595 / 1978 loss=2.965, nll_loss=0.822, word_ins=2.652, length=3.129, ppl=7.81, wps=25627.7, ups=0.43, wpb=59533.4, bsz=1946.1, num_updates=231000, lr=0.000208063, gnorm=1.446, loss_scale=8192, train_wall=232, wall=0
2023-03-03 10:54:54 | INFO | train_inner | epoch 117:   1695 / 1978 loss=2.939, nll_loss=0.806, word_ins=2.637, length=3.02, ppl=7.67, wps=25449.1, ups=0.43, wpb=59370.2, bsz=2049.4, num_updates=231100, lr=0.000208018, gnorm=1.325, loss_scale=8192, train_wall=233, wall=0
2023-03-03 10:58:46 | INFO | train_inner | epoch 117:   1795 / 1978 loss=2.977, nll_loss=0.826, word_ins=2.656, length=3.205, ppl=7.87, wps=25293.2, ups=0.43, wpb=58757.9, bsz=1935.6, num_updates=231200, lr=0.000207973, gnorm=1.363, loss_scale=8192, train_wall=232, wall=0
2023-03-03 11:02:40 | INFO | train_inner | epoch 117:   1895 / 1978 loss=2.952, nll_loss=0.811, word_ins=2.642, length=3.094, ppl=7.74, wps=25490.6, ups=0.43, wpb=59655, bsz=2000.5, num_updates=231300, lr=0.000207928, gnorm=1.368, loss_scale=8192, train_wall=234, wall=0
2023-03-03 11:05:55 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 11:06:11 | INFO | valid | epoch 117 | valid on 'valid' subset | loss 4.046 | nll_loss 1.915 | word_ins 3.678 | length 3.688 | ppl 16.52 | wps 30166.5 | wpb 40242.5 | bsz 1500 | num_updates 231383 | best_loss 4.034
2023-03-03 11:06:11 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 11:06:17 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint117.pt (epoch 117 @ 231383 updates, score 4.046) (writing took 5.420566379092634 seconds)
2023-03-03 11:06:17 | INFO | fairseq_cli.train | end of epoch 117 (average epoch stats below)
2023-03-03 11:06:17 | INFO | train | epoch 117 | loss 2.951 | nll_loss 0.81 | word_ins 2.641 | length 3.099 | ppl 7.73 | wps 25208.1 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 231383 | lr 0.00020789 | gnorm 1.366 | loss_scale 8192 | train_wall 4615 | wall 0
2023-03-03 11:06:17 | INFO | fairseq.trainer | begin training epoch 118
2023-03-03 11:07:05 | INFO | train_inner | epoch 118:     17 / 1978 loss=2.933, nll_loss=0.795, word_ins=2.627, length=3.065, ppl=7.64, wps=22495, ups=0.38, wpb=59631.3, bsz=2033.6, num_updates=231400, lr=0.000207883, gnorm=1.356, loss_scale=8192, train_wall=233, wall=0
2023-03-03 11:11:00 | INFO | train_inner | epoch 118:    117 / 1978 loss=2.944, nll_loss=0.804, word_ins=2.637, length=3.071, ppl=7.69, wps=25124.4, ups=0.43, wpb=59022, bsz=2028.4, num_updates=231500, lr=0.000207838, gnorm=1.38, loss_scale=8192, train_wall=235, wall=0
2023-03-03 11:14:53 | INFO | train_inner | epoch 118:    217 / 1978 loss=2.984, nll_loss=0.838, word_ins=2.668, length=3.16, ppl=7.91, wps=25389.7, ups=0.43, wpb=59082.4, bsz=1838.6, num_updates=231600, lr=0.000207793, gnorm=1.404, loss_scale=8192, train_wall=232, wall=0
2023-03-03 11:18:47 | INFO | train_inner | epoch 118:    317 / 1978 loss=2.956, nll_loss=0.811, word_ins=2.642, length=3.134, ppl=7.76, wps=25391.4, ups=0.43, wpb=59339.5, bsz=1949.8, num_updates=231700, lr=0.000207748, gnorm=1.419, loss_scale=8192, train_wall=233, wall=0
2023-03-03 11:22:42 | INFO | train_inner | epoch 118:    417 / 1978 loss=2.916, nll_loss=0.78, word_ins=2.614, length=3.015, ppl=7.55, wps=25360, ups=0.42, wpb=59788, bsz=2137.6, num_updates=231800, lr=0.000207703, gnorm=1.293, loss_scale=8192, train_wall=236, wall=0
2023-03-03 11:25:12 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 11:26:39 | INFO | train_inner | epoch 118:    518 / 1978 loss=2.956, nll_loss=0.814, word_ins=2.645, length=3.107, ppl=7.76, wps=25236.8, ups=0.42, wpb=59626.4, bsz=1955.9, num_updates=231900, lr=0.000207658, gnorm=1.342, loss_scale=8192, train_wall=236, wall=0
2023-03-03 11:30:32 | INFO | train_inner | epoch 118:    618 / 1978 loss=2.944, nll_loss=0.804, word_ins=2.635, length=3.089, ppl=7.69, wps=25224.9, ups=0.43, wpb=58963.2, bsz=2037.1, num_updates=232000, lr=0.000207614, gnorm=1.276, loss_scale=8192, train_wall=234, wall=0
2023-03-03 11:34:25 | INFO | train_inner | epoch 118:    718 / 1978 loss=2.958, nll_loss=0.818, word_ins=2.649, length=3.088, ppl=7.77, wps=25329.8, ups=0.43, wpb=58930.1, bsz=1936.6, num_updates=232100, lr=0.000207569, gnorm=1.355, loss_scale=8192, train_wall=232, wall=0
2023-03-03 11:38:19 | INFO | train_inner | epoch 118:    818 / 1978 loss=2.947, nll_loss=0.811, word_ins=2.643, length=3.044, ppl=7.71, wps=25394.4, ups=0.43, wpb=59363.1, bsz=2008.3, num_updates=232200, lr=0.000207524, gnorm=1.358, loss_scale=8192, train_wall=234, wall=0
2023-03-03 11:42:12 | INFO | train_inner | epoch 118:    918 / 1978 loss=2.967, nll_loss=0.827, word_ins=2.657, length=3.109, ppl=7.82, wps=25504.1, ups=0.43, wpb=59543.2, bsz=1957.4, num_updates=232300, lr=0.00020748, gnorm=1.373, loss_scale=8192, train_wall=233, wall=0
2023-03-03 11:46:07 | INFO | train_inner | epoch 118:   1018 / 1978 loss=2.928, nll_loss=0.789, word_ins=2.622, length=3.065, ppl=7.61, wps=25358.1, ups=0.43, wpb=59454, bsz=2095.8, num_updates=232400, lr=0.000207435, gnorm=1.351, loss_scale=8192, train_wall=234, wall=0
2023-03-03 11:50:02 | INFO | train_inner | epoch 118:   1118 / 1978 loss=2.94, nll_loss=0.803, word_ins=2.635, length=3.048, ppl=7.67, wps=25264.4, ups=0.43, wpb=59348.6, bsz=2029.7, num_updates=232500, lr=0.00020739, gnorm=1.354, loss_scale=8192, train_wall=235, wall=0
2023-03-03 11:53:55 | INFO | train_inner | epoch 118:   1218 / 1978 loss=2.955, nll_loss=0.813, word_ins=2.643, length=3.119, ppl=7.76, wps=25282.4, ups=0.43, wpb=58951.2, bsz=1921.5, num_updates=232600, lr=0.000207346, gnorm=1.373, loss_scale=8192, train_wall=233, wall=0
2023-03-03 11:57:49 | INFO | train_inner | epoch 118:   1318 / 1978 loss=2.952, nll_loss=0.807, word_ins=2.638, length=3.137, ppl=7.74, wps=25539.1, ups=0.43, wpb=59881.6, bsz=2016, num_updates=232700, lr=0.000207301, gnorm=1.404, loss_scale=8192, train_wall=234, wall=0
2023-03-03 12:01:44 | INFO | train_inner | epoch 118:   1418 / 1978 loss=2.945, nll_loss=0.806, word_ins=2.637, length=3.081, ppl=7.7, wps=25326.6, ups=0.43, wpb=59514.5, bsz=2040.9, num_updates=232800, lr=0.000207257, gnorm=1.368, loss_scale=8192, train_wall=235, wall=0
2023-03-03 12:05:39 | INFO | train_inner | epoch 118:   1518 / 1978 loss=2.941, nll_loss=0.806, word_ins=2.638, length=3.033, ppl=7.68, wps=25401.5, ups=0.43, wpb=59586.7, bsz=2059.4, num_updates=232900, lr=0.000207212, gnorm=1.29, loss_scale=8192, train_wall=234, wall=0
2023-03-03 12:09:31 | INFO | train_inner | epoch 118:   1618 / 1978 loss=2.974, nll_loss=0.825, word_ins=2.654, length=3.201, ppl=7.86, wps=25463.7, ups=0.43, wpb=59054.2, bsz=1916.6, num_updates=233000, lr=0.000207168, gnorm=1.372, loss_scale=8192, train_wall=232, wall=0
2023-03-03 12:13:25 | INFO | train_inner | epoch 118:   1718 / 1978 loss=2.956, nll_loss=0.812, word_ins=2.643, length=3.128, ppl=7.76, wps=25474.5, ups=0.43, wpb=59640.3, bsz=2007.7, num_updates=233100, lr=0.000207123, gnorm=1.381, loss_scale=8192, train_wall=234, wall=0
2023-03-03 12:17:20 | INFO | train_inner | epoch 118:   1818 / 1978 loss=2.935, nll_loss=0.798, word_ins=2.63, length=3.044, ppl=7.65, wps=25249.1, ups=0.43, wpb=59317.7, bsz=2103.1, num_updates=233200, lr=0.000207079, gnorm=1.342, loss_scale=8192, train_wall=235, wall=0
2023-03-03 12:21:13 | INFO | train_inner | epoch 118:   1918 / 1978 loss=2.938, nll_loss=0.799, word_ins=2.631, length=3.071, ppl=7.67, wps=25179.5, ups=0.43, wpb=58705.9, bsz=2006.2, num_updates=233300, lr=0.000207034, gnorm=1.308, loss_scale=8192, train_wall=233, wall=0
2023-03-03 12:23:33 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 12:23:49 | INFO | valid | epoch 118 | valid on 'valid' subset | loss 4.08 | nll_loss 1.915 | word_ins 3.68 | length 3.999 | ppl 16.91 | wps 29548.3 | wpb 40242.5 | bsz 1500 | num_updates 233360 | best_loss 4.034
2023-03-03 12:23:49 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 12:23:54 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint118.pt (epoch 118 @ 233360 updates, score 4.08) (writing took 5.61234269477427 seconds)
2023-03-03 12:23:54 | INFO | fairseq_cli.train | end of epoch 118 (average epoch stats below)
2023-03-03 12:23:54 | INFO | train | epoch 118 | loss 2.95 | nll_loss 0.809 | word_ins 2.641 | length 3.094 | ppl 7.73 | wps 25165.2 | ups 0.42 | wpb 59283.6 | bsz 2002.5 | num_updates 233360 | lr 0.000207008 | gnorm 1.357 | loss_scale 8192 | train_wall 4621 | wall 0
2023-03-03 12:23:54 | INFO | fairseq.trainer | begin training epoch 119
2023-03-03 12:25:36 | INFO | train_inner | epoch 119:     40 / 1978 loss=2.958, nll_loss=0.818, word_ins=2.648, length=3.098, ppl=7.77, wps=22288.9, ups=0.38, wpb=58634.3, bsz=2021.4, num_updates=233400, lr=0.00020699, gnorm=1.347, loss_scale=8192, train_wall=232, wall=0
2023-03-03 12:29:29 | INFO | train_inner | epoch 119:    140 / 1978 loss=2.944, nll_loss=0.803, word_ins=2.635, length=3.089, ppl=7.7, wps=25439.6, ups=0.43, wpb=59369.3, bsz=1960.8, num_updates=233500, lr=0.000206946, gnorm=1.351, loss_scale=8192, train_wall=233, wall=0
2023-03-03 12:33:23 | INFO | train_inner | epoch 119:    240 / 1978 loss=2.941, nll_loss=0.799, word_ins=2.631, length=3.105, ppl=7.68, wps=25363.8, ups=0.43, wpb=59316.5, bsz=1980.9, num_updates=233600, lr=0.000206901, gnorm=1.392, loss_scale=8192, train_wall=234, wall=0
2023-03-03 12:37:17 | INFO | train_inner | epoch 119:    340 / 1978 loss=2.936, nll_loss=0.796, word_ins=2.628, length=3.083, ppl=7.65, wps=25425.7, ups=0.43, wpb=59519.7, bsz=2056.3, num_updates=233700, lr=0.000206857, gnorm=1.363, loss_scale=8192, train_wall=234, wall=0
2023-03-03 12:41:11 | INFO | train_inner | epoch 119:    440 / 1978 loss=2.953, nll_loss=0.812, word_ins=2.643, length=3.098, ppl=7.74, wps=25320.6, ups=0.43, wpb=59118.2, bsz=2025.4, num_updates=233800, lr=0.000206813, gnorm=1.392, loss_scale=8192, train_wall=233, wall=0
2023-03-03 12:45:04 | INFO | train_inner | epoch 119:    540 / 1978 loss=2.955, nll_loss=0.809, word_ins=2.641, length=3.141, ppl=7.75, wps=25361.2, ups=0.43, wpb=59050.3, bsz=1911.3, num_updates=233900, lr=0.000206769, gnorm=1.372, loss_scale=8192, train_wall=233, wall=0
2023-03-03 12:48:58 | INFO | train_inner | epoch 119:    640 / 1978 loss=2.957, nll_loss=0.818, word_ins=2.648, length=3.084, ppl=7.76, wps=25177.5, ups=0.43, wpb=59031.6, bsz=2036.4, num_updates=234000, lr=0.000206725, gnorm=1.373, loss_scale=8192, train_wall=234, wall=0
2023-03-03 12:52:51 | INFO | train_inner | epoch 119:    740 / 1978 loss=2.948, nll_loss=0.804, word_ins=2.636, length=3.123, ppl=7.72, wps=25516, ups=0.43, wpb=59428.3, bsz=1955.4, num_updates=234100, lr=0.00020668, gnorm=1.391, loss_scale=8192, train_wall=233, wall=0
2023-03-03 12:56:45 | INFO | train_inner | epoch 119:    840 / 1978 loss=2.938, nll_loss=0.802, word_ins=2.634, length=3.04, ppl=7.66, wps=25396.9, ups=0.43, wpb=59407.3, bsz=1977.5, num_updates=234200, lr=0.000206636, gnorm=1.359, loss_scale=8192, train_wall=234, wall=0
2023-03-03 13:00:39 | INFO | train_inner | epoch 119:    940 / 1978 loss=2.926, nll_loss=0.789, word_ins=2.622, length=3.044, ppl=7.6, wps=25479.3, ups=0.43, wpb=59495.9, bsz=2079.2, num_updates=234300, lr=0.000206592, gnorm=1.332, loss_scale=8192, train_wall=233, wall=0
2023-03-03 13:04:32 | INFO | train_inner | epoch 119:   1040 / 1978 loss=2.954, nll_loss=0.816, word_ins=2.647, length=3.076, ppl=7.75, wps=25297.7, ups=0.43, wpb=59128.1, bsz=1986.7, num_updates=234400, lr=0.000206548, gnorm=1.283, loss_scale=8192, train_wall=233, wall=0
2023-03-03 13:08:27 | INFO | train_inner | epoch 119:   1140 / 1978 loss=2.949, nll_loss=0.811, word_ins=2.643, length=3.065, ppl=7.72, wps=25204.6, ups=0.43, wpb=59137.8, bsz=2021.1, num_updates=234500, lr=0.000206504, gnorm=1.369, loss_scale=8192, train_wall=234, wall=0
2023-03-03 13:12:20 | INFO | train_inner | epoch 119:   1240 / 1978 loss=2.945, nll_loss=0.806, word_ins=2.637, length=3.082, ppl=7.7, wps=25535.5, ups=0.43, wpb=59574.5, bsz=2051.7, num_updates=234600, lr=0.00020646, gnorm=1.352, loss_scale=8192, train_wall=233, wall=0
2023-03-03 13:16:13 | INFO | train_inner | epoch 119:   1340 / 1978 loss=2.961, nll_loss=0.815, word_ins=2.646, length=3.152, ppl=7.79, wps=25351.5, ups=0.43, wpb=59004.1, bsz=1983.2, num_updates=234700, lr=0.000206416, gnorm=1.345, loss_scale=8192, train_wall=233, wall=0
2023-03-03 13:20:06 | INFO | train_inner | epoch 119:   1440 / 1978 loss=2.937, nll_loss=0.804, word_ins=2.635, length=3.02, ppl=7.66, wps=25701.4, ups=0.43, wpb=59822.2, bsz=2048.7, num_updates=234800, lr=0.000206372, gnorm=1.38, loss_scale=8192, train_wall=233, wall=0
2023-03-03 13:24:02 | INFO | train_inner | epoch 119:   1540 / 1978 loss=2.947, nll_loss=0.802, word_ins=2.634, length=3.138, ppl=7.71, wps=25060.1, ups=0.42, wpb=59177.4, bsz=2027.7, num_updates=234900, lr=0.000206328, gnorm=1.362, loss_scale=8192, train_wall=236, wall=0
2023-03-03 13:27:57 | INFO | train_inner | epoch 119:   1640 / 1978 loss=2.958, nll_loss=0.816, word_ins=2.646, length=3.119, ppl=7.77, wps=25312.7, ups=0.43, wpb=59465.9, bsz=2015.1, num_updates=235000, lr=0.000206284, gnorm=1.398, loss_scale=8192, train_wall=235, wall=0
2023-03-03 13:31:51 | INFO | train_inner | epoch 119:   1740 / 1978 loss=2.967, nll_loss=0.828, word_ins=2.657, length=3.095, ppl=7.82, wps=25247.1, ups=0.43, wpb=59103.6, bsz=2025.5, num_updates=235100, lr=0.00020624, gnorm=1.377, loss_scale=8192, train_wall=234, wall=0
2023-03-03 13:35:45 | INFO | train_inner | epoch 119:   1840 / 1978 loss=2.958, nll_loss=0.816, word_ins=2.646, length=3.115, ppl=7.77, wps=25524.7, ups=0.43, wpb=59783.4, bsz=1950.6, num_updates=235200, lr=0.000206197, gnorm=1.426, loss_scale=8192, train_wall=234, wall=0
2023-03-03 13:39:40 | INFO | train_inner | epoch 119:   1940 / 1978 loss=2.964, nll_loss=0.822, word_ins=2.653, length=3.11, ppl=7.8, wps=25167.7, ups=0.43, wpb=58975.7, bsz=1983, num_updates=235300, lr=0.000206153, gnorm=1.366, loss_scale=8192, train_wall=234, wall=0
2023-03-03 13:41:08 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 13:41:24 | INFO | valid | epoch 119 | valid on 'valid' subset | loss 4.101 | nll_loss 1.913 | word_ins 3.68 | length 4.204 | ppl 17.15 | wps 30131.2 | wpb 40242.5 | bsz 1500 | num_updates 235338 | best_loss 4.034
2023-03-03 13:41:24 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 13:41:30 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint119.pt (epoch 119 @ 235338 updates, score 4.101) (writing took 5.689481223933399 seconds)
2023-03-03 13:41:30 | INFO | fairseq_cli.train | end of epoch 119 (average epoch stats below)
2023-03-03 13:41:30 | INFO | train | epoch 119 | loss 2.949 | nll_loss 0.809 | word_ins 2.64 | length 3.093 | ppl 7.72 | wps 25188.4 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 235338 | lr 0.000206136 | gnorm 1.365 | loss_scale 8192 | train_wall 4620 | wall 0
2023-03-03 13:41:30 | INFO | fairseq.trainer | begin training epoch 120
2023-03-03 13:44:03 | INFO | train_inner | epoch 120:     62 / 1978 loss=2.966, nll_loss=0.825, word_ins=2.655, length=3.113, ppl=7.81, wps=22358.1, ups=0.38, wpb=58933, bsz=1884.3, num_updates=235400, lr=0.000206109, gnorm=1.35, loss_scale=8192, train_wall=232, wall=0
2023-03-03 13:47:58 | INFO | train_inner | epoch 120:    162 / 1978 loss=2.915, nll_loss=0.781, word_ins=2.615, length=3.005, ppl=7.54, wps=25434.6, ups=0.43, wpb=59711.7, bsz=2099.9, num_updates=235500, lr=0.000206065, gnorm=1.356, loss_scale=8192, train_wall=235, wall=0
2023-03-03 13:51:52 | INFO | train_inner | epoch 120:    262 / 1978 loss=2.926, nll_loss=0.792, word_ins=2.624, length=3.011, ppl=7.6, wps=25371.2, ups=0.43, wpb=59384.7, bsz=2030.9, num_updates=235600, lr=0.000206021, gnorm=1.371, loss_scale=8192, train_wall=234, wall=0
2023-03-03 13:55:45 | INFO | train_inner | epoch 120:    362 / 1978 loss=2.934, nll_loss=0.795, word_ins=2.628, length=3.064, ppl=7.64, wps=25615.9, ups=0.43, wpb=59741.7, bsz=2018.7, num_updates=235700, lr=0.000205978, gnorm=1.307, loss_scale=8192, train_wall=233, wall=0
2023-03-03 13:59:37 | INFO | train_inner | epoch 120:    462 / 1978 loss=2.977, nll_loss=0.833, word_ins=2.662, length=3.146, ppl=7.87, wps=25306.6, ups=0.43, wpb=58762.4, bsz=1954.1, num_updates=235800, lr=0.000205934, gnorm=1.334, loss_scale=8192, train_wall=232, wall=0
2023-03-03 14:03:32 | INFO | train_inner | epoch 120:    562 / 1978 loss=2.95, nll_loss=0.805, word_ins=2.637, length=3.126, ppl=7.73, wps=25163.4, ups=0.43, wpb=58991.4, bsz=2006.2, num_updates=235900, lr=0.00020589, gnorm=1.372, loss_scale=8192, train_wall=234, wall=0
2023-03-03 14:05:54 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 14:07:29 | INFO | train_inner | epoch 120:    663 / 1978 loss=2.946, nll_loss=0.805, word_ins=2.637, length=3.087, ppl=7.7, wps=25204.5, ups=0.42, wpb=59658, bsz=1986.1, num_updates=236000, lr=0.000205847, gnorm=1.406, loss_scale=8192, train_wall=236, wall=0
2023-03-03 14:11:24 | INFO | train_inner | epoch 120:    763 / 1978 loss=2.926, nll_loss=0.786, word_ins=2.619, length=3.073, ppl=7.6, wps=25212.3, ups=0.42, wpb=59344.4, bsz=2075, num_updates=236100, lr=0.000205803, gnorm=1.37, loss_scale=8192, train_wall=235, wall=0
2023-03-03 14:15:17 | INFO | train_inner | epoch 120:    863 / 1978 loss=2.95, nll_loss=0.809, word_ins=2.64, length=3.105, ppl=7.73, wps=25435.2, ups=0.43, wpb=59194, bsz=1980.9, num_updates=236200, lr=0.00020576, gnorm=1.359, loss_scale=8192, train_wall=232, wall=0
2023-03-03 14:19:08 | INFO | train_inner | epoch 120:    963 / 1978 loss=2.981, nll_loss=0.834, word_ins=2.663, length=3.174, ppl=7.89, wps=25339.2, ups=0.43, wpb=58697.5, bsz=1904.8, num_updates=236300, lr=0.000205716, gnorm=1.375, loss_scale=8192, train_wall=231, wall=0
2023-03-03 14:23:02 | INFO | train_inner | epoch 120:   1063 / 1978 loss=2.958, nll_loss=0.822, word_ins=2.652, length=3.064, ppl=7.77, wps=25243.5, ups=0.43, wpb=59018.2, bsz=1965.2, num_updates=236400, lr=0.000205673, gnorm=1.395, loss_scale=8192, train_wall=234, wall=0
2023-03-03 14:27:01 | INFO | train_inner | epoch 120:   1163 / 1978 loss=2.939, nll_loss=0.799, word_ins=2.631, length=3.078, ppl=7.67, wps=24724.2, ups=0.42, wpb=59008.7, bsz=2020.2, num_updates=236500, lr=0.000205629, gnorm=1.356, loss_scale=8192, train_wall=238, wall=0
2023-03-03 14:31:01 | INFO | train_inner | epoch 120:   1263 / 1978 loss=2.953, nll_loss=0.811, word_ins=2.643, length=3.105, ppl=7.74, wps=24767.9, ups=0.42, wpb=59401.4, bsz=1999.5, num_updates=236600, lr=0.000205586, gnorm=1.337, loss_scale=8192, train_wall=240, wall=0
2023-03-03 14:34:54 | INFO | train_inner | epoch 120:   1363 / 1978 loss=2.963, nll_loss=0.819, word_ins=2.65, length=3.133, ppl=7.8, wps=25066.2, ups=0.43, wpb=58477.3, bsz=1918.3, num_updates=236700, lr=0.000205542, gnorm=1.377, loss_scale=8192, train_wall=233, wall=0
2023-03-03 14:38:48 | INFO | train_inner | epoch 120:   1463 / 1978 loss=2.946, nll_loss=0.802, word_ins=2.634, length=3.122, ppl=7.71, wps=25554, ups=0.43, wpb=59750.7, bsz=1987.5, num_updates=236800, lr=0.000205499, gnorm=1.41, loss_scale=8192, train_wall=234, wall=0
2023-03-03 14:42:41 | INFO | train_inner | epoch 120:   1563 / 1978 loss=2.936, nll_loss=0.797, word_ins=2.629, length=3.064, ppl=7.65, wps=25555.8, ups=0.43, wpb=59507.4, bsz=2036.5, num_updates=236900, lr=0.000205455, gnorm=1.342, loss_scale=8192, train_wall=233, wall=0
2023-03-03 14:46:34 | INFO | train_inner | epoch 120:   1663 / 1978 loss=2.978, nll_loss=0.834, word_ins=2.663, length=3.149, ppl=7.88, wps=25266.2, ups=0.43, wpb=58885.5, bsz=1931.4, num_updates=237000, lr=0.000205412, gnorm=1.361, loss_scale=8192, train_wall=233, wall=0
2023-03-03 14:50:28 | INFO | train_inner | epoch 120:   1763 / 1978 loss=2.94, nll_loss=0.796, word_ins=2.628, length=3.126, ppl=7.68, wps=25570.3, ups=0.43, wpb=59957.8, bsz=2049, num_updates=237100, lr=0.000205369, gnorm=1.342, loss_scale=8192, train_wall=234, wall=0
2023-03-03 14:54:23 | INFO | train_inner | epoch 120:   1863 / 1978 loss=2.923, nll_loss=0.789, word_ins=2.621, length=3.021, ppl=7.59, wps=25383.1, ups=0.43, wpb=59699.6, bsz=2136.9, num_updates=237200, lr=0.000205325, gnorm=1.324, loss_scale=8192, train_wall=235, wall=0
2023-03-03 14:58:18 | INFO | train_inner | epoch 120:   1963 / 1978 loss=2.941, nll_loss=0.805, word_ins=2.637, length=3.047, ppl=7.68, wps=25396.4, ups=0.43, wpb=59483.3, bsz=2043.8, num_updates=237300, lr=0.000205282, gnorm=1.358, loss_scale=8192, train_wall=234, wall=0
2023-03-03 14:58:53 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 14:59:09 | INFO | valid | epoch 120 | valid on 'valid' subset | loss 4.094 | nll_loss 1.908 | word_ins 3.673 | length 4.218 | ppl 17.08 | wps 30612.4 | wpb 40242.5 | bsz 1500 | num_updates 237315 | best_loss 4.034
2023-03-03 14:59:09 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 14:59:14 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint120.pt (epoch 120 @ 237315 updates, score 4.094) (writing took 5.614077793434262 seconds)
2023-03-03 14:59:14 | INFO | fairseq_cli.train | end of epoch 120 (average epoch stats below)
2023-03-03 14:59:14 | INFO | train | epoch 120 | loss 2.947 | nll_loss 0.807 | word_ins 2.638 | length 3.09 | ppl 7.71 | wps 25128.1 | ups 0.42 | wpb 59284.5 | bsz 2003.1 | num_updates 237315 | lr 0.000205276 | gnorm 1.36 | loss_scale 8192 | train_wall 4628 | wall 0
2023-03-03 14:59:14 | INFO | fairseq.trainer | begin training epoch 121
2023-03-03 15:02:41 | INFO | train_inner | epoch 121:     85 / 1978 loss=2.963, nll_loss=0.82, word_ins=2.651, length=3.12, ppl=7.8, wps=22287.3, ups=0.38, wpb=58750.1, bsz=1920.8, num_updates=237400, lr=0.000205239, gnorm=1.368, loss_scale=8192, train_wall=232, wall=0
2023-03-03 15:06:36 | INFO | train_inner | epoch 121:    185 / 1978 loss=2.926, nll_loss=0.791, word_ins=2.624, length=3.026, ppl=7.6, wps=25406.3, ups=0.43, wpb=59591.8, bsz=2038, num_updates=237500, lr=0.000205196, gnorm=1.353, loss_scale=8192, train_wall=234, wall=0
2023-03-03 15:10:29 | INFO | train_inner | epoch 121:    285 / 1978 loss=2.963, nll_loss=0.817, word_ins=2.647, length=3.154, ppl=7.8, wps=25383.3, ups=0.43, wpb=59331.2, bsz=1979.8, num_updates=237600, lr=0.000205152, gnorm=1.399, loss_scale=8192, train_wall=234, wall=0
2023-03-03 15:14:22 | INFO | train_inner | epoch 121:    385 / 1978 loss=2.951, nll_loss=0.805, word_ins=2.636, length=3.143, ppl=7.73, wps=25365.1, ups=0.43, wpb=58957.9, bsz=1952.9, num_updates=237700, lr=0.000205109, gnorm=1.401, loss_scale=8192, train_wall=232, wall=0
2023-03-03 15:18:15 | INFO | train_inner | epoch 121:    485 / 1978 loss=2.947, nll_loss=0.805, word_ins=2.637, length=3.104, ppl=7.71, wps=25282.6, ups=0.43, wpb=58832.7, bsz=1951.3, num_updates=237800, lr=0.000205066, gnorm=1.365, loss_scale=8192, train_wall=232, wall=0
2023-03-03 15:22:08 | INFO | train_inner | epoch 121:    585 / 1978 loss=2.922, nll_loss=0.787, word_ins=2.62, length=3.019, ppl=7.58, wps=25597, ups=0.43, wpb=59661.9, bsz=2095.8, num_updates=237900, lr=0.000205023, gnorm=1.28, loss_scale=8192, train_wall=233, wall=0
2023-03-03 15:26:02 | INFO | train_inner | epoch 121:    685 / 1978 loss=2.95, nll_loss=0.807, word_ins=2.638, length=3.116, ppl=7.73, wps=25425.5, ups=0.43, wpb=59451.8, bsz=1933.2, num_updates=238000, lr=0.00020498, gnorm=1.375, loss_scale=8192, train_wall=234, wall=0
2023-03-03 15:29:54 | INFO | train_inner | epoch 121:    785 / 1978 loss=2.943, nll_loss=0.803, word_ins=2.635, length=3.084, ppl=7.69, wps=25357.7, ups=0.43, wpb=58963.6, bsz=2005.3, num_updates=238100, lr=0.000204937, gnorm=1.359, loss_scale=8192, train_wall=232, wall=0
2023-03-03 15:33:47 | INFO | train_inner | epoch 121:    885 / 1978 loss=2.944, nll_loss=0.808, word_ins=2.639, length=3.05, ppl=7.69, wps=25661.6, ups=0.43, wpb=59740.3, bsz=2018.6, num_updates=238200, lr=0.000204894, gnorm=1.354, loss_scale=8192, train_wall=233, wall=0
2023-03-03 15:37:40 | INFO | train_inner | epoch 121:    985 / 1978 loss=2.97, nll_loss=0.828, word_ins=2.658, length=3.119, ppl=7.83, wps=25239.8, ups=0.43, wpb=58758.4, bsz=1886, num_updates=238300, lr=0.000204851, gnorm=1.377, loss_scale=8192, train_wall=233, wall=0
2023-03-03 15:41:34 | INFO | train_inner | epoch 121:   1085 / 1978 loss=2.947, nll_loss=0.806, word_ins=2.637, length=3.102, ppl=7.71, wps=25274.1, ups=0.43, wpb=59228.9, bsz=2008.6, num_updates=238400, lr=0.000204808, gnorm=1.372, loss_scale=8192, train_wall=234, wall=0
2023-03-03 15:45:29 | INFO | train_inner | epoch 121:   1185 / 1978 loss=2.957, nll_loss=0.814, word_ins=2.645, length=3.121, ppl=7.76, wps=25279.9, ups=0.43, wpb=59300.6, bsz=2038.6, num_updates=238500, lr=0.000204765, gnorm=1.378, loss_scale=8192, train_wall=234, wall=0
2023-03-03 15:49:21 | INFO | train_inner | epoch 121:   1285 / 1978 loss=2.949, nll_loss=0.811, word_ins=2.642, length=3.069, ppl=7.72, wps=25321.7, ups=0.43, wpb=58936.5, bsz=1981.8, num_updates=238600, lr=0.000204722, gnorm=1.364, loss_scale=8192, train_wall=233, wall=0
2023-03-03 15:53:17 | INFO | train_inner | epoch 121:   1385 / 1978 loss=2.928, nll_loss=0.794, word_ins=2.626, length=3.017, ppl=7.61, wps=25160.1, ups=0.43, wpb=59189, bsz=2102.8, num_updates=238700, lr=0.000204679, gnorm=1.357, loss_scale=8192, train_wall=235, wall=0
2023-03-03 15:57:11 | INFO | train_inner | epoch 121:   1485 / 1978 loss=2.964, nll_loss=0.818, word_ins=2.648, length=3.154, ppl=7.8, wps=25464.2, ups=0.43, wpb=59596.4, bsz=1950.2, num_updates=238800, lr=0.000204636, gnorm=1.354, loss_scale=8192, train_wall=234, wall=0
2023-03-03 16:01:06 | INFO | train_inner | epoch 121:   1585 / 1978 loss=2.918, nll_loss=0.784, word_ins=2.616, length=3.014, ppl=7.56, wps=25360.6, ups=0.42, wpb=59793.7, bsz=2106.6, num_updates=238900, lr=0.000204594, gnorm=1.324, loss_scale=8192, train_wall=236, wall=0
2023-03-03 16:05:02 | INFO | train_inner | epoch 121:   1685 / 1978 loss=2.925, nll_loss=0.791, word_ins=2.623, length=3.016, ppl=7.59, wps=25409.7, ups=0.43, wpb=59741.5, bsz=2097, num_updates=239000, lr=0.000204551, gnorm=1.369, loss_scale=8192, train_wall=235, wall=0
2023-03-03 16:08:55 | INFO | train_inner | epoch 121:   1785 / 1978 loss=2.941, nll_loss=0.8, word_ins=2.631, length=3.093, ppl=7.68, wps=25451.3, ups=0.43, wpb=59488.8, bsz=2015.5, num_updates=239100, lr=0.000204508, gnorm=1.367, loss_scale=8192, train_wall=233, wall=0
2023-03-03 16:12:49 | INFO | train_inner | epoch 121:   1885 / 1978 loss=2.957, nll_loss=0.815, word_ins=2.645, length=3.123, ppl=7.77, wps=25289.6, ups=0.43, wpb=59076.7, bsz=2004.5, num_updates=239200, lr=0.000204465, gnorm=1.332, loss_scale=8192, train_wall=233, wall=0
2023-03-03 16:16:26 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 16:16:40 | INFO | valid | epoch 121 | valid on 'valid' subset | loss 4.109 | nll_loss 1.908 | word_ins 3.675 | length 4.342 | ppl 17.26 | wps 30776.9 | wpb 40242.5 | bsz 1500 | num_updates 239293 | best_loss 4.034
2023-03-03 16:16:40 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 16:16:47 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint121.pt (epoch 121 @ 239293 updates, score 4.109) (writing took 7.147353598847985 seconds)
2023-03-03 16:16:47 | INFO | fairseq_cli.train | end of epoch 121 (average epoch stats below)
2023-03-03 16:16:48 | INFO | train | epoch 121 | loss 2.946 | nll_loss 0.806 | word_ins 2.637 | length 3.088 | ppl 7.71 | wps 25199.8 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 239293 | lr 0.000204425 | gnorm 1.361 | loss_scale 8192 | train_wall 4617 | wall 0
2023-03-03 16:16:48 | INFO | fairseq.trainer | begin training epoch 122
2023-03-03 16:17:13 | INFO | train_inner | epoch 122:      7 / 1978 loss=2.953, nll_loss=0.811, word_ins=2.642, length=3.11, ppl=7.74, wps=22415.3, ups=0.38, wpb=59127.1, bsz=1965.4, num_updates=239300, lr=0.000204422, gnorm=1.362, loss_scale=8192, train_wall=232, wall=0
2023-03-03 16:21:05 | INFO | train_inner | epoch 122:    107 / 1978 loss=2.95, nll_loss=0.803, word_ins=2.635, length=3.15, ppl=7.73, wps=25218.2, ups=0.43, wpb=58701.7, bsz=1906.2, num_updates=239400, lr=0.00020438, gnorm=1.375, loss_scale=8192, train_wall=233, wall=0
2023-03-03 16:25:00 | INFO | train_inner | epoch 122:    207 / 1978 loss=2.924, nll_loss=0.792, word_ins=2.624, length=2.992, ppl=7.59, wps=25396.6, ups=0.43, wpb=59465.5, bsz=2067.6, num_updates=239500, lr=0.000204337, gnorm=1.317, loss_scale=8192, train_wall=234, wall=0
2023-03-03 16:28:53 | INFO | train_inner | epoch 122:    307 / 1978 loss=2.953, nll_loss=0.807, word_ins=2.639, length=3.141, ppl=7.74, wps=25364.3, ups=0.43, wpb=59077.2, bsz=1909.7, num_updates=239600, lr=0.000204294, gnorm=1.368, loss_scale=8192, train_wall=233, wall=0
2023-03-03 16:32:46 | INFO | train_inner | epoch 122:    407 / 1978 loss=2.931, nll_loss=0.797, word_ins=2.629, length=3.025, ppl=7.63, wps=25555.1, ups=0.43, wpb=59591.4, bsz=2014.5, num_updates=239700, lr=0.000204252, gnorm=1.356, loss_scale=8192, train_wall=233, wall=0
2023-03-03 16:36:40 | INFO | train_inner | epoch 122:    507 / 1978 loss=2.939, nll_loss=0.796, word_ins=2.628, length=3.108, ppl=7.67, wps=25402.1, ups=0.43, wpb=59537.7, bsz=2044.8, num_updates=239800, lr=0.000204209, gnorm=1.332, loss_scale=8192, train_wall=234, wall=0
2023-03-03 16:40:36 | INFO | train_inner | epoch 122:    607 / 1978 loss=2.925, nll_loss=0.794, word_ins=2.626, length=2.984, ppl=7.59, wps=25375.2, ups=0.42, wpb=59819.7, bsz=2119.4, num_updates=239900, lr=0.000204167, gnorm=1.359, loss_scale=8192, train_wall=235, wall=0
2023-03-03 16:44:30 | INFO | train_inner | epoch 122:    707 / 1978 loss=2.945, nll_loss=0.804, word_ins=2.636, length=3.089, ppl=7.7, wps=25123.7, ups=0.43, wpb=58707.5, bsz=2012, num_updates=240000, lr=0.000204124, gnorm=1.378, loss_scale=8192, train_wall=233, wall=0
2023-03-03 16:46:45 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 16:48:25 | INFO | train_inner | epoch 122:    808 / 1978 loss=2.961, nll_loss=0.817, word_ins=2.648, length=3.131, ppl=7.79, wps=25001, ups=0.42, wpb=58913.8, bsz=1950.5, num_updates=240100, lr=0.000204082, gnorm=1.347, loss_scale=8192, train_wall=235, wall=0
2023-03-03 16:52:19 | INFO | train_inner | epoch 122:    908 / 1978 loss=2.945, nll_loss=0.806, word_ins=2.637, length=3.075, ppl=7.7, wps=25390.2, ups=0.43, wpb=59476.6, bsz=2021, num_updates=240200, lr=0.000204039, gnorm=1.402, loss_scale=8192, train_wall=234, wall=0
2023-03-03 16:56:13 | INFO | train_inner | epoch 122:   1008 / 1978 loss=2.96, nll_loss=0.817, word_ins=2.648, length=3.12, ppl=7.78, wps=25507.1, ups=0.43, wpb=59506.3, bsz=1909.4, num_updates=240300, lr=0.000203997, gnorm=1.469, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:00:06 | INFO | train_inner | epoch 122:   1108 / 1978 loss=2.94, nll_loss=0.796, word_ins=2.629, length=3.11, ppl=7.67, wps=25558.5, ups=0.43, wpb=59530.2, bsz=1974.7, num_updates=240400, lr=0.000203954, gnorm=1.385, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:03:59 | INFO | train_inner | epoch 122:   1208 / 1978 loss=2.938, nll_loss=0.801, word_ins=2.633, length=3.055, ppl=7.66, wps=25327.3, ups=0.43, wpb=59073.5, bsz=2054.8, num_updates=240500, lr=0.000203912, gnorm=1.36, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:07:54 | INFO | train_inner | epoch 122:   1308 / 1978 loss=2.932, nll_loss=0.795, word_ins=2.627, length=3.047, ppl=7.63, wps=25521.6, ups=0.43, wpb=59902.8, bsz=2053.4, num_updates=240600, lr=0.000203869, gnorm=1.389, loss_scale=8192, train_wall=234, wall=0
2023-03-03 17:11:47 | INFO | train_inner | epoch 122:   1408 / 1978 loss=2.96, nll_loss=0.815, word_ins=2.646, length=3.147, ppl=7.78, wps=25277.2, ups=0.43, wpb=59117.8, bsz=1981.4, num_updates=240700, lr=0.000203827, gnorm=1.384, loss_scale=8192, train_wall=234, wall=0
2023-03-03 17:15:41 | INFO | train_inner | epoch 122:   1508 / 1978 loss=2.959, nll_loss=0.82, word_ins=2.65, length=3.086, ppl=7.78, wps=25304.1, ups=0.43, wpb=58978.2, bsz=1975.4, num_updates=240800, lr=0.000203785, gnorm=1.419, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:19:35 | INFO | train_inner | epoch 122:   1608 / 1978 loss=2.939, nll_loss=0.807, word_ins=2.638, length=3.014, ppl=7.67, wps=25229, ups=0.43, wpb=59255.3, bsz=2048.9, num_updates=240900, lr=0.000203742, gnorm=1.334, loss_scale=8192, train_wall=235, wall=0
2023-03-03 17:23:30 | INFO | train_inner | epoch 122:   1708 / 1978 loss=2.937, nll_loss=0.8, word_ins=2.631, length=3.055, ppl=7.66, wps=25496.3, ups=0.43, wpb=59741, bsz=2028.9, num_updates=241000, lr=0.0002037, gnorm=1.37, loss_scale=8192, train_wall=234, wall=0
2023-03-03 17:27:24 | INFO | train_inner | epoch 122:   1808 / 1978 loss=2.952, nll_loss=0.808, word_ins=2.64, length=3.122, ppl=7.74, wps=25260.9, ups=0.43, wpb=59122.4, bsz=1995.3, num_updates=241100, lr=0.000203658, gnorm=1.335, loss_scale=8192, train_wall=234, wall=0
2023-03-03 17:31:16 | INFO | train_inner | epoch 122:   1908 / 1978 loss=2.955, nll_loss=0.81, word_ins=2.641, length=3.143, ppl=7.75, wps=25485.3, ups=0.43, wpb=59190.8, bsz=1969.1, num_updates=241200, lr=0.000203616, gnorm=1.348, loss_scale=8192, train_wall=232, wall=0
2023-03-03 17:33:59 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 17:34:14 | INFO | valid | epoch 122 | valid on 'valid' subset | loss 4.089 | nll_loss 1.914 | word_ins 3.68 | length 4.097 | ppl 17.02 | wps 29654 | wpb 40242.5 | bsz 1500 | num_updates 241270 | best_loss 4.034
2023-03-03 17:34:14 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 17:34:20 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint122.pt (epoch 122 @ 241270 updates, score 4.089) (writing took 5.667514913715422 seconds)
2023-03-03 17:34:20 | INFO | fairseq_cli.train | end of epoch 122 (average epoch stats below)
2023-03-03 17:34:20 | INFO | train | epoch 122 | loss 2.945 | nll_loss 0.805 | word_ins 2.636 | length 3.083 | ppl 7.7 | wps 25192.2 | ups 0.42 | wpb 59284.2 | bsz 2002.4 | num_updates 241270 | lr 0.000203586 | gnorm 1.37 | loss_scale 8192 | train_wall 4617 | wall 0
2023-03-03 17:34:20 | INFO | fairseq.trainer | begin training epoch 123
2023-03-03 17:35:39 | INFO | train_inner | epoch 123:     30 / 1978 loss=2.948, nll_loss=0.81, word_ins=2.641, length=3.069, ppl=7.72, wps=22400.4, ups=0.38, wpb=58864.8, bsz=1995.1, num_updates=241300, lr=0.000203574, gnorm=1.346, loss_scale=8192, train_wall=232, wall=0
2023-03-03 17:39:32 | INFO | train_inner | epoch 123:    130 / 1978 loss=2.943, nll_loss=0.8, word_ins=2.633, length=3.102, ppl=7.69, wps=25377.5, ups=0.43, wpb=59190.2, bsz=1973.7, num_updates=241400, lr=0.000203531, gnorm=1.373, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:43:26 | INFO | train_inner | epoch 123:    230 / 1978 loss=2.929, nll_loss=0.792, word_ins=2.624, length=3.046, ppl=7.61, wps=25502.6, ups=0.43, wpb=59539.7, bsz=2032.9, num_updates=241500, lr=0.000203489, gnorm=1.405, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:47:20 | INFO | train_inner | epoch 123:    330 / 1978 loss=2.932, nll_loss=0.795, word_ins=2.628, length=3.046, ppl=7.63, wps=25146.7, ups=0.43, wpb=59035.3, bsz=2048.9, num_updates=241600, lr=0.000203447, gnorm=1.334, loss_scale=8192, train_wall=235, wall=0
2023-03-03 17:51:14 | INFO | train_inner | epoch 123:    430 / 1978 loss=2.936, nll_loss=0.797, word_ins=2.629, length=3.069, ppl=7.65, wps=25514.6, ups=0.43, wpb=59610.5, bsz=1993, num_updates=241700, lr=0.000203405, gnorm=1.39, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:55:07 | INFO | train_inner | epoch 123:    530 / 1978 loss=2.953, nll_loss=0.815, word_ins=2.646, length=3.075, ppl=7.75, wps=25347, ups=0.43, wpb=59114.3, bsz=1885.9, num_updates=241800, lr=0.000203363, gnorm=1.333, loss_scale=8192, train_wall=233, wall=0
2023-03-03 17:59:00 | INFO | train_inner | epoch 123:    630 / 1978 loss=2.939, nll_loss=0.8, word_ins=2.632, length=3.073, ppl=7.67, wps=25170.2, ups=0.43, wpb=58719.4, bsz=2010.2, num_updates=241900, lr=0.000203321, gnorm=1.325, loss_scale=8192, train_wall=233, wall=0
2023-03-03 18:02:56 | INFO | train_inner | epoch 123:    730 / 1978 loss=2.922, nll_loss=0.786, word_ins=2.619, length=3.037, ppl=7.58, wps=25067, ups=0.42, wpb=59053.2, bsz=2093.5, num_updates=242000, lr=0.000203279, gnorm=1.315, loss_scale=8192, train_wall=235, wall=0
2023-03-03 18:06:52 | INFO | train_inner | epoch 123:    830 / 1978 loss=2.925, nll_loss=0.79, word_ins=2.623, length=3.018, ppl=7.59, wps=25190.5, ups=0.42, wpb=59367.1, bsz=2094.1, num_updates=242100, lr=0.000203237, gnorm=1.345, loss_scale=8192, train_wall=235, wall=0
2023-03-03 18:10:45 | INFO | train_inner | epoch 123:    930 / 1978 loss=2.969, nll_loss=0.823, word_ins=2.653, length=3.163, ppl=7.83, wps=25251.9, ups=0.43, wpb=58984.2, bsz=1899.8, num_updates=242200, lr=0.000203195, gnorm=1.394, loss_scale=8192, train_wall=233, wall=0
2023-03-03 18:14:38 | INFO | train_inner | epoch 123:   1030 / 1978 loss=2.941, nll_loss=0.8, word_ins=2.632, length=3.09, ppl=7.68, wps=25308.8, ups=0.43, wpb=58890.7, bsz=1998.7, num_updates=242300, lr=0.000203153, gnorm=1.366, loss_scale=8192, train_wall=232, wall=0
2023-03-03 18:18:32 | INFO | train_inner | epoch 123:   1130 / 1978 loss=2.958, nll_loss=0.817, word_ins=2.646, length=3.116, ppl=7.77, wps=25513, ups=0.43, wpb=59638.8, bsz=1990.5, num_updates=242400, lr=0.000203111, gnorm=1.416, loss_scale=8192, train_wall=234, wall=0
2023-03-03 18:22:27 | INFO | train_inner | epoch 123:   1230 / 1978 loss=2.914, nll_loss=0.78, word_ins=2.613, length=3.012, ppl=7.54, wps=25633, ups=0.42, wpb=60354.5, bsz=2105, num_updates=242500, lr=0.000203069, gnorm=1.325, loss_scale=8192, train_wall=235, wall=0
2023-03-03 18:26:20 | INFO | train_inner | epoch 123:   1330 / 1978 loss=2.968, nll_loss=0.829, word_ins=2.659, length=3.094, ppl=7.82, wps=25161, ups=0.43, wpb=58672.8, bsz=1932.9, num_updates=242600, lr=0.000203027, gnorm=1.367, loss_scale=8192, train_wall=233, wall=0
2023-03-03 18:30:14 | INFO | train_inner | epoch 123:   1430 / 1978 loss=2.943, nll_loss=0.808, word_ins=2.638, length=3.049, ppl=7.69, wps=25532, ups=0.43, wpb=59615.3, bsz=2072.2, num_updates=242700, lr=0.000202986, gnorm=1.321, loss_scale=8192, train_wall=233, wall=0
2023-03-03 18:34:08 | INFO | train_inner | epoch 123:   1530 / 1978 loss=2.933, nll_loss=0.8, word_ins=2.631, length=3.012, ppl=7.64, wps=25364.5, ups=0.43, wpb=59470, bsz=2037.8, num_updates=242800, lr=0.000202944, gnorm=1.379, loss_scale=8192, train_wall=234, wall=0
2023-03-03 18:38:01 | INFO | train_inner | epoch 123:   1630 / 1978 loss=2.983, nll_loss=0.837, word_ins=2.666, length=3.164, ppl=7.9, wps=25265.4, ups=0.43, wpb=58766.1, bsz=1917.7, num_updates=242900, lr=0.000202902, gnorm=1.439, loss_scale=8192, train_wall=232, wall=0
2023-03-03 18:41:55 | INFO | train_inner | epoch 123:   1730 / 1978 loss=2.933, nll_loss=0.791, word_ins=2.624, length=3.097, ppl=7.64, wps=25411.2, ups=0.43, wpb=59483.3, bsz=2029.3, num_updates=243000, lr=0.00020286, gnorm=1.361, loss_scale=8192, train_wall=234, wall=0
2023-03-03 18:45:50 | INFO | train_inner | epoch 123:   1830 / 1978 loss=2.949, nll_loss=0.809, word_ins=2.64, length=3.093, ppl=7.72, wps=25417.6, ups=0.43, wpb=59704.1, bsz=2000, num_updates=243100, lr=0.000202818, gnorm=1.405, loss_scale=8192, train_wall=235, wall=0
2023-03-03 18:49:43 | INFO | train_inner | epoch 123:   1930 / 1978 loss=2.97, nll_loss=0.824, word_ins=2.653, length=3.168, ppl=7.84, wps=25311.8, ups=0.43, wpb=58890.1, bsz=1903.5, num_updates=243200, lr=0.000202777, gnorm=1.447, loss_scale=8192, train_wall=232, wall=0
2023-03-03 18:51:36 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 18:51:50 | INFO | valid | epoch 123 | valid on 'valid' subset | loss 4.089 | nll_loss 1.904 | word_ins 3.669 | length 4.197 | ppl 17.01 | wps 29723.4 | wpb 40242.5 | bsz 1500 | num_updates 243248 | best_loss 4.034
2023-03-03 18:51:50 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 18:51:55 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint123.pt (epoch 123 @ 243248 updates, score 4.089) (writing took 5.2997174533084035 seconds)
2023-03-03 18:51:55 | INFO | fairseq_cli.train | end of epoch 123 (average epoch stats below)
2023-03-03 18:51:55 | INFO | train | epoch 123 | loss 2.944 | nll_loss 0.804 | word_ins 2.636 | length 3.078 | ppl 7.69 | wps 25191.6 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 243248 | lr 0.000202757 | gnorm 1.369 | loss_scale 8192 | train_wall 4621 | wall 0
2023-03-03 18:51:55 | INFO | fairseq.trainer | begin training epoch 124
2023-03-03 18:54:04 | INFO | train_inner | epoch 124:     52 / 1978 loss=2.942, nll_loss=0.805, word_ins=2.636, length=3.056, ppl=7.68, wps=22733.8, ups=0.38, wpb=59440.7, bsz=1938.8, num_updates=243300, lr=0.000202735, gnorm=1.368, loss_scale=8192, train_wall=232, wall=0
2023-03-03 18:57:57 | INFO | train_inner | epoch 124:    152 / 1978 loss=2.937, nll_loss=0.797, word_ins=2.629, length=3.074, ppl=7.66, wps=25177.6, ups=0.43, wpb=58747.1, bsz=2012.1, num_updates=243400, lr=0.000202693, gnorm=1.359, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:01:52 | INFO | train_inner | epoch 124:    252 / 1978 loss=2.922, nll_loss=0.785, word_ins=2.618, length=3.035, ppl=7.58, wps=25258.3, ups=0.43, wpb=59116.3, bsz=2110.4, num_updates=243500, lr=0.000202652, gnorm=1.296, loss_scale=8192, train_wall=234, wall=0
2023-03-03 19:05:46 | INFO | train_inner | epoch 124:    352 / 1978 loss=2.938, nll_loss=0.8, word_ins=2.632, length=3.063, ppl=7.66, wps=25443.7, ups=0.43, wpb=59653.2, bsz=2022.6, num_updates=243600, lr=0.00020261, gnorm=1.34, loss_scale=8192, train_wall=234, wall=0
2023-03-03 19:09:39 | INFO | train_inner | epoch 124:    452 / 1978 loss=2.949, nll_loss=0.805, word_ins=2.636, length=3.131, ppl=7.72, wps=25413.7, ups=0.43, wpb=59308.1, bsz=1919.9, num_updates=243700, lr=0.000202569, gnorm=1.434, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:13:33 | INFO | train_inner | epoch 124:    552 / 1978 loss=2.927, nll_loss=0.795, word_ins=2.627, length=2.996, ppl=7.6, wps=25417.6, ups=0.43, wpb=59345.9, bsz=2077.2, num_updates=243800, lr=0.000202527, gnorm=1.343, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:17:27 | INFO | train_inner | epoch 124:    652 / 1978 loss=2.937, nll_loss=0.799, word_ins=2.631, length=3.059, ppl=7.66, wps=25296, ups=0.43, wpb=59157.8, bsz=2059.8, num_updates=243900, lr=0.000202486, gnorm=1.388, loss_scale=8192, train_wall=234, wall=0
2023-03-03 19:21:20 | INFO | train_inner | epoch 124:    752 / 1978 loss=2.961, nll_loss=0.817, word_ins=2.648, length=3.132, ppl=7.79, wps=25370.1, ups=0.43, wpb=59270.6, bsz=1911.8, num_updates=244000, lr=0.000202444, gnorm=1.413, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:25:14 | INFO | train_inner | epoch 124:    852 / 1978 loss=2.925, nll_loss=0.794, word_ins=2.626, length=2.988, ppl=7.59, wps=25405.7, ups=0.43, wpb=59349, bsz=2051.2, num_updates=244100, lr=0.000202403, gnorm=1.344, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:27:31 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 19:29:10 | INFO | train_inner | epoch 124:    953 / 1978 loss=2.939, nll_loss=0.796, word_ins=2.628, length=3.11, ppl=7.67, wps=25120.1, ups=0.42, wpb=59231.2, bsz=2004.1, num_updates=244200, lr=0.000202361, gnorm=1.388, loss_scale=8192, train_wall=236, wall=0
2023-03-03 19:33:03 | INFO | train_inner | epoch 124:   1053 / 1978 loss=2.952, nll_loss=0.812, word_ins=2.643, length=3.09, ppl=7.74, wps=25203.9, ups=0.43, wpb=58892.9, bsz=2010.4, num_updates=244300, lr=0.00020232, gnorm=1.375, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:36:58 | INFO | train_inner | epoch 124:   1153 / 1978 loss=2.926, nll_loss=0.786, word_ins=2.619, length=3.064, ppl=7.6, wps=25269.2, ups=0.43, wpb=59374.6, bsz=2079.7, num_updates=244400, lr=0.000202278, gnorm=1.384, loss_scale=8192, train_wall=235, wall=0
2023-03-03 19:40:52 | INFO | train_inner | epoch 124:   1253 / 1978 loss=2.962, nll_loss=0.824, word_ins=2.654, length=3.078, ppl=7.79, wps=25495.2, ups=0.43, wpb=59612.7, bsz=1905.8, num_updates=244500, lr=0.000202237, gnorm=1.375, loss_scale=8192, train_wall=234, wall=0
2023-03-03 19:44:46 | INFO | train_inner | epoch 124:   1353 / 1978 loss=2.932, nll_loss=0.791, word_ins=2.624, length=3.082, ppl=7.63, wps=25271.8, ups=0.43, wpb=59188.8, bsz=2048.3, num_updates=244600, lr=0.000202196, gnorm=1.389, loss_scale=8192, train_wall=234, wall=0
2023-03-03 19:48:40 | INFO | train_inner | epoch 124:   1453 / 1978 loss=2.944, nll_loss=0.801, word_ins=2.633, length=3.114, ppl=7.7, wps=25409.9, ups=0.43, wpb=59344.3, bsz=1993.3, num_updates=244700, lr=0.000202154, gnorm=1.41, loss_scale=8192, train_wall=233, wall=0
2023-03-03 19:52:34 | INFO | train_inner | epoch 124:   1553 / 1978 loss=2.937, nll_loss=0.799, word_ins=2.631, length=3.06, ppl=7.66, wps=25371.6, ups=0.43, wpb=59397.3, bsz=2038.3, num_updates=244800, lr=0.000202113, gnorm=1.366, loss_scale=8192, train_wall=234, wall=0
2023-03-03 19:56:28 | INFO | train_inner | epoch 124:   1653 / 1978 loss=2.945, nll_loss=0.802, word_ins=2.634, length=3.112, ppl=7.7, wps=25336.2, ups=0.43, wpb=59264.2, bsz=2029.5, num_updates=244900, lr=0.000202072, gnorm=1.327, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:00:22 | INFO | train_inner | epoch 124:   1753 / 1978 loss=2.937, nll_loss=0.797, word_ins=2.629, length=3.081, ppl=7.66, wps=25460.1, ups=0.43, wpb=59525.8, bsz=1995.5, num_updates=245000, lr=0.000202031, gnorm=1.354, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:04:16 | INFO | train_inner | epoch 124:   1853 / 1978 loss=2.922, nll_loss=0.786, word_ins=2.619, length=3.034, ppl=7.58, wps=25592.7, ups=0.43, wpb=60033.6, bsz=2067.1, num_updates=245100, lr=0.000201989, gnorm=1.404, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:08:10 | INFO | train_inner | epoch 124:   1953 / 1978 loss=2.985, nll_loss=0.838, word_ins=2.666, length=3.185, ppl=7.92, wps=25203.2, ups=0.43, wpb=58874.6, bsz=1874.2, num_updates=245200, lr=0.000201948, gnorm=1.409, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:09:08 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 20:09:23 | INFO | valid | epoch 124 | valid on 'valid' subset | loss 4.079 | nll_loss 1.921 | word_ins 3.681 | length 3.983 | ppl 16.91 | wps 30084.3 | wpb 40242.5 | bsz 1500 | num_updates 245225 | best_loss 4.034
2023-03-03 20:09:23 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 20:09:29 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint124.pt (epoch 124 @ 245225 updates, score 4.079) (writing took 5.660234265960753 seconds)
2023-03-03 20:09:29 | INFO | fairseq_cli.train | end of epoch 124 (average epoch stats below)
2023-03-03 20:09:29 | INFO | train | epoch 124 | loss 2.942 | nll_loss 0.802 | word_ins 2.634 | length 3.081 | ppl 7.68 | wps 25182.9 | ups 0.42 | wpb 59284.1 | bsz 2002.6 | num_updates 245225 | lr 0.000201938 | gnorm 1.374 | loss_scale 8192 | train_wall 4618 | wall 0
2023-03-03 20:09:29 | INFO | fairseq.trainer | begin training epoch 125
2023-03-03 20:12:33 | INFO | train_inner | epoch 125:     75 / 1978 loss=2.938, nll_loss=0.798, word_ins=2.631, length=3.078, ppl=7.67, wps=22313, ups=0.38, wpb=58611, bsz=1930.7, num_updates=245300, lr=0.000201907, gnorm=1.324, loss_scale=8192, train_wall=232, wall=0
2023-03-03 20:16:26 | INFO | train_inner | epoch 125:    175 / 1978 loss=2.933, nll_loss=0.793, word_ins=2.625, length=3.077, ppl=7.64, wps=25274.3, ups=0.43, wpb=59085.3, bsz=2005, num_updates=245400, lr=0.000201866, gnorm=1.355, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:20:20 | INFO | train_inner | epoch 125:    275 / 1978 loss=2.949, nll_loss=0.81, word_ins=2.641, length=3.075, ppl=7.72, wps=25364.2, ups=0.43, wpb=59124.4, bsz=1952.3, num_updates=245500, lr=0.000201825, gnorm=1.337, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:24:15 | INFO | train_inner | epoch 125:    375 / 1978 loss=2.921, nll_loss=0.783, word_ins=2.616, length=3.048, ppl=7.57, wps=25135.4, ups=0.43, wpb=59070.8, bsz=2079.4, num_updates=245600, lr=0.000201784, gnorm=1.375, loss_scale=8192, train_wall=235, wall=0
2023-03-03 20:28:08 | INFO | train_inner | epoch 125:    475 / 1978 loss=2.952, nll_loss=0.814, word_ins=2.645, length=3.078, ppl=7.74, wps=25305.7, ups=0.43, wpb=59010.9, bsz=1973.9, num_updates=245700, lr=0.000201743, gnorm=1.37, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:32:01 | INFO | train_inner | epoch 125:    575 / 1978 loss=2.926, nll_loss=0.789, word_ins=2.622, length=3.044, ppl=7.6, wps=25390.7, ups=0.43, wpb=59312.1, bsz=2003, num_updates=245800, lr=0.000201701, gnorm=1.381, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:35:55 | INFO | train_inner | epoch 125:    675 / 1978 loss=2.933, nll_loss=0.796, word_ins=2.628, length=3.053, ppl=7.64, wps=25464.6, ups=0.43, wpb=59416.6, bsz=1979.6, num_updates=245900, lr=0.00020166, gnorm=1.405, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:39:48 | INFO | train_inner | epoch 125:    775 / 1978 loss=2.958, nll_loss=0.815, word_ins=2.646, length=3.121, ppl=7.77, wps=25414.8, ups=0.43, wpb=59190.4, bsz=1915, num_updates=246000, lr=0.000201619, gnorm=1.377, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:43:41 | INFO | train_inner | epoch 125:    875 / 1978 loss=2.939, nll_loss=0.803, word_ins=2.635, length=3.042, ppl=7.67, wps=25536.9, ups=0.43, wpb=59695.8, bsz=2017.5, num_updates=246100, lr=0.000201578, gnorm=1.43, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:47:34 | INFO | train_inner | epoch 125:    975 / 1978 loss=2.952, nll_loss=0.808, word_ins=2.639, length=3.132, ppl=7.74, wps=25336.3, ups=0.43, wpb=59015.9, bsz=1925, num_updates=246200, lr=0.000201538, gnorm=1.344, loss_scale=8192, train_wall=233, wall=0
2023-03-03 20:51:28 | INFO | train_inner | epoch 125:   1075 / 1978 loss=2.944, nll_loss=0.797, word_ins=2.629, length=3.149, ppl=7.7, wps=25545.1, ups=0.43, wpb=59759.8, bsz=1954.9, num_updates=246300, lr=0.000201497, gnorm=1.425, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:55:22 | INFO | train_inner | epoch 125:   1175 / 1978 loss=2.938, nll_loss=0.801, word_ins=2.633, length=3.049, ppl=7.66, wps=25249.9, ups=0.43, wpb=59060.7, bsz=2035, num_updates=246400, lr=0.000201456, gnorm=1.387, loss_scale=8192, train_wall=234, wall=0
2023-03-03 20:59:17 | INFO | train_inner | epoch 125:   1275 / 1978 loss=2.928, nll_loss=0.794, word_ins=2.626, length=3.018, ppl=7.61, wps=25204.2, ups=0.43, wpb=59229.4, bsz=2123.5, num_updates=246500, lr=0.000201415, gnorm=1.362, loss_scale=8192, train_wall=235, wall=0
2023-03-03 21:03:11 | INFO | train_inner | epoch 125:   1375 / 1978 loss=2.958, nll_loss=0.811, word_ins=2.642, length=3.161, ppl=7.77, wps=25041.8, ups=0.43, wpb=58584.4, bsz=1964.8, num_updates=246600, lr=0.000201374, gnorm=1.372, loss_scale=8192, train_wall=234, wall=0
2023-03-03 21:07:04 | INFO | train_inner | epoch 125:   1475 / 1978 loss=2.955, nll_loss=0.815, word_ins=2.645, length=3.094, ppl=7.75, wps=25277, ups=0.43, wpb=58930.1, bsz=2096, num_updates=246700, lr=0.000201333, gnorm=1.383, loss_scale=8192, train_wall=233, wall=0
2023-03-03 21:10:59 | INFO | train_inner | epoch 125:   1575 / 1978 loss=2.937, nll_loss=0.8, word_ins=2.632, length=3.05, ppl=7.66, wps=25335.9, ups=0.43, wpb=59520.6, bsz=2042.5, num_updates=246800, lr=0.000201292, gnorm=1.337, loss_scale=8192, train_wall=235, wall=0
2023-03-03 21:14:53 | INFO | train_inner | epoch 125:   1675 / 1978 loss=2.942, nll_loss=0.8, word_ins=2.631, length=3.102, ppl=7.68, wps=25446.6, ups=0.43, wpb=59462.3, bsz=2057.7, num_updates=246900, lr=0.000201252, gnorm=1.372, loss_scale=8192, train_wall=233, wall=0
2023-03-03 21:18:46 | INFO | train_inner | epoch 125:   1775 / 1978 loss=2.938, nll_loss=0.798, word_ins=2.629, length=3.092, ppl=7.67, wps=25799.8, ups=0.43, wpb=60057.6, bsz=1889.9, num_updates=247000, lr=0.000201211, gnorm=1.436, loss_scale=8192, train_wall=233, wall=0
2023-03-03 21:22:42 | INFO | train_inner | epoch 125:   1875 / 1978 loss=2.947, nll_loss=0.809, word_ins=2.64, length=3.073, ppl=7.71, wps=25192.2, ups=0.42, wpb=59562.9, bsz=1990.8, num_updates=247100, lr=0.00020117, gnorm=1.38, loss_scale=8192, train_wall=236, wall=0
2023-03-03 21:26:37 | INFO | train_inner | epoch 125:   1975 / 1978 loss=2.93, nll_loss=0.79, word_ins=2.622, length=3.08, ppl=7.62, wps=25464.7, ups=0.42, wpb=59924.2, bsz=2058.7, num_updates=247200, lr=0.000201129, gnorm=1.394, loss_scale=8192, train_wall=235, wall=0
2023-03-03 21:26:45 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 21:27:01 | INFO | valid | epoch 125 | valid on 'valid' subset | loss 4.064 | nll_loss 1.917 | word_ins 3.675 | length 3.893 | ppl 16.73 | wps 30034.8 | wpb 40242.5 | bsz 1500 | num_updates 247203 | best_loss 4.034
2023-03-03 21:27:01 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 21:27:07 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint125.pt (epoch 125 @ 247203 updates, score 4.064) (writing took 5.9983569430187345 seconds)
2023-03-03 21:27:07 | INFO | fairseq_cli.train | end of epoch 125 (average epoch stats below)
2023-03-03 21:27:07 | INFO | train | epoch 125 | loss 2.94 | nll_loss 0.801 | word_ins 2.633 | length 3.079 | ppl 7.68 | wps 25176.7 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 247203 | lr 0.000201128 | gnorm 1.378 | loss_scale 8192 | train_wall 4621 | wall 0
2023-03-03 21:27:07 | INFO | fairseq.trainer | begin training epoch 126
2023-03-03 21:31:01 | INFO | train_inner | epoch 126:     97 / 1978 loss=2.924, nll_loss=0.792, word_ins=2.624, length=2.998, ppl=7.59, wps=22500.9, ups=0.38, wpb=59382.1, bsz=1985.9, num_updates=247300, lr=0.000201089, gnorm=1.382, loss_scale=8192, train_wall=232, wall=0
2023-03-03 21:34:57 | INFO | train_inner | epoch 126:    197 / 1978 loss=2.941, nll_loss=0.799, word_ins=2.632, length=3.094, ppl=7.68, wps=25061.6, ups=0.42, wpb=59068.1, bsz=1948, num_updates=247400, lr=0.000201048, gnorm=1.414, loss_scale=8192, train_wall=235, wall=0
2023-03-03 21:38:51 | INFO | train_inner | epoch 126:    297 / 1978 loss=2.946, nll_loss=0.805, word_ins=2.636, length=3.096, ppl=7.71, wps=25351.3, ups=0.43, wpb=59265.6, bsz=1912.2, num_updates=247500, lr=0.000201008, gnorm=1.414, loss_scale=8192, train_wall=234, wall=0
2023-03-03 21:42:46 | INFO | train_inner | epoch 126:    397 / 1978 loss=2.92, nll_loss=0.785, word_ins=2.618, length=3.024, ppl=7.57, wps=25199.1, ups=0.43, wpb=59260.3, bsz=2063.4, num_updates=247600, lr=0.000200967, gnorm=1.42, loss_scale=8192, train_wall=235, wall=0
2023-03-03 21:46:45 | INFO | train_inner | epoch 126:    497 / 1978 loss=2.921, nll_loss=0.781, word_ins=2.614, length=3.064, ppl=7.57, wps=24761.2, ups=0.42, wpb=59163.9, bsz=2120.2, num_updates=247700, lr=0.000200926, gnorm=1.368, loss_scale=8192, train_wall=239, wall=0
2023-03-03 21:50:41 | INFO | train_inner | epoch 126:    597 / 1978 loss=2.939, nll_loss=0.8, word_ins=2.631, length=3.081, ppl=7.67, wps=25329.9, ups=0.42, wpb=59838.6, bsz=2042.2, num_updates=247800, lr=0.000200886, gnorm=1.334, loss_scale=8192, train_wall=236, wall=0
2023-03-03 21:54:38 | INFO | train_inner | epoch 126:    697 / 1978 loss=2.932, nll_loss=0.794, word_ins=2.626, length=3.062, ppl=7.63, wps=25043.7, ups=0.42, wpb=59345.2, bsz=2025.4, num_updates=247900, lr=0.000200845, gnorm=1.368, loss_scale=8192, train_wall=237, wall=0
2023-03-03 21:58:31 | INFO | train_inner | epoch 126:    797 / 1978 loss=2.946, nll_loss=0.805, word_ins=2.636, length=3.099, ppl=7.71, wps=25445.7, ups=0.43, wpb=59250.3, bsz=1949.4, num_updates=248000, lr=0.000200805, gnorm=1.384, loss_scale=8192, train_wall=233, wall=0
2023-03-03 22:02:24 | INFO | train_inner | epoch 126:    897 / 1978 loss=2.941, nll_loss=0.804, word_ins=2.635, length=3.062, ppl=7.68, wps=25451.4, ups=0.43, wpb=59215.7, bsz=1991.5, num_updates=248100, lr=0.000200764, gnorm=1.368, loss_scale=8192, train_wall=232, wall=0
2023-03-03 22:06:20 | INFO | train_inner | epoch 126:    997 / 1978 loss=2.924, nll_loss=0.788, word_ins=2.62, length=3.034, ppl=7.59, wps=25350.6, ups=0.42, wpb=59851, bsz=1978.7, num_updates=248200, lr=0.000200724, gnorm=1.36, loss_scale=8192, train_wall=236, wall=0
2023-03-03 22:08:29 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-03 22:10:17 | INFO | train_inner | epoch 126:   1098 / 1978 loss=2.934, nll_loss=0.788, word_ins=2.621, length=3.129, ppl=7.64, wps=24950.4, ups=0.42, wpb=59131.6, bsz=2027.3, num_updates=248300, lr=0.000200683, gnorm=1.344, loss_scale=8192, train_wall=237, wall=0
2023-03-03 22:12:19 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 4096.0
2023-03-03 22:14:13 | INFO | train_inner | epoch 126:   1199 / 1978 loss=2.926, nll_loss=0.79, word_ins=2.622, length=3.041, ppl=7.6, wps=25069.9, ups=0.42, wpb=59324.6, bsz=2023, num_updates=248400, lr=0.000200643, gnorm=1.392, loss_scale=4096, train_wall=236, wall=0
2023-03-03 22:18:09 | INFO | train_inner | epoch 126:   1299 / 1978 loss=2.939, nll_loss=0.798, word_ins=2.63, length=3.091, ppl=7.67, wps=25234.5, ups=0.43, wpb=59368.1, bsz=2064.2, num_updates=248500, lr=0.000200603, gnorm=1.337, loss_scale=4096, train_wall=235, wall=0
2023-03-03 22:22:03 | INFO | train_inner | epoch 126:   1399 / 1978 loss=2.941, nll_loss=0.801, word_ins=2.632, length=3.085, ppl=7.68, wps=25060.9, ups=0.43, wpb=58766.3, bsz=2019.4, num_updates=248600, lr=0.000200562, gnorm=1.36, loss_scale=4096, train_wall=234, wall=0
2023-03-03 22:25:58 | INFO | train_inner | epoch 126:   1499 / 1978 loss=2.942, nll_loss=0.799, word_ins=2.63, length=3.115, ppl=7.68, wps=25186, ups=0.43, wpb=59115.2, bsz=1989.1, num_updates=248700, lr=0.000200522, gnorm=1.365, loss_scale=4096, train_wall=234, wall=0
2023-03-03 22:29:50 | INFO | train_inner | epoch 126:   1599 / 1978 loss=2.963, nll_loss=0.821, word_ins=2.65, length=3.13, ppl=7.8, wps=25527.7, ups=0.43, wpb=59359.9, bsz=1926.2, num_updates=248800, lr=0.000200482, gnorm=1.427, loss_scale=4096, train_wall=232, wall=0
2023-03-03 22:33:44 | INFO | train_inner | epoch 126:   1699 / 1978 loss=2.966, nll_loss=0.827, word_ins=2.657, length=3.097, ppl=7.81, wps=25168, ups=0.43, wpb=58752.6, bsz=2003.3, num_updates=248900, lr=0.000200441, gnorm=1.436, loss_scale=4096, train_wall=233, wall=0
2023-03-03 22:37:37 | INFO | train_inner | epoch 126:   1799 / 1978 loss=2.953, nll_loss=0.813, word_ins=2.643, length=3.098, ppl=7.74, wps=25467.4, ups=0.43, wpb=59470.1, bsz=1915.4, num_updates=249000, lr=0.000200401, gnorm=1.41, loss_scale=4096, train_wall=233, wall=0
2023-03-03 22:41:33 | INFO | train_inner | epoch 126:   1899 / 1978 loss=2.934, nll_loss=0.795, word_ins=2.627, length=3.075, ppl=7.64, wps=25390.1, ups=0.42, wpb=59760.7, bsz=2083, num_updates=249100, lr=0.000200361, gnorm=1.41, loss_scale=4096, train_wall=235, wall=0
2023-03-03 22:44:37 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-03 22:44:52 | INFO | valid | epoch 126 | valid on 'valid' subset | loss 4.146 | nll_loss 1.921 | word_ins 3.687 | length 4.584 | ppl 17.71 | wps 31243.1 | wpb 40242.5 | bsz 1500 | num_updates 249179 | best_loss 4.034
2023-03-03 22:44:52 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-03 22:44:58 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint126.pt (epoch 126 @ 249179 updates, score 4.146) (writing took 5.7539648385718465 seconds)
2023-03-03 22:44:58 | INFO | fairseq_cli.train | end of epoch 126 (average epoch stats below)
2023-03-03 22:44:58 | INFO | train | epoch 126 | loss 2.939 | nll_loss 0.8 | word_ins 2.631 | length 3.079 | ppl 7.67 | wps 25079.1 | ups 0.42 | wpb 59282.7 | bsz 2003 | num_updates 249179 | lr 0.000200329 | gnorm 1.382 | loss_scale 4096 | train_wall 4636 | wall 0
2023-03-03 22:44:58 | INFO | fairseq.trainer | begin training epoch 127
2023-03-03 22:45:56 | INFO | train_inner | epoch 127:     21 / 1978 loss=2.939, nll_loss=0.799, word_ins=2.631, length=3.08, ppl=7.67, wps=22367, ups=0.38, wpb=58812.6, bsz=2030.8, num_updates=249200, lr=0.000200321, gnorm=1.332, loss_scale=4096, train_wall=233, wall=0
2023-03-03 22:49:50 | INFO | train_inner | epoch 127:    121 / 1978 loss=2.924, nll_loss=0.788, word_ins=2.621, length=3.038, ppl=7.59, wps=25389.2, ups=0.43, wpb=59561.8, bsz=2059.7, num_updates=249300, lr=0.000200281, gnorm=1.372, loss_scale=4096, train_wall=234, wall=0
2023-03-03 22:53:44 | INFO | train_inner | epoch 127:    221 / 1978 loss=2.947, nll_loss=0.806, word_ins=2.638, length=3.091, ppl=7.71, wps=25255.9, ups=0.43, wpb=59037, bsz=1972.3, num_updates=249400, lr=0.00020024, gnorm=1.367, loss_scale=4096, train_wall=234, wall=0
2023-03-03 22:57:38 | INFO | train_inner | epoch 127:    321 / 1978 loss=2.939, nll_loss=0.8, word_ins=2.632, length=3.064, ppl=7.67, wps=24923.3, ups=0.43, wpb=58248, bsz=1981.8, num_updates=249500, lr=0.0002002, gnorm=1.351, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:01:31 | INFO | train_inner | epoch 127:    421 / 1978 loss=2.923, nll_loss=0.782, word_ins=2.615, length=3.077, ppl=7.58, wps=25526, ups=0.43, wpb=59565.9, bsz=2001.9, num_updates=249600, lr=0.00020016, gnorm=1.414, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:05:25 | INFO | train_inner | epoch 127:    521 / 1978 loss=2.924, nll_loss=0.788, word_ins=2.621, length=3.028, ppl=7.59, wps=25417.2, ups=0.43, wpb=59554.7, bsz=2074, num_updates=249700, lr=0.00020012, gnorm=1.375, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:09:20 | INFO | train_inner | epoch 127:    621 / 1978 loss=2.914, nll_loss=0.78, word_ins=2.614, length=2.996, ppl=7.54, wps=25406.3, ups=0.43, wpb=59499.8, bsz=2049, num_updates=249800, lr=0.00020008, gnorm=1.324, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:13:13 | INFO | train_inner | epoch 127:    721 / 1978 loss=2.933, nll_loss=0.789, word_ins=2.621, length=3.123, ppl=7.64, wps=25491.6, ups=0.43, wpb=59400.7, bsz=1973.8, num_updates=249900, lr=0.00020004, gnorm=1.339, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:17:07 | INFO | train_inner | epoch 127:    821 / 1978 loss=2.947, nll_loss=0.808, word_ins=2.639, length=3.076, ppl=7.71, wps=25315.9, ups=0.43, wpb=59218.4, bsz=1997.8, num_updates=250000, lr=0.0002, gnorm=1.452, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:21:01 | INFO | train_inner | epoch 127:    921 / 1978 loss=2.925, nll_loss=0.784, word_ins=2.617, length=3.083, ppl=7.6, wps=25242.8, ups=0.43, wpb=59217.3, bsz=2048, num_updates=250100, lr=0.00019996, gnorm=1.375, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:24:55 | INFO | train_inner | epoch 127:   1021 / 1978 loss=2.944, nll_loss=0.803, word_ins=2.634, length=3.106, ppl=7.7, wps=25252.9, ups=0.43, wpb=58930.2, bsz=1979.9, num_updates=250200, lr=0.00019992, gnorm=1.365, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:28:48 | INFO | train_inner | epoch 127:   1121 / 1978 loss=2.938, nll_loss=0.807, word_ins=2.638, length=3.002, ppl=7.66, wps=25693.4, ups=0.43, wpb=59966.4, bsz=1982.9, num_updates=250300, lr=0.00019988, gnorm=1.421, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:32:42 | INFO | train_inner | epoch 127:   1221 / 1978 loss=2.944, nll_loss=0.809, word_ins=2.64, length=3.046, ppl=7.7, wps=25372.8, ups=0.43, wpb=59326.2, bsz=1966.6, num_updates=250400, lr=0.00019984, gnorm=1.389, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:36:35 | INFO | train_inner | epoch 127:   1321 / 1978 loss=2.956, nll_loss=0.811, word_ins=2.641, length=3.147, ppl=7.76, wps=25278.2, ups=0.43, wpb=59046.8, bsz=1958.5, num_updates=250500, lr=0.0001998, gnorm=1.389, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:40:28 | INFO | train_inner | epoch 127:   1421 / 1978 loss=2.938, nll_loss=0.801, word_ins=2.632, length=3.06, ppl=7.66, wps=25517.3, ups=0.43, wpb=59423, bsz=1997.9, num_updates=250600, lr=0.00019976, gnorm=1.374, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:44:22 | INFO | train_inner | epoch 127:   1521 / 1978 loss=2.936, nll_loss=0.8, word_ins=2.632, length=3.044, ppl=7.65, wps=25186.6, ups=0.43, wpb=58977.1, bsz=2040.6, num_updates=250700, lr=0.000199721, gnorm=1.334, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:48:16 | INFO | train_inner | epoch 127:   1621 / 1978 loss=2.945, nll_loss=0.807, word_ins=2.638, length=3.069, ppl=7.7, wps=25460.6, ups=0.43, wpb=59439.7, bsz=1975.4, num_updates=250800, lr=0.000199681, gnorm=1.378, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:52:10 | INFO | train_inner | epoch 127:   1721 / 1978 loss=2.957, nll_loss=0.816, word_ins=2.646, length=3.106, ppl=7.76, wps=25182, ups=0.43, wpb=58893.3, bsz=1992.6, num_updates=250900, lr=0.000199641, gnorm=1.426, loss_scale=4096, train_wall=234, wall=0
2023-03-03 23:56:04 | INFO | train_inner | epoch 127:   1821 / 1978 loss=2.949, nll_loss=0.811, word_ins=2.642, length=3.079, ppl=7.72, wps=25540.1, ups=0.43, wpb=59697.2, bsz=1995.4, num_updates=251000, lr=0.000199601, gnorm=1.431, loss_scale=4096, train_wall=233, wall=0
2023-03-03 23:59:57 | INFO | train_inner | epoch 127:   1921 / 1978 loss=2.939, nll_loss=0.801, word_ins=2.633, length=3.064, ppl=7.67, wps=25604.1, ups=0.43, wpb=59807.6, bsz=1980, num_updates=251100, lr=0.000199561, gnorm=1.383, loss_scale=4096, train_wall=233, wall=0
2023-03-04 00:02:11 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 00:02:28 | INFO | valid | epoch 127 | valid on 'valid' subset | loss 4.122 | nll_loss 1.927 | word_ins 3.688 | length 4.333 | ppl 17.41 | wps 29971.5 | wpb 40242.5 | bsz 1500 | num_updates 251157 | best_loss 4.034
2023-03-04 00:02:28 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 00:02:34 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint127.pt (epoch 127 @ 251157 updates, score 4.122) (writing took 5.71666799671948 seconds)
2023-03-04 00:02:34 | INFO | fairseq_cli.train | end of epoch 127 (average epoch stats below)
2023-03-04 00:02:34 | INFO | train | epoch 127 | loss 2.938 | nll_loss 0.799 | word_ins 2.631 | length 3.069 | ppl 7.66 | wps 25185.9 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 251157 | lr 0.000199539 | gnorm 1.382 | loss_scale 4096 | train_wall 4619 | wall 0
2023-03-04 00:02:34 | INFO | fairseq.trainer | begin training epoch 128
2023-03-04 00:04:23 | INFO | train_inner | epoch 128:     43 / 1978 loss=2.937, nll_loss=0.795, word_ins=2.627, length=3.101, ppl=7.66, wps=22131.7, ups=0.38, wpb=58825.5, bsz=1950, num_updates=251200, lr=0.000199522, gnorm=1.422, loss_scale=4096, train_wall=232, wall=0
2023-03-04 00:08:16 | INFO | train_inner | epoch 128:    143 / 1978 loss=2.922, nll_loss=0.788, word_ins=2.621, length=3.015, ppl=7.58, wps=25526.1, ups=0.43, wpb=59506.3, bsz=2005, num_updates=251300, lr=0.000199482, gnorm=1.375, loss_scale=4096, train_wall=233, wall=0
2023-03-04 00:12:09 | INFO | train_inner | epoch 128:    243 / 1978 loss=2.943, nll_loss=0.807, word_ins=2.638, length=3.049, ppl=7.69, wps=25451.5, ups=0.43, wpb=59257.9, bsz=1999, num_updates=251400, lr=0.000199442, gnorm=1.422, loss_scale=4096, train_wall=233, wall=0
2023-03-04 00:16:03 | INFO | train_inner | epoch 128:    343 / 1978 loss=2.935, nll_loss=0.794, word_ins=2.626, length=3.089, ppl=7.65, wps=25024.3, ups=0.43, wpb=58668.9, bsz=2017.7, num_updates=251500, lr=0.000199403, gnorm=1.362, loss_scale=4096, train_wall=234, wall=0
2023-03-04 00:19:55 | INFO | train_inner | epoch 128:    443 / 1978 loss=2.94, nll_loss=0.8, word_ins=2.632, length=3.083, ppl=7.68, wps=25612.2, ups=0.43, wpb=59445, bsz=1942.1, num_updates=251600, lr=0.000199363, gnorm=1.399, loss_scale=4096, train_wall=232, wall=0
2023-03-04 00:23:50 | INFO | train_inner | epoch 128:    543 / 1978 loss=2.912, nll_loss=0.773, word_ins=2.607, length=3.056, ppl=7.53, wps=25228, ups=0.43, wpb=59174.5, bsz=2090.3, num_updates=251700, lr=0.000199323, gnorm=1.325, loss_scale=4096, train_wall=234, wall=0
2023-03-04 00:27:45 | INFO | train_inner | epoch 128:    643 / 1978 loss=2.93, nll_loss=0.789, word_ins=2.622, length=3.083, ppl=7.62, wps=25273, ups=0.43, wpb=59387.5, bsz=1982.6, num_updates=251800, lr=0.000199284, gnorm=1.352, loss_scale=4096, train_wall=235, wall=0
2023-03-04 00:31:41 | INFO | train_inner | epoch 128:    743 / 1978 loss=2.936, nll_loss=0.796, word_ins=2.628, length=3.076, ppl=7.65, wps=25180.1, ups=0.42, wpb=59488.5, bsz=1940, num_updates=251900, lr=0.000199244, gnorm=1.401, loss_scale=4096, train_wall=236, wall=0
2023-03-04 00:35:36 | INFO | train_inner | epoch 128:    843 / 1978 loss=2.925, nll_loss=0.786, word_ins=2.619, length=3.057, ppl=7.59, wps=25324.2, ups=0.43, wpb=59439.5, bsz=2035.5, num_updates=252000, lr=0.000199205, gnorm=1.326, loss_scale=4096, train_wall=234, wall=0
2023-03-04 00:39:37 | INFO | train_inner | epoch 128:    943 / 1978 loss=2.938, nll_loss=0.799, word_ins=2.632, length=3.062, ppl=7.66, wps=24601.7, ups=0.41, wpb=59327.4, bsz=1983.2, num_updates=252100, lr=0.000199165, gnorm=1.368, loss_scale=4096, train_wall=237, wall=0
2023-03-04 00:43:33 | INFO | train_inner | epoch 128:   1043 / 1978 loss=2.961, nll_loss=0.819, word_ins=2.649, length=3.121, ppl=7.79, wps=24990.9, ups=0.42, wpb=58920.4, bsz=1962.5, num_updates=252200, lr=0.000199126, gnorm=1.431, loss_scale=4096, train_wall=235, wall=0
2023-03-04 00:47:35 | INFO | train_inner | epoch 128:   1143 / 1978 loss=2.937, nll_loss=0.8, word_ins=2.631, length=3.051, ppl=7.66, wps=24569.2, ups=0.41, wpb=59445.3, bsz=2012.7, num_updates=252300, lr=0.000199086, gnorm=1.425, loss_scale=4096, train_wall=242, wall=0
2023-03-04 00:51:39 | INFO | train_inner | epoch 128:   1243 / 1978 loss=2.92, nll_loss=0.787, word_ins=2.62, length=3.001, ppl=7.57, wps=24361, ups=0.41, wpb=59602.2, bsz=2058.6, num_updates=252400, lr=0.000199047, gnorm=1.356, loss_scale=4096, train_wall=244, wall=0
2023-03-04 00:55:35 | INFO | train_inner | epoch 128:   1343 / 1978 loss=2.936, nll_loss=0.794, word_ins=2.626, length=3.107, ppl=7.65, wps=25205, ups=0.43, wpb=59304.7, bsz=2007.7, num_updates=252500, lr=0.000199007, gnorm=1.384, loss_scale=8192, train_wall=235, wall=0
2023-03-04 00:59:31 | INFO | train_inner | epoch 128:   1443 / 1978 loss=2.944, nll_loss=0.805, word_ins=2.636, length=3.079, ppl=7.69, wps=25246.6, ups=0.42, wpb=59650.1, bsz=2038.2, num_updates=252600, lr=0.000198968, gnorm=1.43, loss_scale=8192, train_wall=236, wall=0
2023-03-04 01:03:26 | INFO | train_inner | epoch 128:   1543 / 1978 loss=2.975, nll_loss=0.825, word_ins=2.654, length=3.203, ppl=7.86, wps=24933.6, ups=0.43, wpb=58573.8, bsz=1917.5, num_updates=252700, lr=0.000198929, gnorm=1.401, loss_scale=8192, train_wall=235, wall=0
2023-03-04 01:09:06 | INFO | train_inner | epoch 128:   1643 / 1978 loss=2.935, nll_loss=0.796, word_ins=2.628, length=3.068, ppl=7.65, wps=17280.8, ups=0.29, wpb=58811, bsz=2062.8, num_updates=252800, lr=0.000198889, gnorm=1.369, loss_scale=8192, train_wall=340, wall=0
2023-03-04 01:13:02 | INFO | train_inner | epoch 128:   1743 / 1978 loss=2.94, nll_loss=0.798, word_ins=2.63, length=3.108, ppl=7.68, wps=24948, ups=0.42, wpb=58894.8, bsz=1982.5, num_updates=252900, lr=0.00019885, gnorm=1.352, loss_scale=8192, train_wall=236, wall=0
2023-03-04 01:16:57 | INFO | train_inner | epoch 128:   1843 / 1978 loss=2.943, nll_loss=0.799, word_ins=2.63, length=3.134, ppl=7.69, wps=25495.1, ups=0.43, wpb=59840.4, bsz=1943.1, num_updates=253000, lr=0.000198811, gnorm=1.425, loss_scale=8192, train_wall=234, wall=0
2023-03-04 01:20:54 | INFO | train_inner | epoch 128:   1943 / 1978 loss=2.935, nll_loss=0.802, word_ins=2.633, length=3.024, ppl=7.65, wps=25210.4, ups=0.42, wpb=59625, bsz=2076.3, num_updates=253100, lr=0.000198771, gnorm=1.336, loss_scale=8192, train_wall=236, wall=0
2023-03-04 01:22:16 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 01:22:29 | INFO | valid | epoch 128 | valid on 'valid' subset | loss 4.063 | nll_loss 1.912 | word_ins 3.679 | length 3.834 | ppl 16.71 | wps 31835.6 | wpb 40242.5 | bsz 1500 | num_updates 253135 | best_loss 4.034
2023-03-04 01:22:29 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 01:22:35 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint128.pt (epoch 128 @ 253135 updates, score 4.063) (writing took 5.738503781147301 seconds)
2023-03-04 01:22:35 | INFO | fairseq_cli.train | end of epoch 128 (average epoch stats below)
2023-03-04 01:22:35 | INFO | train | epoch 128 | loss 2.937 | nll_loss 0.797 | word_ins 2.629 | length 3.076 | ppl 7.66 | wps 24423 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 253135 | lr 0.000198758 | gnorm 1.383 | loss_scale 8192 | train_wall 4764 | wall 0
2023-03-04 01:22:35 | INFO | fairseq.trainer | begin training epoch 129
2023-03-04 01:25:19 | INFO | train_inner | epoch 129:     65 / 1978 loss=2.893, nll_loss=0.761, word_ins=2.596, length=2.977, ppl=7.43, wps=22341.8, ups=0.38, wpb=59314.7, bsz=2114.1, num_updates=253200, lr=0.000198732, gnorm=1.34, loss_scale=8192, train_wall=236, wall=0
2023-03-04 01:29:15 | INFO | train_inner | epoch 129:    165 / 1978 loss=2.927, nll_loss=0.789, word_ins=2.622, length=3.049, ppl=7.61, wps=25263.1, ups=0.42, wpb=59469.8, bsz=1959.4, num_updates=253300, lr=0.000198693, gnorm=1.432, loss_scale=8192, train_wall=235, wall=0
2023-03-04 01:33:10 | INFO | train_inner | epoch 129:    265 / 1978 loss=2.944, nll_loss=0.806, word_ins=2.638, length=3.065, ppl=7.7, wps=24982, ups=0.43, wpb=58778.8, bsz=1963.7, num_updates=253400, lr=0.000198654, gnorm=1.394, loss_scale=8192, train_wall=235, wall=0
2023-03-04 01:37:04 | INFO | train_inner | epoch 129:    365 / 1978 loss=2.926, nll_loss=0.787, word_ins=2.62, length=3.062, ppl=7.6, wps=24923.8, ups=0.43, wpb=58414.1, bsz=2022.3, num_updates=253500, lr=0.000198615, gnorm=1.285, loss_scale=8192, train_wall=234, wall=0
2023-03-04 01:41:01 | INFO | train_inner | epoch 129:    465 / 1978 loss=2.93, nll_loss=0.794, word_ins=2.627, length=3.036, ppl=7.62, wps=24925, ups=0.42, wpb=58921.2, bsz=2047, num_updates=253600, lr=0.000198575, gnorm=1.345, loss_scale=8192, train_wall=236, wall=0
2023-03-04 01:44:56 | INFO | train_inner | epoch 129:    565 / 1978 loss=2.948, nll_loss=0.809, word_ins=2.64, length=3.079, ppl=7.72, wps=25048.8, ups=0.42, wpb=58962.9, bsz=1962.3, num_updates=253700, lr=0.000198536, gnorm=1.41, loss_scale=8192, train_wall=235, wall=0
2023-03-04 01:49:03 | INFO | train_inner | epoch 129:    665 / 1978 loss=2.923, nll_loss=0.783, word_ins=2.616, length=3.072, ppl=7.59, wps=24193.7, ups=0.4, wpb=59748.8, bsz=2014.3, num_updates=253800, lr=0.000198497, gnorm=1.399, loss_scale=8192, train_wall=247, wall=0
2023-03-04 01:53:00 | INFO | train_inner | epoch 129:    765 / 1978 loss=2.927, nll_loss=0.787, word_ins=2.62, length=3.072, ppl=7.61, wps=25040.8, ups=0.42, wpb=59472, bsz=1975.7, num_updates=253900, lr=0.000198458, gnorm=1.414, loss_scale=8192, train_wall=237, wall=0
2023-03-04 01:58:30 | INFO | train_inner | epoch 129:    865 / 1978 loss=2.946, nll_loss=0.8, word_ins=2.631, length=3.146, ppl=7.7, wps=18054.4, ups=0.3, wpb=59451.1, bsz=1951.7, num_updates=254000, lr=0.000198419, gnorm=1.402, loss_scale=8192, train_wall=234, wall=0
2023-03-04 02:02:31 | INFO | train_inner | epoch 129:    965 / 1978 loss=2.94, nll_loss=0.801, word_ins=2.632, length=3.076, ppl=7.67, wps=24512.1, ups=0.41, wpb=59194.2, bsz=2016.3, num_updates=254100, lr=0.00019838, gnorm=1.363, loss_scale=8192, train_wall=241, wall=0
2023-03-04 02:06:27 | INFO | train_inner | epoch 129:   1065 / 1978 loss=2.95, nll_loss=0.812, word_ins=2.642, length=3.076, ppl=7.73, wps=25076.5, ups=0.42, wpb=59195, bsz=1930.7, num_updates=254200, lr=0.000198341, gnorm=1.362, loss_scale=8192, train_wall=236, wall=0
2023-03-04 02:10:24 | INFO | train_inner | epoch 129:   1165 / 1978 loss=2.929, nll_loss=0.789, word_ins=2.621, length=3.072, ppl=7.61, wps=25066.6, ups=0.42, wpb=59398.7, bsz=2011.1, num_updates=254300, lr=0.000198302, gnorm=1.42, loss_scale=8192, train_wall=236, wall=0
2023-03-04 02:14:22 | INFO | train_inner | epoch 129:   1265 / 1978 loss=2.921, nll_loss=0.786, word_ins=2.618, length=3.027, ppl=7.57, wps=25171.7, ups=0.42, wpb=59900.7, bsz=2071.3, num_updates=254400, lr=0.000198263, gnorm=1.385, loss_scale=8192, train_wall=238, wall=0
2023-03-04 02:18:19 | INFO | train_inner | epoch 129:   1365 / 1978 loss=2.941, nll_loss=0.804, word_ins=2.635, length=3.054, ppl=7.68, wps=25129.8, ups=0.42, wpb=59580.7, bsz=2066.9, num_updates=254500, lr=0.000198224, gnorm=1.366, loss_scale=8192, train_wall=235, wall=0
2023-03-04 02:22:16 | INFO | train_inner | epoch 129:   1465 / 1978 loss=2.928, nll_loss=0.79, word_ins=2.622, length=3.063, ppl=7.61, wps=25198, ups=0.42, wpb=59642.1, bsz=2040.2, num_updates=254600, lr=0.000198185, gnorm=1.402, loss_scale=8192, train_wall=236, wall=0
2023-03-04 02:26:13 | INFO | train_inner | epoch 129:   1565 / 1978 loss=2.933, nll_loss=0.794, word_ins=2.626, length=3.066, ppl=7.64, wps=24947.5, ups=0.42, wpb=59115, bsz=2084.8, num_updates=254700, lr=0.000198146, gnorm=1.383, loss_scale=8192, train_wall=234, wall=0
2023-03-04 02:30:09 | INFO | train_inner | epoch 129:   1665 / 1978 loss=2.932, nll_loss=0.797, word_ins=2.628, length=3.038, ppl=7.63, wps=25121.9, ups=0.42, wpb=59411.9, bsz=2073.5, num_updates=254800, lr=0.000198107, gnorm=1.359, loss_scale=8192, train_wall=236, wall=0
2023-03-04 02:34:04 | INFO | train_inner | epoch 129:   1765 / 1978 loss=2.946, nll_loss=0.801, word_ins=2.633, length=3.138, ppl=7.71, wps=25313.3, ups=0.43, wpb=59389.2, bsz=1947.7, num_updates=254900, lr=0.000198068, gnorm=1.413, loss_scale=8192, train_wall=234, wall=0
2023-03-04 02:37:59 | INFO | train_inner | epoch 129:   1865 / 1978 loss=2.953, nll_loss=0.813, word_ins=2.643, length=3.095, ppl=7.74, wps=25392.1, ups=0.43, wpb=59523.2, bsz=1958.4, num_updates=255000, lr=0.00019803, gnorm=1.435, loss_scale=8192, train_wall=234, wall=0
2023-03-04 02:41:52 | INFO | train_inner | epoch 129:   1965 / 1978 loss=2.953, nll_loss=0.812, word_ins=2.642, length=3.105, ppl=7.74, wps=25240.9, ups=0.43, wpb=59038.5, bsz=1896.6, num_updates=255100, lr=0.000197991, gnorm=1.434, loss_scale=8192, train_wall=234, wall=0
2023-03-04 02:42:22 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 02:42:38 | INFO | valid | epoch 129 | valid on 'valid' subset | loss 4.098 | nll_loss 1.931 | word_ins 3.692 | length 4.058 | ppl 17.12 | wps 29858.7 | wpb 40242.5 | bsz 1500 | num_updates 255113 | best_loss 4.034
2023-03-04 02:42:38 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 02:42:43 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint129.pt (epoch 129 @ 255113 updates, score 4.098) (writing took 5.606136574409902 seconds)
2023-03-04 02:42:43 | INFO | fairseq_cli.train | end of epoch 129 (average epoch stats below)
2023-03-04 02:42:43 | INFO | train | epoch 129 | loss 2.935 | nll_loss 0.797 | word_ins 2.628 | length 3.069 | ppl 7.65 | wps 24387.2 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 255113 | lr 0.000197986 | gnorm 1.387 | loss_scale 8192 | train_wall 4670 | wall 0
2023-03-04 02:42:43 | INFO | fairseq.trainer | begin training epoch 130
2023-03-04 02:46:17 | INFO | train_inner | epoch 130:     87 / 1978 loss=2.928, nll_loss=0.79, word_ins=2.623, length=3.047, ppl=7.61, wps=22083.8, ups=0.38, wpb=58505.2, bsz=2003.7, num_updates=255200, lr=0.000197952, gnorm=1.411, loss_scale=8192, train_wall=235, wall=0
2023-03-04 02:50:11 | INFO | train_inner | epoch 130:    187 / 1978 loss=2.924, nll_loss=0.785, word_ins=2.618, length=3.062, ppl=7.59, wps=25322.4, ups=0.43, wpb=59242.7, bsz=2008.1, num_updates=255300, lr=0.000197913, gnorm=1.351, loss_scale=8192, train_wall=234, wall=0
2023-03-04 02:54:07 | INFO | train_inner | epoch 130:    287 / 1978 loss=2.935, nll_loss=0.799, word_ins=2.631, length=3.045, ppl=7.65, wps=25180.3, ups=0.42, wpb=59416.2, bsz=1941.8, num_updates=255400, lr=0.000197874, gnorm=1.423, loss_scale=8192, train_wall=236, wall=0
2023-03-04 02:58:07 | INFO | train_inner | epoch 130:    387 / 1978 loss=2.931, nll_loss=0.795, word_ins=2.627, length=3.038, ppl=7.63, wps=24767.3, ups=0.42, wpb=59416.2, bsz=2058.6, num_updates=255500, lr=0.000197836, gnorm=1.401, loss_scale=8192, train_wall=240, wall=0
2023-03-04 03:02:04 | INFO | train_inner | epoch 130:    487 / 1978 loss=2.939, nll_loss=0.801, word_ins=2.633, length=3.065, ppl=7.67, wps=24946.5, ups=0.42, wpb=59124.3, bsz=2044.6, num_updates=255600, lr=0.000197797, gnorm=1.362, loss_scale=8192, train_wall=237, wall=0
2023-03-04 03:06:03 | INFO | train_inner | epoch 130:    587 / 1978 loss=2.916, nll_loss=0.779, word_ins=2.613, length=3.03, ppl=7.55, wps=25014.2, ups=0.42, wpb=59615.5, bsz=2047.8, num_updates=255700, lr=0.000197758, gnorm=1.363, loss_scale=8192, train_wall=238, wall=0
2023-03-04 03:10:01 | INFO | train_inner | epoch 130:    687 / 1978 loss=2.905, nll_loss=0.77, word_ins=2.604, length=3.005, ppl=7.49, wps=24884.4, ups=0.42, wpb=59241.4, bsz=2105.8, num_updates=255800, lr=0.00019772, gnorm=1.337, loss_scale=8192, train_wall=238, wall=0
2023-03-04 03:13:56 | INFO | train_inner | epoch 130:    787 / 1978 loss=2.942, nll_loss=0.804, word_ins=2.635, length=3.07, ppl=7.69, wps=24814.1, ups=0.42, wpb=58485.7, bsz=1990.4, num_updates=255900, lr=0.000197681, gnorm=1.368, loss_scale=8192, train_wall=235, wall=0
2023-03-04 03:17:54 | INFO | train_inner | epoch 130:    887 / 1978 loss=2.948, nll_loss=0.811, word_ins=2.642, length=3.066, ppl=7.72, wps=25002, ups=0.42, wpb=59460.8, bsz=1954.8, num_updates=256000, lr=0.000197642, gnorm=1.354, loss_scale=8192, train_wall=238, wall=0
2023-03-04 03:21:50 | INFO | train_inner | epoch 130:    987 / 1978 loss=2.923, nll_loss=0.787, word_ins=2.619, length=3.044, ppl=7.59, wps=25288.6, ups=0.42, wpb=59746.6, bsz=1984.8, num_updates=256100, lr=0.000197604, gnorm=1.425, loss_scale=8192, train_wall=236, wall=0
2023-03-04 03:25:47 | INFO | train_inner | epoch 130:   1087 / 1978 loss=2.94, nll_loss=0.8, word_ins=2.632, length=3.085, ppl=7.67, wps=24887.5, ups=0.42, wpb=58779.2, bsz=1995.5, num_updates=256200, lr=0.000197565, gnorm=1.401, loss_scale=8192, train_wall=236, wall=0
2023-03-04 03:29:44 | INFO | train_inner | epoch 130:   1187 / 1978 loss=2.926, nll_loss=0.791, word_ins=2.623, length=3.025, ppl=7.6, wps=24921.4, ups=0.42, wpb=59132.3, bsz=2124.9, num_updates=256300, lr=0.000197527, gnorm=1.335, loss_scale=8192, train_wall=237, wall=0
2023-03-04 03:33:39 | INFO | train_inner | epoch 130:   1287 / 1978 loss=2.948, nll_loss=0.809, word_ins=2.64, length=3.08, ppl=7.71, wps=25383.8, ups=0.42, wpb=59738.4, bsz=1927.1, num_updates=256400, lr=0.000197488, gnorm=1.45, loss_scale=8192, train_wall=235, wall=0
2023-03-04 03:37:38 | INFO | train_inner | epoch 130:   1387 / 1978 loss=2.939, nll_loss=0.799, word_ins=2.63, length=3.093, ppl=7.67, wps=24926.5, ups=0.42, wpb=59560.5, bsz=1953.1, num_updates=256500, lr=0.00019745, gnorm=1.412, loss_scale=8192, train_wall=239, wall=0
2023-03-04 03:39:29 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 03:41:38 | INFO | train_inner | epoch 130:   1488 / 1978 loss=2.961, nll_loss=0.818, word_ins=2.648, length=3.134, ppl=7.79, wps=24767.5, ups=0.42, wpb=59462.7, bsz=1928.6, num_updates=256600, lr=0.000197411, gnorm=1.496, loss_scale=8192, train_wall=240, wall=0
2023-03-04 03:45:46 | INFO | train_inner | epoch 130:   1588 / 1978 loss=2.937, nll_loss=0.797, word_ins=2.629, length=3.086, ppl=7.66, wps=23968.8, ups=0.4, wpb=59414.8, bsz=1961.4, num_updates=256700, lr=0.000197373, gnorm=1.424, loss_scale=8192, train_wall=238, wall=0
2023-03-04 03:51:23 | INFO | train_inner | epoch 130:   1688 / 1978 loss=2.922, nll_loss=0.783, word_ins=2.615, length=3.064, ppl=7.58, wps=17619.9, ups=0.3, wpb=59358.9, bsz=2025.4, num_updates=256800, lr=0.000197334, gnorm=1.375, loss_scale=8192, train_wall=337, wall=0
2023-03-04 03:55:21 | INFO | train_inner | epoch 130:   1788 / 1978 loss=2.948, nll_loss=0.804, word_ins=2.635, length=3.131, ppl=7.72, wps=24840.4, ups=0.42, wpb=59117.7, bsz=1951, num_updates=256900, lr=0.000197296, gnorm=1.356, loss_scale=8192, train_wall=238, wall=0
2023-03-04 03:59:18 | INFO | train_inner | epoch 130:   1888 / 1978 loss=2.922, nll_loss=0.784, word_ins=2.616, length=3.058, ppl=7.58, wps=25063.3, ups=0.42, wpb=59503.4, bsz=2037.5, num_updates=257000, lr=0.000197257, gnorm=1.339, loss_scale=8192, train_wall=237, wall=0
2023-03-04 04:02:52 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 04:03:06 | INFO | valid | epoch 130 | valid on 'valid' subset | loss 4.115 | nll_loss 1.94 | word_ins 3.703 | length 4.124 | ppl 17.33 | wps 28612.6 | wpb 40242.5 | bsz 1500 | num_updates 257090 | best_loss 4.034
2023-03-04 04:03:06 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 04:03:11 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint130.pt (epoch 130 @ 257090 updates, score 4.115) (writing took 5.705053749494255 seconds)
2023-03-04 04:03:11 | INFO | fairseq_cli.train | end of epoch 130 (average epoch stats below)
2023-03-04 04:03:11 | INFO | train | epoch 130 | loss 2.933 | nll_loss 0.795 | word_ins 2.627 | length 3.065 | ppl 7.64 | wps 24276.1 | ups 0.41 | wpb 59282.7 | bsz 2002.6 | num_updates 257090 | lr 0.000197223 | gnorm 1.389 | loss_scale 8192 | train_wall 4784 | wall 0
2023-03-04 04:03:11 | INFO | fairseq.trainer | begin training epoch 131
2023-03-04 04:03:44 | INFO | train_inner | epoch 131:     10 / 1978 loss=2.94, nll_loss=0.802, word_ins=2.633, length=3.067, ppl=7.67, wps=22373.2, ups=0.38, wpb=59321.1, bsz=1964.1, num_updates=257100, lr=0.000197219, gnorm=1.413, loss_scale=8192, train_wall=236, wall=0
2023-03-04 04:07:41 | INFO | train_inner | epoch 131:    110 / 1978 loss=2.94, nll_loss=0.803, word_ins=2.635, length=3.05, ppl=7.67, wps=24840.6, ups=0.42, wpb=58983, bsz=1959.3, num_updates=257200, lr=0.000197181, gnorm=1.399, loss_scale=8192, train_wall=237, wall=0
2023-03-04 04:11:40 | INFO | train_inner | epoch 131:    210 / 1978 loss=2.921, nll_loss=0.783, word_ins=2.616, length=3.049, ppl=7.57, wps=24884.5, ups=0.42, wpb=59435.4, bsz=2020.1, num_updates=257300, lr=0.000197142, gnorm=1.346, loss_scale=8192, train_wall=238, wall=0
2023-03-04 04:15:39 | INFO | train_inner | epoch 131:    310 / 1978 loss=2.924, nll_loss=0.786, word_ins=2.619, length=3.05, ppl=7.59, wps=24820.4, ups=0.42, wpb=59427.2, bsz=1938.8, num_updates=257400, lr=0.000197104, gnorm=1.399, loss_scale=8192, train_wall=239, wall=0
2023-03-04 04:19:38 | INFO | train_inner | epoch 131:    410 / 1978 loss=2.93, nll_loss=0.792, word_ins=2.624, length=3.057, ppl=7.62, wps=24834.7, ups=0.42, wpb=59394.8, bsz=2057.8, num_updates=257500, lr=0.000197066, gnorm=1.416, loss_scale=8192, train_wall=239, wall=0
2023-03-04 04:23:38 | INFO | train_inner | epoch 131:    510 / 1978 loss=2.895, nll_loss=0.765, word_ins=2.6, length=2.949, ppl=7.44, wps=24851.7, ups=0.42, wpb=59617.4, bsz=2116, num_updates=257600, lr=0.000197028, gnorm=1.333, loss_scale=8192, train_wall=240, wall=0
2023-03-04 04:27:38 | INFO | train_inner | epoch 131:    610 / 1978 loss=2.937, nll_loss=0.8, word_ins=2.631, length=3.058, ppl=7.66, wps=24516, ups=0.42, wpb=58727.8, bsz=2002.2, num_updates=257700, lr=0.000196989, gnorm=1.447, loss_scale=8192, train_wall=239, wall=0
2023-03-04 04:31:41 | INFO | train_inner | epoch 131:    710 / 1978 loss=2.951, nll_loss=0.811, word_ins=2.642, length=3.094, ppl=7.73, wps=24311.7, ups=0.41, wpb=59159.5, bsz=1950.7, num_updates=257800, lr=0.000196951, gnorm=1.4, loss_scale=8192, train_wall=243, wall=0
2023-03-04 04:35:40 | INFO | train_inner | epoch 131:    810 / 1978 loss=2.92, nll_loss=0.783, word_ins=2.616, length=3.043, ppl=7.57, wps=24854.3, ups=0.42, wpb=59291.9, bsz=2052.6, num_updates=257900, lr=0.000196913, gnorm=1.353, loss_scale=8192, train_wall=238, wall=0
2023-03-04 04:39:37 | INFO | train_inner | epoch 131:    910 / 1978 loss=2.907, nll_loss=0.772, word_ins=2.606, length=3.008, ppl=7.5, wps=25066.3, ups=0.42, wpb=59352.1, bsz=2140.4, num_updates=258000, lr=0.000196875, gnorm=1.387, loss_scale=8192, train_wall=237, wall=0
2023-03-04 04:43:42 | INFO | train_inner | epoch 131:   1010 / 1978 loss=2.941, nll_loss=0.8, word_ins=2.632, length=3.092, ppl=7.68, wps=24127.4, ups=0.41, wpb=59244, bsz=1950.3, num_updates=258100, lr=0.000196837, gnorm=1.392, loss_scale=8192, train_wall=245, wall=0
2023-03-04 04:47:44 | INFO | train_inner | epoch 131:   1110 / 1978 loss=2.934, nll_loss=0.794, word_ins=2.626, length=3.083, ppl=7.64, wps=24593.9, ups=0.41, wpb=59513.6, bsz=2045.8, num_updates=258200, lr=0.000196799, gnorm=1.373, loss_scale=8192, train_wall=242, wall=0
2023-03-04 04:51:50 | INFO | train_inner | epoch 131:   1210 / 1978 loss=2.956, nll_loss=0.817, word_ins=2.647, length=3.086, ppl=7.76, wps=23937.7, ups=0.41, wpb=58739.5, bsz=1937.2, num_updates=258300, lr=0.00019676, gnorm=1.402, loss_scale=8192, train_wall=245, wall=0
2023-03-04 04:55:52 | INFO | train_inner | epoch 131:   1310 / 1978 loss=2.941, nll_loss=0.803, word_ins=2.634, length=3.069, ppl=7.68, wps=24433.8, ups=0.41, wpb=59174.9, bsz=1993.4, num_updates=258400, lr=0.000196722, gnorm=1.396, loss_scale=8192, train_wall=242, wall=0
2023-03-04 04:59:49 | INFO | train_inner | epoch 131:   1410 / 1978 loss=2.935, nll_loss=0.796, word_ins=2.628, length=3.071, ppl=7.65, wps=24936, ups=0.42, wpb=59289.5, bsz=2045, num_updates=258500, lr=0.000196684, gnorm=1.4, loss_scale=8192, train_wall=237, wall=0
2023-03-04 05:03:50 | INFO | train_inner | epoch 131:   1510 / 1978 loss=2.927, nll_loss=0.792, word_ins=2.624, length=3.031, ppl=7.61, wps=24986.1, ups=0.42, wpb=60027, bsz=2056.2, num_updates=258600, lr=0.000196646, gnorm=1.378, loss_scale=8192, train_wall=240, wall=0
2023-03-04 05:07:46 | INFO | train_inner | epoch 131:   1610 / 1978 loss=2.961, nll_loss=0.813, word_ins=2.644, length=3.174, ppl=7.79, wps=24832.6, ups=0.42, wpb=58620.8, bsz=1865, num_updates=258700, lr=0.000196608, gnorm=1.428, loss_scale=8192, train_wall=236, wall=0
2023-03-04 05:11:43 | INFO | train_inner | epoch 131:   1710 / 1978 loss=2.92, nll_loss=0.78, word_ins=2.613, length=3.073, ppl=7.57, wps=25007.5, ups=0.42, wpb=59429.2, bsz=2003.2, num_updates=258800, lr=0.00019657, gnorm=1.38, loss_scale=8192, train_wall=237, wall=0
2023-03-04 05:15:54 | INFO | train_inner | epoch 131:   1810 / 1978 loss=2.94, nll_loss=0.799, word_ins=2.63, length=3.095, ppl=7.67, wps=23623.9, ups=0.4, wpb=59205.9, bsz=1961.5, num_updates=258900, lr=0.000196532, gnorm=1.374, loss_scale=8192, train_wall=249, wall=0
2023-03-04 05:19:53 | INFO | train_inner | epoch 131:   1910 / 1978 loss=2.929, nll_loss=0.788, word_ins=2.62, length=3.091, ppl=7.62, wps=24886.6, ups=0.42, wpb=59442.3, bsz=1973.8, num_updates=259000, lr=0.000196494, gnorm=1.376, loss_scale=8192, train_wall=239, wall=0
2023-03-04 05:22:38 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 05:22:52 | INFO | valid | epoch 131 | valid on 'valid' subset | loss 4.121 | nll_loss 1.925 | word_ins 3.688 | length 4.332 | ppl 17.4 | wps 22399.3 | wpb 40242.5 | bsz 1500 | num_updates 259068 | best_loss 4.034
2023-03-04 05:22:52 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 05:22:58 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint131.pt (epoch 131 @ 259068 updates, score 4.121) (writing took 5.754134381189942 seconds)
2023-03-04 05:22:58 | INFO | fairseq_cli.train | end of epoch 131 (average epoch stats below)
2023-03-04 05:22:58 | INFO | train | epoch 131 | loss 2.933 | nll_loss 0.794 | word_ins 2.626 | length 3.064 | ppl 7.64 | wps 24496.7 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 259068 | lr 0.000196469 | gnorm 1.392 | loss_scale 8192 | train_wall 4747 | wall 0
2023-03-04 05:22:58 | INFO | fairseq.trainer | begin training epoch 132
2023-03-04 05:24:21 | INFO | train_inner | epoch 132:     32 / 1978 loss=2.941, nll_loss=0.804, word_ins=2.635, length=3.052, ppl=7.68, wps=22192.9, ups=0.37, wpb=59464.8, bsz=1960.4, num_updates=259100, lr=0.000196456, gnorm=1.466, loss_scale=8192, train_wall=236, wall=0
2023-03-04 05:28:19 | INFO | train_inner | epoch 132:    132 / 1978 loss=2.925, nll_loss=0.791, word_ins=2.623, length=3.019, ppl=7.6, wps=24688.6, ups=0.42, wpb=58792.1, bsz=2050.2, num_updates=259200, lr=0.000196419, gnorm=1.393, loss_scale=8192, train_wall=238, wall=0
2023-03-04 05:32:16 | INFO | train_inner | epoch 132:    232 / 1978 loss=2.929, nll_loss=0.79, word_ins=2.623, length=3.067, ppl=7.62, wps=24841.3, ups=0.42, wpb=58800.7, bsz=1983.4, num_updates=259300, lr=0.000196381, gnorm=1.362, loss_scale=8192, train_wall=236, wall=0
2023-03-04 05:36:13 | INFO | train_inner | epoch 132:    332 / 1978 loss=2.945, nll_loss=0.805, word_ins=2.636, length=3.092, ppl=7.7, wps=25067.8, ups=0.42, wpb=59575.2, bsz=1939, num_updates=259400, lr=0.000196343, gnorm=1.425, loss_scale=8192, train_wall=237, wall=0
2023-03-04 05:40:13 | INFO | train_inner | epoch 132:    432 / 1978 loss=2.891, nll_loss=0.761, word_ins=2.596, length=2.952, ppl=7.42, wps=24826.1, ups=0.42, wpb=59541.4, bsz=2132.7, num_updates=259500, lr=0.000196305, gnorm=1.328, loss_scale=8192, train_wall=240, wall=0
2023-03-04 05:45:48 | INFO | train_inner | epoch 132:    532 / 1978 loss=2.931, nll_loss=0.796, word_ins=2.628, length=3.029, ppl=7.63, wps=17708.6, ups=0.3, wpb=59359, bsz=2041.5, num_updates=259600, lr=0.000196267, gnorm=1.407, loss_scale=8192, train_wall=335, wall=0
2023-03-04 05:51:33 | INFO | train_inner | epoch 132:    632 / 1978 loss=2.938, nll_loss=0.796, word_ins=2.627, length=3.107, ppl=7.66, wps=17224.8, ups=0.29, wpb=59269.7, bsz=1973.1, num_updates=259700, lr=0.000196229, gnorm=1.411, loss_scale=8192, train_wall=344, wall=0
2023-03-04 05:55:32 | INFO | train_inner | epoch 132:    732 / 1978 loss=2.919, nll_loss=0.781, word_ins=2.615, length=3.044, ppl=7.56, wps=24690.9, ups=0.42, wpb=59000.1, bsz=2029.6, num_updates=259800, lr=0.000196192, gnorm=1.445, loss_scale=8192, train_wall=239, wall=0
2023-03-04 06:01:44 | INFO | train_inner | epoch 132:    832 / 1978 loss=2.921, nll_loss=0.789, word_ins=2.622, length=2.99, ppl=7.57, wps=15911.7, ups=0.27, wpb=59258.6, bsz=2066.4, num_updates=259900, lr=0.000196154, gnorm=1.371, loss_scale=8192, train_wall=372, wall=0
2023-03-04 06:05:42 | INFO | train_inner | epoch 132:    932 / 1978 loss=2.93, nll_loss=0.79, word_ins=2.622, length=3.077, ppl=7.62, wps=24900.6, ups=0.42, wpb=59371, bsz=1967, num_updates=260000, lr=0.000196116, gnorm=1.373, loss_scale=8192, train_wall=238, wall=0
2023-03-04 06:09:39 | INFO | train_inner | epoch 132:   1032 / 1978 loss=2.941, nll_loss=0.796, word_ins=2.628, length=3.129, ppl=7.68, wps=25171.3, ups=0.42, wpb=59630, bsz=1955.4, num_updates=260100, lr=0.000196078, gnorm=1.369, loss_scale=8192, train_wall=237, wall=0
2023-03-04 06:13:36 | INFO | train_inner | epoch 132:   1132 / 1978 loss=2.942, nll_loss=0.799, word_ins=2.63, length=3.112, ppl=7.68, wps=24863.7, ups=0.42, wpb=58844, bsz=1947.2, num_updates=260200, lr=0.000196041, gnorm=1.35, loss_scale=8192, train_wall=236, wall=0
2023-03-04 06:17:33 | INFO | train_inner | epoch 132:   1232 / 1978 loss=2.922, nll_loss=0.787, word_ins=2.62, length=3.025, ppl=7.58, wps=25135.7, ups=0.42, wpb=59481.8, bsz=2098.7, num_updates=260300, lr=0.000196003, gnorm=1.374, loss_scale=8192, train_wall=236, wall=0
2023-03-04 06:21:30 | INFO | train_inner | epoch 132:   1332 / 1978 loss=2.94, nll_loss=0.803, word_ins=2.635, length=3.051, ppl=7.67, wps=24858.8, ups=0.42, wpb=58991.1, bsz=1981.4, num_updates=260400, lr=0.000195965, gnorm=1.352, loss_scale=8192, train_wall=237, wall=0
2023-03-04 06:25:26 | INFO | train_inner | epoch 132:   1432 / 1978 loss=2.949, nll_loss=0.81, word_ins=2.641, length=3.085, ppl=7.72, wps=25216.9, ups=0.42, wpb=59541.4, bsz=1895.9, num_updates=260500, lr=0.000195928, gnorm=1.439, loss_scale=8192, train_wall=236, wall=0
2023-03-04 06:29:20 | INFO | train_inner | epoch 132:   1532 / 1978 loss=2.945, nll_loss=0.803, word_ins=2.633, length=3.118, ppl=7.7, wps=25275.8, ups=0.43, wpb=59219.6, bsz=1952.7, num_updates=260600, lr=0.00019589, gnorm=1.398, loss_scale=8192, train_wall=234, wall=0
2023-03-04 06:31:02 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 06:33:21 | INFO | train_inner | epoch 132:   1633 / 1978 loss=2.915, nll_loss=0.78, word_ins=2.612, length=3.033, ppl=7.54, wps=24823.6, ups=0.42, wpb=59672.2, bsz=2048.5, num_updates=260700, lr=0.000195853, gnorm=1.377, loss_scale=8192, train_wall=240, wall=0
2023-03-04 06:37:18 | INFO | train_inner | epoch 132:   1733 / 1978 loss=2.94, nll_loss=0.8, word_ins=2.632, length=3.089, ppl=7.68, wps=25017.2, ups=0.42, wpb=59277.6, bsz=1943.1, num_updates=260800, lr=0.000195815, gnorm=1.43, loss_scale=8192, train_wall=237, wall=0
2023-03-04 06:41:14 | INFO | train_inner | epoch 132:   1833 / 1978 loss=2.931, nll_loss=0.792, word_ins=2.624, length=3.068, ppl=7.62, wps=25275.1, ups=0.42, wpb=59825.4, bsz=1993.4, num_updates=260900, lr=0.000195778, gnorm=1.374, loss_scale=8192, train_wall=236, wall=0
2023-03-04 06:45:18 | INFO | train_inner | epoch 132:   1933 / 1978 loss=2.924, nll_loss=0.786, word_ins=2.618, length=3.055, ppl=7.59, wps=24397.2, ups=0.41, wpb=59340.5, bsz=2043.5, num_updates=261000, lr=0.00019574, gnorm=1.342, loss_scale=8192, train_wall=243, wall=0
2023-03-04 06:47:05 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 06:47:21 | INFO | valid | epoch 132 | valid on 'valid' subset | loss 4.083 | nll_loss 1.918 | word_ins 3.682 | length 4.013 | ppl 16.95 | wps 28500.4 | wpb 40242.5 | bsz 1500 | num_updates 261045 | best_loss 4.034
2023-03-04 06:47:21 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 06:47:26 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint132.pt (epoch 132 @ 261045 updates, score 4.083) (writing took 5.357746437191963 seconds)
2023-03-04 06:47:26 | INFO | fairseq_cli.train | end of epoch 132 (average epoch stats below)
2023-03-04 06:47:26 | INFO | train | epoch 132 | loss 2.931 | nll_loss 0.793 | word_ins 2.625 | length 3.058 | ppl 7.62 | wps 23125.2 | ups 0.39 | wpb 59282.9 | bsz 2002.3 | num_updates 261045 | lr 0.000195723 | gnorm 1.387 | loss_scale 8192 | train_wall 5032 | wall 0
2023-03-04 06:47:26 | INFO | fairseq.trainer | begin training epoch 133
2023-03-04 06:49:44 | INFO | train_inner | epoch 133:     55 / 1978 loss=2.923, nll_loss=0.791, word_ins=2.624, length=2.987, ppl=7.58, wps=22062.9, ups=0.38, wpb=58755.5, bsz=2060.4, num_updates=261100, lr=0.000195703, gnorm=1.436, loss_scale=8192, train_wall=235, wall=0
2023-03-04 06:53:41 | INFO | train_inner | epoch 133:    155 / 1978 loss=2.93, nll_loss=0.791, word_ins=2.624, length=3.059, ppl=7.62, wps=24853.4, ups=0.42, wpb=58898.1, bsz=2003.8, num_updates=261200, lr=0.000195665, gnorm=1.4, loss_scale=8192, train_wall=237, wall=0
2023-03-04 06:57:37 | INFO | train_inner | epoch 133:    255 / 1978 loss=2.932, nll_loss=0.791, word_ins=2.623, length=3.09, ppl=7.63, wps=25039, ups=0.42, wpb=59045.9, bsz=1987.4, num_updates=261300, lr=0.000195628, gnorm=1.404, loss_scale=8192, train_wall=235, wall=0
2023-03-04 07:01:33 | INFO | train_inner | epoch 133:    355 / 1978 loss=2.936, nll_loss=0.795, word_ins=2.627, length=3.097, ppl=7.66, wps=25459.9, ups=0.42, wpb=60063.6, bsz=1935.9, num_updates=261400, lr=0.00019559, gnorm=1.418, loss_scale=8192, train_wall=235, wall=0
2023-03-04 07:05:32 | INFO | train_inner | epoch 133:    455 / 1978 loss=2.918, nll_loss=0.782, word_ins=2.615, length=3.026, ppl=7.56, wps=24947, ups=0.42, wpb=59652.5, bsz=2061.5, num_updates=261500, lr=0.000195553, gnorm=1.363, loss_scale=8192, train_wall=237, wall=0
2023-03-04 07:09:30 | INFO | train_inner | epoch 133:    555 / 1978 loss=2.914, nll_loss=0.779, word_ins=2.613, length=3.009, ppl=7.53, wps=24560.8, ups=0.42, wpb=58553.7, bsz=2136.2, num_updates=261600, lr=0.000195515, gnorm=1.369, loss_scale=8192, train_wall=238, wall=0
2023-03-04 07:13:27 | INFO | train_inner | epoch 133:    655 / 1978 loss=2.932, nll_loss=0.799, word_ins=2.63, length=3.017, ppl=7.63, wps=25293.4, ups=0.42, wpb=59785.2, bsz=2004.6, num_updates=261700, lr=0.000195478, gnorm=1.418, loss_scale=8192, train_wall=236, wall=0
2023-03-04 07:17:23 | INFO | train_inner | epoch 133:    755 / 1978 loss=2.933, nll_loss=0.792, word_ins=2.624, length=3.091, ppl=7.64, wps=25065.9, ups=0.42, wpb=59254.6, bsz=2027.3, num_updates=261800, lr=0.000195441, gnorm=1.421, loss_scale=8192, train_wall=236, wall=0
2023-03-04 07:21:19 | INFO | train_inner | epoch 133:    855 / 1978 loss=2.934, nll_loss=0.796, word_ins=2.628, length=3.057, ppl=7.64, wps=25094.3, ups=0.42, wpb=59320.4, bsz=2003.3, num_updates=261900, lr=0.000195403, gnorm=1.401, loss_scale=8192, train_wall=236, wall=0
2023-03-04 07:25:14 | INFO | train_inner | epoch 133:    955 / 1978 loss=2.965, nll_loss=0.82, word_ins=2.65, length=3.151, ppl=7.81, wps=24990.6, ups=0.43, wpb=58691.6, bsz=1880.8, num_updates=262000, lr=0.000195366, gnorm=1.479, loss_scale=8192, train_wall=235, wall=0
2023-03-04 07:29:07 | INFO | train_inner | epoch 133:   1055 / 1978 loss=2.924, nll_loss=0.785, word_ins=2.618, length=3.058, ppl=7.59, wps=25496.2, ups=0.43, wpb=59464.3, bsz=2006.2, num_updates=262100, lr=0.000195329, gnorm=1.354, loss_scale=8192, train_wall=233, wall=0
2023-03-04 07:32:59 | INFO | train_inner | epoch 133:   1155 / 1978 loss=2.94, nll_loss=0.799, word_ins=2.631, length=3.098, ppl=7.68, wps=25615.1, ups=0.43, wpb=59300.5, bsz=1943.3, num_updates=262200, lr=0.000195292, gnorm=1.372, loss_scale=8192, train_wall=231, wall=0
2023-03-04 07:36:59 | INFO | train_inner | epoch 133:   1255 / 1978 loss=2.921, nll_loss=0.789, word_ins=2.622, length=2.994, ppl=7.57, wps=24718, ups=0.42, wpb=59246.4, bsz=2020.9, num_updates=262300, lr=0.000195254, gnorm=1.362, loss_scale=8192, train_wall=239, wall=0
2023-03-04 07:42:40 | INFO | train_inner | epoch 133:   1355 / 1978 loss=2.919, nll_loss=0.781, word_ins=2.615, length=3.044, ppl=7.56, wps=17194.9, ups=0.29, wpb=58683, bsz=2037.1, num_updates=262400, lr=0.000195217, gnorm=1.367, loss_scale=8192, train_wall=341, wall=0
2023-03-04 07:46:34 | INFO | train_inner | epoch 133:   1455 / 1978 loss=2.929, nll_loss=0.794, word_ins=2.626, length=3.031, ppl=7.62, wps=25308.4, ups=0.43, wpb=59302.9, bsz=1994.4, num_updates=262500, lr=0.00019518, gnorm=1.456, loss_scale=8192, train_wall=234, wall=0
2023-03-04 07:50:32 | INFO | train_inner | epoch 133:   1555 / 1978 loss=2.945, nll_loss=0.805, word_ins=2.636, length=3.097, ppl=7.7, wps=24961.2, ups=0.42, wpb=59258.4, bsz=1976.7, num_updates=262600, lr=0.000195143, gnorm=1.392, loss_scale=8192, train_wall=237, wall=0
2023-03-04 07:54:27 | INFO | train_inner | epoch 133:   1655 / 1978 loss=2.934, nll_loss=0.795, word_ins=2.626, length=3.08, ppl=7.64, wps=25277.2, ups=0.42, wpb=59577.2, bsz=1995.5, num_updates=262700, lr=0.000195106, gnorm=1.428, loss_scale=8192, train_wall=235, wall=0
2023-03-04 07:58:21 | INFO | train_inner | epoch 133:   1755 / 1978 loss=2.907, nll_loss=0.774, word_ins=2.607, length=3.002, ppl=7.5, wps=25601.4, ups=0.43, wpb=59770.3, bsz=2073.8, num_updates=262800, lr=0.000195069, gnorm=1.376, loss_scale=8192, train_wall=233, wall=0
2023-03-04 08:02:15 | INFO | train_inner | epoch 133:   1855 / 1978 loss=2.929, nll_loss=0.79, word_ins=2.622, length=3.067, ppl=7.62, wps=25317.6, ups=0.43, wpb=59279.7, bsz=1980, num_updates=262900, lr=0.000195031, gnorm=1.388, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:06:09 | INFO | train_inner | epoch 133:   1955 / 1978 loss=2.938, nll_loss=0.799, word_ins=2.63, length=3.072, ppl=7.66, wps=25370.9, ups=0.43, wpb=59431.7, bsz=1984.8, num_updates=263000, lr=0.000194994, gnorm=1.343, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:07:03 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 08:07:19 | INFO | valid | epoch 133 | valid on 'valid' subset | loss 4.068 | nll_loss 1.902 | word_ins 3.669 | length 3.994 | ppl 16.78 | wps 23272.6 | wpb 40242.5 | bsz 1500 | num_updates 263023 | best_loss 4.034
2023-03-04 08:07:19 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 08:07:24 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint133.pt (epoch 133 @ 263023 updates, score 4.068) (writing took 5.576400735415518 seconds)
2023-03-04 08:07:24 | INFO | fairseq_cli.train | end of epoch 133 (average epoch stats below)
2023-03-04 08:07:24 | INFO | train | epoch 133 | loss 2.93 | nll_loss 0.792 | word_ins 2.624 | length 3.058 | ppl 7.62 | wps 24439.6 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 263023 | lr 0.000194986 | gnorm 1.396 | loss_scale 8192 | train_wall 4759 | wall 0
2023-03-04 08:07:24 | INFO | fairseq.trainer | begin training epoch 134
2023-03-04 08:10:35 | INFO | train_inner | epoch 134:     77 / 1978 loss=2.911, nll_loss=0.778, word_ins=2.612, length=2.993, ppl=7.52, wps=22211.5, ups=0.38, wpb=58942.6, bsz=2034.6, num_updates=263100, lr=0.000194957, gnorm=1.38, loss_scale=8192, train_wall=231, wall=0
2023-03-04 08:14:31 | INFO | train_inner | epoch 134:    177 / 1978 loss=2.908, nll_loss=0.774, word_ins=2.608, length=2.999, ppl=7.51, wps=25024.1, ups=0.42, wpb=59108.6, bsz=2062.2, num_updates=263200, lr=0.00019492, gnorm=1.383, loss_scale=8192, train_wall=236, wall=0
2023-03-04 08:18:25 | INFO | train_inner | epoch 134:    277 / 1978 loss=2.929, nll_loss=0.791, word_ins=2.624, length=3.045, ppl=7.61, wps=25182, ups=0.43, wpb=58901.8, bsz=1977.8, num_updates=263300, lr=0.000194883, gnorm=1.397, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:22:19 | INFO | train_inner | epoch 134:    377 / 1978 loss=2.93, nll_loss=0.789, word_ins=2.621, length=3.086, ppl=7.62, wps=25254.6, ups=0.43, wpb=59223.2, bsz=1969.4, num_updates=263400, lr=0.000194846, gnorm=1.379, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:26:17 | INFO | train_inner | epoch 134:    477 / 1978 loss=2.907, nll_loss=0.778, word_ins=2.611, length=2.963, ppl=7.5, wps=25153.6, ups=0.42, wpb=59801.3, bsz=2121, num_updates=263500, lr=0.000194809, gnorm=1.319, loss_scale=8192, train_wall=237, wall=0
2023-03-04 08:30:11 | INFO | train_inner | epoch 134:    577 / 1978 loss=2.928, nll_loss=0.788, word_ins=2.62, length=3.079, ppl=7.61, wps=25176.4, ups=0.43, wpb=58997.7, bsz=2016.6, num_updates=263600, lr=0.000194772, gnorm=1.344, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:34:06 | INFO | train_inner | epoch 134:    677 / 1978 loss=2.917, nll_loss=0.779, word_ins=2.613, length=3.044, ppl=7.55, wps=25397.7, ups=0.43, wpb=59619.4, bsz=2037.3, num_updates=263700, lr=0.000194735, gnorm=1.393, loss_scale=8192, train_wall=235, wall=0
2023-03-04 08:37:59 | INFO | train_inner | epoch 134:    777 / 1978 loss=2.939, nll_loss=0.801, word_ins=2.632, length=3.062, ppl=7.67, wps=25624.4, ups=0.43, wpb=59693.8, bsz=1925.9, num_updates=263800, lr=0.000194698, gnorm=1.438, loss_scale=8192, train_wall=233, wall=0
2023-03-04 08:41:55 | INFO | train_inner | epoch 134:    877 / 1978 loss=2.923, nll_loss=0.786, word_ins=2.618, length=3.048, ppl=7.58, wps=25357.6, ups=0.42, wpb=59756.2, bsz=2060.6, num_updates=263900, lr=0.000194662, gnorm=1.439, loss_scale=8192, train_wall=235, wall=0
2023-03-04 08:45:49 | INFO | train_inner | epoch 134:    977 / 1978 loss=2.93, nll_loss=0.79, word_ins=2.622, length=3.079, ppl=7.62, wps=25504.8, ups=0.43, wpb=59868.4, bsz=1978.2, num_updates=264000, lr=0.000194625, gnorm=1.419, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:49:45 | INFO | train_inner | epoch 134:   1077 / 1978 loss=2.921, nll_loss=0.784, word_ins=2.616, length=3.049, ppl=7.58, wps=25146.4, ups=0.42, wpb=59278.8, bsz=2057, num_updates=264100, lr=0.000194588, gnorm=1.359, loss_scale=8192, train_wall=235, wall=0
2023-03-04 08:53:39 | INFO | train_inner | epoch 134:   1177 / 1978 loss=2.925, nll_loss=0.786, word_ins=2.619, length=3.053, ppl=7.59, wps=25199, ups=0.43, wpb=58929.1, bsz=1974.3, num_updates=264200, lr=0.000194551, gnorm=1.439, loss_scale=8192, train_wall=234, wall=0
2023-03-04 08:57:33 | INFO | train_inner | epoch 134:   1277 / 1978 loss=2.941, nll_loss=0.805, word_ins=2.635, length=3.055, ppl=7.68, wps=25134.3, ups=0.43, wpb=58892.4, bsz=1947.2, num_updates=264300, lr=0.000194514, gnorm=1.4, loss_scale=8192, train_wall=234, wall=0
2023-03-04 09:01:29 | INFO | train_inner | epoch 134:   1377 / 1978 loss=2.909, nll_loss=0.776, word_ins=2.609, length=2.996, ppl=7.51, wps=25348, ups=0.42, wpb=59812, bsz=2075.8, num_updates=264400, lr=0.000194477, gnorm=1.392, loss_scale=8192, train_wall=236, wall=0
2023-03-04 09:05:23 | INFO | train_inner | epoch 134:   1477 / 1978 loss=2.954, nll_loss=0.808, word_ins=2.639, length=3.149, ppl=7.75, wps=25255.8, ups=0.43, wpb=59051.2, bsz=1907.8, num_updates=264500, lr=0.000194441, gnorm=1.443, loss_scale=8192, train_wall=233, wall=0
2023-03-04 09:09:16 | INFO | train_inner | epoch 134:   1577 / 1978 loss=2.952, nll_loss=0.812, word_ins=2.642, length=3.097, ppl=7.74, wps=25267.2, ups=0.43, wpb=58874.3, bsz=1906.7, num_updates=264600, lr=0.000194404, gnorm=1.455, loss_scale=8192, train_wall=233, wall=0
2023-03-04 09:13:11 | INFO | train_inner | epoch 134:   1677 / 1978 loss=2.944, nll_loss=0.801, word_ins=2.633, length=3.117, ppl=7.7, wps=25082, ups=0.43, wpb=58859.7, bsz=1965, num_updates=264700, lr=0.000194367, gnorm=1.438, loss_scale=8192, train_wall=234, wall=0
2023-03-04 09:14:51 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 09:17:08 | INFO | train_inner | epoch 134:   1778 / 1978 loss=2.931, nll_loss=0.794, word_ins=2.626, length=3.05, ppl=7.63, wps=24973, ups=0.42, wpb=59287.3, bsz=2053.2, num_updates=264800, lr=0.000194331, gnorm=1.388, loss_scale=8192, train_wall=237, wall=0
2023-03-04 09:21:03 | INFO | train_inner | epoch 134:   1878 / 1978 loss=2.936, nll_loss=0.798, word_ins=2.629, length=3.074, ppl=7.66, wps=25342.2, ups=0.43, wpb=59381.5, bsz=1982.8, num_updates=264900, lr=0.000194294, gnorm=1.439, loss_scale=8192, train_wall=234, wall=0
2023-03-04 09:24:59 | INFO | train_inner | epoch 134:   1978 / 1978 loss=2.929, nll_loss=0.791, word_ins=2.623, length=3.063, ppl=7.62, wps=25157.6, ups=0.42, wpb=59392.7, bsz=1982.2, num_updates=265000, lr=0.000194257, gnorm=1.442, loss_scale=8192, train_wall=234, wall=0
2023-03-04 09:24:59 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 09:25:13 | INFO | valid | epoch 134 | valid on 'valid' subset | loss 4.063 | nll_loss 1.91 | word_ins 3.673 | length 3.903 | ppl 16.71 | wps 30606 | wpb 40242.5 | bsz 1500 | num_updates 265000 | best_loss 4.034
2023-03-04 09:25:13 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 09:25:19 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint134.pt (epoch 134 @ 265000 updates, score 4.063) (writing took 6.022040725685656 seconds)
2023-03-04 09:25:19 | INFO | fairseq_cli.train | end of epoch 134 (average epoch stats below)
2023-03-04 09:25:19 | INFO | train | epoch 134 | loss 2.928 | nll_loss 0.791 | word_ins 2.623 | length 3.056 | ppl 7.61 | wps 25072.5 | ups 0.42 | wpb 59283.5 | bsz 2002.7 | num_updates 265000 | lr 0.000194257 | gnorm 1.404 | loss_scale 8192 | train_wall 4635 | wall 0
2023-03-04 09:25:19 | INFO | fairseq.trainer | begin training epoch 135
2023-03-04 09:29:25 | INFO | train_inner | epoch 135:    100 / 1978 loss=2.927, nll_loss=0.791, word_ins=2.624, length=3.035, ppl=7.61, wps=22317.7, ups=0.38, wpb=59379.4, bsz=1953.7, num_updates=265100, lr=0.000194221, gnorm=1.411, loss_scale=8192, train_wall=233, wall=0
2023-03-04 09:33:24 | INFO | train_inner | epoch 135:    200 / 1978 loss=2.916, nll_loss=0.778, word_ins=2.612, length=3.039, ppl=7.55, wps=24758.6, ups=0.42, wpb=59296, bsz=2025.4, num_updates=265200, lr=0.000194184, gnorm=1.526, loss_scale=8192, train_wall=239, wall=0
2023-03-04 09:37:21 | INFO | train_inner | epoch 135:    300 / 1978 loss=2.917, nll_loss=0.782, word_ins=2.615, length=3.027, ppl=7.55, wps=25053.6, ups=0.42, wpb=59447.3, bsz=2000.2, num_updates=265300, lr=0.000194147, gnorm=1.481, loss_scale=8192, train_wall=237, wall=0
2023-03-04 09:41:17 | INFO | train_inner | epoch 135:    400 / 1978 loss=2.908, nll_loss=0.772, word_ins=2.606, length=3.014, ppl=7.5, wps=25440.1, ups=0.42, wpb=59874.7, bsz=2049.8, num_updates=265400, lr=0.000194111, gnorm=1.406, loss_scale=8192, train_wall=235, wall=0
2023-03-04 09:45:13 | INFO | train_inner | epoch 135:    500 / 1978 loss=2.942, nll_loss=0.799, word_ins=2.631, length=3.106, ppl=7.68, wps=24979.5, ups=0.42, wpb=58964.7, bsz=1958.6, num_updates=265500, lr=0.000194074, gnorm=1.428, loss_scale=8192, train_wall=236, wall=0
2023-03-04 09:49:05 | INFO | train_inner | epoch 135:    600 / 1978 loss=2.942, nll_loss=0.803, word_ins=2.634, length=3.074, ppl=7.68, wps=25495.7, ups=0.43, wpb=59218.9, bsz=1966.4, num_updates=265600, lr=0.000194038, gnorm=1.361, loss_scale=8192, train_wall=232, wall=0
2023-03-04 09:52:57 | INFO | train_inner | epoch 135:    700 / 1978 loss=2.93, nll_loss=0.794, word_ins=2.626, length=3.041, ppl=7.62, wps=25457.9, ups=0.43, wpb=58934.4, bsz=1978.9, num_updates=265700, lr=0.000194001, gnorm=1.333, loss_scale=8192, train_wall=231, wall=0
2023-03-04 09:56:56 | INFO | train_inner | epoch 135:    800 / 1978 loss=2.938, nll_loss=0.797, word_ins=2.629, length=3.089, ppl=7.66, wps=24786.2, ups=0.42, wpb=59357.8, bsz=1974.6, num_updates=265800, lr=0.000193965, gnorm=1.401, loss_scale=8192, train_wall=239, wall=0
2023-03-04 10:00:55 | INFO | train_inner | epoch 135:    900 / 1978 loss=2.934, nll_loss=0.799, word_ins=2.63, length=3.032, ppl=7.64, wps=24740.7, ups=0.42, wpb=59055.2, bsz=2007.8, num_updates=265900, lr=0.000193928, gnorm=1.398, loss_scale=8192, train_wall=238, wall=0
2023-03-04 10:04:51 | INFO | train_inner | epoch 135:   1000 / 1978 loss=2.919, nll_loss=0.782, word_ins=2.615, length=3.037, ppl=7.56, wps=25255.6, ups=0.42, wpb=59630.7, bsz=2056.3, num_updates=266000, lr=0.000193892, gnorm=1.391, loss_scale=8192, train_wall=236, wall=0
2023-03-04 10:08:50 | INFO | train_inner | epoch 135:   1100 / 1978 loss=2.93, nll_loss=0.788, word_ins=2.621, length=3.091, ppl=7.62, wps=24937.6, ups=0.42, wpb=59709.8, bsz=1963.3, num_updates=266100, lr=0.000193855, gnorm=1.461, loss_scale=8192, train_wall=239, wall=0
2023-03-04 10:12:52 | INFO | train_inner | epoch 135:   1200 / 1978 loss=2.934, nll_loss=0.79, word_ins=2.622, length=3.123, ppl=7.64, wps=24464.8, ups=0.41, wpb=59189.3, bsz=1963.2, num_updates=266200, lr=0.000193819, gnorm=1.44, loss_scale=8192, train_wall=242, wall=0
2023-03-04 10:16:52 | INFO | train_inner | epoch 135:   1300 / 1978 loss=2.921, nll_loss=0.783, word_ins=2.615, length=3.052, ppl=7.57, wps=24777.3, ups=0.42, wpb=59453, bsz=1964.6, num_updates=266300, lr=0.000193782, gnorm=1.441, loss_scale=8192, train_wall=240, wall=0
2023-03-04 10:20:56 | INFO | train_inner | epoch 135:   1400 / 1978 loss=2.906, nll_loss=0.774, word_ins=2.608, length=2.977, ppl=7.49, wps=24487.6, ups=0.41, wpb=59599.2, bsz=2145.8, num_updates=266400, lr=0.000193746, gnorm=1.388, loss_scale=8192, train_wall=243, wall=0
2023-03-04 10:24:55 | INFO | train_inner | epoch 135:   1500 / 1978 loss=2.947, nll_loss=0.804, word_ins=2.635, length=3.117, ppl=7.71, wps=24674.8, ups=0.42, wpb=58947.8, bsz=1964.4, num_updates=266500, lr=0.00019371, gnorm=1.422, loss_scale=8192, train_wall=239, wall=0
2023-03-04 10:28:51 | INFO | train_inner | epoch 135:   1600 / 1978 loss=2.923, nll_loss=0.79, word_ins=2.622, length=3.013, ppl=7.59, wps=25170.5, ups=0.42, wpb=59492.5, bsz=1975.5, num_updates=266600, lr=0.000193673, gnorm=1.396, loss_scale=8192, train_wall=236, wall=0
2023-03-04 10:32:51 | INFO | train_inner | epoch 135:   1700 / 1978 loss=2.921, nll_loss=0.783, word_ins=2.615, length=3.058, ppl=7.57, wps=24617.7, ups=0.42, wpb=59167.7, bsz=2074.1, num_updates=266700, lr=0.000193637, gnorm=1.354, loss_scale=8192, train_wall=240, wall=0
2023-03-04 10:36:49 | INFO | train_inner | epoch 135:   1800 / 1978 loss=2.937, nll_loss=0.799, word_ins=2.63, length=3.06, ppl=7.66, wps=24740, ups=0.42, wpb=58838, bsz=2001, num_updates=266800, lr=0.000193601, gnorm=1.311, loss_scale=8192, train_wall=238, wall=0
2023-03-04 10:40:48 | INFO | train_inner | epoch 135:   1900 / 1978 loss=2.919, nll_loss=0.782, word_ins=2.615, length=3.039, ppl=7.56, wps=24781, ups=0.42, wpb=59154.8, bsz=2107.5, num_updates=266900, lr=0.000193565, gnorm=1.399, loss_scale=8192, train_wall=238, wall=0
2023-03-04 10:43:50 | INFO | fairseq_cli.train | begin validation on "valid" subset
2023-03-04 10:44:16 | INFO | valid | epoch 135 | valid on 'valid' subset | loss 4.089 | nll_loss 1.929 | word_ins 3.691 | length 3.987 | ppl 17.02 | wps 31640.9 | wpb 40242.5 | bsz 1500 | num_updates 266978 | best_loss 4.034
2023-03-04 10:44:16 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 10:44:33 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint135.pt (epoch 135 @ 266978 updates, score 4.089) (writing took 17.14436882827431 seconds)
2023-03-04 10:44:33 | INFO | fairseq_cli.train | end of epoch 135 (average epoch stats below)
2023-03-04 10:44:33 | INFO | train | epoch 135 | loss 2.928 | nll_loss 0.79 | word_ins 2.623 | length 3.057 | ppl 7.61 | wps 24667.8 | ups 0.42 | wpb 59284.3 | bsz 2002.6 | num_updates 266978 | lr 0.000193536 | gnorm 1.408 | loss_scale 8192 | train_wall 4693 | wall 0
2023-03-04 10:44:33 | INFO | fairseq.trainer | begin training epoch 136
2023-03-04 10:45:43 | INFO | train_inner | epoch 136:     22 / 1978 loss=2.968, nll_loss=0.823, word_ins=2.653, length=3.147, ppl=7.82, wps=19934.4, ups=0.34, wpb=58788.7, bsz=1874.1, num_updates=267000, lr=0.000193528, gnorm=1.417, loss_scale=8192, train_wall=232, wall=0
2023-03-04 10:49:42 | INFO | train_inner | epoch 136:    122 / 1978 loss=2.914, nll_loss=0.783, word_ins=2.616, length=2.987, ppl=7.54, wps=24815, ups=0.42, wpb=59412.3, bsz=2036.2, num_updates=267100, lr=0.000193492, gnorm=1.381, loss_scale=8192, train_wall=239, wall=0
2023-03-04 10:53:38 | INFO | train_inner | epoch 136:    222 / 1978 loss=2.912, nll_loss=0.776, word_ins=2.609, length=3.031, ppl=7.53, wps=25267.9, ups=0.42, wpb=59609, bsz=1945.5, num_updates=267200, lr=0.000193456, gnorm=1.359, loss_scale=8192, train_wall=236, wall=0
2023-03-04 10:57:38 | INFO | train_inner | epoch 136:    322 / 1978 loss=2.92, nll_loss=0.779, word_ins=2.612, length=3.076, ppl=7.57, wps=24699.4, ups=0.42, wpb=59331.3, bsz=1979.4, num_updates=267300, lr=0.00019342, gnorm=1.429, loss_scale=8192, train_wall=240, wall=0
2023-03-04 11:01:40 | INFO | train_inner | epoch 136:    422 / 1978 loss=2.941, nll_loss=0.803, word_ins=2.635, length=3.067, ppl=7.68, wps=24332.6, ups=0.41, wpb=58767, bsz=1955, num_updates=267400, lr=0.000193383, gnorm=1.412, loss_scale=8192, train_wall=241, wall=0
2023-03-04 11:05:42 | INFO | train_inner | epoch 136:    522 / 1978 loss=2.927, nll_loss=0.79, word_ins=2.623, length=3.044, ppl=7.61, wps=24390.9, ups=0.41, wpb=59066.9, bsz=2070.7, num_updates=267500, lr=0.000193347, gnorm=1.396, loss_scale=8192, train_wall=242, wall=0
2023-03-04 11:09:40 | INFO | train_inner | epoch 136:    622 / 1978 loss=2.949, nll_loss=0.803, word_ins=2.634, length=3.149, ppl=7.72, wps=24913.8, ups=0.42, wpb=59264.1, bsz=1905.5, num_updates=267600, lr=0.000193311, gnorm=1.421, loss_scale=8192, train_wall=238, wall=0
2023-03-04 11:13:38 | INFO | train_inner | epoch 136:    722 / 1978 loss=2.935, nll_loss=0.803, word_ins=2.635, length=3.001, ppl=7.65, wps=24783.2, ups=0.42, wpb=58904.9, bsz=1990.6, num_updates=267700, lr=0.000193275, gnorm=1.391, loss_scale=8192, train_wall=237, wall=0
2023-03-04 11:17:33 | INFO | train_inner | epoch 136:    822 / 1978 loss=2.903, nll_loss=0.767, word_ins=2.601, length=3.02, ppl=7.48, wps=25219.5, ups=0.43, wpb=59334.3, bsz=2123.4, num_updates=267800, lr=0.000193239, gnorm=1.34, loss_scale=8192, train_wall=235, wall=0
2023-03-04 11:21:26 | INFO | train_inner | epoch 136:    922 / 1978 loss=2.943, nll_loss=0.807, word_ins=2.638, length=3.05, ppl=7.69, wps=25105.3, ups=0.43, wpb=58651, bsz=2009.8, num_updates=267900, lr=0.000193203, gnorm=1.47, loss_scale=8192, train_wall=233, wall=0
2023-03-04 11:25:31 | INFO | train_inner | epoch 136:   1022 / 1978 loss=2.923, nll_loss=0.781, word_ins=2.614, length=3.099, ppl=7.59, wps=24445.2, ups=0.41, wpb=59661, bsz=1953.8, num_updates=268000, lr=0.000193167, gnorm=1.41, loss_scale=8192, train_wall=244, wall=0
2023-03-04 11:29:30 | INFO | train_inner | epoch 136:   1122 / 1978 loss=2.92, nll_loss=0.785, word_ins=2.617, length=3.029, ppl=7.57, wps=24658, ups=0.42, wpb=59015.1, bsz=2040.8, num_updates=268100, lr=0.000193131, gnorm=1.378, loss_scale=8192, train_wall=239, wall=0
2023-03-04 11:33:26 | INFO | train_inner | epoch 136:   1222 / 1978 loss=2.934, nll_loss=0.792, word_ins=2.624, length=3.1, ppl=7.64, wps=25182.1, ups=0.42, wpb=59544.5, bsz=1920.9, num_updates=268200, lr=0.000193095, gnorm=1.425, loss_scale=8192, train_wall=236, wall=0
2023-03-04 11:37:32 | INFO | train_inner | epoch 136:   1322 / 1978 loss=2.935, nll_loss=0.796, word_ins=2.628, length=3.073, ppl=7.65, wps=24133.6, ups=0.41, wpb=59245, bsz=1939.2, num_updates=268300, lr=0.000193059, gnorm=1.409, loss_scale=8192, train_wall=245, wall=0
2023-03-04 11:41:32 | INFO | train_inner | epoch 136:   1422 / 1978 loss=2.908, nll_loss=0.774, word_ins=2.607, length=3.01, ppl=7.51, wps=24920.7, ups=0.42, wpb=59752.2, bsz=2067.7, num_updates=268400, lr=0.000193023, gnorm=1.424, loss_scale=8192, train_wall=239, wall=0
2023-03-04 11:45:29 | INFO | train_inner | epoch 136:   1522 / 1978 loss=2.938, nll_loss=0.797, word_ins=2.628, length=3.102, ppl=7.66, wps=24929.6, ups=0.42, wpb=59243.8, bsz=1960.9, num_updates=268500, lr=0.000192987, gnorm=1.435, loss_scale=8192, train_wall=237, wall=0
2023-03-04 11:49:29 | INFO | train_inner | epoch 136:   1622 / 1978 loss=2.935, nll_loss=0.797, word_ins=2.628, length=3.069, ppl=7.65, wps=24793, ups=0.42, wpb=59342.4, bsz=2019.4, num_updates=268600, lr=0.000192951, gnorm=1.477, loss_scale=8192, train_wall=239, wall=0
2023-03-04 11:53:28 | INFO | train_inner | epoch 136:   1722 / 1978 loss=2.897, nll_loss=0.766, word_ins=2.6, length=2.974, ppl=7.45, wps=24952.1, ups=0.42, wpb=59629.4, bsz=2138.8, num_updates=268700, lr=0.000192915, gnorm=1.349, loss_scale=8192, train_wall=239, wall=0
2023-03-04 11:57:27 | INFO | train_inner | epoch 136:   1822 / 1978 loss=2.915, nll_loss=0.778, word_ins=2.611, length=3.038, ppl=7.54, wps=24628.3, ups=0.42, wpb=59018.9, bsz=2079.7, num_updates=268800, lr=0.000192879, gnorm=1.322, loss_scale=8192, train_wall=239, wall=0
2023-03-04 11:59:01 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 12:01:26 | INFO | train_inner | epoch 136:   1923 / 1978 loss=2.937, nll_loss=0.8, word_ins=2.631, length=3.06, ppl=7.66, wps=24844.4, ups=0.42, wpb=59386.3, bsz=1989.1, num_updates=268900, lr=0.000192843, gnorm=1.426, loss_scale=8192, train_wall=239, wall=0
2023-03-04 12:03:38 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 12:03:53 | INFO | valid | epoch 136 | valid on 'valid' subset | loss 4.081 | nll_loss 1.902 | word_ins 3.668 | length 4.122 | ppl 16.92 | wps 30189.6 | wpb 40242.5 | bsz 1500 | num_updates 268955 | best_loss 4.034
2023-03-04 12:03:53 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 12:03:59 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint136.pt (epoch 136 @ 268955 updates, score 4.081) (writing took 6.138830596581101 seconds)
2023-03-04 12:03:59 | INFO | fairseq_cli.train | end of epoch 136 (average epoch stats below)
2023-03-04 12:03:59 | INFO | train | epoch 136 | loss 2.926 | nll_loss 0.788 | word_ins 2.621 | length 3.052 | ppl 7.6 | wps 24590.7 | ups 0.41 | wpb 59282.9 | bsz 2002.8 | num_updates 268955 | lr 0.000192824 | gnorm 1.405 | loss_scale 8192 | train_wall 4719 | wall 0
2023-03-04 12:03:59 | INFO | fairseq.trainer | begin training epoch 137
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 12:05:55 | INFO | train_inner | epoch 137:     45 / 1978 loss=2.918, nll_loss=0.786, word_ins=2.619, length=2.99, ppl=7.56, wps=22178.8, ups=0.37, wpb=59629.8, bsz=2000.2, num_updates=269000, lr=0.000192807, gnorm=1.417, loss_scale=8192, train_wall=239, wall=0
2023-03-04 12:09:56 | INFO | train_inner | epoch 137:    145 / 1978 loss=2.907, nll_loss=0.775, word_ins=2.609, length=2.979, ppl=7.5, wps=24715.4, ups=0.42, wpb=59528.6, bsz=2046.2, num_updates=269100, lr=0.000192772, gnorm=1.41, loss_scale=8192, train_wall=241, wall=0
2023-03-04 12:13:52 | INFO | train_inner | epoch 137:    245 / 1978 loss=2.944, nll_loss=0.807, word_ins=2.638, length=3.068, ppl=7.7, wps=25068, ups=0.42, wpb=59201.1, bsz=1925.1, num_updates=269200, lr=0.000192736, gnorm=1.459, loss_scale=8192, train_wall=236, wall=0
2023-03-04 12:17:49 | INFO | train_inner | epoch 137:    345 / 1978 loss=2.931, nll_loss=0.793, word_ins=2.626, length=3.052, ppl=7.63, wps=25186.3, ups=0.42, wpb=59556.6, bsz=1945.1, num_updates=269300, lr=0.0001927, gnorm=1.435, loss_scale=8192, train_wall=236, wall=0
2023-03-04 12:21:50 | INFO | train_inner | epoch 137:    445 / 1978 loss=2.911, nll_loss=0.778, word_ins=2.612, length=2.99, ppl=7.52, wps=24592, ups=0.41, wpb=59337.8, bsz=2063.1, num_updates=269400, lr=0.000192664, gnorm=1.362, loss_scale=8192, train_wall=241, wall=0
2023-03-04 12:25:45 | INFO | train_inner | epoch 137:    545 / 1978 loss=2.923, nll_loss=0.786, word_ins=2.619, length=3.042, ppl=7.58, wps=25285.7, ups=0.43, wpb=59336.3, bsz=1985.2, num_updates=269500, lr=0.000192629, gnorm=1.366, loss_scale=8192, train_wall=234, wall=0
2023-03-04 12:29:50 | INFO | train_inner | epoch 137:    645 / 1978 loss=2.918, nll_loss=0.783, word_ins=2.616, length=3.018, ppl=7.56, wps=24361.4, ups=0.41, wpb=59676.2, bsz=2045.1, num_updates=269600, lr=0.000192593, gnorm=1.42, loss_scale=8192, train_wall=245, wall=0
2023-03-04 12:33:51 | INFO | train_inner | epoch 137:    745 / 1978 loss=2.943, nll_loss=0.798, word_ins=2.63, length=3.134, ppl=7.69, wps=24151, ups=0.41, wpb=58428.2, bsz=1928.5, num_updates=269700, lr=0.000192557, gnorm=1.388, loss_scale=8192, train_wall=242, wall=0
2023-03-04 12:37:55 | INFO | train_inner | epoch 137:    845 / 1978 loss=2.911, nll_loss=0.774, word_ins=2.607, length=3.045, ppl=7.52, wps=24286, ups=0.41, wpb=59242.9, bsz=2038.2, num_updates=269800, lr=0.000192521, gnorm=1.379, loss_scale=8192, train_wall=244, wall=0
2023-03-04 12:41:56 | INFO | train_inner | epoch 137:    945 / 1978 loss=2.916, nll_loss=0.784, word_ins=2.616, length=2.999, ppl=7.55, wps=24865.6, ups=0.42, wpb=59892.3, bsz=2093.2, num_updates=269900, lr=0.000192486, gnorm=1.477, loss_scale=8192, train_wall=241, wall=0
2023-03-04 12:46:05 | INFO | train_inner | epoch 137:   1045 / 1978 loss=2.939, nll_loss=0.792, word_ins=2.624, length=3.146, ppl=7.67, wps=23700.3, ups=0.4, wpb=59033.2, bsz=1979, num_updates=270000, lr=0.00019245, gnorm=1.382, loss_scale=8192, train_wall=248, wall=0
2023-03-04 12:50:05 | INFO | train_inner | epoch 137:   1145 / 1978 loss=2.914, nll_loss=0.779, word_ins=2.612, length=3.017, ppl=7.54, wps=24813.8, ups=0.42, wpb=59384.8, bsz=2001.6, num_updates=270100, lr=0.000192414, gnorm=1.38, loss_scale=8192, train_wall=239, wall=0
2023-03-04 12:54:04 | INFO | train_inner | epoch 137:   1245 / 1978 loss=2.926, nll_loss=0.788, word_ins=2.62, length=3.063, ppl=7.6, wps=24720.5, ups=0.42, wpb=59179.1, bsz=1956.2, num_updates=270200, lr=0.000192379, gnorm=1.406, loss_scale=8192, train_wall=239, wall=0
2023-03-04 12:58:03 | INFO | train_inner | epoch 137:   1345 / 1978 loss=2.924, nll_loss=0.789, word_ins=2.621, length=3.038, ppl=7.59, wps=24735.1, ups=0.42, wpb=59190.6, bsz=2039.2, num_updates=270300, lr=0.000192343, gnorm=1.403, loss_scale=8192, train_wall=239, wall=0
2023-03-04 13:02:00 | INFO | train_inner | epoch 137:   1445 / 1978 loss=2.92, nll_loss=0.783, word_ins=2.615, length=3.05, ppl=7.57, wps=24941.3, ups=0.42, wpb=59080.6, bsz=1995.8, num_updates=270400, lr=0.000192308, gnorm=1.41, loss_scale=8192, train_wall=237, wall=0
2023-03-04 13:06:06 | INFO | train_inner | epoch 137:   1545 / 1978 loss=2.921, nll_loss=0.783, word_ins=2.615, length=3.051, ppl=7.57, wps=24266.2, ups=0.41, wpb=59635.3, bsz=2021.5, num_updates=270500, lr=0.000192272, gnorm=1.401, loss_scale=8192, train_wall=245, wall=0
2023-03-04 13:10:14 | INFO | train_inner | epoch 137:   1645 / 1978 loss=2.914, nll_loss=0.777, word_ins=2.61, length=3.044, ppl=7.54, wps=23851.8, ups=0.4, wpb=59085.5, bsz=2099.3, num_updates=270600, lr=0.000192237, gnorm=1.354, loss_scale=8192, train_wall=247, wall=0
2023-03-04 13:14:17 | INFO | train_inner | epoch 137:   1745 / 1978 loss=2.943, nll_loss=0.803, word_ins=2.634, length=3.096, ppl=7.69, wps=24360.2, ups=0.41, wpb=59178.7, bsz=1989, num_updates=270700, lr=0.000192201, gnorm=1.408, loss_scale=8192, train_wall=243, wall=0
2023-03-04 13:18:26 | INFO | train_inner | epoch 137:   1845 / 1978 loss=2.93, nll_loss=0.786, word_ins=2.618, length=3.115, ppl=7.62, wps=23881.6, ups=0.4, wpb=59526.6, bsz=1938.7, num_updates=270800, lr=0.000192166, gnorm=1.434, loss_scale=8192, train_wall=249, wall=0
2023-03-04 13:22:16 | INFO | train_inner | epoch 137:   1945 / 1978 loss=2.952, nll_loss=0.808, word_ins=2.639, length=3.138, ppl=7.74, wps=25576.5, ups=0.43, wpb=58911.9, bsz=1903.2, num_updates=270900, lr=0.00019213, gnorm=1.434, loss_scale=8192, train_wall=230, wall=0
2023-03-04 13:23:33 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 13:23:47 | INFO | valid | epoch 137 | valid on 'valid' subset | loss 4.104 | nll_loss 1.925 | word_ins 3.69 | length 4.142 | ppl 17.2 | wps 31191.9 | wpb 40242.5 | bsz 1500 | num_updates 270933 | best_loss 4.034
2023-03-04 13:23:47 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 13:23:52 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint137.pt (epoch 137 @ 270933 updates, score 4.104) (writing took 5.356207834556699 seconds)
2023-03-04 13:23:52 | INFO | fairseq_cli.train | end of epoch 137 (average epoch stats below)
2023-03-04 13:23:52 | INFO | train | epoch 137 | loss 2.925 | nll_loss 0.787 | word_ins 2.62 | length 3.053 | ppl 7.59 | wps 24463.2 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 270933 | lr 0.000192118 | gnorm 1.405 | loss_scale 8192 | train_wall 4759 | wall 0
2023-03-04 13:23:52 | INFO | fairseq.trainer | begin training epoch 138
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 13:26:34 | INFO | train_inner | epoch 138:     67 / 1978 loss=2.917, nll_loss=0.779, word_ins=2.612, length=3.045, ppl=7.55, wps=22960.5, ups=0.39, wpb=59132.1, bsz=2003.6, num_updates=271000, lr=0.000192095, gnorm=1.449, loss_scale=8192, train_wall=230, wall=0
2023-03-04 13:30:24 | INFO | train_inner | epoch 138:    167 / 1978 loss=2.918, nll_loss=0.782, word_ins=2.614, length=3.04, ppl=7.56, wps=25944.5, ups=0.44, wpb=59619.9, bsz=1977.7, num_updates=271100, lr=0.000192059, gnorm=1.434, loss_scale=8192, train_wall=230, wall=0
2023-03-04 13:34:15 | INFO | train_inner | epoch 138:    267 / 1978 loss=2.921, nll_loss=0.782, word_ins=2.616, length=3.057, ppl=7.57, wps=25564.6, ups=0.43, wpb=59015, bsz=2021.3, num_updates=271200, lr=0.000192024, gnorm=1.409, loss_scale=8192, train_wall=231, wall=0
2023-03-04 13:38:05 | INFO | train_inner | epoch 138:    367 / 1978 loss=2.918, nll_loss=0.78, word_ins=2.613, length=3.05, ppl=7.56, wps=25627, ups=0.43, wpb=59192.6, bsz=1971.2, num_updates=271300, lr=0.000191988, gnorm=1.405, loss_scale=8192, train_wall=231, wall=0
2023-03-04 13:41:57 | INFO | train_inner | epoch 138:    467 / 1978 loss=2.913, nll_loss=0.777, word_ins=2.61, length=3.032, ppl=7.53, wps=25595.7, ups=0.43, wpb=59281.4, bsz=2038.3, num_updates=271400, lr=0.000191953, gnorm=1.377, loss_scale=8192, train_wall=231, wall=0
2023-03-04 13:45:48 | INFO | train_inner | epoch 138:    567 / 1978 loss=2.949, nll_loss=0.808, word_ins=2.639, length=3.1, ppl=7.72, wps=25545.7, ups=0.43, wpb=58914.2, bsz=1922.5, num_updates=271500, lr=0.000191918, gnorm=1.473, loss_scale=8192, train_wall=230, wall=0
2023-03-04 13:49:38 | INFO | train_inner | epoch 138:    667 / 1978 loss=2.924, nll_loss=0.787, word_ins=2.619, length=3.049, ppl=7.59, wps=25680.4, ups=0.43, wpb=59208.2, bsz=1970.6, num_updates=271600, lr=0.000191882, gnorm=1.391, loss_scale=8192, train_wall=230, wall=0
2023-03-04 13:53:29 | INFO | train_inner | epoch 138:    767 / 1978 loss=2.927, nll_loss=0.789, word_ins=2.622, length=3.057, ppl=7.61, wps=25744.8, ups=0.43, wpb=59317.4, bsz=1977.7, num_updates=271700, lr=0.000191847, gnorm=1.397, loss_scale=8192, train_wall=230, wall=0
2023-03-04 13:57:22 | INFO | train_inner | epoch 138:    867 / 1978 loss=2.929, nll_loss=0.793, word_ins=2.625, length=3.046, ppl=7.62, wps=25444.1, ups=0.43, wpb=59344.8, bsz=2014.7, num_updates=271800, lr=0.000191812, gnorm=1.434, loss_scale=8192, train_wall=233, wall=0
2023-03-04 14:01:14 | INFO | train_inner | epoch 138:    967 / 1978 loss=2.917, nll_loss=0.78, word_ins=2.613, length=3.037, ppl=7.55, wps=25665.3, ups=0.43, wpb=59667, bsz=2100.8, num_updates=271900, lr=0.000191777, gnorm=1.434, loss_scale=8192, train_wall=232, wall=0
2023-03-04 14:05:05 | INFO | train_inner | epoch 138:   1067 / 1978 loss=2.947, nll_loss=0.806, word_ins=2.637, length=3.102, ppl=7.71, wps=25584.5, ups=0.43, wpb=59103.6, bsz=1991.7, num_updates=272000, lr=0.000191741, gnorm=1.407, loss_scale=8192, train_wall=231, wall=0
2023-03-04 14:08:56 | INFO | train_inner | epoch 138:   1167 / 1978 loss=2.92, nll_loss=0.783, word_ins=2.616, length=3.041, ppl=7.57, wps=25726.8, ups=0.43, wpb=59293.4, bsz=1959.5, num_updates=272100, lr=0.000191706, gnorm=1.382, loss_scale=8192, train_wall=230, wall=0
2023-03-04 14:12:47 | INFO | train_inner | epoch 138:   1267 / 1978 loss=2.951, nll_loss=0.807, word_ins=2.637, length=3.136, ppl=7.73, wps=25784.5, ups=0.43, wpb=59484.9, bsz=1944.2, num_updates=272200, lr=0.000191671, gnorm=1.462, loss_scale=8192, train_wall=230, wall=0
2023-03-04 14:16:38 | INFO | train_inner | epoch 138:   1367 / 1978 loss=2.899, nll_loss=0.769, word_ins=2.602, length=2.972, ppl=7.46, wps=25607, ups=0.43, wpb=59289.6, bsz=2087.4, num_updates=272300, lr=0.000191636, gnorm=1.358, loss_scale=8192, train_wall=231, wall=0
2023-03-04 14:20:30 | INFO | train_inner | epoch 138:   1467 / 1978 loss=2.912, nll_loss=0.778, word_ins=2.611, length=3.002, ppl=7.52, wps=25668.1, ups=0.43, wpb=59629.9, bsz=2032.7, num_updates=272400, lr=0.0001916, gnorm=1.375, loss_scale=8192, train_wall=232, wall=0
2023-03-04 14:24:23 | INFO | train_inner | epoch 138:   1567 / 1978 loss=2.912, nll_loss=0.779, word_ins=2.611, length=3.013, ppl=7.53, wps=25603.2, ups=0.43, wpb=59497.9, bsz=2018.9, num_updates=272500, lr=0.000191565, gnorm=1.384, loss_scale=8192, train_wall=232, wall=0
2023-03-04 14:28:15 | INFO | train_inner | epoch 138:   1667 / 1978 loss=2.92, nll_loss=0.781, word_ins=2.614, length=3.059, ppl=7.57, wps=25601.1, ups=0.43, wpb=59404.6, bsz=2007.3, num_updates=272600, lr=0.00019153, gnorm=1.374, loss_scale=8192, train_wall=232, wall=0
2023-03-04 14:32:07 | INFO | train_inner | epoch 138:   1767 / 1978 loss=2.932, nll_loss=0.8, word_ins=2.632, length=2.997, ppl=7.63, wps=25571.7, ups=0.43, wpb=59390.4, bsz=1996.8, num_updates=272700, lr=0.000191495, gnorm=1.428, loss_scale=8192, train_wall=232, wall=0
2023-03-04 14:36:02 | INFO | train_inner | epoch 138:   1867 / 1978 loss=2.924, nll_loss=0.788, word_ins=2.62, length=3.037, ppl=7.59, wps=25145.2, ups=0.43, wpb=58964.5, bsz=2076.6, num_updates=272800, lr=0.00019146, gnorm=1.363, loss_scale=8192, train_wall=234, wall=0
2023-03-04 14:39:56 | INFO | train_inner | epoch 138:   1967 / 1978 loss=2.937, nll_loss=0.799, word_ins=2.63, length=3.067, ppl=7.66, wps=25163.8, ups=0.43, wpb=59056.7, bsz=1972.4, num_updates=272900, lr=0.000191425, gnorm=1.407, loss_scale=8192, train_wall=234, wall=0
2023-03-04 14:40:22 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 14:40:37 | INFO | valid | epoch 138 | valid on 'valid' subset | loss 4.08 | nll_loss 1.92 | word_ins 3.681 | length 3.989 | ppl 16.92 | wps 30277.5 | wpb 40242.5 | bsz 1500 | num_updates 272911 | best_loss 4.034
2023-03-04 14:40:37 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 14:40:45 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint138.pt (epoch 138 @ 272911 updates, score 4.08) (writing took 7.550186853855848 seconds)
2023-03-04 14:40:45 | INFO | fairseq_cli.train | end of epoch 138 (average epoch stats below)
2023-03-04 14:40:45 | INFO | train | epoch 138 | loss 2.925 | nll_loss 0.788 | word_ins 2.62 | length 3.048 | ppl 7.59 | wps 25425.3 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 272911 | lr 0.000191421 | gnorm 1.407 | loss_scale 8192 | train_wall 4577 | wall 0
2023-03-04 14:40:45 | INFO | fairseq.trainer | begin training epoch 139
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 14:42:00 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 14:44:24 | INFO | train_inner | epoch 139:     90 / 1978 loss=2.898, nll_loss=0.768, word_ins=2.602, length=2.962, ppl=7.45, wps=22260.6, ups=0.37, wpb=59573.7, bsz=2054.4, num_updates=273000, lr=0.00019139, gnorm=1.385, loss_scale=8192, train_wall=236, wall=0
2023-03-04 14:48:16 | INFO | train_inner | epoch 139:    190 / 1978 loss=2.909, nll_loss=0.774, word_ins=2.607, length=3.017, ppl=7.51, wps=25897.1, ups=0.43, wpb=59991.8, bsz=2045.1, num_updates=273100, lr=0.000191355, gnorm=1.406, loss_scale=8192, train_wall=231, wall=0
2023-03-04 14:52:06 | INFO | train_inner | epoch 139:    290 / 1978 loss=2.935, nll_loss=0.797, word_ins=2.629, length=3.068, ppl=7.65, wps=25610, ups=0.43, wpb=58998.5, bsz=1979.7, num_updates=273200, lr=0.00019132, gnorm=1.457, loss_scale=8192, train_wall=230, wall=0
2023-03-04 14:55:59 | INFO | train_inner | epoch 139:    390 / 1978 loss=2.912, nll_loss=0.775, word_ins=2.608, length=3.036, ppl=7.53, wps=25501.6, ups=0.43, wpb=59304.7, bsz=2009.9, num_updates=273300, lr=0.000191285, gnorm=1.377, loss_scale=8192, train_wall=232, wall=0
2023-03-04 14:59:49 | INFO | train_inner | epoch 139:    490 / 1978 loss=2.937, nll_loss=0.797, word_ins=2.628, length=3.086, ppl=7.66, wps=25622, ups=0.43, wpb=59146.9, bsz=1946.2, num_updates=273400, lr=0.00019125, gnorm=1.418, loss_scale=8192, train_wall=231, wall=0
2023-03-04 15:03:41 | INFO | train_inner | epoch 139:    590 / 1978 loss=2.92, nll_loss=0.783, word_ins=2.616, length=3.044, ppl=7.57, wps=25705.1, ups=0.43, wpb=59592.1, bsz=2008.6, num_updates=273500, lr=0.000191215, gnorm=1.424, loss_scale=8192, train_wall=232, wall=0
2023-03-04 15:07:32 | INFO | train_inner | epoch 139:    690 / 1978 loss=2.938, nll_loss=0.8, word_ins=2.631, length=3.068, ppl=7.66, wps=25501.1, ups=0.43, wpb=58931.6, bsz=1968.7, num_updates=273600, lr=0.00019118, gnorm=1.459, loss_scale=8192, train_wall=231, wall=0
2023-03-04 15:11:23 | INFO | train_inner | epoch 139:    790 / 1978 loss=2.935, nll_loss=0.795, word_ins=2.627, length=3.081, ppl=7.65, wps=26000.9, ups=0.43, wpb=59974.3, bsz=1927.4, num_updates=273700, lr=0.000191145, gnorm=1.412, loss_scale=8192, train_wall=230, wall=0
2023-03-04 15:15:14 | INFO | train_inner | epoch 139:    890 / 1978 loss=2.903, nll_loss=0.771, word_ins=2.605, length=2.981, ppl=7.48, wps=25620.1, ups=0.43, wpb=59260.3, bsz=2114.9, num_updates=273800, lr=0.00019111, gnorm=1.371, loss_scale=8192, train_wall=231, wall=0
2023-03-04 15:19:09 | INFO | train_inner | epoch 139:    990 / 1978 loss=2.911, nll_loss=0.775, word_ins=2.609, length=3.02, ppl=7.52, wps=25338.3, ups=0.43, wpb=59366.4, bsz=2037.3, num_updates=273900, lr=0.000191075, gnorm=1.384, loss_scale=8192, train_wall=234, wall=0
2023-03-04 15:23:25 | INFO | train_inner | epoch 139:   1090 / 1978 loss=2.903, nll_loss=0.768, word_ins=2.602, length=3.011, ppl=7.48, wps=23119.2, ups=0.39, wpb=59170, bsz=2047.5, num_updates=274000, lr=0.00019104, gnorm=1.368, loss_scale=8192, train_wall=256, wall=0
2023-03-04 15:27:39 | INFO | train_inner | epoch 139:   1190 / 1978 loss=2.92, nll_loss=0.781, word_ins=2.614, length=3.065, ppl=7.57, wps=23283.2, ups=0.39, wpb=59291.1, bsz=2013.7, num_updates=274100, lr=0.000191005, gnorm=1.4, loss_scale=8192, train_wall=254, wall=0
2023-03-04 15:31:50 | INFO | train_inner | epoch 139:   1290 / 1978 loss=2.928, nll_loss=0.788, word_ins=2.62, length=3.079, ppl=7.61, wps=23589.2, ups=0.4, wpb=59234.2, bsz=1954.8, num_updates=274200, lr=0.00019097, gnorm=1.416, loss_scale=8192, train_wall=251, wall=0
2023-03-04 15:36:00 | INFO | train_inner | epoch 139:   1390 / 1978 loss=2.929, nll_loss=0.79, word_ins=2.622, length=3.077, ppl=7.62, wps=23679, ups=0.4, wpb=59001.8, bsz=2037.8, num_updates=274300, lr=0.000190936, gnorm=1.423, loss_scale=8192, train_wall=249, wall=0
2023-03-04 15:40:08 | INFO | train_inner | epoch 139:   1490 / 1978 loss=2.938, nll_loss=0.8, word_ins=2.631, length=3.065, ppl=7.66, wps=23802.1, ups=0.4, wpb=59256.6, bsz=1927.4, num_updates=274400, lr=0.000190901, gnorm=1.481, loss_scale=8192, train_wall=249, wall=0
2023-03-04 15:44:19 | INFO | train_inner | epoch 139:   1590 / 1978 loss=2.923, nll_loss=0.787, word_ins=2.619, length=3.045, ppl=7.59, wps=23627.2, ups=0.4, wpb=59093.6, bsz=2006.8, num_updates=274500, lr=0.000190866, gnorm=1.355, loss_scale=8192, train_wall=250, wall=0
2023-03-04 15:48:32 | INFO | train_inner | epoch 139:   1690 / 1978 loss=2.919, nll_loss=0.782, word_ins=2.615, length=3.042, ppl=7.57, wps=23329.4, ups=0.39, wpb=59116.3, bsz=2005.5, num_updates=274600, lr=0.000190831, gnorm=1.363, loss_scale=8192, train_wall=253, wall=0
2023-03-04 15:52:46 | INFO | train_inner | epoch 139:   1790 / 1978 loss=2.936, nll_loss=0.793, word_ins=2.625, length=3.104, ppl=7.65, wps=23235.5, ups=0.39, wpb=59046, bsz=1990.8, num_updates=274700, lr=0.000190797, gnorm=1.419, loss_scale=8192, train_wall=254, wall=0
2023-03-04 15:57:01 | INFO | train_inner | epoch 139:   1890 / 1978 loss=2.924, nll_loss=0.785, word_ins=2.617, length=3.067, ppl=7.59, wps=23267, ups=0.39, wpb=59387, bsz=1999.5, num_updates=274800, lr=0.000190762, gnorm=1.472, loss_scale=8192, train_wall=255, wall=0
2023-03-04 16:00:42 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 16:00:55 | INFO | valid | epoch 139 | valid on 'valid' subset | loss 4.098 | nll_loss 1.914 | word_ins 3.673 | length 4.245 | ppl 17.12 | wps 22291.1 | wpb 40242.5 | bsz 1500 | num_updates 274888 | best_loss 4.034
2023-03-04 16:00:55 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 16:01:01 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint139.pt (epoch 139 @ 274888 updates, score 4.098) (writing took 6.153051231056452 seconds)
2023-03-04 16:01:01 | INFO | fairseq_cli.train | end of epoch 139 (average epoch stats below)
2023-03-04 16:01:01 | INFO | train | epoch 139 | loss 2.923 | nll_loss 0.785 | word_ins 2.618 | length 3.049 | ppl 7.58 | wps 24331.6 | ups 0.41 | wpb 59284.1 | bsz 2003 | num_updates 274888 | lr 0.000190731 | gnorm 1.412 | loss_scale 8192 | train_wall 4782 | wall 0
2023-03-04 16:01:01 | INFO | fairseq.trainer | begin training epoch 140
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 16:01:40 | INFO | train_inner | epoch 140:     12 / 1978 loss=2.936, nll_loss=0.799, word_ins=2.63, length=3.056, ppl=7.65, wps=21139.6, ups=0.36, wpb=58972.4, bsz=1977.8, num_updates=274900, lr=0.000190727, gnorm=1.432, loss_scale=8192, train_wall=249, wall=0
2023-03-04 16:05:55 | INFO | train_inner | epoch 140:    112 / 1978 loss=2.917, nll_loss=0.782, word_ins=2.615, length=3.019, ppl=7.55, wps=23258.3, ups=0.39, wpb=59176.2, bsz=2010.6, num_updates=275000, lr=0.000190693, gnorm=1.399, loss_scale=8192, train_wall=254, wall=0
2023-03-04 16:10:09 | INFO | train_inner | epoch 140:    212 / 1978 loss=2.907, nll_loss=0.774, word_ins=2.608, length=2.989, ppl=7.5, wps=23478.4, ups=0.39, wpb=59690.8, bsz=2079, num_updates=275100, lr=0.000190658, gnorm=1.445, loss_scale=8192, train_wall=254, wall=0
2023-03-04 16:14:20 | INFO | train_inner | epoch 140:    312 / 1978 loss=2.933, nll_loss=0.793, word_ins=2.625, length=3.087, ppl=7.64, wps=23603.1, ups=0.4, wpb=59213.9, bsz=1931.3, num_updates=275200, lr=0.000190623, gnorm=1.439, loss_scale=8192, train_wall=251, wall=0
2023-03-04 16:18:32 | INFO | train_inner | epoch 140:    412 / 1978 loss=2.902, nll_loss=0.764, word_ins=2.598, length=3.04, ppl=7.48, wps=23714.5, ups=0.4, wpb=59807.7, bsz=2019.2, num_updates=275300, lr=0.000190589, gnorm=1.386, loss_scale=8192, train_wall=252, wall=0
2023-03-04 16:22:45 | INFO | train_inner | epoch 140:    512 / 1978 loss=2.915, nll_loss=0.78, word_ins=2.613, length=3.02, ppl=7.54, wps=23433.4, ups=0.4, wpb=59175.2, bsz=1963.1, num_updates=275400, lr=0.000190554, gnorm=1.378, loss_scale=8192, train_wall=252, wall=0
2023-03-04 16:26:55 | INFO | train_inner | epoch 140:    612 / 1978 loss=2.923, nll_loss=0.787, word_ins=2.62, length=3.029, ppl=7.58, wps=23776.1, ups=0.4, wpb=59526.9, bsz=1966.5, num_updates=275500, lr=0.000190519, gnorm=1.44, loss_scale=8192, train_wall=250, wall=0
2023-03-04 16:31:08 | INFO | train_inner | epoch 140:    712 / 1978 loss=2.931, nll_loss=0.793, word_ins=2.625, length=3.064, ppl=7.63, wps=23406.4, ups=0.4, wpb=59161.4, bsz=1923.2, num_updates=275600, lr=0.000190485, gnorm=1.462, loss_scale=8192, train_wall=252, wall=0
2023-03-04 16:35:21 | INFO | train_inner | epoch 140:    812 / 1978 loss=2.91, nll_loss=0.771, word_ins=2.605, length=3.051, ppl=7.52, wps=23366.2, ups=0.39, wpb=59237.6, bsz=2031.8, num_updates=275700, lr=0.00019045, gnorm=1.334, loss_scale=8192, train_wall=253, wall=0
2023-03-04 16:39:36 | INFO | train_inner | epoch 140:    912 / 1978 loss=2.93, nll_loss=0.791, word_ins=2.623, length=3.063, ppl=7.62, wps=22841.1, ups=0.39, wpb=58112.2, bsz=2023.4, num_updates=275800, lr=0.000190416, gnorm=1.394, loss_scale=8192, train_wall=254, wall=0
2023-03-04 16:43:42 | INFO | train_inner | epoch 140:   1012 / 1978 loss=2.919, nll_loss=0.78, word_ins=2.612, length=3.061, ppl=7.56, wps=24299.7, ups=0.41, wpb=59772.1, bsz=2008.5, num_updates=275900, lr=0.000190381, gnorm=1.423, loss_scale=8192, train_wall=246, wall=0
2023-03-04 16:47:43 | INFO | train_inner | epoch 140:   1112 / 1978 loss=2.907, nll_loss=0.776, word_ins=2.609, length=2.984, ppl=7.5, wps=24572.8, ups=0.42, wpb=59187, bsz=2120.6, num_updates=276000, lr=0.000190347, gnorm=1.358, loss_scale=8192, train_wall=241, wall=0
2023-03-04 16:51:43 | INFO | train_inner | epoch 140:   1212 / 1978 loss=2.919, nll_loss=0.788, word_ins=2.621, length=2.984, ppl=7.56, wps=24660.3, ups=0.42, wpb=59370, bsz=2025.5, num_updates=276100, lr=0.000190312, gnorm=1.398, loss_scale=8192, train_wall=240, wall=0
2023-03-04 16:55:40 | INFO | train_inner | epoch 140:   1312 / 1978 loss=2.909, nll_loss=0.768, word_ins=2.602, length=3.067, ppl=7.51, wps=25124.1, ups=0.42, wpb=59540.5, bsz=2018.2, num_updates=276200, lr=0.000190278, gnorm=1.36, loss_scale=8192, train_wall=237, wall=0
2023-03-04 16:59:37 | INFO | train_inner | epoch 140:   1412 / 1978 loss=2.904, nll_loss=0.773, word_ins=2.607, length=2.969, ppl=7.48, wps=25086.6, ups=0.42, wpb=59503.6, bsz=2102.7, num_updates=276300, lr=0.000190243, gnorm=1.418, loss_scale=8192, train_wall=237, wall=0
2023-03-04 17:03:32 | INFO | train_inner | epoch 140:   1512 / 1978 loss=2.948, nll_loss=0.815, word_ins=2.645, length=3.038, ppl=7.72, wps=25125.4, ups=0.43, wpb=59037, bsz=1895.6, num_updates=276400, lr=0.000190209, gnorm=1.485, loss_scale=8192, train_wall=235, wall=0
2023-03-04 17:07:33 | INFO | train_inner | epoch 140:   1612 / 1978 loss=2.931, nll_loss=0.795, word_ins=2.627, length=3.04, ppl=7.63, wps=24503.8, ups=0.41, wpb=59054.6, bsz=2030.2, num_updates=276500, lr=0.000190175, gnorm=1.432, loss_scale=8192, train_wall=241, wall=0
2023-03-04 17:11:32 | INFO | train_inner | epoch 140:   1712 / 1978 loss=2.933, nll_loss=0.794, word_ins=2.625, length=3.072, ppl=7.63, wps=24932.4, ups=0.42, wpb=59352.6, bsz=1990.8, num_updates=276600, lr=0.00019014, gnorm=1.46, loss_scale=8192, train_wall=238, wall=0
2023-03-04 17:15:29 | INFO | train_inner | epoch 140:   1812 / 1978 loss=2.913, nll_loss=0.779, word_ins=2.612, length=3.012, ppl=7.53, wps=25118.8, ups=0.42, wpb=59648.1, bsz=2002.9, num_updates=276700, lr=0.000190106, gnorm=1.393, loss_scale=8192, train_wall=237, wall=0
2023-03-04 17:19:26 | INFO | train_inner | epoch 140:   1912 / 1978 loss=2.938, nll_loss=0.797, word_ins=2.628, length=3.098, ppl=7.66, wps=24836.2, ups=0.42, wpb=58950.5, bsz=1914.3, num_updates=276800, lr=0.000190071, gnorm=1.454, loss_scale=8192, train_wall=237, wall=0
2023-03-04 17:22:02 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 17:22:25 | INFO | valid | epoch 140 | valid on 'valid' subset | loss 4.094 | nll_loss 1.919 | word_ins 3.684 | length 4.093 | ppl 17.08 | wps 16234.6 | wpb 40242.5 | bsz 1500 | num_updates 276866 | best_loss 4.034
2023-03-04 17:22:25 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-04 17:22:30 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint140.pt (epoch 140 @ 276866 updates, score 4.094) (writing took 5.58367707207799 seconds)
2023-03-04 17:22:30 | INFO | fairseq_cli.train | end of epoch 140 (average epoch stats below)
2023-03-04 17:22:31 | INFO | train | epoch 140 | loss 2.921 | nll_loss 0.785 | word_ins 2.617 | length 3.039 | ppl 7.57 | wps 23984.9 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 276866 | lr 0.000190049 | gnorm 1.413 | loss_scale 8192 | train_wall 4845 | wall 0
2023-03-04 17:22:31 | INFO | fairseq.trainer | begin training epoch 141
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 17:24:08 | INFO | train_inner | epoch 141:     34 / 1978 loss=2.918, nll_loss=0.78, word_ins=2.613, length=3.054, ppl=7.56, wps=21113.1, ups=0.35, wpb=59562.9, bsz=2009.9, num_updates=276900, lr=0.000190037, gnorm=1.418, loss_scale=8192, train_wall=234, wall=0
2023-03-04 17:28:03 | INFO | train_inner | epoch 141:    134 / 1978 loss=2.92, nll_loss=0.781, word_ins=2.614, length=3.063, ppl=7.57, wps=25036.5, ups=0.43, wpb=58760.8, bsz=1978.1, num_updates=277000, lr=0.000190003, gnorm=1.415, loss_scale=8192, train_wall=234, wall=0
2023-03-04 17:29:28 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 17:32:04 | INFO | train_inner | epoch 141:    235 / 1978 loss=2.907, nll_loss=0.772, word_ins=2.606, length=3.011, ppl=7.5, wps=24657.8, ups=0.42, wpb=59265.5, bsz=2028, num_updates=277100, lr=0.000189969, gnorm=1.365, loss_scale=8192, train_wall=240, wall=0
2023-03-04 17:36:01 | INFO | train_inner | epoch 141:    335 / 1978 loss=2.895, nll_loss=0.764, word_ins=2.598, length=2.966, ppl=7.44, wps=25173.5, ups=0.42, wpb=59672.2, bsz=2055.4, num_updates=277200, lr=0.000189934, gnorm=1.357, loss_scale=8192, train_wall=237, wall=0
2023-03-04 17:39:56 | INFO | train_inner | epoch 141:    435 / 1978 loss=2.895, nll_loss=0.763, word_ins=2.598, length=2.973, ppl=7.44, wps=25406.9, ups=0.42, wpb=59884.1, bsz=2110, num_updates=277300, lr=0.0001899, gnorm=1.371, loss_scale=8192, train_wall=235, wall=0
2023-03-04 17:43:47 | INFO | train_inner | epoch 141:    535 / 1978 loss=2.926, nll_loss=0.789, word_ins=2.621, length=3.044, ppl=7.6, wps=25514, ups=0.43, wpb=58991, bsz=2013.8, num_updates=277400, lr=0.000189866, gnorm=1.478, loss_scale=8192, train_wall=231, wall=0
2023-03-04 17:47:45 | INFO | train_inner | epoch 141:    635 / 1978 loss=2.938, nll_loss=0.8, word_ins=2.631, length=3.075, ppl=7.67, wps=24965.8, ups=0.42, wpb=59322.7, bsz=1895.5, num_updates=277500, lr=0.000189832, gnorm=1.446, loss_scale=8192, train_wall=237, wall=0
2023-03-04 17:51:44 | INFO | train_inner | epoch 141:    735 / 1978 loss=2.924, nll_loss=0.788, word_ins=2.621, length=3.031, ppl=7.59, wps=24834.2, ups=0.42, wpb=59327.7, bsz=1979, num_updates=277600, lr=0.000189797, gnorm=1.453, loss_scale=8192, train_wall=238, wall=0
2023-03-04 17:55:44 | INFO | train_inner | epoch 141:    835 / 1978 loss=2.898, nll_loss=0.765, word_ins=2.599, length=2.996, ppl=7.46, wps=24995, ups=0.42, wpb=59899.1, bsz=2069.6, num_updates=277700, lr=0.000189763, gnorm=1.34, loss_scale=8192, train_wall=239, wall=0
2023-03-04 17:59:42 | INFO | train_inner | epoch 141:    935 / 1978 loss=2.926, nll_loss=0.791, word_ins=2.623, length=3.034, ppl=7.6, wps=24795.6, ups=0.42, wpb=59055.3, bsz=2004.2, num_updates=277800, lr=0.000189729, gnorm=1.416, loss_scale=8192, train_wall=238, wall=0
2023-03-04 18:03:40 | INFO | train_inner | epoch 141:   1035 / 1978 loss=2.928, nll_loss=0.795, word_ins=2.627, length=3.005, ppl=7.61, wps=24560.6, ups=0.42, wpb=58554.9, bsz=1992.4, num_updates=277900, lr=0.000189695, gnorm=1.412, loss_scale=8192, train_wall=238, wall=0
2023-03-04 18:07:38 | INFO | train_inner | epoch 141:   1135 / 1978 loss=2.911, nll_loss=0.772, word_ins=2.605, length=3.061, ppl=7.52, wps=24879.7, ups=0.42, wpb=59212.7, bsz=2061.7, num_updates=278000, lr=0.000189661, gnorm=1.411, loss_scale=8192, train_wall=238, wall=0
2023-03-04 18:11:37 | INFO | train_inner | epoch 141:   1235 / 1978 loss=2.916, nll_loss=0.78, word_ins=2.613, length=3.035, ppl=7.55, wps=24805.2, ups=0.42, wpb=59150.7, bsz=2077.4, num_updates=278100, lr=0.000189627, gnorm=1.4, loss_scale=8192, train_wall=238, wall=0
2023-03-04 18:15:36 | INFO | train_inner | epoch 141:   1335 / 1978 loss=2.934, nll_loss=0.792, word_ins=2.624, length=3.098, ppl=7.64, wps=24859.9, ups=0.42, wpb=59504.6, bsz=1929.4, num_updates=278200, lr=0.000189593, gnorm=1.436, loss_scale=8192, train_wall=239, wall=0
2023-03-04 18:19:35 | INFO | train_inner | epoch 141:   1435 / 1978 loss=2.919, nll_loss=0.783, word_ins=2.615, length=3.039, ppl=7.56, wps=25036.3, ups=0.42, wpb=59856.2, bsz=2001, num_updates=278300, lr=0.000189559, gnorm=1.39, loss_scale=8192, train_wall=239, wall=0
2023-03-04 18:23:32 | INFO | train_inner | epoch 141:   1535 / 1978 loss=2.915, nll_loss=0.781, word_ins=2.614, length=3.015, ppl=7.54, wps=25020, ups=0.42, wpb=59341, bsz=2073.4, num_updates=278400, lr=0.000189525, gnorm=1.399, loss_scale=8192, train_wall=237, wall=0
2023-03-04 18:27:32 | INFO | train_inner | epoch 141:   1635 / 1978 loss=2.97, nll_loss=0.828, word_ins=2.657, length=3.13, ppl=7.84, wps=24506.5, ups=0.42, wpb=58737.9, bsz=1808.3, num_updates=278500, lr=0.00018949, gnorm=1.474, loss_scale=8192, train_wall=239, wall=0
2023-03-04 18:31:30 | INFO | train_inner | epoch 141:   1735 / 1978 loss=2.906, nll_loss=0.766, word_ins=2.599, length=3.064, ppl=7.49, wps=24954.1, ups=0.42, wpb=59415.6, bsz=2067.6, num_updates=278600, lr=0.000189456, gnorm=1.387, loss_scale=8192, train_wall=238, wall=0
2023-03-04 18:35:28 | INFO | train_inner | epoch 141:   1835 / 1978 loss=2.924, nll_loss=0.783, word_ins=2.615, length=3.087, ppl=7.59, wps=24885.3, ups=0.42, wpb=59257.8, bsz=2003.4, num_updates=278700, lr=0.000189422, gnorm=1.445, loss_scale=8192, train_wall=238, wall=0
2023-03-04 18:39:25 | INFO | train_inner | epoch 141:   1935 / 1978 loss=2.936, nll_loss=0.798, word_ins=2.63, length=3.066, ppl=7.65, wps=24900.2, ups=0.42, wpb=58882.4, bsz=1977, num_updates=278800, lr=0.000189389, gnorm=1.41, loss_scale=8192, train_wall=236, wall=0
2023-03-04 18:41:06 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 18:41:22 | INFO | valid | epoch 141 | valid on 'valid' subset | loss 4.165 | nll_loss 1.933 | word_ins 3.697 | length 4.675 | ppl 17.93 | wps 30322.9 | wpb 40242.5 | bsz 1500 | num_updates 278843 | best_loss 4.034
2023-03-04 18:41:22 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 18:41:29 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint141.pt (epoch 141 @ 278843 updates, score 4.165) (writing took 6.901502635329962 seconds)
2023-03-04 18:41:29 | INFO | fairseq_cli.train | end of epoch 141 (average epoch stats below)
2023-03-04 18:41:29 | INFO | train | epoch 141 | loss 2.921 | nll_loss 0.784 | word_ins 2.617 | length 3.043 | ppl 7.57 | wps 24735.6 | ups 0.42 | wpb 59284 | bsz 2002.8 | num_updates 278843 | lr 0.000189374 | gnorm 1.415 | loss_scale 8192 | train_wall 4690 | wall 0
2023-03-04 18:41:29 | INFO | fairseq.trainer | begin training epoch 142
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 18:43:53 | INFO | train_inner | epoch 142:     57 / 1978 loss=2.937, nll_loss=0.794, word_ins=2.626, length=3.11, ppl=7.66, wps=21936.7, ups=0.37, wpb=58747.7, bsz=1892, num_updates=278900, lr=0.000189355, gnorm=1.46, loss_scale=8192, train_wall=236, wall=0
2023-03-04 18:47:48 | INFO | train_inner | epoch 142:    157 / 1978 loss=2.904, nll_loss=0.77, word_ins=2.605, length=2.99, ppl=7.49, wps=25108.3, ups=0.42, wpb=59223, bsz=2080.3, num_updates=279000, lr=0.000189321, gnorm=1.355, loss_scale=8192, train_wall=236, wall=0
2023-03-04 18:51:40 | INFO | train_inner | epoch 142:    257 / 1978 loss=2.928, nll_loss=0.788, word_ins=2.621, length=3.074, ppl=7.61, wps=25706.7, ups=0.43, wpb=59421.7, bsz=1950.3, num_updates=279100, lr=0.000189287, gnorm=1.417, loss_scale=8192, train_wall=231, wall=0
2023-03-04 18:55:29 | INFO | train_inner | epoch 142:    357 / 1978 loss=2.919, nll_loss=0.783, word_ins=2.616, length=3.025, ppl=7.56, wps=25433.9, ups=0.44, wpb=58389.4, bsz=2006.4, num_updates=279200, lr=0.000189253, gnorm=1.428, loss_scale=8192, train_wall=229, wall=0
2023-03-04 18:59:19 | INFO | train_inner | epoch 142:    457 / 1978 loss=2.91, nll_loss=0.773, word_ins=2.606, length=3.034, ppl=7.52, wps=25884.3, ups=0.43, wpb=59598.7, bsz=2020.3, num_updates=279300, lr=0.000189219, gnorm=1.412, loss_scale=8192, train_wall=230, wall=0
2023-03-04 19:03:10 | INFO | train_inner | epoch 142:    557 / 1978 loss=2.905, nll_loss=0.769, word_ins=2.602, length=3.03, ppl=7.49, wps=25814.4, ups=0.43, wpb=59595.6, bsz=2039, num_updates=279400, lr=0.000189185, gnorm=1.408, loss_scale=8192, train_wall=231, wall=0
2023-03-04 19:07:02 | INFO | train_inner | epoch 142:    657 / 1978 loss=2.896, nll_loss=0.767, word_ins=2.6, length=2.958, ppl=7.44, wps=25751.2, ups=0.43, wpb=59690.4, bsz=2109.2, num_updates=279500, lr=0.000189151, gnorm=1.361, loss_scale=8192, train_wall=232, wall=0
2023-03-04 19:10:53 | INFO | train_inner | epoch 142:    757 / 1978 loss=2.92, nll_loss=0.779, word_ins=2.612, length=3.079, ppl=7.57, wps=25574.6, ups=0.43, wpb=59098.1, bsz=1971.6, num_updates=279600, lr=0.000189117, gnorm=1.461, loss_scale=8192, train_wall=231, wall=0
2023-03-04 19:14:52 | INFO | train_inner | epoch 142:    857 / 1978 loss=2.922, nll_loss=0.787, word_ins=2.619, length=3.022, ppl=7.58, wps=25104.3, ups=0.42, wpb=59855.3, bsz=1989.1, num_updates=279700, lr=0.000189084, gnorm=1.438, loss_scale=8192, train_wall=238, wall=0
2023-03-04 19:18:51 | INFO | train_inner | epoch 142:    957 / 1978 loss=2.922, nll_loss=0.785, word_ins=2.618, length=3.042, ppl=7.58, wps=24816.5, ups=0.42, wpb=59512.9, bsz=1964.5, num_updates=279800, lr=0.00018905, gnorm=1.392, loss_scale=8192, train_wall=239, wall=0
2023-03-04 19:22:42 | INFO | train_inner | epoch 142:   1057 / 1978 loss=2.938, nll_loss=0.801, word_ins=2.633, length=3.056, ppl=7.67, wps=25581.3, ups=0.43, wpb=59082.9, bsz=2011.3, num_updates=279900, lr=0.000189016, gnorm=1.442, loss_scale=8192, train_wall=231, wall=0
2023-03-04 19:26:34 | INFO | train_inner | epoch 142:   1157 / 1978 loss=2.904, nll_loss=0.772, word_ins=2.605, length=2.985, ppl=7.48, wps=25682.6, ups=0.43, wpb=59372.5, bsz=2107.7, num_updates=280000, lr=0.000188982, gnorm=1.402, loss_scale=8192, train_wall=231, wall=0
2023-03-04 19:30:24 | INFO | train_inner | epoch 142:   1257 / 1978 loss=2.927, nll_loss=0.787, word_ins=2.619, length=3.081, ppl=7.61, wps=25787.6, ups=0.43, wpb=59377.2, bsz=1957.6, num_updates=280100, lr=0.000188948, gnorm=1.419, loss_scale=8192, train_wall=230, wall=0
2023-03-04 19:34:14 | INFO | train_inner | epoch 142:   1357 / 1978 loss=2.93, nll_loss=0.791, word_ins=2.623, length=3.078, ppl=7.62, wps=25838.3, ups=0.44, wpb=59355.6, bsz=1962.5, num_updates=280200, lr=0.000188915, gnorm=1.374, loss_scale=8192, train_wall=229, wall=0
2023-03-04 19:38:03 | INFO | train_inner | epoch 142:   1457 / 1978 loss=2.941, nll_loss=0.802, word_ins=2.634, length=3.068, ppl=7.68, wps=25736.1, ups=0.44, wpb=59049.2, bsz=1948.4, num_updates=280300, lr=0.000188881, gnorm=1.435, loss_scale=8192, train_wall=229, wall=0
2023-03-04 19:41:52 | INFO | train_inner | epoch 142:   1557 / 1978 loss=2.944, nll_loss=0.801, word_ins=2.632, length=3.121, ppl=7.69, wps=25903.1, ups=0.44, wpb=59424.6, bsz=1895.2, num_updates=280400, lr=0.000188847, gnorm=1.46, loss_scale=8192, train_wall=229, wall=0
2023-03-04 19:45:45 | INFO | train_inner | epoch 142:   1657 / 1978 loss=2.903, nll_loss=0.772, word_ins=2.605, length=2.984, ppl=7.48, wps=25740.6, ups=0.43, wpb=59758, bsz=2080.2, num_updates=280500, lr=0.000188814, gnorm=1.406, loss_scale=8192, train_wall=232, wall=0
2023-03-04 19:49:35 | INFO | train_inner | epoch 142:   1757 / 1978 loss=2.918, nll_loss=0.781, word_ins=2.614, length=3.047, ppl=7.56, wps=25604.5, ups=0.43, wpb=59129, bsz=1999.7, num_updates=280600, lr=0.00018878, gnorm=1.47, loss_scale=8192, train_wall=231, wall=0
2023-03-04 19:53:25 | INFO | train_inner | epoch 142:   1857 / 1978 loss=2.939, nll_loss=0.8, word_ins=2.631, length=3.073, ppl=7.67, wps=25461.8, ups=0.43, wpb=58555.9, bsz=1923.2, num_updates=280700, lr=0.000188746, gnorm=1.388, loss_scale=8192, train_wall=230, wall=0
2023-03-04 19:57:17 | INFO | train_inner | epoch 142:   1957 / 1978 loss=2.929, nll_loss=0.792, word_ins=2.624, length=3.048, ppl=7.61, wps=25549.2, ups=0.43, wpb=59200.5, bsz=2029.6, num_updates=280800, lr=0.000188713, gnorm=1.429, loss_scale=8192, train_wall=231, wall=0
2023-03-04 19:58:06 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 19:58:19 | INFO | valid | epoch 142 | valid on 'valid' subset | loss 4.136 | nll_loss 1.935 | word_ins 3.693 | length 4.426 | ppl 17.58 | wps 30600.1 | wpb 40242.5 | bsz 1500 | num_updates 280821 | best_loss 4.034
2023-03-04 19:58:19 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 19:58:25 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint142.pt (epoch 142 @ 280821 updates, score 4.136) (writing took 5.490651285275817 seconds)
2023-03-04 19:58:25 | INFO | fairseq_cli.train | end of epoch 142 (average epoch stats below)
2023-03-04 19:58:25 | INFO | train | epoch 142 | loss 2.92 | nll_loss 0.783 | word_ins 2.616 | length 3.04 | ppl 7.57 | wps 25405.7 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 280821 | lr 0.000188706 | gnorm 1.414 | loss_scale 8192 | train_wall 4584 | wall 0
2023-03-04 19:58:25 | INFO | fairseq.trainer | begin training epoch 143
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 20:01:43 | INFO | train_inner | epoch 143:     79 / 1978 loss=2.882, nll_loss=0.755, word_ins=2.59, length=2.924, ppl=7.37, wps=22270.7, ups=0.38, wpb=59139.2, bsz=2113.8, num_updates=280900, lr=0.000188679, gnorm=1.37, loss_scale=8192, train_wall=239, wall=0
2023-03-04 20:05:41 | INFO | train_inner | epoch 143:    179 / 1978 loss=2.915, nll_loss=0.781, word_ins=2.614, length=3.006, ppl=7.54, wps=24725.7, ups=0.42, wpb=58860, bsz=2067.7, num_updates=281000, lr=0.000188646, gnorm=1.355, loss_scale=8192, train_wall=238, wall=0
2023-03-04 20:09:32 | INFO | train_inner | epoch 143:    279 / 1978 loss=2.906, nll_loss=0.773, word_ins=2.607, length=2.983, ppl=7.49, wps=25714.9, ups=0.43, wpb=59428.4, bsz=2041.5, num_updates=281100, lr=0.000188612, gnorm=1.407, loss_scale=8192, train_wall=231, wall=0
2023-03-04 20:10:47 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 20:13:25 | INFO | train_inner | epoch 143:    380 / 1978 loss=2.924, nll_loss=0.786, word_ins=2.619, length=3.055, ppl=7.59, wps=25694, ups=0.43, wpb=60003, bsz=1956.6, num_updates=281200, lr=0.000188579, gnorm=1.488, loss_scale=8192, train_wall=233, wall=0
2023-03-04 20:17:16 | INFO | train_inner | epoch 143:    480 / 1978 loss=2.934, nll_loss=0.792, word_ins=2.625, length=3.09, ppl=7.64, wps=25562.8, ups=0.43, wpb=58979.8, bsz=1917.5, num_updates=281300, lr=0.000188545, gnorm=1.446, loss_scale=8192, train_wall=231, wall=0
2023-03-04 20:21:07 | INFO | train_inner | epoch 143:    580 / 1978 loss=2.921, nll_loss=0.79, word_ins=2.621, length=3.002, ppl=7.58, wps=25775.4, ups=0.43, wpb=59581.9, bsz=2027.1, num_updates=281400, lr=0.000188512, gnorm=1.41, loss_scale=8192, train_wall=231, wall=0
2023-03-04 20:24:58 | INFO | train_inner | epoch 143:    680 / 1978 loss=2.922, nll_loss=0.785, word_ins=2.618, length=3.042, ppl=7.58, wps=25789.8, ups=0.43, wpb=59390, bsz=2022.6, num_updates=281500, lr=0.000188478, gnorm=1.398, loss_scale=8192, train_wall=230, wall=0
2023-03-04 20:28:47 | INFO | train_inner | epoch 143:    780 / 1978 loss=2.94, nll_loss=0.799, word_ins=2.631, length=3.097, ppl=7.68, wps=25614.6, ups=0.44, wpb=58796.8, bsz=1960.2, num_updates=281600, lr=0.000188445, gnorm=1.49, loss_scale=8192, train_wall=229, wall=0
2023-03-04 20:32:40 | INFO | train_inner | epoch 143:    880 / 1978 loss=2.895, nll_loss=0.762, word_ins=2.597, length=2.989, ppl=7.44, wps=25745.9, ups=0.43, wpb=60051.8, bsz=1993.2, num_updates=281700, lr=0.000188411, gnorm=1.411, loss_scale=8192, train_wall=233, wall=0
2023-03-04 20:36:58 | INFO | train_inner | epoch 143:    980 / 1978 loss=2.905, nll_loss=0.768, word_ins=2.602, length=3.038, ppl=7.49, wps=22895.6, ups=0.39, wpb=59006.5, bsz=2016.2, num_updates=281800, lr=0.000188378, gnorm=1.395, loss_scale=8192, train_wall=257, wall=0
2023-03-04 20:41:11 | INFO | train_inner | epoch 143:   1080 / 1978 loss=2.923, nll_loss=0.783, word_ins=2.615, length=3.081, ppl=7.58, wps=23514.7, ups=0.4, wpb=59413.5, bsz=1909, num_updates=281900, lr=0.000188344, gnorm=1.385, loss_scale=8192, train_wall=252, wall=0
2023-03-04 20:45:25 | INFO | train_inner | epoch 143:   1180 / 1978 loss=2.918, nll_loss=0.781, word_ins=2.614, length=3.048, ppl=7.56, wps=23407.6, ups=0.39, wpb=59484, bsz=1994.3, num_updates=282000, lr=0.000188311, gnorm=1.431, loss_scale=8192, train_wall=254, wall=0
2023-03-04 20:49:40 | INFO | train_inner | epoch 143:   1280 / 1978 loss=2.922, nll_loss=0.784, word_ins=2.616, length=3.064, ppl=7.58, wps=23263, ups=0.39, wpb=59453.6, bsz=1998.7, num_updates=282100, lr=0.000188278, gnorm=1.45, loss_scale=8192, train_wall=255, wall=0
2023-03-04 20:53:55 | INFO | train_inner | epoch 143:   1380 / 1978 loss=2.917, nll_loss=0.781, word_ins=2.614, length=3.032, ppl=7.55, wps=23168.5, ups=0.39, wpb=58905.4, bsz=2039.8, num_updates=282200, lr=0.000188244, gnorm=1.405, loss_scale=8192, train_wall=254, wall=0
2023-03-04 20:58:06 | INFO | train_inner | epoch 143:   1480 / 1978 loss=2.915, nll_loss=0.777, word_ins=2.61, length=3.045, ppl=7.54, wps=23343.2, ups=0.4, wpb=58699.5, bsz=1962, num_updates=282300, lr=0.000188211, gnorm=1.415, loss_scale=8192, train_wall=251, wall=0
2023-03-04 21:02:16 | INFO | train_inner | epoch 143:   1580 / 1978 loss=2.921, nll_loss=0.783, word_ins=2.615, length=3.054, ppl=7.57, wps=23629.8, ups=0.4, wpb=59038.3, bsz=2011, num_updates=282400, lr=0.000188177, gnorm=1.375, loss_scale=8192, train_wall=250, wall=0
2023-03-04 21:06:29 | INFO | train_inner | epoch 143:   1680 / 1978 loss=2.918, nll_loss=0.785, word_ins=2.617, length=3.019, ppl=7.56, wps=23379.6, ups=0.4, wpb=59050.5, bsz=2028.1, num_updates=282500, lr=0.000188144, gnorm=1.405, loss_scale=8192, train_wall=252, wall=0
2023-03-04 21:10:43 | INFO | train_inner | epoch 143:   1780 / 1978 loss=2.915, nll_loss=0.78, word_ins=2.613, length=3.023, ppl=7.54, wps=23107.2, ups=0.39, wpb=58869.4, bsz=2072.6, num_updates=282600, lr=0.000188111, gnorm=1.437, loss_scale=8192, train_wall=254, wall=0
2023-03-04 21:14:55 | INFO | train_inner | epoch 143:   1880 / 1978 loss=2.914, nll_loss=0.777, word_ins=2.61, length=3.036, ppl=7.53, wps=23807.8, ups=0.4, wpb=60001.9, bsz=2002.1, num_updates=282700, lr=0.000188078, gnorm=1.47, loss_scale=8192, train_wall=252, wall=0
2023-03-04 21:19:04 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 21:19:19 | INFO | valid | epoch 143 | valid on 'valid' subset | loss 4.096 | nll_loss 1.922 | word_ins 3.685 | length 4.101 | ppl 17.1 | wps 27992.6 | wpb 40242.5 | bsz 1500 | num_updates 282798 | best_loss 4.034
2023-03-04 21:19:19 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 21:19:26 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint143.pt (epoch 143 @ 282798 updates, score 4.096) (writing took 7.1339281145483255 seconds)
2023-03-04 21:19:26 | INFO | fairseq_cli.train | end of epoch 143 (average epoch stats below)
2023-03-04 21:19:26 | INFO | train | epoch 143 | loss 2.917 | nll_loss 0.781 | word_ins 2.614 | length 3.038 | ppl 7.56 | wps 24108.6 | ups 0.41 | wpb 59283 | bsz 2002.6 | num_updates 282798 | lr 0.000188045 | gnorm 1.421 | loss_scale 8192 | train_wall 4826 | wall 0
2023-03-04 21:19:26 | INFO | fairseq.trainer | begin training epoch 144
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 21:19:39 | INFO | train_inner | epoch 144:      2 / 1978 loss=2.929, nll_loss=0.788, word_ins=2.62, length=3.09, ppl=7.61, wps=21009, ups=0.35, wpb=59554.5, bsz=1955.2, num_updates=282800, lr=0.000188044, gnorm=1.475, loss_scale=8192, train_wall=251, wall=0
2023-03-04 21:23:55 | INFO | train_inner | epoch 144:    102 / 1978 loss=2.9, nll_loss=0.765, word_ins=2.599, length=3.001, ppl=7.46, wps=23324, ups=0.39, wpb=59727, bsz=2053.8, num_updates=282900, lr=0.000188011, gnorm=1.413, loss_scale=8192, train_wall=256, wall=0
2023-03-04 21:28:11 | INFO | train_inner | epoch 144:    202 / 1978 loss=2.913, nll_loss=0.78, word_ins=2.614, length=2.997, ppl=7.53, wps=23070.8, ups=0.39, wpb=59001.2, bsz=2031.2, num_updates=283000, lr=0.000187978, gnorm=1.435, loss_scale=8192, train_wall=255, wall=0
2023-03-04 21:32:25 | INFO | train_inner | epoch 144:    302 / 1978 loss=2.909, nll_loss=0.774, word_ins=2.608, length=3.018, ppl=7.51, wps=23308, ups=0.39, wpb=59316.9, bsz=2011.6, num_updates=283100, lr=0.000187945, gnorm=1.43, loss_scale=8192, train_wall=254, wall=0
2023-03-04 21:36:36 | INFO | train_inner | epoch 144:    402 / 1978 loss=2.897, nll_loss=0.762, word_ins=2.596, length=3.012, ppl=7.45, wps=23819.9, ups=0.4, wpb=59716.1, bsz=2082.4, num_updates=283200, lr=0.000187912, gnorm=1.395, loss_scale=8192, train_wall=250, wall=0
2023-03-04 21:40:49 | INFO | train_inner | epoch 144:    502 / 1978 loss=2.906, nll_loss=0.773, word_ins=2.607, length=2.995, ppl=7.5, wps=23419, ups=0.4, wpb=59229.8, bsz=1995, num_updates=283300, lr=0.000187878, gnorm=1.396, loss_scale=8192, train_wall=253, wall=0
2023-03-04 21:45:00 | INFO | train_inner | epoch 144:    602 / 1978 loss=2.919, nll_loss=0.782, word_ins=2.615, length=3.043, ppl=7.57, wps=23537.8, ups=0.4, wpb=59156.9, bsz=1927, num_updates=283400, lr=0.000187845, gnorm=1.428, loss_scale=8192, train_wall=251, wall=0
2023-03-04 21:49:15 | INFO | train_inner | epoch 144:    702 / 1978 loss=2.91, nll_loss=0.772, word_ins=2.605, length=3.051, ppl=7.52, wps=23161, ups=0.39, wpb=58995.7, bsz=2000.6, num_updates=283500, lr=0.000187812, gnorm=1.384, loss_scale=8192, train_wall=254, wall=0
2023-03-04 21:53:27 | INFO | train_inner | epoch 144:    802 / 1978 loss=2.918, nll_loss=0.779, word_ins=2.612, length=3.055, ppl=7.56, wps=23609.5, ups=0.4, wpb=59510.1, bsz=1964.4, num_updates=283600, lr=0.000187779, gnorm=1.431, loss_scale=8192, train_wall=252, wall=0
2023-03-04 21:57:34 | INFO | train_inner | epoch 144:    902 / 1978 loss=2.912, nll_loss=0.777, word_ins=2.61, length=3.027, ppl=7.53, wps=23891, ups=0.4, wpb=59123, bsz=2000.8, num_updates=283700, lr=0.000187746, gnorm=1.409, loss_scale=8192, train_wall=247, wall=0
2023-03-04 22:01:33 | INFO | train_inner | epoch 144:   1002 / 1978 loss=2.913, nll_loss=0.775, word_ins=2.608, length=3.052, ppl=7.53, wps=24854.2, ups=0.42, wpb=59274.3, bsz=2036.9, num_updates=283800, lr=0.000187713, gnorm=1.368, loss_scale=8192, train_wall=238, wall=0
2023-03-04 22:05:30 | INFO | train_inner | epoch 144:   1102 / 1978 loss=2.914, nll_loss=0.781, word_ins=2.614, length=3.008, ppl=7.54, wps=24853.4, ups=0.42, wpb=59007.1, bsz=2034.7, num_updates=283900, lr=0.00018768, gnorm=1.34, loss_scale=8192, train_wall=237, wall=0
2023-03-04 22:09:28 | INFO | train_inner | epoch 144:   1202 / 1978 loss=2.919, nll_loss=0.783, word_ins=2.615, length=3.043, ppl=7.57, wps=24937.9, ups=0.42, wpb=59346.9, bsz=2013.1, num_updates=284000, lr=0.000187647, gnorm=1.413, loss_scale=8192, train_wall=238, wall=0
2023-03-04 22:13:25 | INFO | train_inner | epoch 144:   1302 / 1978 loss=2.937, nll_loss=0.8, word_ins=2.631, length=3.054, ppl=7.66, wps=24985.7, ups=0.42, wpb=59112.4, bsz=1916.5, num_updates=284100, lr=0.000187614, gnorm=1.492, loss_scale=8192, train_wall=236, wall=0
2023-03-04 22:17:22 | INFO | train_inner | epoch 144:   1402 / 1978 loss=2.913, nll_loss=0.778, word_ins=2.611, length=3.024, ppl=7.53, wps=25125.3, ups=0.42, wpb=59658.3, bsz=1980.6, num_updates=284200, lr=0.000187581, gnorm=1.44, loss_scale=8192, train_wall=237, wall=0
2023-03-04 22:21:19 | INFO | train_inner | epoch 144:   1502 / 1978 loss=2.921, nll_loss=0.786, word_ins=2.618, length=3.027, ppl=7.57, wps=24799.2, ups=0.42, wpb=58699.8, bsz=1998.8, num_updates=284300, lr=0.000187548, gnorm=1.391, loss_scale=8192, train_wall=236, wall=0
2023-03-04 22:25:17 | INFO | train_inner | epoch 144:   1602 / 1978 loss=2.91, nll_loss=0.772, word_ins=2.605, length=3.044, ppl=7.51, wps=24915.5, ups=0.42, wpb=59373.3, bsz=2067.8, num_updates=284400, lr=0.000187515, gnorm=1.351, loss_scale=8192, train_wall=238, wall=0
2023-03-04 22:29:16 | INFO | train_inner | epoch 144:   1702 / 1978 loss=2.926, nll_loss=0.789, word_ins=2.62, length=3.055, ppl=7.6, wps=24788, ups=0.42, wpb=59044.1, bsz=2004.3, num_updates=284500, lr=0.000187482, gnorm=1.447, loss_scale=8192, train_wall=238, wall=0
2023-03-04 22:33:14 | INFO | train_inner | epoch 144:   1802 / 1978 loss=2.93, nll_loss=0.793, word_ins=2.624, length=3.058, ppl=7.62, wps=25008.2, ups=0.42, wpb=59541.4, bsz=1964.3, num_updates=284600, lr=0.000187449, gnorm=1.441, loss_scale=8192, train_wall=237, wall=0
2023-03-04 22:37:12 | INFO | train_inner | epoch 144:   1902 / 1978 loss=2.934, nll_loss=0.796, word_ins=2.627, length=3.066, ppl=7.64, wps=24935.3, ups=0.42, wpb=59472.9, bsz=1961, num_updates=284700, lr=0.000187416, gnorm=1.431, loss_scale=8192, train_wall=238, wall=0
2023-03-04 22:40:15 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 22:40:31 | INFO | valid | epoch 144 | valid on 'valid' subset | loss 4.042 | nll_loss 1.916 | word_ins 3.676 | length 3.661 | ppl 16.47 | wps 29713.9 | wpb 40242.5 | bsz 1500 | num_updates 284776 | best_loss 4.034
2023-03-04 22:40:31 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
2023-03-04 22:40:36 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint144.pt (epoch 144 @ 284776 updates, score 4.042) (writing took 5.802800751291215 seconds)
2023-03-04 22:40:37 | INFO | fairseq_cli.train | end of epoch 144 (average epoch stats below)
2023-03-04 22:40:37 | INFO | train | epoch 144 | loss 2.917 | nll_loss 0.78 | word_ins 2.613 | length 3.037 | ppl 7.55 | wps 24076.5 | ups 0.41 | wpb 59284.3 | bsz 2002.6 | num_updates 284776 | lr 0.000187391 | gnorm 1.415 | loss_scale 8192 | train_wall 4833 | wall 0
2023-03-04 22:40:37 | INFO | fairseq.trainer | begin training epoch 145
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 22:41:40 | INFO | train_inner | epoch 145:     24 / 1978 loss=2.916, nll_loss=0.775, word_ins=2.608, length=3.084, ppl=7.55, wps=22170.7, ups=0.37, wpb=59479.4, bsz=2052, num_updates=284800, lr=0.000187383, gnorm=1.417, loss_scale=8192, train_wall=239, wall=0
2023-03-04 22:45:42 | INFO | train_inner | epoch 145:    124 / 1978 loss=2.88, nll_loss=0.752, word_ins=2.587, length=2.931, ppl=7.36, wps=24871.7, ups=0.41, wpb=60092.4, bsz=2150.8, num_updates=284900, lr=0.00018735, gnorm=1.433, loss_scale=8192, train_wall=241, wall=0
2023-03-04 22:49:42 | INFO | train_inner | epoch 145:    224 / 1978 loss=2.918, nll_loss=0.78, word_ins=2.613, length=3.046, ppl=7.56, wps=24646.5, ups=0.42, wpb=59128.9, bsz=1940.6, num_updates=285000, lr=0.000187317, gnorm=1.476, loss_scale=8192, train_wall=240, wall=0
2023-03-04 22:53:41 | INFO | train_inner | epoch 145:    324 / 1978 loss=2.894, nll_loss=0.758, word_ins=2.593, length=3.01, ppl=7.43, wps=24931.6, ups=0.42, wpb=59589.8, bsz=2068.3, num_updates=285100, lr=0.000187284, gnorm=1.381, loss_scale=8192, train_wall=239, wall=0
2023-03-04 22:57:40 | INFO | train_inner | epoch 145:    424 / 1978 loss=2.933, nll_loss=0.794, word_ins=2.626, length=3.074, ppl=7.64, wps=24660.2, ups=0.42, wpb=58854, bsz=2080.1, num_updates=285200, lr=0.000187251, gnorm=1.408, loss_scale=8192, train_wall=238, wall=0
2023-03-04 22:58:55 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-04 23:01:41 | INFO | train_inner | epoch 145:    525 / 1978 loss=2.913, nll_loss=0.777, word_ins=2.61, length=3.027, ppl=7.53, wps=24550.9, ups=0.41, wpb=59368.8, bsz=1988.8, num_updates=285300, lr=0.000187219, gnorm=1.412, loss_scale=8192, train_wall=241, wall=0
2023-03-04 23:05:41 | INFO | train_inner | epoch 145:    625 / 1978 loss=2.914, nll_loss=0.779, word_ins=2.612, length=3.02, ppl=7.54, wps=24619.1, ups=0.42, wpb=58852.8, bsz=2018.8, num_updates=285400, lr=0.000187186, gnorm=1.405, loss_scale=8192, train_wall=239, wall=0
2023-03-04 23:09:39 | INFO | train_inner | epoch 145:    725 / 1978 loss=2.907, nll_loss=0.769, word_ins=2.603, length=3.039, ppl=7.5, wps=25046.6, ups=0.42, wpb=59687.8, bsz=1959.1, num_updates=285500, lr=0.000187153, gnorm=1.424, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:13:38 | INFO | train_inner | epoch 145:    825 / 1978 loss=2.912, nll_loss=0.777, word_ins=2.61, length=3.017, ppl=7.52, wps=24732.5, ups=0.42, wpb=59257.2, bsz=2024.7, num_updates=285600, lr=0.00018712, gnorm=1.379, loss_scale=8192, train_wall=239, wall=0
2023-03-04 23:17:43 | INFO | train_inner | epoch 145:    925 / 1978 loss=2.931, nll_loss=0.791, word_ins=2.623, length=3.082, ppl=7.62, wps=24288.1, ups=0.41, wpb=59350.7, bsz=1922.5, num_updates=285700, lr=0.000187088, gnorm=1.378, loss_scale=8192, train_wall=244, wall=0
2023-03-04 23:21:41 | INFO | train_inner | epoch 145:   1025 / 1978 loss=2.906, nll_loss=0.77, word_ins=2.604, length=3.02, ppl=7.5, wps=24914.9, ups=0.42, wpb=59294.4, bsz=2047.9, num_updates=285800, lr=0.000187055, gnorm=1.392, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:25:39 | INFO | train_inner | epoch 145:   1125 / 1978 loss=2.929, nll_loss=0.794, word_ins=2.625, length=3.034, ppl=7.61, wps=24766.1, ups=0.42, wpb=59027.5, bsz=1994.4, num_updates=285900, lr=0.000187022, gnorm=1.47, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:29:37 | INFO | train_inner | epoch 145:   1225 / 1978 loss=2.918, nll_loss=0.78, word_ins=2.613, length=3.05, ppl=7.56, wps=25181.9, ups=0.42, wpb=59907.7, bsz=1915.2, num_updates=286000, lr=0.000186989, gnorm=1.463, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:33:36 | INFO | train_inner | epoch 145:   1325 / 1978 loss=2.926, nll_loss=0.787, word_ins=2.619, length=3.064, ppl=7.6, wps=25031.1, ups=0.42, wpb=59703.2, bsz=1928, num_updates=286100, lr=0.000186957, gnorm=1.495, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:37:31 | INFO | train_inner | epoch 145:   1425 / 1978 loss=2.926, nll_loss=0.787, word_ins=2.619, length=3.074, ppl=7.6, wps=24756.9, ups=0.42, wpb=58382.6, bsz=1966.5, num_updates=286200, lr=0.000186924, gnorm=1.436, loss_scale=8192, train_wall=236, wall=0
2023-03-04 23:41:29 | INFO | train_inner | epoch 145:   1525 / 1978 loss=2.934, nll_loss=0.796, word_ins=2.626, length=3.076, ppl=7.64, wps=25011.7, ups=0.42, wpb=59538.6, bsz=1907.4, num_updates=286300, lr=0.000186891, gnorm=1.401, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:45:29 | INFO | train_inner | epoch 145:   1625 / 1978 loss=2.895, nll_loss=0.761, word_ins=2.595, length=2.998, ppl=7.44, wps=24510, ups=0.42, wpb=58605.4, bsz=2103, num_updates=286400, lr=0.000186859, gnorm=1.367, loss_scale=8192, train_wall=239, wall=0
2023-03-04 23:49:26 | INFO | train_inner | epoch 145:   1725 / 1978 loss=2.923, nll_loss=0.789, word_ins=2.62, length=3.026, ppl=7.58, wps=25099.9, ups=0.42, wpb=59611.9, bsz=1963.3, num_updates=286500, lr=0.000186826, gnorm=1.499, loss_scale=8192, train_wall=237, wall=0
2023-03-04 23:53:24 | INFO | train_inner | epoch 145:   1825 / 1978 loss=2.925, nll_loss=0.786, word_ins=2.618, length=3.067, ppl=7.59, wps=24833.3, ups=0.42, wpb=59102.3, bsz=1964.7, num_updates=286600, lr=0.000186794, gnorm=1.378, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:57:23 | INFO | train_inner | epoch 145:   1925 / 1978 loss=2.935, nll_loss=0.803, word_ins=2.633, length=3.017, ppl=7.65, wps=24738.5, ups=0.42, wpb=59071.7, bsz=2007.6, num_updates=286700, lr=0.000186761, gnorm=1.422, loss_scale=8192, train_wall=238, wall=0
2023-03-04 23:59:28 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 23:59:41 | INFO | valid | epoch 145 | valid on 'valid' subset | loss 4.123 | nll_loss 1.928 | word_ins 3.691 | length 4.321 | ppl 17.43 | wps 23540.6 | wpb 40242.5 | bsz 1500 | num_updates 286753 | best_loss 4.034
2023-03-04 23:59:41 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-04 23:59:47 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint145.pt (epoch 145 @ 286753 updates, score 4.123) (writing took 6.0298621179535985 seconds)
2023-03-04 23:59:47 | INFO | fairseq_cli.train | end of epoch 145 (average epoch stats below)
2023-03-04 23:59:47 | INFO | train | epoch 145 | loss 2.916 | nll_loss 0.78 | word_ins 2.613 | length 3.033 | ppl 7.55 | wps 24670.2 | ups 0.42 | wpb 59284.3 | bsz 2002.7 | num_updates 286753 | lr 0.000186744 | gnorm 1.42 | loss_scale 8192 | train_wall 4717 | wall 0
2023-03-04 23:59:47 | INFO | fairseq.trainer | begin training epoch 146
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 00:01:47 | INFO | train_inner | epoch 146:     47 / 1978 loss=2.905, nll_loss=0.773, word_ins=2.606, length=2.988, ppl=7.49, wps=22488.4, ups=0.38, wpb=59399.9, bsz=2073.7, num_updates=286800, lr=0.000186728, gnorm=1.466, loss_scale=8192, train_wall=235, wall=0
2023-03-05 00:05:46 | INFO | train_inner | epoch 146:    147 / 1978 loss=2.924, nll_loss=0.789, word_ins=2.621, length=3.033, ppl=7.59, wps=24940.6, ups=0.42, wpb=59569.3, bsz=1967.8, num_updates=286900, lr=0.000186696, gnorm=1.459, loss_scale=8192, train_wall=239, wall=0
2023-03-05 00:09:45 | INFO | train_inner | epoch 146:    247 / 1978 loss=2.937, nll_loss=0.798, word_ins=2.63, length=3.074, ppl=7.66, wps=24520.9, ups=0.42, wpb=58562.9, bsz=1917, num_updates=287000, lr=0.000186663, gnorm=1.468, loss_scale=8192, train_wall=239, wall=0
2023-03-05 00:13:42 | INFO | train_inner | epoch 146:    347 / 1978 loss=2.927, nll_loss=0.784, word_ins=2.616, length=3.105, ppl=7.6, wps=24991.9, ups=0.42, wpb=59376.9, bsz=1923.4, num_updates=287100, lr=0.000186631, gnorm=1.459, loss_scale=8192, train_wall=237, wall=0
2023-03-05 00:17:40 | INFO | train_inner | epoch 146:    447 / 1978 loss=2.904, nll_loss=0.771, word_ins=2.604, length=2.999, ppl=7.48, wps=25090.1, ups=0.42, wpb=59637.9, bsz=1997.4, num_updates=287200, lr=0.000186598, gnorm=1.472, loss_scale=8192, train_wall=237, wall=0
2023-03-05 00:21:38 | INFO | train_inner | epoch 146:    547 / 1978 loss=2.926, nll_loss=0.791, word_ins=2.623, length=3.03, ppl=7.6, wps=24863, ups=0.42, wpb=59215.9, bsz=1955.1, num_updates=287300, lr=0.000186566, gnorm=1.443, loss_scale=8192, train_wall=238, wall=0
2023-03-05 00:25:32 | INFO | train_inner | epoch 146:    647 / 1978 loss=2.915, nll_loss=0.779, word_ins=2.612, length=3.032, ppl=7.54, wps=25578.3, ups=0.43, wpb=59792.4, bsz=1939.7, num_updates=287400, lr=0.000186533, gnorm=1.419, loss_scale=8192, train_wall=234, wall=0
2023-03-05 00:29:34 | INFO | train_inner | epoch 146:    747 / 1978 loss=2.908, nll_loss=0.775, word_ins=2.608, length=3.002, ppl=7.51, wps=24439.3, ups=0.41, wpb=59284.1, bsz=2038.7, num_updates=287500, lr=0.000186501, gnorm=1.4, loss_scale=8192, train_wall=242, wall=0
2023-03-05 00:33:28 | INFO | train_inner | epoch 146:    847 / 1978 loss=2.916, nll_loss=0.78, word_ins=2.613, length=3.031, ppl=7.55, wps=25112.7, ups=0.43, wpb=58748, bsz=2097.7, num_updates=287600, lr=0.000186469, gnorm=1.362, loss_scale=8192, train_wall=234, wall=0
2023-03-05 00:37:32 | INFO | train_inner | epoch 146:    947 / 1978 loss=2.903, nll_loss=0.769, word_ins=2.602, length=3.007, ppl=7.48, wps=24318.7, ups=0.41, wpb=59309.2, bsz=1988.4, num_updates=287700, lr=0.000186436, gnorm=1.364, loss_scale=8192, train_wall=244, wall=0
2023-03-05 00:41:48 | INFO | train_inner | epoch 146:   1047 / 1978 loss=2.898, nll_loss=0.766, word_ins=2.6, length=2.977, ppl=7.45, wps=23103.3, ups=0.39, wpb=59090.7, bsz=2127.3, num_updates=287800, lr=0.000186404, gnorm=1.393, loss_scale=8192, train_wall=255, wall=0
2023-03-05 00:46:01 | INFO | train_inner | epoch 146:   1147 / 1978 loss=2.893, nll_loss=0.761, word_ins=2.595, length=2.985, ppl=7.43, wps=23656.2, ups=0.4, wpb=59842.1, bsz=2082.6, num_updates=287900, lr=0.000186371, gnorm=1.386, loss_scale=8192, train_wall=253, wall=0
2023-03-05 00:50:20 | INFO | train_inner | epoch 146:   1247 / 1978 loss=2.909, nll_loss=0.778, word_ins=2.611, length=2.982, ppl=7.51, wps=22903.8, ups=0.39, wpb=59349.2, bsz=1998.1, num_updates=288000, lr=0.000186339, gnorm=1.425, loss_scale=8192, train_wall=259, wall=0
2023-03-05 00:54:45 | INFO | train_inner | epoch 146:   1347 / 1978 loss=2.929, nll_loss=0.795, word_ins=2.627, length=3.02, ppl=7.61, wps=22196.1, ups=0.38, wpb=58857.1, bsz=1965.7, num_updates=288100, lr=0.000186307, gnorm=1.468, loss_scale=8192, train_wall=265, wall=0
2023-03-05 00:59:12 | INFO | train_inner | epoch 146:   1447 / 1978 loss=2.91, nll_loss=0.772, word_ins=2.606, length=3.045, ppl=7.52, wps=22119.2, ups=0.38, wpb=58911.6, bsz=2031.1, num_updates=288200, lr=0.000186274, gnorm=1.475, loss_scale=8192, train_wall=266, wall=0
2023-03-05 01:03:40 | INFO | train_inner | epoch 146:   1547 / 1978 loss=2.916, nll_loss=0.782, word_ins=2.614, length=3.018, ppl=7.55, wps=22326, ups=0.37, wpb=59824.5, bsz=2057, num_updates=288300, lr=0.000186242, gnorm=1.416, loss_scale=8192, train_wall=268, wall=0
2023-03-05 01:08:03 | INFO | train_inner | epoch 146:   1647 / 1978 loss=2.92, nll_loss=0.78, word_ins=2.613, length=3.074, ppl=7.57, wps=22565.7, ups=0.38, wpb=59492.8, bsz=1937.2, num_updates=288400, lr=0.00018621, gnorm=1.487, loss_scale=8192, train_wall=263, wall=0
2023-03-05 01:12:31 | INFO | train_inner | epoch 146:   1747 / 1978 loss=2.929, nll_loss=0.791, word_ins=2.623, length=3.055, ppl=7.61, wps=22079.8, ups=0.37, wpb=59064.8, bsz=1998.4, num_updates=288500, lr=0.000186177, gnorm=1.394, loss_scale=8192, train_wall=267, wall=0
2023-03-05 01:16:57 | INFO | train_inner | epoch 146:   1847 / 1978 loss=2.931, nll_loss=0.787, word_ins=2.618, length=3.124, ppl=7.62, wps=22212.2, ups=0.38, wpb=59151.5, bsz=1973.2, num_updates=288600, lr=0.000186145, gnorm=1.445, loss_scale=8192, train_wall=266, wall=0
2023-03-05 01:21:25 | INFO | train_inner | epoch 146:   1947 / 1978 loss=2.9, nll_loss=0.766, word_ins=2.6, length=3.008, ppl=7.47, wps=22131.6, ups=0.37, wpb=59287.8, bsz=2014.8, num_updates=288700, lr=0.000186113, gnorm=1.337, loss_scale=8192, train_wall=268, wall=0
2023-03-05 01:22:49 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 01:23:05 | INFO | valid | epoch 146 | valid on 'valid' subset | loss 4.083 | nll_loss 1.906 | word_ins 3.666 | length 4.167 | ppl 16.94 | wps 22956 | wpb 40242.5 | bsz 1500 | num_updates 288731 | best_loss 4.034
2023-03-05 01:23:05 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-05 01:23:13 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint146.pt (epoch 146 @ 288731 updates, score 4.083) (writing took 7.494593943469226 seconds)
2023-03-05 01:23:13 | INFO | fairseq_cli.train | end of epoch 146 (average epoch stats below)
2023-03-05 01:23:13 | INFO | train | epoch 146 | loss 2.915 | nll_loss 0.779 | word_ins 2.612 | length 3.031 | ppl 7.54 | wps 23427.8 | ups 0.4 | wpb 59284.3 | bsz 2002.6 | num_updates 288731 | lr 0.000186103 | gnorm 1.428 | loss_scale 8192 | train_wall 4966 | wall 0
2023-03-05 01:23:13 | INFO | fairseq.trainer | begin training epoch 147
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 01:26:24 | INFO | train_inner | epoch 147:     69 / 1978 loss=2.9, nll_loss=0.764, word_ins=2.598, length=3.012, ppl=7.46, wps=19767.3, ups=0.33, wpb=59035, bsz=2055.1, num_updates=288800, lr=0.000186081, gnorm=1.434, loss_scale=8192, train_wall=265, wall=0
2023-03-05 01:30:49 | INFO | train_inner | epoch 147:    169 / 1978 loss=2.925, nll_loss=0.788, word_ins=2.62, length=3.044, ppl=7.59, wps=22357.6, ups=0.38, wpb=59404.9, bsz=1898, num_updates=288900, lr=0.000186049, gnorm=1.477, loss_scale=8192, train_wall=265, wall=0
2023-03-05 01:35:17 | INFO | train_inner | epoch 147:    269 / 1978 loss=2.902, nll_loss=0.768, word_ins=2.602, length=3.001, ppl=7.47, wps=22322.7, ups=0.37, wpb=59649.5, bsz=2028.6, num_updates=289000, lr=0.000186016, gnorm=1.409, loss_scale=8192, train_wall=267, wall=0
2023-03-05 01:39:43 | INFO | train_inner | epoch 147:    369 / 1978 loss=2.912, nll_loss=0.777, word_ins=2.61, length=3.016, ppl=7.53, wps=22365.3, ups=0.38, wpb=59589.3, bsz=1971.1, num_updates=289100, lr=0.000185984, gnorm=1.478, loss_scale=8192, train_wall=266, wall=0
2023-03-05 01:44:11 | INFO | train_inner | epoch 147:    469 / 1978 loss=2.922, nll_loss=0.784, word_ins=2.616, length=3.063, ppl=7.58, wps=21913.4, ups=0.37, wpb=58773.2, bsz=1942, num_updates=289200, lr=0.000185952, gnorm=1.421, loss_scale=8192, train_wall=268, wall=0
2023-03-05 01:48:39 | INFO | train_inner | epoch 147:    569 / 1978 loss=2.916, nll_loss=0.779, word_ins=2.612, length=3.043, ppl=7.55, wps=22129, ups=0.37, wpb=59307.8, bsz=1957.5, num_updates=289300, lr=0.00018592, gnorm=1.495, loss_scale=8192, train_wall=268, wall=0
2023-03-05 01:50:10 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-05 01:53:09 | INFO | train_inner | epoch 147:    670 / 1978 loss=2.911, nll_loss=0.772, word_ins=2.605, length=3.059, ppl=7.52, wps=21894.2, ups=0.37, wpb=59150.6, bsz=2008.2, num_updates=289400, lr=0.000185888, gnorm=1.377, loss_scale=8192, train_wall=270, wall=0
2023-03-05 01:57:37 | INFO | train_inner | epoch 147:    770 / 1978 loss=2.908, nll_loss=0.777, word_ins=2.609, length=2.989, ppl=7.51, wps=22220.1, ups=0.37, wpb=59482.7, bsz=2059.9, num_updates=289500, lr=0.000185856, gnorm=1.403, loss_scale=8192, train_wall=267, wall=0
2023-03-05 02:02:04 | INFO | train_inner | epoch 147:    870 / 1978 loss=2.921, nll_loss=0.786, word_ins=2.618, length=3.029, ppl=7.58, wps=22206.7, ups=0.37, wpb=59220.5, bsz=1987.2, num_updates=289600, lr=0.000185824, gnorm=1.44, loss_scale=8192, train_wall=266, wall=0
2023-03-05 02:06:30 | INFO | train_inner | epoch 147:    970 / 1978 loss=2.916, nll_loss=0.777, word_ins=2.611, length=3.054, ppl=7.55, wps=22284.8, ups=0.38, wpb=59327.5, bsz=2021.3, num_updates=289700, lr=0.000185791, gnorm=1.418, loss_scale=8192, train_wall=266, wall=0
2023-03-05 02:11:00 | INFO | train_inner | epoch 147:   1070 / 1978 loss=2.894, nll_loss=0.759, word_ins=2.594, length=3, ppl=7.43, wps=22004.5, ups=0.37, wpb=59375.5, bsz=2084.3, num_updates=289800, lr=0.000185759, gnorm=1.48, loss_scale=8192, train_wall=270, wall=0
2023-03-05 02:15:27 | INFO | train_inner | epoch 147:   1170 / 1978 loss=2.902, nll_loss=0.765, word_ins=2.599, length=3.027, ppl=7.47, wps=22277.5, ups=0.37, wpb=59478.8, bsz=2015.4, num_updates=289900, lr=0.000185727, gnorm=1.394, loss_scale=8192, train_wall=267, wall=0
2023-03-05 02:19:51 | INFO | train_inner | epoch 147:   1270 / 1978 loss=2.908, nll_loss=0.774, word_ins=2.608, length=3.008, ppl=7.51, wps=22251.3, ups=0.38, wpb=58756.8, bsz=2071.9, num_updates=290000, lr=0.000185695, gnorm=1.35, loss_scale=8192, train_wall=264, wall=0
2023-03-05 02:24:22 | INFO | train_inner | epoch 147:   1370 / 1978 loss=2.907, nll_loss=0.772, word_ins=2.605, length=3.015, ppl=7.5, wps=21906.1, ups=0.37, wpb=59404.3, bsz=2068.7, num_updates=290100, lr=0.000185663, gnorm=1.43, loss_scale=8192, train_wall=271, wall=0
2023-03-05 02:28:47 | INFO | train_inner | epoch 147:   1470 / 1978 loss=2.922, nll_loss=0.788, word_ins=2.62, length=3.026, ppl=7.58, wps=22447.5, ups=0.38, wpb=59543.8, bsz=1941.4, num_updates=290200, lr=0.000185631, gnorm=1.469, loss_scale=8192, train_wall=265, wall=0
2023-03-05 02:33:12 | INFO | train_inner | epoch 147:   1570 / 1978 loss=2.935, nll_loss=0.791, word_ins=2.623, length=3.117, ppl=7.65, wps=22297.6, ups=0.38, wpb=59092.1, bsz=1923, num_updates=290300, lr=0.000185599, gnorm=1.502, loss_scale=8192, train_wall=265, wall=0
2023-03-05 02:37:38 | INFO | train_inner | epoch 147:   1670 / 1978 loss=2.946, nll_loss=0.808, word_ins=2.639, length=3.074, ppl=7.71, wps=21912.5, ups=0.38, wpb=58123.7, bsz=1982.8, num_updates=290400, lr=0.000185567, gnorm=1.353, loss_scale=8192, train_wall=265, wall=0
2023-03-05 02:42:05 | INFO | train_inner | epoch 147:   1770 / 1978 loss=2.907, nll_loss=0.777, word_ins=2.61, length=2.966, ppl=7.5, wps=22256.6, ups=0.37, wpb=59502.4, bsz=2103.5, num_updates=290500, lr=0.000185535, gnorm=1.373, loss_scale=8192, train_wall=267, wall=0
2023-03-05 02:46:29 | INFO | train_inner | epoch 147:   1870 / 1978 loss=2.918, nll_loss=0.775, word_ins=2.608, length=3.1, ppl=7.56, wps=22636.8, ups=0.38, wpb=59733.6, bsz=1940, num_updates=290600, lr=0.000185504, gnorm=1.467, loss_scale=8192, train_wall=264, wall=0
2023-03-05 02:50:54 | INFO | train_inner | epoch 147:   1970 / 1978 loss=2.908, nll_loss=0.772, word_ins=2.605, length=3.03, ppl=7.51, wps=22511.6, ups=0.38, wpb=59775.2, bsz=1985.8, num_updates=290700, lr=0.000185472, gnorm=1.463, loss_scale=8192, train_wall=265, wall=0
2023-03-05 02:51:16 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 02:51:31 | INFO | valid | epoch 147 | valid on 'valid' subset | loss 4.115 | nll_loss 1.923 | word_ins 3.688 | length 4.273 | ppl 17.33 | wps 19719.1 | wpb 40242.5 | bsz 1500 | num_updates 290708 | best_loss 4.034
2023-03-05 02:51:31 | INFO | fairseq_cli.train | begin save checkpoint
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 02:51:39 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint147.pt (epoch 147 @ 290708 updates, score 4.115) (writing took 7.955062634311616 seconds)
2023-03-05 02:51:39 | INFO | fairseq_cli.train | end of epoch 147 (average epoch stats below)
2023-03-05 02:51:39 | INFO | train | epoch 147 | loss 2.914 | nll_loss 0.778 | word_ins 2.611 | length 3.032 | ppl 7.54 | wps 22089.8 | ups 0.37 | wpb 59283.5 | bsz 2003 | num_updates 290708 | lr 0.000185469 | gnorm 1.43 | loss_scale 8192 | train_wall 5268 | wall 0
2023-03-05 02:51:39 | INFO | fairseq.trainer | begin training epoch 148
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 02:55:53 | INFO | train_inner | epoch 148:     92 / 1978 loss=2.906, nll_loss=0.771, word_ins=2.605, length=3.003, ppl=7.49, wps=19629.3, ups=0.34, wpb=58541.1, bsz=1984.9, num_updates=290800, lr=0.00018544, gnorm=1.393, loss_scale=8192, train_wall=265, wall=0
2023-03-05 03:00:19 | INFO | train_inner | epoch 148:    192 / 1978 loss=2.897, nll_loss=0.766, word_ins=2.6, length=2.962, ppl=7.45, wps=22114.8, ups=0.37, wpb=58980.5, bsz=2069.9, num_updates=290900, lr=0.000185408, gnorm=1.405, loss_scale=8192, train_wall=266, wall=0
2023-03-05 03:04:46 | INFO | train_inner | epoch 148:    292 / 1978 loss=2.912, nll_loss=0.775, word_ins=2.609, length=3.028, ppl=7.53, wps=22107.1, ups=0.37, wpb=59005.9, bsz=2032.3, num_updates=291000, lr=0.000185376, gnorm=1.449, loss_scale=8192, train_wall=267, wall=0
2023-03-05 03:09:14 | INFO | train_inner | epoch 148:    392 / 1978 loss=2.907, nll_loss=0.768, word_ins=2.601, length=3.055, ppl=7.5, wps=22118.2, ups=0.37, wpb=59218.6, bsz=2014.6, num_updates=291100, lr=0.000185344, gnorm=1.411, loss_scale=8192, train_wall=267, wall=0
2023-03-05 03:13:41 | INFO | train_inner | epoch 148:    492 / 1978 loss=2.906, nll_loss=0.77, word_ins=2.604, length=3.018, ppl=7.49, wps=22240, ups=0.37, wpb=59489.5, bsz=2041.4, num_updates=291200, lr=0.000185312, gnorm=1.394, loss_scale=8192, train_wall=267, wall=0
2023-03-05 03:18:08 | INFO | train_inner | epoch 148:    592 / 1978 loss=2.915, nll_loss=0.78, word_ins=2.613, length=3.018, ppl=7.54, wps=22207.2, ups=0.38, wpb=59170.6, bsz=1942.7, num_updates=291300, lr=0.000185281, gnorm=1.396, loss_scale=8192, train_wall=266, wall=0
2023-03-05 03:22:35 | INFO | train_inner | epoch 148:    692 / 1978 loss=2.913, nll_loss=0.776, word_ins=2.609, length=3.041, ppl=7.53, wps=22378.5, ups=0.37, wpb=59688.4, bsz=1955.6, num_updates=291400, lr=0.000185249, gnorm=1.45, loss_scale=8192, train_wall=266, wall=0
2023-03-05 03:27:02 | INFO | train_inner | epoch 148:    792 / 1978 loss=2.897, nll_loss=0.762, word_ins=2.596, length=3.014, ppl=7.45, wps=22211.5, ups=0.37, wpb=59411.3, bsz=2045, num_updates=291500, lr=0.000185217, gnorm=1.397, loss_scale=8192, train_wall=267, wall=0
2023-03-05 03:31:28 | INFO | train_inner | epoch 148:    892 / 1978 loss=2.911, nll_loss=0.775, word_ins=2.609, length=3.027, ppl=7.52, wps=22231.9, ups=0.38, wpb=59141.4, bsz=2033.4, num_updates=291600, lr=0.000185185, gnorm=1.405, loss_scale=8192, train_wall=266, wall=0
2023-03-05 03:35:52 | INFO | train_inner | epoch 148:    992 / 1978 loss=2.923, nll_loss=0.789, word_ins=2.621, length=3.012, ppl=7.58, wps=22310.7, ups=0.38, wpb=58786.1, bsz=2029.8, num_updates=291700, lr=0.000185153, gnorm=1.344, loss_scale=8192, train_wall=263, wall=0
2023-03-05 03:40:01 | INFO | train_inner | epoch 148:   1092 / 1978 loss=2.896, nll_loss=0.758, word_ins=2.592, length=3.046, ppl=7.45, wps=23766.7, ups=0.4, wpb=59230.2, bsz=2033.2, num_updates=291800, lr=0.000185122, gnorm=1.38, loss_scale=8192, train_wall=249, wall=0
2023-03-05 03:44:11 | INFO | train_inner | epoch 148:   1192 / 1978 loss=2.921, nll_loss=0.785, word_ins=2.617, length=3.035, ppl=7.57, wps=23996.6, ups=0.4, wpb=59975.4, bsz=2000.3, num_updates=291900, lr=0.00018509, gnorm=1.512, loss_scale=8192, train_wall=250, wall=0
2023-03-05 03:48:23 | INFO | train_inner | epoch 148:   1292 / 1978 loss=2.91, nll_loss=0.775, word_ins=2.608, length=3.028, ppl=7.52, wps=23677.7, ups=0.4, wpb=59673.4, bsz=2005.4, num_updates=292000, lr=0.000185058, gnorm=1.442, loss_scale=8192, train_wall=252, wall=0
2023-03-05 03:52:18 | INFO | train_inner | epoch 148:   1392 / 1978 loss=2.927, nll_loss=0.79, word_ins=2.622, length=3.054, ppl=7.61, wps=25205.7, ups=0.42, wpb=59379.4, bsz=1893.5, num_updates=292100, lr=0.000185027, gnorm=1.472, loss_scale=8192, train_wall=235, wall=0
2023-03-05 03:56:10 | INFO | train_inner | epoch 148:   1492 / 1978 loss=2.911, nll_loss=0.776, word_ins=2.609, length=3.021, ppl=7.52, wps=25547.4, ups=0.43, wpb=59254, bsz=2021.2, num_updates=292200, lr=0.000184995, gnorm=1.442, loss_scale=8192, train_wall=232, wall=0
2023-03-05 04:00:02 | INFO | train_inner | epoch 148:   1592 / 1978 loss=2.924, nll_loss=0.785, word_ins=2.618, length=3.059, ppl=7.59, wps=25392.6, ups=0.43, wpb=58721.3, bsz=2011.6, num_updates=292300, lr=0.000184963, gnorm=1.423, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:03:54 | INFO | train_inner | epoch 148:   1692 / 1978 loss=2.916, nll_loss=0.781, word_ins=2.613, length=3.028, ppl=7.55, wps=25608.2, ups=0.43, wpb=59438.1, bsz=2014.4, num_updates=292400, lr=0.000184932, gnorm=1.42, loss_scale=8192, train_wall=232, wall=0
2023-03-05 04:07:46 | INFO | train_inner | epoch 148:   1792 / 1978 loss=2.911, nll_loss=0.778, word_ins=2.611, length=3.002, ppl=7.52, wps=25539.1, ups=0.43, wpb=59400.3, bsz=2063.6, num_updates=292500, lr=0.0001849, gnorm=1.388, loss_scale=8192, train_wall=232, wall=0
2023-03-05 04:11:37 | INFO | train_inner | epoch 148:   1892 / 1978 loss=2.923, nll_loss=0.785, word_ins=2.617, length=3.057, ppl=7.58, wps=25787.5, ups=0.43, wpb=59535.8, bsz=1933.7, num_updates=292600, lr=0.000184868, gnorm=1.513, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:14:57 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 04:15:18 | INFO | valid | epoch 148 | valid on 'valid' subset | loss 4.077 | nll_loss 1.916 | word_ins 3.681 | length 3.955 | ppl 16.88 | wps 7171.3 | wpb 40242.5 | bsz 1500 | num_updates 292686 | best_loss 4.034
2023-03-05 04:15:18 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-05 04:15:24 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint148.pt (epoch 148 @ 292686 updates, score 4.077) (writing took 5.643513989634812 seconds)
2023-03-05 04:15:24 | INFO | fairseq_cli.train | end of epoch 148 (average epoch stats below)
2023-03-05 04:15:24 | INFO | train | epoch 148 | loss 2.913 | nll_loss 0.777 | word_ins 2.61 | length 3.03 | ppl 7.53 | wps 23335.9 | ups 0.39 | wpb 59284.3 | bsz 2002.6 | num_updates 292686 | lr 0.000184841 | gnorm 1.426 | loss_scale 8192 | train_wall 4982 | wall 0
2023-03-05 04:15:24 | INFO | fairseq.trainer | begin training epoch 149
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 04:16:12 | INFO | train_inner | epoch 149:     14 / 1978 loss=2.922, nll_loss=0.784, word_ins=2.616, length=3.057, ppl=7.58, wps=21544.6, ups=0.36, wpb=59304.1, bsz=1935.8, num_updates=292700, lr=0.000184837, gnorm=1.494, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:20:05 | INFO | train_inner | epoch 149:    114 / 1978 loss=2.904, nll_loss=0.771, word_ins=2.605, length=2.997, ppl=7.49, wps=25555.9, ups=0.43, wpb=59452.4, bsz=2029.8, num_updates=292800, lr=0.000184805, gnorm=1.433, loss_scale=8192, train_wall=232, wall=0
2023-03-05 04:23:57 | INFO | train_inner | epoch 149:    214 / 1978 loss=2.918, nll_loss=0.782, word_ins=2.615, length=3.037, ppl=7.56, wps=25488.4, ups=0.43, wpb=59070.5, bsz=1956.7, num_updates=292900, lr=0.000184774, gnorm=1.435, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:27:48 | INFO | train_inner | epoch 149:    314 / 1978 loss=2.923, nll_loss=0.787, word_ins=2.619, length=3.042, ppl=7.58, wps=25479.7, ups=0.43, wpb=59012.1, bsz=1967.7, num_updates=293000, lr=0.000184742, gnorm=1.445, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:31:39 | INFO | train_inner | epoch 149:    414 / 1978 loss=2.917, nll_loss=0.776, word_ins=2.609, length=3.074, ppl=7.55, wps=25833.7, ups=0.43, wpb=59471.5, bsz=1943.2, num_updates=293100, lr=0.000184711, gnorm=1.412, loss_scale=8192, train_wall=230, wall=0
2023-03-05 04:35:32 | INFO | train_inner | epoch 149:    514 / 1978 loss=2.869, nll_loss=0.745, word_ins=2.58, length=2.887, ppl=7.31, wps=25649.6, ups=0.43, wpb=59826.5, bsz=2146.4, num_updates=293200, lr=0.000184679, gnorm=1.419, loss_scale=8192, train_wall=233, wall=0
2023-03-05 04:39:24 | INFO | train_inner | epoch 149:    614 / 1978 loss=2.918, nll_loss=0.781, word_ins=2.614, length=3.045, ppl=7.56, wps=25458.3, ups=0.43, wpb=59070.2, bsz=2016.3, num_updates=293300, lr=0.000184648, gnorm=1.425, loss_scale=8192, train_wall=232, wall=0
2023-03-05 04:43:16 | INFO | train_inner | epoch 149:    714 / 1978 loss=2.912, nll_loss=0.774, word_ins=2.608, length=3.047, ppl=7.53, wps=25609.8, ups=0.43, wpb=59340.5, bsz=2000.6, num_updates=293400, lr=0.000184616, gnorm=1.426, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:44:40 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-05 04:47:10 | INFO | train_inner | epoch 149:    815 / 1978 loss=2.901, nll_loss=0.765, word_ins=2.599, length=3.021, ppl=7.47, wps=25105, ups=0.43, wpb=58786.7, bsz=2021.8, num_updates=293500, lr=0.000184585, gnorm=1.368, loss_scale=8192, train_wall=234, wall=0
2023-03-05 04:51:01 | INFO | train_inner | epoch 149:    915 / 1978 loss=2.914, nll_loss=0.775, word_ins=2.609, length=3.048, ppl=7.53, wps=25544.9, ups=0.43, wpb=59065.9, bsz=1967.3, num_updates=293600, lr=0.000184553, gnorm=1.432, loss_scale=8192, train_wall=231, wall=0
2023-03-05 04:54:53 | INFO | train_inner | epoch 149:   1015 / 1978 loss=2.937, nll_loss=0.801, word_ins=2.633, length=3.041, ppl=7.66, wps=25501.2, ups=0.43, wpb=59231.5, bsz=1985.8, num_updates=293700, lr=0.000184522, gnorm=1.465, loss_scale=8192, train_wall=232, wall=0
2023-03-05 04:58:44 | INFO | train_inner | epoch 149:   1115 / 1978 loss=2.923, nll_loss=0.785, word_ins=2.616, length=3.07, ppl=7.59, wps=25873.3, ups=0.43, wpb=59702, bsz=1936.5, num_updates=293800, lr=0.000184491, gnorm=1.49, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:02:35 | INFO | train_inner | epoch 149:   1215 / 1978 loss=2.912, nll_loss=0.778, word_ins=2.611, length=3.008, ppl=7.53, wps=25838, ups=0.43, wpb=59603.1, bsz=1968.5, num_updates=293900, lr=0.000184459, gnorm=1.515, loss_scale=8192, train_wall=230, wall=0
2023-03-05 05:06:25 | INFO | train_inner | epoch 149:   1315 / 1978 loss=2.896, nll_loss=0.764, word_ins=2.598, length=2.982, ppl=7.44, wps=25927.8, ups=0.43, wpb=59705.6, bsz=2026.6, num_updates=294000, lr=0.000184428, gnorm=1.4, loss_scale=8192, train_wall=230, wall=0
2023-03-05 05:10:14 | INFO | train_inner | epoch 149:   1415 / 1978 loss=2.927, nll_loss=0.787, word_ins=2.619, length=3.078, ppl=7.6, wps=25594.5, ups=0.44, wpb=58685.4, bsz=1935.4, num_updates=294100, lr=0.000184396, gnorm=1.429, loss_scale=8192, train_wall=229, wall=0
2023-03-05 05:14:05 | INFO | train_inner | epoch 149:   1515 / 1978 loss=2.91, nll_loss=0.774, word_ins=2.607, length=3.028, ppl=7.52, wps=25762.5, ups=0.43, wpb=59454.2, bsz=2001.4, num_updates=294200, lr=0.000184365, gnorm=1.376, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:17:55 | INFO | train_inner | epoch 149:   1615 / 1978 loss=2.916, nll_loss=0.78, word_ins=2.613, length=3.032, ppl=7.55, wps=25682.2, ups=0.44, wpb=58988.8, bsz=1978.1, num_updates=294300, lr=0.000184334, gnorm=1.412, loss_scale=8192, train_wall=229, wall=0
2023-03-05 05:21:46 | INFO | train_inner | epoch 149:   1715 / 1978 loss=2.912, nll_loss=0.777, word_ins=2.61, length=3.013, ppl=7.52, wps=25517.3, ups=0.43, wpb=58960.1, bsz=2075.2, num_updates=294400, lr=0.000184302, gnorm=1.378, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:25:37 | INFO | train_inner | epoch 149:   1815 / 1978 loss=2.914, nll_loss=0.775, word_ins=2.608, length=3.064, ppl=7.54, wps=25580.2, ups=0.43, wpb=59189.3, bsz=2024.4, num_updates=294500, lr=0.000184271, gnorm=1.384, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:29:28 | INFO | train_inner | epoch 149:   1915 / 1978 loss=2.903, nll_loss=0.766, word_ins=2.6, length=3.037, ppl=7.48, wps=25795.7, ups=0.43, wpb=59590.8, bsz=2016.7, num_updates=294600, lr=0.00018424, gnorm=1.386, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:31:54 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 05:32:16 | INFO | valid | epoch 149 | valid on 'valid' subset | loss 4.093 | nll_loss 1.931 | word_ins 3.69 | length 4.025 | ppl 17.06 | wps 31412.9 | wpb 40242.5 | bsz 1500 | num_updates 294663 | best_loss 4.034
2023-03-05 05:32:16 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-05 05:32:22 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint149.pt (epoch 149 @ 294663 updates, score 4.093) (writing took 5.695578278042376 seconds)
2023-03-05 05:32:22 | INFO | fairseq_cli.train | end of epoch 149 (average epoch stats below)
2023-03-05 05:32:22 | INFO | train | epoch 149 | loss 2.911 | nll_loss 0.775 | word_ins 2.608 | length 3.024 | ppl 7.52 | wps 25376.7 | ups 0.43 | wpb 59282.8 | bsz 2002.8 | num_updates 294663 | lr 0.00018422 | gnorm 1.423 | loss_scale 8192 | train_wall 4569 | wall 0
2023-03-05 05:32:22 | INFO | fairseq.trainer | begin training epoch 150
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 05:34:04 | INFO | train_inner | epoch 150:     37 / 1978 loss=2.886, nll_loss=0.759, word_ins=2.593, length=2.926, ppl=7.39, wps=21594.8, ups=0.36, wpb=59543.2, bsz=2074.6, num_updates=294700, lr=0.000184209, gnorm=1.411, loss_scale=8192, train_wall=230, wall=0
2023-03-05 05:37:56 | INFO | train_inner | epoch 150:    137 / 1978 loss=2.87, nll_loss=0.745, word_ins=2.58, length=2.899, ppl=7.31, wps=25699.6, ups=0.43, wpb=59674.5, bsz=2086.7, num_updates=294800, lr=0.000184177, gnorm=1.401, loss_scale=8192, train_wall=232, wall=0
2023-03-05 05:41:48 | INFO | train_inner | epoch 150:    237 / 1978 loss=2.891, nll_loss=0.763, word_ins=2.597, length=2.944, ppl=7.42, wps=25595.2, ups=0.43, wpb=59254.3, bsz=2063.1, num_updates=294900, lr=0.000184146, gnorm=1.398, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:45:38 | INFO | train_inner | epoch 150:    337 / 1978 loss=2.903, nll_loss=0.773, word_ins=2.606, length=2.964, ppl=7.48, wps=25804.4, ups=0.43, wpb=59496.9, bsz=2012.2, num_updates=295000, lr=0.000184115, gnorm=1.406, loss_scale=8192, train_wall=230, wall=0
2023-03-05 05:49:29 | INFO | train_inner | epoch 150:    437 / 1978 loss=2.9, nll_loss=0.768, word_ins=2.602, length=2.976, ppl=7.46, wps=25742.8, ups=0.43, wpb=59398.7, bsz=2021.4, num_updates=295100, lr=0.000184084, gnorm=1.457, loss_scale=8192, train_wall=231, wall=0
2023-03-05 05:53:20 | INFO | train_inner | epoch 150:    537 / 1978 loss=2.915, nll_loss=0.777, word_ins=2.609, length=3.057, ppl=7.54, wps=25591.4, ups=0.43, wpb=59022.3, bsz=1987, num_updates=295200, lr=0.000184053, gnorm=1.376, loss_scale=8192, train_wall=230, wall=0
2023-03-05 05:57:10 | INFO | train_inner | epoch 150:    637 / 1978 loss=2.923, nll_loss=0.784, word_ins=2.616, length=3.068, ppl=7.58, wps=25707.8, ups=0.43, wpb=59159.8, bsz=1949.3, num_updates=295300, lr=0.000184021, gnorm=1.427, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:00:58 | INFO | train_inner | epoch 150:    737 / 1978 loss=2.926, nll_loss=0.786, word_ins=2.618, length=3.083, ppl=7.6, wps=25809.8, ups=0.44, wpb=58903.6, bsz=1917.3, num_updates=295400, lr=0.00018399, gnorm=1.454, loss_scale=8192, train_wall=228, wall=0
2023-03-05 06:04:49 | INFO | train_inner | epoch 150:    837 / 1978 loss=2.899, nll_loss=0.766, word_ins=2.6, length=2.994, ppl=7.46, wps=25466.4, ups=0.43, wpb=58854, bsz=2086.9, num_updates=295500, lr=0.000183959, gnorm=1.377, loss_scale=8192, train_wall=231, wall=0
2023-03-05 06:08:39 | INFO | train_inner | epoch 150:    937 / 1978 loss=2.918, nll_loss=0.779, word_ins=2.612, length=3.061, ppl=7.56, wps=25703.7, ups=0.43, wpb=59231.2, bsz=1943.8, num_updates=295600, lr=0.000183928, gnorm=1.407, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:12:30 | INFO | train_inner | epoch 150:   1037 / 1978 loss=2.921, nll_loss=0.787, word_ins=2.619, length=3.017, ppl=7.57, wps=25706.5, ups=0.43, wpb=59371.8, bsz=1994.5, num_updates=295700, lr=0.000183897, gnorm=1.447, loss_scale=8192, train_wall=231, wall=0
2023-03-05 06:16:22 | INFO | train_inner | epoch 150:   1137 / 1978 loss=2.897, nll_loss=0.766, word_ins=2.6, length=2.975, ppl=7.45, wps=25654.2, ups=0.43, wpb=59406.7, bsz=2105.2, num_updates=295800, lr=0.000183866, gnorm=1.41, loss_scale=8192, train_wall=231, wall=0
2023-03-05 06:20:13 | INFO | train_inner | epoch 150:   1237 / 1978 loss=2.923, nll_loss=0.782, word_ins=2.615, length=3.08, ppl=7.58, wps=25389.9, ups=0.43, wpb=58562.5, bsz=2002.6, num_updates=295900, lr=0.000183835, gnorm=1.445, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:24:03 | INFO | train_inner | epoch 150:   1337 / 1978 loss=2.919, nll_loss=0.784, word_ins=2.616, length=3.038, ppl=7.57, wps=25849, ups=0.43, wpb=59603.8, bsz=1983.3, num_updates=296000, lr=0.000183804, gnorm=1.437, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:27:54 | INFO | train_inner | epoch 150:   1437 / 1978 loss=2.911, nll_loss=0.777, word_ins=2.61, length=3.013, ppl=7.52, wps=25768.1, ups=0.43, wpb=59452.6, bsz=2010.8, num_updates=296100, lr=0.000183773, gnorm=1.399, loss_scale=8192, train_wall=231, wall=0
2023-03-05 06:31:44 | INFO | train_inner | epoch 150:   1537 / 1978 loss=2.924, nll_loss=0.781, word_ins=2.613, length=3.105, ppl=7.59, wps=25619.6, ups=0.43, wpb=58895.7, bsz=1958.2, num_updates=296200, lr=0.000183742, gnorm=1.419, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:35:36 | INFO | train_inner | epoch 150:   1637 / 1978 loss=2.9, nll_loss=0.766, word_ins=2.599, length=3.008, ppl=7.46, wps=25642.9, ups=0.43, wpb=59496.1, bsz=2082.1, num_updates=296300, lr=0.000183711, gnorm=1.38, loss_scale=8192, train_wall=232, wall=0
2023-03-05 06:39:27 | INFO | train_inner | epoch 150:   1737 / 1978 loss=2.928, nll_loss=0.791, word_ins=2.623, length=3.054, ppl=7.61, wps=25832.3, ups=0.43, wpb=59594.8, bsz=1886.6, num_updates=296400, lr=0.00018368, gnorm=1.464, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:43:17 | INFO | train_inner | epoch 150:   1837 / 1978 loss=2.917, nll_loss=0.783, word_ins=2.615, length=3.018, ppl=7.55, wps=25915.3, ups=0.43, wpb=59582.8, bsz=1958.3, num_updates=296500, lr=0.000183649, gnorm=1.462, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:47:08 | INFO | train_inner | epoch 150:   1937 / 1978 loss=2.914, nll_loss=0.776, word_ins=2.609, length=3.053, ppl=7.54, wps=25593.7, ups=0.43, wpb=59343.3, bsz=2045.2, num_updates=296600, lr=0.000183618, gnorm=1.406, loss_scale=8192, train_wall=232, wall=0
2023-03-05 06:48:43 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 06:49:07 | INFO | valid | epoch 150 | valid on 'valid' subset | loss 4.089 | nll_loss 1.919 | word_ins 3.679 | length 4.097 | ppl 17.02 | wps 31207.3 | wpb 40242.5 | bsz 1500 | num_updates 296641 | best_loss 4.034
2023-03-05 06:49:07 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-05 06:49:13 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint150.pt (epoch 150 @ 296641 updates, score 4.089) (writing took 6.496240872889757 seconds)
2023-03-05 06:49:13 | INFO | fairseq_cli.train | end of epoch 150 (average epoch stats below)
2023-03-05 06:49:13 | INFO | train | epoch 150 | loss 2.911 | nll_loss 0.776 | word_ins 2.609 | length 3.022 | ppl 7.52 | wps 25429.3 | ups 0.43 | wpb 59284.3 | bsz 2002.6 | num_updates 296641 | lr 0.000183605 | gnorm 1.42 | loss_scale 8192 | train_wall 4559 | wall 0
2023-03-05 06:49:13 | INFO | fairseq.trainer | begin training epoch 151
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 06:51:44 | INFO | train_inner | epoch 151:     59 / 1978 loss=2.899, nll_loss=0.765, word_ins=2.599, length=2.999, ppl=7.46, wps=21512.5, ups=0.36, wpb=59384.1, bsz=2036.1, num_updates=296700, lr=0.000183587, gnorm=1.396, loss_scale=8192, train_wall=230, wall=0
2023-03-05 06:55:36 | INFO | train_inner | epoch 151:    159 / 1978 loss=2.898, nll_loss=0.766, word_ins=2.6, length=2.971, ppl=7.45, wps=25604.5, ups=0.43, wpb=59288.2, bsz=2042.6, num_updates=296800, lr=0.000183556, gnorm=1.433, loss_scale=8192, train_wall=231, wall=0
2023-03-05 06:59:27 | INFO | train_inner | epoch 151:    259 / 1978 loss=2.922, nll_loss=0.785, word_ins=2.617, length=3.052, ppl=7.58, wps=25698.4, ups=0.43, wpb=59278.1, bsz=1946.2, num_updates=296900, lr=0.000183525, gnorm=1.466, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:03:18 | INFO | train_inner | epoch 151:    359 / 1978 loss=2.9, nll_loss=0.771, word_ins=2.605, length=2.954, ppl=7.46, wps=25791.5, ups=0.43, wpb=59592, bsz=2017.3, num_updates=297000, lr=0.000183494, gnorm=1.428, loss_scale=8192, train_wall=231, wall=0
2023-03-05 07:07:09 | INFO | train_inner | epoch 151:    459 / 1978 loss=2.895, nll_loss=0.763, word_ins=2.597, length=2.981, ppl=7.44, wps=25732.7, ups=0.43, wpb=59608.9, bsz=2028.2, num_updates=297100, lr=0.000183463, gnorm=1.426, loss_scale=8192, train_wall=231, wall=0
2023-03-05 07:11:00 | INFO | train_inner | epoch 151:    559 / 1978 loss=2.927, nll_loss=0.789, word_ins=2.621, length=3.053, ppl=7.6, wps=25475.1, ups=0.43, wpb=58880.6, bsz=1952.8, num_updates=297200, lr=0.000183432, gnorm=1.432, loss_scale=8192, train_wall=231, wall=0
2023-03-05 07:14:52 | INFO | train_inner | epoch 151:    659 / 1978 loss=2.918, nll_loss=0.782, word_ins=2.615, length=3.029, ppl=7.56, wps=25583.9, ups=0.43, wpb=59108.4, bsz=2019.3, num_updates=297300, lr=0.000183401, gnorm=1.427, loss_scale=8192, train_wall=231, wall=0
2023-03-05 07:18:42 | INFO | train_inner | epoch 151:    759 / 1978 loss=2.911, nll_loss=0.778, word_ins=2.611, length=3.003, ppl=7.52, wps=25899.5, ups=0.43, wpb=59652.6, bsz=1972.6, num_updates=297400, lr=0.000183371, gnorm=1.449, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:22:33 | INFO | train_inner | epoch 151:    859 / 1978 loss=2.901, nll_loss=0.764, word_ins=2.598, length=3.031, ppl=7.47, wps=25882.2, ups=0.43, wpb=59712.6, bsz=2025.8, num_updates=297500, lr=0.00018334, gnorm=1.421, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:23:47 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 8192.0
2023-03-05 07:26:28 | INFO | train_inner | epoch 151:    960 / 1978 loss=2.891, nll_loss=0.762, word_ins=2.596, length=2.951, ppl=7.42, wps=25369.3, ups=0.43, wpb=59607.6, bsz=2081, num_updates=297600, lr=0.000183309, gnorm=1.342, loss_scale=8192, train_wall=235, wall=0
2023-03-05 07:30:18 | INFO | train_inner | epoch 151:   1060 / 1978 loss=2.901, nll_loss=0.766, word_ins=2.599, length=3.016, ppl=7.47, wps=25722.8, ups=0.43, wpb=59285.8, bsz=2033.8, num_updates=297700, lr=0.000183278, gnorm=1.417, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:34:08 | INFO | train_inner | epoch 151:   1160 / 1978 loss=2.915, nll_loss=0.78, word_ins=2.613, length=3.026, ppl=7.54, wps=25759.9, ups=0.43, wpb=59284.2, bsz=1965.8, num_updates=297800, lr=0.000183247, gnorm=1.415, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:37:58 | INFO | train_inner | epoch 151:   1260 / 1978 loss=2.929, nll_loss=0.791, word_ins=2.623, length=3.059, ppl=7.62, wps=25690, ups=0.43, wpb=59068, bsz=1965.5, num_updates=297900, lr=0.000183217, gnorm=1.397, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:41:49 | INFO | train_inner | epoch 151:   1360 / 1978 loss=2.926, nll_loss=0.788, word_ins=2.619, length=3.066, ppl=7.6, wps=25463.2, ups=0.43, wpb=58704.3, bsz=1926.5, num_updates=298000, lr=0.000183186, gnorm=1.362, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:45:39 | INFO | train_inner | epoch 151:   1460 / 1978 loss=2.913, nll_loss=0.778, word_ins=2.611, length=3.024, ppl=7.53, wps=25733.4, ups=0.43, wpb=59207.6, bsz=2017.3, num_updates=298100, lr=0.000183155, gnorm=1.414, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:49:31 | INFO | train_inner | epoch 151:   1560 / 1978 loss=2.892, nll_loss=0.763, word_ins=2.597, length=2.953, ppl=7.42, wps=25670.6, ups=0.43, wpb=59525.2, bsz=2119.8, num_updates=298200, lr=0.000183124, gnorm=1.445, loss_scale=8192, train_wall=232, wall=0
2023-03-05 07:53:21 | INFO | train_inner | epoch 151:   1660 / 1978 loss=2.92, nll_loss=0.78, word_ins=2.613, length=3.076, ppl=7.57, wps=25846.1, ups=0.43, wpb=59525.3, bsz=1906.4, num_updates=298300, lr=0.000183094, gnorm=1.458, loss_scale=8192, train_wall=230, wall=0
2023-03-05 07:57:12 | INFO | train_inner | epoch 151:   1760 / 1978 loss=2.909, nll_loss=0.777, word_ins=2.61, length=2.994, ppl=7.51, wps=25556.5, ups=0.43, wpb=59157.1, bsz=2019, num_updates=298400, lr=0.000183063, gnorm=1.415, loss_scale=8192, train_wall=231, wall=0
2023-03-05 08:01:02 | INFO | train_inner | epoch 151:   1860 / 1978 loss=2.933, nll_loss=0.791, word_ins=2.622, length=3.107, ppl=7.63, wps=25687.7, ups=0.43, wpb=59076.5, bsz=1922.1, num_updates=298500, lr=0.000183032, gnorm=1.421, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:04:55 | INFO | train_inner | epoch 151:   1960 / 1978 loss=2.903, nll_loss=0.773, word_ins=2.606, length=2.968, ppl=7.48, wps=25396, ups=0.43, wpb=59061, bsz=2052.9, num_updates=298600, lr=0.000183002, gnorm=1.417, loss_scale=8192, train_wall=232, wall=0
2023-03-05 08:05:36 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 08:05:57 | INFO | valid | epoch 151 | valid on 'valid' subset | loss 4.084 | nll_loss 1.919 | word_ins 3.685 | length 3.987 | ppl 16.96 | wps 6236.8 | wpb 40242.5 | bsz 1500 | num_updates 298618 | best_loss 4.034
2023-03-05 08:05:57 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-05 08:06:03 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint151.pt (epoch 151 @ 298618 updates, score 4.084) (writing took 5.59220127761364 seconds)
2023-03-05 08:06:03 | INFO | fairseq_cli.train | end of epoch 151 (average epoch stats below)
2023-03-05 08:06:03 | INFO | train | epoch 151 | loss 2.91 | nll_loss 0.776 | word_ins 2.609 | length 3.016 | ppl 7.52 | wps 25426.5 | ups 0.43 | wpb 59283 | bsz 2002.6 | num_updates 298618 | lr 0.000182996 | gnorm 1.42 | loss_scale 8192 | train_wall 4563 | wall 0
2023-03-05 08:06:03 | INFO | fairseq.trainer | begin training epoch 152
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 08:09:27 | INFO | train_inner | epoch 152:     82 / 1978 loss=2.918, nll_loss=0.777, word_ins=2.611, length=3.069, ppl=7.56, wps=21687, ups=0.37, wpb=58908.2, bsz=2017.7, num_updates=298700, lr=0.000182971, gnorm=1.451, loss_scale=8192, train_wall=232, wall=0
2023-03-05 08:13:17 | INFO | train_inner | epoch 152:    182 / 1978 loss=2.902, nll_loss=0.769, word_ins=2.603, length=2.997, ppl=7.48, wps=25787.9, ups=0.43, wpb=59395.7, bsz=1949.4, num_updates=298800, lr=0.00018294, gnorm=1.441, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:17:07 | INFO | train_inner | epoch 152:    282 / 1978 loss=2.909, nll_loss=0.773, word_ins=2.606, length=3.023, ppl=7.51, wps=25837.1, ups=0.43, wpb=59547, bsz=1997.8, num_updates=298900, lr=0.00018291, gnorm=1.451, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:20:59 | INFO | train_inner | epoch 152:    382 / 1978 loss=2.889, nll_loss=0.756, word_ins=2.591, length=2.981, ppl=7.41, wps=25549, ups=0.43, wpb=59143.6, bsz=2082.6, num_updates=299000, lr=0.000182879, gnorm=1.382, loss_scale=8192, train_wall=231, wall=0
2023-03-05 08:24:49 | INFO | train_inner | epoch 152:    482 / 1978 loss=2.918, nll_loss=0.78, word_ins=2.613, length=3.054, ppl=7.56, wps=25729, ups=0.43, wpb=59209.2, bsz=1899.9, num_updates=299100, lr=0.000182849, gnorm=1.436, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:28:40 | INFO | train_inner | epoch 152:    582 / 1978 loss=2.905, nll_loss=0.769, word_ins=2.603, length=3.026, ppl=7.49, wps=25496.9, ups=0.43, wpb=58806.4, bsz=2009.8, num_updates=299200, lr=0.000182818, gnorm=1.38, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:32:30 | INFO | train_inner | epoch 152:    682 / 1978 loss=2.896, nll_loss=0.763, word_ins=2.597, length=2.985, ppl=7.44, wps=25606.4, ups=0.43, wpb=59076, bsz=2026.3, num_updates=299300, lr=0.000182788, gnorm=1.422, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:36:21 | INFO | train_inner | epoch 152:    782 / 1978 loss=2.905, nll_loss=0.769, word_ins=2.603, length=3.021, ppl=7.49, wps=25726.1, ups=0.43, wpb=59324.9, bsz=2005.4, num_updates=299400, lr=0.000182757, gnorm=1.437, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:40:13 | INFO | train_inner | epoch 152:    882 / 1978 loss=2.903, nll_loss=0.766, word_ins=2.599, length=3.038, ppl=7.48, wps=25688.7, ups=0.43, wpb=59665.5, bsz=2037.9, num_updates=299500, lr=0.000182727, gnorm=1.436, loss_scale=8192, train_wall=232, wall=0
2023-03-05 08:44:04 | INFO | train_inner | epoch 152:    982 / 1978 loss=2.92, nll_loss=0.787, word_ins=2.619, length=3.006, ppl=7.57, wps=25432.5, ups=0.43, wpb=58681.9, bsz=1955.9, num_updates=299600, lr=0.000182696, gnorm=1.384, loss_scale=8192, train_wall=231, wall=0
2023-03-05 08:47:55 | INFO | train_inner | epoch 152:   1082 / 1978 loss=2.902, nll_loss=0.763, word_ins=2.596, length=3.053, ppl=7.47, wps=25739.5, ups=0.43, wpb=59439.2, bsz=1999.6, num_updates=299700, lr=0.000182666, gnorm=1.37, loss_scale=8192, train_wall=231, wall=0
2023-03-05 08:51:45 | INFO | train_inner | epoch 152:   1182 / 1978 loss=2.901, nll_loss=0.769, word_ins=2.602, length=2.987, ppl=7.47, wps=25763, ups=0.43, wpb=59415.7, bsz=2018.3, num_updates=299800, lr=0.000182635, gnorm=1.416, loss_scale=8192, train_wall=230, wall=0
2023-03-05 08:55:37 | INFO | train_inner | epoch 152:   1282 / 1978 loss=2.929, nll_loss=0.789, word_ins=2.621, length=3.07, ppl=7.61, wps=25579.7, ups=0.43, wpb=59218.7, bsz=1969.3, num_updates=299900, lr=0.000182605, gnorm=1.46, loss_scale=8192, train_wall=231, wall=0
2023-03-05 08:59:28 | INFO | train_inner | epoch 152:   1382 / 1978 loss=2.914, nll_loss=0.779, word_ins=2.612, length=3.027, ppl=7.54, wps=25636.8, ups=0.43, wpb=59321.1, bsz=2017.4, num_updates=300000, lr=0.000182574, gnorm=1.467, loss_scale=8192, train_wall=231, wall=0
2023-03-05 08:59:28 | INFO | fairseq_cli.train | begin validation on "valid" subset
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:root:ceph manager has not be registered
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
WARNING:fairseq.checkpoint_utils:no ceph manager
2023-03-05 08:59:52 | INFO | valid | epoch 152 | valid on 'valid' subset | loss 4.162 | nll_loss 1.919 | word_ins 3.683 | length 4.79 | ppl 17.9 | wps 31069.9 | wpb 40242.5 | bsz 1500 | num_updates 300000 | best_loss 4.034
2023-03-05 08:59:52 | INFO | fairseq_cli.train | begin save checkpoint
2023-03-05 08:59:55 | INFO | fairseq.checkpoint_utils | saved checkpoint /mnt/petrelfs/jiangshuyang/checkpoints/WMTdeen_distill_CMLMC_L5D3_300k_causalself_amlpseq_ema99_scale_c5/checkpoint_last.pt (epoch 152 @ 300000 updates, score 4.162) (writing took 3.005044285207987 seconds)
2023-03-05 08:59:55 | INFO | fairseq_cli.train | end of epoch 152 (average epoch stats below)
2023-03-05 08:59:55 | INFO | train | epoch 152 | loss 2.907 | nll_loss 0.772 | word_ins 2.605 | length 3.02 | ppl 7.5 | wps 25328.8 | ups 0.43 | wpb 59244.3 | bsz 2001.7 | num_updates 300000 | lr 0.000182574 | gnorm 1.422 | loss_scale 8192 | train_wall 3190 | wall 0
2023-03-05 08:59:55 | INFO | fairseq_cli.train | done training in 465530.5 seconds
